/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => IOCCanvasPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian5 = require("obsidian");

// src/RenderTimelinesModal.ts
var import_obsidian = require("obsidian");

// src/IOCCardsTypes.ts
var IOC_TYPES = {
  // --- Network-related IOC types ---
  ip_address: {
    name: "IP Address",
    icon: "network",
    color: "#FF6B6B",
    fields: ["IP", "country", "asn"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <circle cx="12" cy="15" r="7"/>
  <path d="M12 8c-3.9 0-7 3.1-7 7"/>
  <path d="M12 8c3.9 0 7 3.1 7 7"/>
  <line x1="5" y1="15" x2="19" y2="15"/>
  <line x1="12" y1="8" x2="12" y2="22"/>
  <path d="M12 8c-1.7-3-1.7-6 0-6s1.7 3 0 6z"/>
  <circle cx="12" cy="4" r="2" fill="currentColor"/>
</svg>`
  },
  domain: {
    name: "Domain Name",
    icon: "globe",
    color: "#4ECDC4",
    fields: ["name", "IP"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="10"/>
    <line x1="2" y1="12" x2="22" y2="12"/>
    <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
  </svg>`
  },
  file_hash: {
    name: "File Hash",
    icon: "hash",
    color: "#45B7D1",
    fields: ["hash", "hash_type", "filename", "file_size"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <line x1="4" y1="9" x2="20" y2="9"/>
    <line x1="4" y1="15" x2="20" y2="15"/>
    <line x1="10" y1="3" x2="8" y2="21"/>
    <line x1="16" y1="3" x2="14" y2="21"/>
  </svg>`
  },
  url: {
    name: "URL",
    icon: "link",
    color: "#96CEB4",
    fields: ["url", "domain", "category"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
    <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
  </svg>`
  },
  email: {
    name: "Email Address",
    icon: "mail",
    color: "#FECA57",
    fields: ["email", "domain"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
    <polyline points="22,6 12,13 2,6"/>
  </svg>`
  },
  // Hostname is the only IOC type with os_icons, triggering a secondary
  // OS selector sub-view in RenderIOCCardsModal before card creation.
  hostname: {
    name: "Hostname",
    icon: "monitor",
    color: "#9C27B0",
    fields: ["hostname", "os_type", "domain"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
    <line x1="8" y1="21" x2="16" y2="21"/>
    <line x1="12" y1="17" x2="12" y2="21"/>
  </svg>`,
    os_icons: {
      windows_workstation: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="currentColor">
    <path d="M0 3.5L10 2v9.5H0V3.5zM11 1.9l13-1.9v11H11V1.9zM0 12.5h10V22l-10-1.5v-8zM11 12h13v10l-13 2v-12z"/>
  </svg>`,
      windows_server: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="currentColor">
    <path d="M0 3.5L10 2v9.5H0V3.5zM11 1.9l13-1.9v11H11V1.9zM0 12.5h10V22l-10-1.5v-8zM11 12h13v10l-13 2v-12z"/>
  </svg>`,
      macos: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="currentColor">
    <path d="M17.05 20.28c-.98.95-2.05.8-3.08.35-1.09-.46-2.09-.48-3.24 0-1.44.62-2.2.44-3.06-.35C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"/>
  </svg>`,
      linux: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="currentColor">
    <path d="M12.504 0c-.155 0-.315.008-.48.021-4.226.333-3.105 4.807-3.17 6.298-.076 1.092-.3 1.953-1.05 3.02-.885 1.051-2.127 2.75-2.716 4.521-.278.84-.41 1.684-.287 2.489.845 5.548 5.676 6.016 6.855 6.016.178 0 .287-.016.287-.016s8.029-.192 8.03-8.047c0-4.662-3.916-9.69-7.47-14.302z"/>
  </svg>`
    }
  },
  // --- Detection rule types ---
  yara_rule: {
    name: "YARA Rule",
    icon: "shield",
    color: "#FF9FF3",
    fields: ["rule_name", "rule_content"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
    <text x="12" y="15" font-size="10" text-anchor="middle" fill="currentColor" font-weight="bold">Y</text>
  </svg>`
  },
  sigma_rule: {
    name: "Sigma Rule",
    icon: "search",
    color: "#A8E6CF",
    fields: ["rule_name", "rule_content"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="10"/>
    <text x="12" y="17" font-size="14" text-anchor="middle" fill="currentColor" font-weight="bold">\u03A3</text>
  </svg>`
  },
  // --- Host-based IOC types ---
  registry_key: {
    name: "Registry Key",
    icon: "settings",
    color: "#FFB74D",
    fields: ["key_path", "key_name", "key_data"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
    <path d="M7 11V7a5 5 0 0 1 9.9-1"/>
  </svg>`
  },
  process_name: {
    name: "Process Name",
    icon: "cpu",
    color: "#81C784",
    fields: ["process_name", "command_line", "pid", "parent_process"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <rect x="3" y="5" width="18" height="14" rx="2" ry="2"/>
  <line x1="3" y1="9" x2="21" y2="9"/>
  <circle cx="6" cy="7" r="0.8" fill="currentColor"/>
  <circle cx="9" cy="7" r="0.8" fill="currentColor"/>
  <line x1="7" y1="13" x2="17" y2="13"/>
  <line x1="7" y1="16" x2="14" y2="16"/>
</svg>`
  },
  network: {
    name: "Network",
    icon: "activity",
    color: "#9575CD",
    fields: ["protocol", "port", "direction"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
  </svg>`
  },
  command_line: {
    name: "Command Line",
    icon: "terminal",
    color: "#2E8B57",
    fields: ["command", "pid", "parent_process"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <polyline points="4 17 10 11 4 5"/>
    <line x1="12" y1="19" x2="20" y2="19"/>
  </svg>`
  },
  // --- File and artifact types ---
  file: {
    name: "File",
    icon: "file",
    color: "#E91E63",
    fields: ["name", "type", "path", "size", "hash", "pid"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <path d="M4 4h12l4 4v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2z"/>
  <line x1="8" y1="11" x2="16" y2="11"/>
  <line x1="8" y1="15" x2="16" y2="15"/>
</svg>`
  },
  // --- Utility types ---
  note: {
    name: "Note",
    icon: "note",
    color: "#F39C12",
    fields: ["NB"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <rect x="4" y="4" width="16" height="16" rx="2" ry="2"/>
  <line x1="8" y1="8" x2="16" y2="8"/>
  <line x1="8" y1="12" x2="16" y2="12"/>
  <line x1="8" y1="16" x2="14" y2="16"/>
</svg>`
  },
  dll: {
    name: "DLL",
    icon: "dll",
    color: "#3498DB",
    fields: ["name", "type", "path", "size", "hash"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"/>
  <polyline points="14 2 14 8 20 8"/>
  <circle cx="12" cy="13" r="2"/>
  <path d="M12 10.5v-1"/>
  <path d="M12 15.5v1"/>
  <path d="M14.5 11.5l0.7-0.7"/>
  <path d="M9.8 16.2l-0.7 0.7"/>
  <path d="M15.5 13h1"/>
  <path d="M8.5 13h-1"/>
  <path d="M14.5 14.5l0.7 0.7"/>
  <path d="M9.8 9.8l-0.7-0.7"/>
</svg>`
  },
  // --- Threat infrastructure ---
  c2: {
    name: "C2",
    icon: "c2",
    color: "#E74C3C",
    fields: ["domain", "IP"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <circle cx="12" cy="12" r="9"/>
  <path d="M12 3v1.5"/>
  <path d="M12 19.5V21"/>
  <path d="M3 12h1.5"/>
  <path d="M19.5 12H21"/>
  <path d="M5.6 5.6l1.1 1.1"/>
  <path d="M17.3 17.3l1.1 1.1"/>
  <path d="M5.6 18.4l1.1-1.1"/>
  <path d="M17.3 6.7l1.1-1.1"/>
  <polyline points="8 10 11 13 8 16"/>
  <line x1="13" y1="16" x2="16" y2="16"/>
</svg>`
  }
};

// src/IOCParser.ts
var IOC_TYPE_PATTERNS = [
  { pattern: /IP Address/i, type: "IP Address" },
  { pattern: /Domain Name/i, type: "Domain Name" },
  { pattern: /File Hash/i, type: "File Hash" },
  { pattern: /URL/i, type: "URL" },
  { pattern: /Email Address/i, type: "Email Address" },
  { pattern: /Hostname/i, type: "Hostname" },
  { pattern: /YARA Rule/i, type: "YARA Rule" },
  { pattern: /Sigma Rule/i, type: "Sigma Rule" },
  { pattern: /Registry Key/i, type: "Registry Key" },
  { pattern: /Process Name/i, type: "Process Name" },
  // FIX: The IOC_TYPES constant uses "Network" (not "Network Traffic").
  // The old code used "Network Traffic" which would never match the
  // IOC_TYPES lookup, so color and icon were never resolved for this type.
  { pattern: /Network/i, type: "Network" },
  { pattern: /Command Line/i, type: "Command Line" },
  { pattern: /File/i, type: "File" },
  { pattern: /Note/i, type: "Note" },
  { pattern: /DLL/i, type: "DLL" },
  { pattern: /C2/i, type: "C2" }
];
function detectIOCType(text) {
  for (const { pattern, type } of IOC_TYPE_PATTERNS) {
    if (pattern.test(text)) {
      return type;
    }
  }
  return "";
}
function extractValue(text) {
  console.debug("[IOCParser] extractValue - input length:", text.length);
  const codeBlockMatch = text.match(/```([\s\S]*?)```/);
  if (codeBlockMatch && codeBlockMatch[1] && codeBlockMatch[1].trim()) {
    const value2 = codeBlockMatch[1].trim();
    console.debug("[IOCParser] extractValue - found code block:", value2);
    return value2;
  }
  const parts = text.split("</div></div>");
  if (parts.length < 2) {
    console.debug("[IOCParser] extractValue - no HTML header found");
    return "";
  }
  let afterHeader = parts[1].trim();
  console.debug("[IOCParser] extractValue - content after header length:", afterHeader.length);
  const fieldMatch = afterHeader.match(/[^:\n]+:\s*/);
  if (!fieldMatch) {
    console.debug("[IOCParser] extractValue - no field label found");
    return "";
  }
  console.debug("[IOCParser] extractValue - first field:", fieldMatch[0].trim());
  const afterFieldLabel = afterHeader.substring(fieldMatch.index + fieldMatch[0].length);
  const separatorMatch = afterFieldLabel.match(/\n?-----/);
  const nextFieldMatch = afterFieldLabel.match(/\n([^:\n]+:\s*)/);
  let value;
  let delimiterIndex;
  if (separatorMatch && separatorMatch.index !== void 0) {
    delimiterIndex = separatorMatch.index;
  }
  if (nextFieldMatch && nextFieldMatch.index !== void 0) {
    if (delimiterIndex === void 0 || nextFieldMatch.index < delimiterIndex) {
      delimiterIndex = nextFieldMatch.index;
    }
  }
  if (delimiterIndex === void 0) {
    const timeIndex = afterFieldLabel.indexOf("Time of Event:");
    value = timeIndex === -1 ? afterFieldLabel : afterFieldLabel.substring(0, timeIndex);
  } else {
    value = afterFieldLabel.substring(0, delimiterIndex);
  }
  const trimmedValue = value.trim();
  console.debug("[IOCParser] extractValue - result:", trimmedValue || "(empty)");
  return trimmedValue;
}
function extractTime(text) {
  const timePatterns = [
    /\*\*Time of Event:\*\*\s*(\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2})/i,
    /\*\*Time of Event:\*\*\s*(\d{4}-\d{2}-\d{2})/i,
    /Time of Event[:\s]*(\d{4}-\d{2}-\d{2}[T\s]\d{2}:\d{2}:\d{2})/i,
    /Time of Event[:\s]*(\d{4}-\d{2}-\d{2})/i,
    /Time[:\s]*(\d{4}-\d{2}-\d{2}[T\s]\d{2}:\d{2}:\d{2})/i,
    /(\d{4}-\d{2}-\d{2}[T\s]\d{2}:\d{2}:\d{2})/i
  ];
  for (const pattern of timePatterns) {
    const match = text.match(pattern);
    if (match && match[1]) {
      return match[1].trim();
    }
  }
  return "";
}
function extractSplunkQuery(text) {
  const match = text.match(/\*\*Splunk Query:\*\*[:\s]*([\s\S]*?)(?=\*\*|$)/i);
  if (match && match[1] && match[1].trim()) {
    return match[1].trim();
  }
  return "";
}
function extractTactic(text) {
  let match = text.match(/Mitre Tactic:[ \t]*([^\n]*)/i);
  if (match && match[1] && match[1].trim()) {
    return match[1].trim().toUpperCase();
  }
  match = text.match(/\*\*Mitre Tactic:\*\*[ \t]*([^\n]*)/i) || text.match(/\*\*Mitre Tactic:\*\*[:\s]*([\s\S]*?)(?=\*\*|$)/i);
  if (match && match[1] && match[1].trim()) {
    return match[1].trim().toUpperCase();
  }
  return "";
}
function extractTechnique(text) {
  let match = text.match(/Mitre Technique:[ \t]*([^\n]*)/i);
  if (match && match[1] && match[1].trim()) {
    return match[1].trim().toUpperCase();
  }
  match = text.match(/\*\*Mitre Technique:\*\*[ \t]*([^\n]*)/i) || text.match(/\*\*Mitre Technique:\*\*[:\s]*([\s\S]*?)(?=\*\*|$)/i);
  if (match && match[1] && match[1].trim()) {
    return match[1].trim().toUpperCase();
  }
  return "";
}
function extractCardId(text) {
  console.debug("[IOCParser] Extracting Card ID...");
  const commentMatch = text.match(/<!-- IOC_CARD_ID:([^>]+) -->/);
  if (commentMatch && commentMatch[1]) {
    const cardId = commentMatch[1].trim();
    console.debug("[IOCParser] Found Card ID in HTML comment:", cardId);
    return cardId;
  }
  const cardIdMatch = text.match(/Card ID:\s*([^\n]+)/i);
  if (cardIdMatch && cardIdMatch[1]) {
    const cardId = cardIdMatch[1].trim();
    console.debug("[IOCParser] Found Card ID in legacy field format:", cardId);
    return cardId;
  }
  console.debug("[IOCParser] No Card ID found");
  return "";
}
function lookupTypeVisuals(iocType, fallbackColor) {
  let icon = "";
  let color = fallbackColor;
  if (IOC_TYPES && typeof IOC_TYPES === "object") {
    for (const key of Object.keys(IOC_TYPES)) {
      if (IOC_TYPES[key].name === iocType) {
        icon = IOC_TYPES[key].svg;
        color = IOC_TYPES[key].color;
        break;
      }
    }
  }
  return { icon, color };
}
function parseIOCNode(node) {
  console.debug("[IOCParser] parseIOCNode - node:", node.id);
  if (!node.text) {
    return null;
  }
  const iocType = detectIOCType(node.text);
  if (!iocType) {
    return null;
  }
  const value = extractValue(node.text);
  const time = extractTime(node.text);
  const splunkQuery = extractSplunkQuery(node.text);
  const tactic = extractTactic(node.text);
  const technique = extractTechnique(node.text);
  const cardId = extractCardId(node.text);
  const fallbackColor = node.color || "#333";
  const { icon, color } = lookupTypeVisuals(iocType, fallbackColor);
  const result = {
    id: node.id,
    cardId,
    type: iocType,
    value,
    time,
    splunkQuery,
    tactic,
    technique,
    icon,
    color
  };
  console.debug("[IOCParser] parseIOCNode - result:", iocType, "value:", value || "(empty)");
  return result;
}

// src/TimeTimelineProcessing.ts
var TimeTimelineProcessor = class {
  constructor(app, plugin, IOCCardsTypes) {
    this.app = app;
    this.plugin = plugin;
    this.IOCCardsTypes = IOCCardsTypes;
  }
  /**
   * Extract IOC data from all canvas text nodes for time-based timeline.
   *
   * Iterates over every node in the active canvas. Each node with a `text`
   * property is parsed via the shared IOCParser. Nodes that match a known
   * IOC type are included in the returned array.
   *
   * The caller (RenderTimelinesModal) sorts the result by time for display.
   *
   * DEBUG: Console logs show processing steps for troubleshooting.
   *
   * @returns Array of parsed IOC node data objects, unsorted
   */
  extractFixedIOCData() {
    console.debug("[TimeProcessor] Starting extraction");
    const activeLeaf = this.app.workspace.activeLeaf;
    if (!activeLeaf || !activeLeaf.view || activeLeaf.view.getViewType() !== "canvas") {
      console.debug("[TimeProcessor] No active canvas view");
      return [];
    }
    const canvasView = activeLeaf.view;
    const canvas = canvasView.canvas;
    if (!canvas || !canvas.nodes) {
      console.debug("[TimeProcessor] No canvas or nodes");
      return [];
    }
    const totalNodes = canvas.nodes.size || canvas.nodes.length || 0;
    console.debug("[TimeProcessor] Processing", totalNodes, "nodes");
    const iocData = [];
    let emptyValueCount = 0;
    canvas.nodes.forEach((node) => {
      if (node.text) {
        const parsedData = parseIOCNode(node);
        if (parsedData) {
          if (!parsedData.value || !parsedData.value.trim()) {
            emptyValueCount++;
          }
          iocData.push(parsedData);
        }
      }
    });
    console.debug("[TimeProcessor] Extraction complete - found:", iocData.length, "IOCs,", emptyValueCount, "empty values");
    return iocData;
  }
};

// src/RenderTimelinesModal.ts
var RenderTimelinesModal = class extends import_obsidian.Modal {
  constructor(app, plugin) {
    super(app);
    this.plugin = plugin;
    this.timeProcessor = new TimeTimelineProcessor(app, plugin, plugin.iocTypes);
  }
  onOpen() {
    const { contentEl } = this;
    this.modalEl.classList.add("timeline-modal-fullscreen");
    const headerContainer = contentEl.createDiv("timeline-modal-header");
    headerContainer.createEl("h2", { text: "\u{1F550} Time-Based IOC Timeline" });
    const contentArea = contentEl.createDiv("timeline-tab-content");
    this.renderEnhancedTimeTimeline(contentArea);
  }
  /**
   * Renders the chronological Time Timeline. Extracts IOC data from canvas
   * nodes via the time processor, sorts by event timestamp, and renders each
   * IOC as a colored card with a gradient connector to the next card.
   *
   * DEBUG: Console logs show timeline data for troubleshooting.
   */
  renderEnhancedTimeTimeline(container) {
    console.debug("[TimeTimeline] Starting render");
    const iocData = this.timeProcessor.extractFixedIOCData();
    console.debug("[TimeTimeline] Extracted", iocData.length, "IOC cards");
    if (iocData.length === 0) {
      container.createEl("p", {
        text: "No IOC cards found in the current canvas. Create some IOC cards first to see the timeline.",
        cls: "timeline-empty-message"
      });
      return;
    }
    iocData.sort((a, b) => new Date(a.time).getTime() - new Date(b.time).getTime());
    const timelineContainer = container.createDiv("timeline-container");
    iocData.forEach((ioc, index) => {
      const timelineItem = timelineContainer.createDiv("timeline-item");
      timelineItem.style.setProperty("--ioc-color", ioc.color);
      timelineItem.style.setProperty("--ioc-color-30", `${ioc.color}30`);
      timelineItem.style.background = `linear-gradient(135deg, ${ioc.color}15 0%, ${ioc.color}05 100%)`;
      timelineItem.style.boxShadow = `0 4px 12px ${ioc.color}25`;
      timelineItem.style.borderColor = ioc.color;
      if (index < iocData.length - 1) {
        const connector = timelineItem.createDiv("timeline-connector");
        connector.style.background = `linear-gradient(180deg, ${ioc.color} 0%, ${iocData[index + 1].color} 100%)`;
      }
      const iconContainer = timelineItem.createDiv("timeline-icon");
      iconContainer.innerHTML = ioc.icon;
      iconContainer.style.background = `${ioc.color}20`;
      iconContainer.style.borderColor = ioc.color;
      const detailsContainer = timelineItem.createDiv("timeline-details");
      const titleEl = detailsContainer.createEl("h3", { text: ioc.type });
      titleEl.style.textShadow = `0 1px 3px ${ioc.color}40`;
      const timeEl = detailsContainer.createDiv("timeline-time");
      timeEl.innerHTML = `\u{1F550} Time: ${ioc.time}`;
      if (ioc.value && ioc.value.trim()) {
        const valueEl = detailsContainer.createDiv("timeline-value");
        valueEl.innerHTML = `\u{1F4CC} Value: ${ioc.value}`;
      }
      if (ioc.splunkQuery && ioc.splunkQuery.trim()) {
        const splunkEl = detailsContainer.createDiv("timeline-splunk");
        splunkEl.innerHTML = `\u{1F50D} Splunk Query: ${ioc.splunkQuery}`;
      }
      if (ioc.tactic) {
        const tacticEl = detailsContainer.createDiv("timeline-tactic");
        tacticEl.innerHTML = `\u2694\uFE0F Tactic: ${ioc.tactic}`;
      }
      if (ioc.technique) {
        const techniqueEl = detailsContainer.createDiv("timeline-technique");
        techniqueEl.innerHTML = `\u{1F3AF} Technique: ${ioc.technique}`;
      }
      timelineItem.addEventListener("mouseover", () => {
        timelineItem.style.boxShadow = `0 8px 20px ${ioc.color}35`;
      });
      timelineItem.addEventListener("mouseout", () => {
        timelineItem.style.boxShadow = `0 4px 12px ${ioc.color}25`;
      });
    });
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/RenderMitreModal.ts
var import_obsidian2 = require("obsidian");

// src/MitreLoader.ts
var cachedDataset = null;
var TACTIC_ABBREVIATIONS = {
  "Reconnaissance": ["RECON", "RECCE", "RE"],
  "Resource Development": ["RESOURCE", "RES", "RD"],
  "Initial Access": ["IA", "INIT"],
  "Execution": ["EXEC", "EXE", "EX"],
  "Persistence": ["PERSIST", "PERS", "PS"],
  "Privilege Escalation": ["PRIV", "PE", "PRIVESC", "PRIV ESC"],
  "Defense Evasion": ["DEFENSE", "DEF", "DE"],
  "Credential Access": ["CRED", "CA", "CRED ACCESS"],
  "Discovery": ["DISC", "DIS", "DI"],
  "Lateral Movement": ["LATERAL", "LM", "LAT MOVE"],
  "Collection": ["COLLECT", "COL", "CO"],
  "Command and Control": ["C2", "CNC", "CC"],
  "Exfiltration": ["EXFIL", "EXFILTRATE", "EX"],
  "Impact": ["IMP", "IM"]
};
async function loadMitreDataset(app) {
  if (cachedDataset) {
    console.debug("[MitreLoader] Returning cached dataset");
    return cachedDataset;
  }
  try {
    const adapter = app.vault.adapter;
    const jsonPath = ".obsidian/plugins/cyber_canvas/MITRE/enterprise-attack.json";
    console.debug("[MitreLoader] Attempting to load from:", jsonPath);
    if (await adapter.exists(jsonPath)) {
      const content = await adapter.read(jsonPath);
      const stixBundle = JSON.parse(content);
      if (stixBundle.type === "bundle" && Array.isArray(stixBundle.objects)) {
        console.debug("[MitreLoader] Parsing STIX 2.1 bundle format...");
        cachedDataset = parseStixBundle(stixBundle);
        console.log("[MitreLoader] \u2713 Loaded full dataset from STIX bundle. Tactics:", Object.keys(cachedDataset.tactics).length, "Techniques:", Object.keys(cachedDataset.techniques).length);
        return cachedDataset;
      } else if (stixBundle.version && stixBundle.tactics && stixBundle.techniques) {
        cachedDataset = stixBundle;
        console.log("[MitreLoader] \u2713 Loaded pre-processed dataset. Version:", cachedDataset.version, "Techniques:", Object.keys(cachedDataset.techniques).length);
        return cachedDataset;
      } else {
        console.warn("[MitreLoader] Unknown JSON format");
      }
    } else {
      console.error("[MitreLoader] JSON file not found at:", jsonPath);
      throw new Error(
        "MITRE ATT&CK dataset not found. Please ensure enterprise-attack.json exists in the MITRE folder. Download from: https://github.com/mitre-attack/attack-stix-data"
      );
    }
  } catch (err) {
    console.error("[MitreLoader] Failed to load MITRE dataset:", err);
    throw new Error(
      "MITRE ATT&CK dataset not found. Please ensure enterprise-attack.json exists in the MITRE folder. Download from: https://github.com/mitre-attack/attack-stix-data"
    );
  }
  throw new Error("MITRE ATT&CK dataset could not be loaded");
}
function parseStixBundle(stixBundle) {
  var _a, _b, _c, _d, _e, _f, _g, _h;
  console.debug("[MitreLoader] Parsing STIX bundle with", (_a = stixBundle.objects) == null ? void 0 : _a.length, "objects");
  const tactics = {};
  const techniques = {};
  let version = "unknown";
  let last_updated = new Date().toISOString().split("T")[0];
  for (const obj of stixBundle.objects) {
    if (obj.type === "x-mitre-collection") {
      version = obj.x_mitre_version || "unknown";
      last_updated = ((_b = obj.modified) == null ? void 0 : _b.split("T")[0]) || last_updated;
      console.debug("[MitreLoader] Found collection metadata - version:", version, "updated:", last_updated);
    }
  }
  for (const obj of stixBundle.objects) {
    if (obj.type === "x-mitre-tactic" && !obj.x_mitre_deprecated) {
      const tacticId = (_d = (_c = obj.external_references) == null ? void 0 : _c.find((ref) => ref.source_name === "mitre-attack")) == null ? void 0 : _d.external_id;
      if (!tacticId)
        continue;
      const shortName = obj.x_mitre_shortname || tacticId.toLowerCase();
      tactics[tacticId] = {
        id: tacticId,
        name: obj.name,
        short_name: shortName,
        description: obj.description || "",
        abbreviations: generateAbbreviations(obj.name)
      };
    }
  }
  console.debug("[MitreLoader] Parsed", Object.keys(tactics).length, "tactics");
  const shortNameToTacticId = /* @__PURE__ */ new Map();
  for (const [tacticId, tactic] of Object.entries(tactics)) {
    shortNameToTacticId.set(tactic.short_name, tacticId);
  }
  for (const obj of stixBundle.objects) {
    if (obj.type === "attack-pattern" && !obj.x_mitre_deprecated) {
      const techniqueId = (_f = (_e = obj.external_references) == null ? void 0 : _e.find((ref) => ref.source_name === "mitre-attack")) == null ? void 0 : _f.external_id;
      if (!techniqueId)
        continue;
      const tacticIds = [];
      if (obj.kill_chain_phases) {
        for (const phase of obj.kill_chain_phases) {
          if (phase.kill_chain_name === "mitre-attack") {
            const tacticId = shortNameToTacticId.get(phase.phase_name);
            if (tacticId) {
              tacticIds.push(tacticId);
            }
          }
        }
      }
      let parent;
      if (obj.x_mitre_is_subtechnique && techniqueId.includes(".")) {
        parent = techniqueId.split(".")[0];
      }
      techniques[techniqueId] = {
        id: techniqueId,
        name: obj.name,
        description: obj.description || "",
        tactics: tacticIds,
        parent,
        url: ((_h = (_g = obj.external_references) == null ? void 0 : _g.find((ref) => ref.source_name === "mitre-attack")) == null ? void 0 : _h.url) || `https://attack.mitre.org/techniques/${techniqueId.replace(".", "/")}`
      };
    }
  }
  console.debug("[MitreLoader] Parsed", Object.keys(techniques).length, "techniques");
  return {
    version,
    last_updated,
    tactics,
    techniques
  };
}
function generateAbbreviations(tacticName) {
  const abbrevs = [];
  const words = tacticName.split(/[\s\-]+/);
  if (words.length > 0) {
    abbrevs.push(words.map((w) => w[0]).join("").toUpperCase());
  }
  if (TACTIC_ABBREVIATIONS[tacticName]) {
    abbrevs.push(...TACTIC_ABBREVIATIONS[tacticName]);
  }
  return abbrevs;
}
function normalizeTacticName(name, dataset) {
  const normalized = name.toLowerCase().replace(/[\s\-_]+/g, "");
  console.debug("[MitreLoader] Normalizing tactic:", name, "\u2192", normalized);
  for (const [tacticId, tactic] of Object.entries(dataset.tactics)) {
    if (tactic.short_name.replace(/\-/g, "") === normalized) {
      console.debug("[MitreLoader] \u2713 Matched by short_name:", tactic.name, "(" + tacticId + ")");
      return tacticId;
    }
  }
  for (const [tacticId, tactic] of Object.entries(dataset.tactics)) {
    if (tactic.name.toLowerCase().replace(/[\s\-_]+/g, "") === normalized) {
      console.debug("[MitreLoader] \u2713 Matched by full name:", tactic.name, "(" + tacticId + ")");
      return tacticId;
    }
  }
  const upper = name.toUpperCase().trim();
  for (const [tacticId, tactic] of Object.entries(dataset.tactics)) {
    if (tactic.abbreviations.includes(upper)) {
      console.debug("[MitreLoader] \u2713 Matched by abbreviation:", upper, "\u2192", tactic.name, "(" + tacticId + ")");
      return tacticId;
    }
  }
  console.debug("[MitreLoader] \u2717 No match found for:", name);
  return null;
}
function validateTechniqueTactic(techniqueId, tacticInput, dataset) {
  const tacticId = normalizeTacticName(tacticInput, dataset);
  if (!tacticId) {
    return {
      severity: "unknown_tactic",
      message: `Unknown tactic: "${tacticInput}"`
    };
  }
  const technique = dataset.techniques[techniqueId];
  if (!technique) {
    return {
      severity: "unknown_technique",
      message: `Unknown technique: "${techniqueId}"`
    };
  }
  if (!technique.tactics.includes(tacticId)) {
    const validTactics = technique.tactics.map((tid) => {
      var _a;
      return ((_a = dataset.tactics[tid]) == null ? void 0 : _a.name) || tid;
    }).join(", ");
    return {
      severity: "mismatch",
      message: `${techniqueId} (${technique.name}) does not belong to ${dataset.tactics[tacticId].name}. Valid tactics: ${validTactics}`,
      tacticId
    };
  }
  return {
    severity: "valid",
    tacticId
  };
}

// src/RenderMitreModal.ts
var RenderMitreModal = class extends import_obsidian2.Modal {
  constructor(app, plugin) {
    super(app);
    this.mitreDataset = null;
    this.subtechniquesMap = /* @__PURE__ */ new Map();
    this.currentSearchState = null;
    this.currentTactics = null;
    this.searchBar = null;
    this.searchClearButton = null;
    this.searchMatchCount = null;
    this.validationErrors = [];
    // Truncation limits
    this.TECHNIQUE_TRUNCATE_LIMIT = 180;
    this.SUBTECHNIQUE_TRUNCATE_LIMIT = 100;
    this.plugin = plugin;
    this.timeProcessor = new TimeTimelineProcessor(app, plugin, IOC_TYPES);
    this.loadDataset();
  }
  /**
   * Whether the severity represents a critical error (red indicator).
   */
  isCriticalSeverity(severity) {
    return severity === "unknown_technique" || severity === "unknown_tactic" || severity === "empty_tactic";
  }
  /**
   * Get the appropriate icon for a validation severity level.
   */
  getSeverityIcon(severity) {
    return this.isCriticalSeverity(severity) ? "\u{1F534}" : "\u26A0\uFE0F";
  }
  /**
   * Apply the appropriate CSS validation class based on severity.
   */
  applySeverityClass(element, severity) {
    if (this.isCriticalSeverity(severity)) {
      element.addClass("mitre-technique-error");
    } else if (severity === "mismatch") {
      element.addClass("mitre-technique-warning");
    }
  }
  /**
   * Clean MITRE description text by removing markdown links and square brackets.
   *
   * @param description - Raw description from MITRE dataset
   * @returns Cleaned description text
   */
  cleanDescription(description) {
    if (!description)
      return "";
    let cleaned = description;
    cleaned = cleaned.replace(/\[([^\]]+)\]\([^)]+\)/g, "");
    cleaned = cleaned.replace(/\[[^\]]*\]/g, "");
    cleaned = cleaned.replace(/\s+/g, " ").trim();
    return cleaned;
  }
  /**
   * Truncate description to maximum character length with ellipsis.
   *
   * @param description - Cleaned description text
   * @param maxChars - Maximum characters (default: 180)
   * @returns Truncated description with "..." if needed
   */
  truncateDescription(description, maxChars = 180) {
    if (!description || description.length <= maxChars) {
      return description;
    }
    const truncated = description.substring(0, maxChars);
    const lastSpace = truncated.lastIndexOf(" ");
    if (lastSpace > 0) {
      return truncated.substring(0, lastSpace) + "...";
    }
    return truncated + "...";
  }
  /**
   * Toggle expansion (expand/collapse) for techniques or subtechniques.
   * Handles description swap and optional subtechniques rendering.
   *
   * @param element - The technique/subtechnique DOM element
   * @param subtechniques - Subtechniques to render (only for parent techniques)
   */
  toggleExpansion(element, subtechniques) {
    var _a, _b, _c;
    const isCollapsed = element.hasClass("collapsed");
    const expandIcon = element.querySelector(".mitre-expand-icon");
    const descEl = element.querySelector(".mitre-technique-description");
    if (isCollapsed) {
      element.removeClass("collapsed");
      element.addClass("expanded");
      element.setAttribute("data-is-expanded", "true");
      if (expandIcon)
        expandIcon.setText("\u25BC");
      if (subtechniques && subtechniques.length > 0) {
        this.renderSubtechniques(element, subtechniques, this.currentSearchState);
      }
      if (descEl) {
        const fullDesc = element.getAttribute("data-full-description");
        if (fullDesc) {
          descEl.textContent = fullDesc;
          if ((_a = this.currentSearchState) == null ? void 0 : _a.isActive) {
            this.highlightMatches(descEl, fullDesc, this.currentSearchState);
          }
        }
      }
    } else {
      element.removeClass("expanded");
      element.addClass("collapsed");
      element.setAttribute("data-is-expanded", "false");
      if (expandIcon)
        expandIcon.setText("\u25B6");
      (_b = element.querySelector(".mitre-subtechniques-container")) == null ? void 0 : _b.remove();
      if (descEl) {
        const fullDesc = element.getAttribute("data-full-description");
        const truncatedDesc = element.getAttribute("data-truncated-description");
        const displayText = truncatedDesc || (fullDesc ? this.truncateDescription(fullDesc) : null);
        if (displayText) {
          descEl.textContent = displayText;
          if ((_c = this.currentSearchState) == null ? void 0 : _c.isActive) {
            this.highlightMatches(descEl, displayText, this.currentSearchState);
          }
        }
      }
    }
  }
  /**
   * Load MITRE dataset asynchronously
   */
  async loadDataset() {
    try {
      this.mitreDataset = await loadMitreDataset(this.app);
      console.debug("[MitreModal] Dataset loaded:", this.mitreDataset.version, "- Techniques:", Object.keys(this.mitreDataset.techniques).length);
    } catch (err) {
      console.error("[MitreModal] Failed to load dataset:", err);
      this.mitreDataset = null;
    }
  }
  onOpen() {
    console.debug("[MitreModal] ===== MODAL OPENED =====");
    const { contentEl } = this;
    this.modalEl.classList.add("mitre-modal-fullscreen");
    this.makeResizable();
    const headerContainer = contentEl.createDiv("mitre-modal-header");
    const titleRow = headerContainer.createDiv("mitre-title-row");
    titleRow.createEl("h2", { text: "\u{1F3AF} MITRE ATT&CK Technique Mapper" });
    const exportBtn = titleRow.createEl("button", {
      text: "Export to Navigator",
      cls: "mitre-export-button"
    });
    exportBtn.addEventListener("click", () => this.exportToNavigator());
    this.renderSearchBar(headerContainer);
    const statsContainer = contentEl.createDiv("mitre-stats");
    const contentArea = contentEl.createDiv("mitre-content-area");
    this.renderMitreMapping(contentArea, statsContainer);
  }
  /**
   * Render search bar in modal header.
   *
   * @param headerContainer - Header container element
   */
  renderSearchBar(headerContainer) {
    const searchContainer = headerContainer.createDiv("mitre-search-container");
    const searchInput = searchContainer.createEl("input", {
      type: "text",
      placeholder: 'Search techniques (use "quotes" for exact phrases)...',
      cls: "mitre-search-input"
    });
    const clearButton = searchContainer.createEl("button", {
      text: "\u2715",
      cls: "mitre-search-clear",
      attr: { "aria-label": "Clear search" }
    });
    clearButton.style.display = "none";
    const matchCount = searchContainer.createDiv("mitre-search-match-count");
    matchCount.style.display = "none";
    this.searchBar = searchInput;
    this.searchClearButton = clearButton;
    this.searchMatchCount = matchCount;
    let debounceTimer = null;
    searchInput.addEventListener("input", () => {
      if (debounceTimer !== null) {
        clearTimeout(debounceTimer);
      }
      debounceTimer = window.setTimeout(() => {
        this.handleSearchInput(searchInput.value);
      }, 300);
    });
    clearButton.addEventListener("click", () => {
      searchInput.value = "";
      this.handleSearchInput("");
    });
    searchInput.addEventListener("keydown", (e) => {
      if (e.key === "Escape") {
        searchInput.value = "";
        this.handleSearchInput("");
      }
    });
  }
  /**
   * Handle search input changes and re-render content.
   *
   * @param query - Search query string
   */
  handleSearchInput(query) {
    const searchState = this.parseSearchQuery(query);
    this.currentSearchState = searchState;
    console.debug("[MitreModal] Search query:", query, "- Parsed:", searchState);
    if (this.searchClearButton) {
      this.searchClearButton.style.display = searchState.isActive ? "block" : "none";
    }
    const container = this.modalEl.querySelector(".mitre-content-area");
    if (container && this.currentTactics) {
      container.empty();
      let matchCount = 0;
      this.currentTactics.forEach((tactic) => {
        const matchingTechniques = tactic.techniques.filter((tech) => {
          if (!searchState.isActive)
            return true;
          const match = this.matchesSearch(tech, searchState);
          if (match.matched)
            matchCount++;
          return match.matched;
        });
        if (matchingTechniques.length > 0) {
          const filteredTactic = { ...tactic, techniques: matchingTechniques };
          this.renderTacticSection(container, filteredTactic, searchState);
        }
      });
      if (this.searchMatchCount) {
        if (searchState.isActive) {
          this.searchMatchCount.textContent = `${matchCount} technique${matchCount !== 1 ? "s" : ""} found`;
          this.searchMatchCount.style.display = "block";
        } else {
          this.searchMatchCount.style.display = "none";
        }
      }
      if (matchCount === 0 && searchState.isActive) {
        container.createDiv({
          cls: "mitre-no-results",
          text: "No techniques match your search"
        });
      }
    }
  }
  async renderMitreMapping(container, statsContainer) {
    console.debug("[MitreModal] ===== STARTING DATA EXTRACTION =====");
    const iocData = this.timeProcessor.extractFixedIOCData();
    console.debug("[MitreModal] Extracted IOC count:", iocData.length);
    if (iocData.length === 0) {
      container.createEl("p", {
        text: "No IOC cards found in the current canvas.",
        cls: "mitre-empty-message"
      });
      return;
    }
    const tactics = await this.aggregateTacticsTechniques(iocData);
    console.debug("[MitreModal] ===== AGGREGATION COMPLETE =====");
    console.debug("[MitreModal] Tactics:", tactics.length);
    if (!this.mitreDataset) {
      container.createEl("div", {
        cls: "mitre-error-message",
        text: "\u274C MITRE ATT&CK dataset could not be loaded."
      });
      container.createEl("p", {
        text: "Please ensure enterprise-attack.json exists in the MITRE folder."
      });
      container.createEl("a", {
        text: "Download dataset from MITRE",
        attr: { href: "https://github.com/mitre-attack/attack-stix-data", target: "_blank" }
      });
      return;
    }
    if (tactics.length === 0) {
      container.createEl("p", {
        text: 'No MITRE tactics or techniques found in IOC cards. Add "Mitre Tactic" and "Mitre Technique" fields to your cards.',
        cls: "mitre-empty-message"
      });
      return;
    }
    const totalTechniques = tactics.reduce((sum, t) => sum + t.techniques.length, 0);
    const foundTechniques = tactics.reduce((sum, t) => sum + t.techniques.filter((tech) => tech.isFound).length, 0);
    const coveragePercent = totalTechniques > 0 ? Math.round(foundTechniques / totalTechniques * 100) : 0;
    statsContainer.createEl("div", {
      text: `\u{1F4CA} Coverage: ${foundTechniques}/${totalTechniques} techniques (${coveragePercent}%)`,
      cls: "mitre-stat-item"
    });
    const activeTactics = tactics.filter((t) => t.techniques.some((tech) => tech.isFound)).length;
    statsContainer.createEl("div", {
      text: `\u2694\uFE0F Tactics: ${activeTactics}/${tactics.length} active`,
      cls: "mitre-stat-item"
    });
    statsContainer.createEl("div", {
      text: `\u{1F4C7} IOC Cards: ${iocData.length} total`,
      cls: "mitre-stat-item"
    });
    this.currentTactics = tactics;
    this.renderValidationErrors(container);
    tactics.forEach((tactic) => {
      this.renderTacticSection(container, tactic, this.currentSearchState);
    });
  }
  /**
   * Render validation errors section with card references.
   * Groups errors by type (Tactic Errors, Technique Errors, Validation Mismatches).
   *
   * @param container - Container element for error section
   */
  renderValidationErrors(container) {
    if (this.validationErrors.length === 0) {
      return;
    }
    console.debug("[MitreModal] Rendering", this.validationErrors.length, "validation errors");
    const emptyTacticErrors = this.validationErrors.filter((e) => e.severity === "empty_tactic");
    const tacticErrors = this.validationErrors.filter((e) => e.severity === "unknown_tactic");
    const techniqueErrors = this.validationErrors.filter((e) => e.severity === "unknown_technique");
    const mismatchErrors = this.validationErrors.filter((e) => e.severity === "mismatch");
    const errorSection = container.createDiv("mitre-validation-errors");
    const header = errorSection.createDiv("mitre-errors-header");
    header.createEl("h3", {
      text: `\u26A0\uFE0F Validation Issues (${this.validationErrors.length})`
    });
    const toggleBtn = header.createEl("button", {
      text: "Hide",
      cls: "mitre-errors-toggle"
    });
    const errorsList = errorSection.createDiv("mitre-errors-list");
    errorSection.addClass("expanded");
    toggleBtn.addEventListener("click", () => {
      if (errorSection.hasClass("expanded")) {
        errorSection.removeClass("expanded");
        errorSection.addClass("collapsed");
        toggleBtn.setText("Show");
        errorsList.style.display = "none";
      } else {
        errorSection.removeClass("collapsed");
        errorSection.addClass("expanded");
        toggleBtn.setText("Hide");
        errorsList.style.display = "block";
      }
    });
    if (emptyTacticErrors.length > 0) {
      this.renderErrorCategory(errorsList, "Missing Tactic", emptyTacticErrors, "\u{1F534}");
    }
    if (tacticErrors.length > 0) {
      this.renderErrorCategory(errorsList, "Unknown Tactic", tacticErrors, "\u{1F534}");
    }
    if (techniqueErrors.length > 0) {
      this.renderErrorCategory(errorsList, "Technique Errors", techniqueErrors, "\u{1F534}");
    }
    if (mismatchErrors.length > 0) {
      this.renderErrorCategory(errorsList, "Validation Mismatches", mismatchErrors, "\u26A0\uFE0F");
    }
  }
  /**
   * Render a category of validation errors with header and items.
   *
   * @param container - Parent container element
   * @param categoryTitle - Display title for this error category
   * @param errors - Array of errors in this category
   * @param icon - Icon to use for this category
   */
  renderErrorCategory(container, categoryTitle, errors, icon) {
    const categorySection = container.createDiv("mitre-error-category");
    const categoryHeader = categorySection.createDiv("mitre-error-category-header");
    categoryHeader.createEl("h4", {
      text: `${icon} ${categoryTitle} (${errors.length})`
    });
    errors.forEach((error) => {
      const errorItem = categorySection.createDiv("mitre-error-item");
      if (this.isCriticalSeverity(error.severity)) {
        errorItem.addClass("mitre-error-critical");
      } else if (error.severity === "mismatch") {
        errorItem.addClass("mitre-error-warning");
      }
      const errorHeader = errorItem.createDiv("mitre-error-header");
      errorHeader.createEl("span", {
        text: error.techniqueId,
        cls: "mitre-error-technique-id"
      });
      errorHeader.createEl("span", {
        text: error.techniqueName,
        cls: "mitre-error-technique-name"
      });
      errorItem.createDiv({
        text: error.message,
        cls: "mitre-error-message"
      });
      const cardsSection = errorItem.createDiv("mitre-error-cards");
      cardsSection.createEl("span", {
        text: "Affected cards: ",
        cls: "mitre-error-cards-label"
      });
      error.iocCards.forEach((card, index) => {
        const cardBadge = cardsSection.createEl("span", {
          cls: "mitre-error-card-badge",
          attr: { "title": `Node ID: ${card.nodeId}` }
        });
        cardBadge.createEl("span", {
          text: card.iocType,
          cls: "mitre-error-card-type"
        });
        cardBadge.createEl("span", {
          text: ` ${card.cardId}`,
          cls: "mitre-error-card-id"
        });
        if (index < error.iocCards.length - 1) {
          cardsSection.createEl("span", { text: ", " });
        }
      });
    });
  }
  /**
   * Determines if newSeverity should override existingSeverity when aggregating.
   *
   * When multiple IOC cards reference the same technique with different validation
   * results, we need to decide which severity to display in the matrix. This uses
   * a priority ranking system where more critical errors override less critical ones.
   *
   * **Ranking (highest to lowest priority):**
   * 1. `unknown_technique` (5) - Technique ID not in dataset (CRITICAL - red)
   * 2. `unknown_tactic` (4) - Tactic name not recognized (CRITICAL - red)
   * 3. `empty_tactic` (3) - Technique filled but tactic empty (CRITICAL - red)
   * 4. `mismatch` (2) - Both valid but don't belong together (WARNING - orange)
   * 5. `valid` (1) - Correct pairing (SUCCESS - green)
   *
   * **Example:** If 3 cards reference T1566, one with valid pairing, one with mismatch,
   * and one with unknown_tactic, the final severity shown is `unknown_tactic` (highest rank).
   *
   * @param newSeverity - Severity from newly processed card
   * @param existingSeverity - Current aggregated severity for this technique
   * @returns true if newSeverity should replace existingSeverity
   */
  shouldOverrideSeverity(newSeverity, existingSeverity) {
    const severityRank = {
      "unknown_technique": 5,
      // Red - technique doesn't exist
      "unknown_tactic": 4,
      // Red - tactic name/abbrev not found
      "empty_tactic": 3,
      // Red - missing required field
      "mismatch": 2,
      // Orange - wrong tactic for technique
      "valid": 1
      // Green - correct pairing
    };
    return severityRank[newSeverity] > severityRank[existingSeverity];
  }
  /**
   * Aggregate MITRE tactics and techniques from IOC cards into full matrix structure.
   *
   * This is the core aggregation algorithm that builds the complete MITRE ATT&CK matrix
   * showing ALL 14 tactics and ALL ~800+ techniques, with found techniques highlighted
   * and validated. Uses a 5-step process for building the matrix and collecting errors.
   *
   * **Algorithm Overview:**
   * 1. Build map of found techniques from IOC cards (with validation per card)
   * 2. Build full tactic structure from dataset (all 14 tactics)
   * 3. Populate ALL techniques from dataset (found and unfound)
   * 4. Convert to array and sort by kill chain order
   * 5. Collect validation errors for display
   *
   * @param iocData - Array of parsed IOC nodes from canvas
   * @returns Array of MitreTactic objects with nested techniques
   */
  async aggregateTacticsTechniques(iocData) {
    if (!this.mitreDataset) {
      await this.loadDataset();
    }
    if (!this.mitreDataset) {
      console.error("[MitreModal] Failed to load dataset");
      return [];
    }
    console.log("[MitreModal] Starting full matrix aggregation with", iocData.length, "IOC cards");
    console.log("[MitreModal] Dataset has", Object.keys(this.mitreDataset.techniques).length, "techniques");
    const foundTechniques = /* @__PURE__ */ new Map();
    const cardValidations = /* @__PURE__ */ new Map();
    iocData.forEach((ioc) => {
      const rawTactic = (ioc.tactic || "").trim();
      const rawTechnique = (ioc.technique || "").trim();
      if (!rawTechnique) {
        console.debug("[MitreModal] Skipping IOC card with empty technique:", {
          id: ioc.id,
          cardId: ioc.cardId || "(no ID)",
          type: ioc.type,
          hasTactic: !!rawTactic,
          hasTechnique: false,
          tacticValue: rawTactic || "(empty)",
          techniqueValue: "(empty)"
        });
        return;
      }
      const technique = rawTechnique;
      const techniqueId = this.extractTechniqueId(technique);
      const techniqueName = this.extractTechniqueName(technique);
      if (!rawTactic) {
        console.debug("[MitreModal] Found IOC card with empty tactic:", {
          id: ioc.id,
          cardId: ioc.cardId || "(no ID)",
          type: ioc.type,
          techniqueId,
          technique
        });
        const validation2 = {
          severity: "empty_tactic",
          message: "Tactic field is empty",
          tacticId: void 0
        };
        cardValidations.set(ioc.id, {
          cardId: ioc.cardId || ioc.id,
          techniqueId,
          techniqueName,
          tactic: "(empty)",
          severity: validation2.severity,
          validationMessage: validation2.message,
          iocType: ioc.type,
          nodeId: ioc.id
        });
        if (foundTechniques.has(techniqueId)) {
          const existing = foundTechniques.get(techniqueId);
          existing.count++;
          existing.iocCards.push(ioc.id);
          if (this.shouldOverrideSeverity(validation2.severity, existing.severity)) {
            existing.severity = validation2.severity;
            existing.validationMessage = validation2.message;
          }
        } else {
          foundTechniques.set(techniqueId, {
            count: 1,
            iocCards: [ioc.id],
            severity: validation2.severity,
            validationMessage: validation2.message,
            userProvidedTactic: "(empty)"
          });
        }
        return;
      }
      const tactic = rawTactic;
      const validation = validateTechniqueTactic(techniqueId, tactic, this.mitreDataset);
      console.debug("[MitreModal] Found technique:", {
        techniqueId,
        tactic,
        severity: validation.severity
      });
      cardValidations.set(ioc.id, {
        cardId: ioc.cardId || ioc.id,
        techniqueId,
        techniqueName,
        tactic,
        severity: validation.severity,
        validationMessage: validation.message,
        iocType: ioc.type,
        nodeId: ioc.id
      });
      if (foundTechniques.has(techniqueId)) {
        const existing = foundTechniques.get(techniqueId);
        existing.count++;
        existing.iocCards.push(ioc.id);
        if (this.shouldOverrideSeverity(validation.severity, existing.severity)) {
          existing.severity = validation.severity;
          existing.validationMessage = validation.message;
        }
      } else {
        foundTechniques.set(techniqueId, {
          count: 1,
          iocCards: [ioc.id],
          severity: validation.severity,
          validationMessage: validation.message,
          userProvidedTactic: tactic
        });
      }
    });
    console.log("[MitreModal] Found", foundTechniques.size, "unique techniques in IOC cards");
    const tacticMap = /* @__PURE__ */ new Map();
    Object.values(this.mitreDataset.tactics).forEach((tacticData) => {
      tacticMap.set(tacticData.id, {
        name: tacticData.id,
        displayName: `${tacticData.name} (${tacticData.id})`,
        techniques: []
      });
    });
    this.subtechniquesMap.clear();
    Object.values(this.mitreDataset.techniques).forEach((techData) => {
      const foundData = foundTechniques.get(techData.id);
      const isFound = !!foundData;
      const techniqueObj = {
        id: techData.id,
        name: techData.name,
        tactic: "",
        // Will be set per-tactic below
        tacticId: "",
        // Will be set per-tactic below
        count: (foundData == null ? void 0 : foundData.count) || 0,
        iocCards: (foundData == null ? void 0 : foundData.iocCards) || [],
        severity: (foundData == null ? void 0 : foundData.severity) || "not_found",
        validationMessage: foundData == null ? void 0 : foundData.validationMessage,
        description: techData.description,
        isFound
      };
      if (techData.parent) {
        if (!this.subtechniquesMap.has(techData.parent)) {
          this.subtechniquesMap.set(techData.parent, []);
        }
        if (techData.tactics.length > 0) {
          techniqueObj.tactic = (foundData == null ? void 0 : foundData.userProvidedTactic) || techData.tactics[0];
          techniqueObj.tacticId = techData.tactics[0];
        }
        this.subtechniquesMap.get(techData.parent).push(techniqueObj);
        return;
      }
      techData.tactics.forEach((tacticId) => {
        if (!tacticMap.has(tacticId)) {
          console.warn("[MitreModal] Unknown tactic ID in dataset:", tacticId);
          return;
        }
        const tactic = tacticMap.get(tacticId);
        tactic.techniques.push({
          ...techniqueObj,
          tactic: (foundData == null ? void 0 : foundData.userProvidedTactic) || tacticId,
          tacticId
        });
      });
    });
    const tactics = Array.from(tacticMap.values());
    const tacticOrder = [
      "TA0043",
      // Reconnaissance
      "TA0042",
      // Resource Development
      "TA0001",
      // Initial Access
      "TA0002",
      // Execution
      "TA0003",
      // Persistence
      "TA0004",
      // Privilege Escalation
      "TA0005",
      // Defense Evasion
      "TA0006",
      // Credential Access
      "TA0007",
      // Discovery
      "TA0008",
      // Lateral Movement
      "TA0009",
      // Collection
      "TA0011",
      // Command and Control
      "TA0010",
      // Exfiltration
      "TA0040"
      // Impact
    ];
    tactics.sort((a, b) => {
      const indexA = tacticOrder.indexOf(a.name);
      const indexB = tacticOrder.indexOf(b.name);
      if (indexA === -1)
        return 1;
      if (indexB === -1)
        return -1;
      return indexA - indexB;
    });
    tactics.forEach((tactic) => {
      tactic.techniques.sort((a, b) => {
        if (a.isFound && !b.isFound)
          return -1;
        if (!a.isFound && b.isFound)
          return 1;
        return a.id.localeCompare(b.id);
      });
    });
    console.log("[MitreModal] Full matrix built:", {
      totalTactics: tactics.length,
      totalTechniques: tactics.reduce((sum, t) => sum + t.techniques.length, 0),
      foundTechniques: foundTechniques.size
    });
    console.log("[MitreModal] Collecting validation errors from card-level validation...");
    this.validationErrors = [];
    const errorsByTechnique = /* @__PURE__ */ new Map();
    cardValidations.forEach((cardValidation, cardId) => {
      if (cardValidation.severity !== "valid") {
        const key = `${cardValidation.techniqueId}-${cardValidation.severity}`;
        if (!errorsByTechnique.has(key)) {
          errorsByTechnique.set(key, {
            techniqueId: cardValidation.techniqueId,
            techniqueName: cardValidation.techniqueName,
            severity: cardValidation.severity,
            message: cardValidation.validationMessage || "Validation error",
            cards: []
          });
        }
        errorsByTechnique.get(key).cards.push({
          cardId: cardValidation.cardId,
          iocType: cardValidation.iocType,
          nodeId: cardValidation.nodeId
        });
      }
    });
    errorsByTechnique.forEach((errorData) => {
      this.validationErrors.push({
        techniqueId: errorData.techniqueId,
        techniqueName: errorData.techniqueName,
        severity: errorData.severity,
        message: errorData.message,
        iocCards: errorData.cards
      });
    });
    console.log("[MitreModal] Found", this.validationErrors.length, "validation error groups from", cardValidations.size, "cards");
    console.log("[MitreModal] Cards with errors:", Array.from(cardValidations.values()).filter((v) => v.severity !== "valid").length);
    return tactics;
  }
  /**
   * Extract technique ID from various formats.
   *
   * Supported formats:
   * - "T1566" -> "T1566"
   * - "T1566.001" -> "T1566.001"
   * - "T1566 - Phishing" -> "T1566"
   * - "Phishing (T1566)" -> "T1566"
   * - "T1566.001 - Spearphishing Attachment" -> "T1566.001"
   * - "Phishing" (name only) -> "Phishing" (fallback, will fail validation)
   *
   * NOTE: Technique field is already uppercased by IOCParser for consistency
   */
  extractTechniqueId(technique) {
    const idMatch = technique.match(/T\d{4}(?:\.\d{3})?/i);
    if (idMatch) {
      const techniqueId = idMatch[0].toUpperCase();
      console.debug("[MitreModal] Extracted technique ID:", techniqueId, "from:", technique);
      return techniqueId;
    }
    console.debug("[MitreModal] No technique ID found in:", technique, "- using raw string");
    return technique.trim();
  }
  /**
   * Extract technique name from various formats.
   *
   * Supported formats:
   * - "T1566 - Phishing" -> "Phishing"
   * - "Phishing (T1566)" -> "Phishing"
   * - "T1566.001 - Spearphishing Attachment" -> "Spearphishing Attachment"
   * - "T1566" (ID only) -> lookup name from MitreData
   * - "Phishing" (name only) -> "Phishing"
   */
  extractTechniqueName(technique) {
    const dashMatch = technique.match(/T\d{4}(?:\.\d{3})?\s*-\s*(.+)/);
    if (dashMatch) {
      const name = dashMatch[1].trim();
      console.debug("[MitreModal] Extracted name from dash format:", name);
      return name;
    }
    const parenMatch = technique.match(/(.+?)\s*\(T\d{4}(?:\.\d{3})?\)/);
    if (parenMatch) {
      const name = parenMatch[1].trim();
      console.debug("[MitreModal] Extracted name from paren format:", name);
      return name;
    }
    const idOnlyMatch = technique.match(/^T\d{4}(?:\.\d{3})?$/);
    if (idOnlyMatch && this.mitreDataset) {
      const techData = this.mitreDataset.techniques[idOnlyMatch[0]];
      if (techData) {
        console.debug("[MitreModal] Looked up name for ID:", idOnlyMatch[0], "->", techData.name);
        return techData.name;
      }
    }
    console.debug("[MitreModal] Using raw technique string as name:", technique);
    return technique.trim();
  }
  renderTacticSection(container, tactic, searchState) {
    const tacticColumn = container.createDiv("mitre-tactic-column");
    const foundCount = tactic.techniques.filter((t) => t.isFound).length;
    const totalCount = tactic.techniques.length;
    const tacticHeader = tacticColumn.createDiv("mitre-tactic-header");
    tacticHeader.createEl("h3", { text: `\u2694\uFE0F ${tactic.displayName || tactic.name}` });
    tacticHeader.createEl("span", {
      text: `${foundCount}/${totalCount} techniques covered`,
      cls: "mitre-technique-count"
    });
    const techniqueList = tacticColumn.createDiv("mitre-technique-list");
    tactic.techniques.forEach((technique) => {
      const techItem = techniqueList.createDiv("mitre-technique-item");
      const subtechniques = this.subtechniquesMap.get(technique.id) || [];
      const hasSubtechniques = subtechniques.length > 0;
      const cleanedDesc = this.cleanDescription(technique.description || "");
      const isLongDescription = cleanedDesc.length > 180;
      const isExpandable = isLongDescription || hasSubtechniques;
      techItem.setAttribute("data-technique-id", technique.id);
      techItem.setAttribute("data-subtechnique-count", subtechniques.length.toString());
      techItem.setAttribute("data-is-expandable", isExpandable.toString());
      techItem.setAttribute("data-full-description", cleanedDesc);
      if (isLongDescription) {
        const truncated = this.truncateDescription(cleanedDesc);
        techItem.setAttribute("data-truncated-description", truncated);
      }
      if (!technique.isFound) {
        techItem.addClass("mitre-technique-unfound");
      } else {
        this.applySeverityClass(techItem, technique.severity);
      }
      const techInfo = techItem.createDiv("mitre-technique-info");
      if (isExpandable) {
        const expandIcon = techInfo.createEl("span", {
          cls: "mitre-expand-icon",
          text: "\u25B6"
        });
        techItem.addClass("has-expandable");
        techItem.addClass("collapsed");
        techItem.addEventListener("click", (e) => {
          e.stopPropagation();
          this.toggleExpansion(techItem, subtechniques);
        });
      }
      if (technique.isFound && technique.severity !== "valid" && technique.severity !== "not_found") {
        const warningEl = techInfo.createEl("span", {
          cls: "mitre-validation-icon",
          attr: {
            "title": technique.validationMessage || "Warning"
          }
        });
        warningEl.innerHTML = this.getSeverityIcon(technique.severity);
      }
      techInfo.createEl("span", {
        text: technique.id,
        cls: "mitre-technique-id"
      });
      const nameText = hasSubtechniques ? `${technique.name} (${subtechniques.length})` : technique.name;
      const nameEl = techInfo.createEl("span", {
        text: nameText,
        cls: "mitre-technique-name"
      });
      if (searchState == null ? void 0 : searchState.isActive) {
        this.highlightMatches(nameEl, technique.name, searchState);
      }
      if (technique.description) {
        const descEl = techItem.createDiv("mitre-technique-description");
        const isExpanded = techItem.hasClass("expanded");
        let displayText;
        if (isExpanded || !isExpandable) {
          displayText = cleanedDesc;
        } else {
          displayText = this.truncateDescription(cleanedDesc);
        }
        descEl.textContent = displayText;
        if (searchState == null ? void 0 : searchState.isActive) {
          this.highlightMatches(descEl, displayText, searchState);
        }
      }
      if (technique.isFound) {
        const techCount = techItem.createDiv("mitre-technique-count-badge");
        techCount.textContent = `${technique.count} card${technique.count > 1 ? "s" : ""}`;
      }
    });
  }
  renderSubtechniques(parentEl, subtechniques, searchState) {
    const container = parentEl.createDiv({ cls: "mitre-subtechniques-container" });
    subtechniques.forEach((subtech) => {
      const subItem = container.createDiv("mitre-technique-item mitre-subtechnique");
      const cleanedDesc = this.cleanDescription(subtech.description || "");
      const isLongDescription = cleanedDesc.length > this.SUBTECHNIQUE_TRUNCATE_LIMIT;
      subItem.setAttribute("data-technique-id", subtech.id);
      subItem.setAttribute("data-full-description", cleanedDesc);
      if (isLongDescription) {
        const truncated = this.truncateDescription(cleanedDesc, this.SUBTECHNIQUE_TRUNCATE_LIMIT);
        subItem.setAttribute("data-truncated-description", truncated);
      }
      if (!subtech.isFound) {
        subItem.addClass("mitre-technique-unfound");
      } else {
        this.applySeverityClass(subItem, subtech.severity);
      }
      const subInfo = subItem.createDiv("mitre-technique-info");
      if (isLongDescription) {
        const expandIcon = subInfo.createEl("span", {
          cls: "mitre-expand-icon",
          text: "\u25B6"
        });
        subItem.addClass("has-expandable");
        subItem.addClass("collapsed");
        subItem.addEventListener("click", (e) => {
          e.stopPropagation();
          this.toggleExpansion(subItem);
        });
      }
      if (subtech.isFound && subtech.severity !== "valid" && subtech.severity !== "not_found") {
        const warningEl = subInfo.createEl("span", {
          cls: "mitre-validation-icon",
          attr: {
            "title": subtech.validationMessage || "Warning"
          }
        });
        warningEl.innerHTML = this.getSeverityIcon(subtech.severity);
      }
      subInfo.createEl("span", {
        text: subtech.id,
        cls: "mitre-technique-id"
      });
      const nameEl = subInfo.createEl("span", {
        text: subtech.name,
        cls: "mitre-technique-name"
      });
      if (searchState == null ? void 0 : searchState.isActive) {
        this.highlightMatches(nameEl, subtech.name, searchState);
      }
      if (subtech.description) {
        const descEl = subItem.createDiv("mitre-technique-description");
        let displayText;
        if (isLongDescription) {
          displayText = this.truncateDescription(cleanedDesc, this.SUBTECHNIQUE_TRUNCATE_LIMIT);
        } else {
          displayText = cleanedDesc;
        }
        descEl.textContent = displayText;
        if (searchState == null ? void 0 : searchState.isActive) {
          this.highlightMatches(descEl, displayText, searchState);
        }
      }
      if (subtech.isFound) {
        const subCount = subItem.createDiv("mitre-technique-count-badge");
        subCount.textContent = `${subtech.count} card${subtech.count > 1 ? "s" : ""}`;
      }
    });
  }
  /**
   * Parse search query into keywords and phrases.
   *
   * Supports two types of search terms:
   * 1. **Keywords**: Space-separated words (e.g., "spear phishing"  ["spear", "phishing"])
   * 2. **Phrases**: Quoted strings (e.g., "spear phishing"  ["spear phishing"])
   *
   * **Phrase Syntax:**
   * - Quoted phrases match exact sequences: "lateral movement" only matches that phrase
   * - Keywords match anywhere: lateral movement matches both separately
   * - Unmatched quotes are automatically removed (e.g., "spear phishing becomes spear phishing)
   *
   * **Algorithm:**
   * 1. Check for unmatched quotes and remove the last one
   * 2. Extract all quoted phrases using regex: /"([^"]+)"/g
   * 3. Remove phrases from query and split remaining text into keywords
   * 4. Normalize all terms to lowercase for case-insensitive matching
   *
   * @param query - Raw search query string
   * @returns SearchState object with parsed keywords and phrases
   */
  parseSearchQuery(query) {
    if (!query || !query.trim()) {
      return {
        query: "",
        keywords: [],
        phrases: [],
        isActive: false
      };
    }
    const trimmedQuery = query.trim();
    const quoteCount = (trimmedQuery.match(/"/g) || []).length;
    let processedQuery = trimmedQuery;
    if (quoteCount % 2 !== 0) {
      const lastQuoteIndex = processedQuery.lastIndexOf('"');
      processedQuery = processedQuery.substring(0, lastQuoteIndex) + processedQuery.substring(lastQuoteIndex + 1);
    }
    const phrases = [];
    const phraseRegex = /"([^"]+)"/g;
    let match;
    while ((match = phraseRegex.exec(processedQuery)) !== null) {
      phrases.push(match[1].toLowerCase());
    }
    const remainingQuery = processedQuery.replace(/"[^"]+"/g, " ");
    const keywords = remainingQuery.split(/\s+/).map((k) => k.trim().toLowerCase()).filter((k) => k.length > 0);
    return {
      query: trimmedQuery,
      keywords,
      phrases,
      isActive: keywords.length > 0 || phrases.length > 0
    };
  }
  /**
   * Check if text matches all keywords and phrases in search state.
   *
   * @param text - Text to check
   * @param searchState - Parsed search state
   * @returns True if text matches all search terms
   */
  textMatchesQuery(text, searchState) {
    if (!searchState.isActive)
      return true;
    const lowerText = text.toLowerCase();
    const allKeywordsMatch = searchState.keywords.every(
      (keyword) => lowerText.includes(keyword)
    );
    const allPhrasesMatch = searchState.phrases.every(
      (phrase) => lowerText.includes(phrase)
    );
    return allKeywordsMatch && allPhrasesMatch;
  }
  /**
   * Check if a technique matches the search query.
   *
   * **Search Hierarchy (checked in order):**
   * 1. **Technique ID** (e.g., "T1566") - highest priority, exact match
   * 2. **Technique Name** (e.g., "Phishing") - common use case
   * 3. **Technique Description** - finds techniques by their behavior description
   * 4. **Subtechniques** - if any subtechnique matches, show the parent too
   *
   * **Parent/Subtechnique Logic:**
   * When a subtechnique matches the search, the parent technique is also
   * included in results so the user can expand it and see the matching
   * subtechnique. For example, searching "spearphishing" will show T1566
   * (Phishing) with T1566.001 (Spearphishing Attachment) as an expandable child.
   *
   * **Match Precedence:**
   * Returns as soon as a match is found (short-circuits), prioritizing
   * more specific matches (ID > name > description > subtechnique).
   *
   * @param technique - Technique to check
   * @param searchState - Parsed search state with keywords/phrases
   * @returns SearchMatch result with match details
   */
  matchesSearch(technique, searchState) {
    if (!searchState.isActive) {
      return { matched: true };
    }
    if (this.textMatchesQuery(technique.id, searchState)) {
      return {
        matched: true,
        matchType: "id",
        matchText: technique.id
      };
    }
    if (this.textMatchesQuery(technique.name, searchState)) {
      return {
        matched: true,
        matchType: "name",
        matchText: technique.name
      };
    }
    if (technique.description && this.textMatchesQuery(technique.description, searchState)) {
      return {
        matched: true,
        matchType: "description",
        matchText: technique.description
      };
    }
    const subtechniques = this.subtechniquesMap.get(technique.id) || [];
    for (const subtech of subtechniques) {
      if (this.textMatchesQuery(subtech.id, searchState) || this.textMatchesQuery(subtech.name, searchState) || subtech.description && this.textMatchesQuery(subtech.description, searchState)) {
        return {
          matched: true,
          matchType: "subtechnique",
          matchText: subtech.name
        };
      }
    }
    return { matched: false };
  }
  /**
   * Escape HTML to prevent XSS injection.
   *
   * @param text - Text to escape
   * @returns HTML-escaped text
   */
  escapeHtml(text) {
    const div = document.createElement("div");
    div.textContent = text;
    return div.innerHTML;
  }
  /**
   * Escape special regex characters.
   *
   * @param text - Text to escape
   * @returns Regex-escaped text
   */
  escapeRegex(text) {
    return text.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
  }
  /**
   * Highlight search matches in text element.
   *
   * @param element - DOM element to highlight
   * @param originalText - Original text content
   * @param searchState - Parsed search state
   */
  highlightMatches(element, originalText, searchState) {
    if (!searchState.isActive || !originalText) {
      return;
    }
    let escapedText = this.escapeHtml(originalText);
    searchState.phrases.forEach((phrase) => {
      const escapedPhrase = this.escapeRegex(phrase);
      const regex = new RegExp(`(${escapedPhrase})`, "gi");
      escapedText = escapedText.replace(regex, '<mark class="mitre-search-highlight">$1</mark>');
    });
    searchState.keywords.forEach((keyword) => {
      const escapedKeyword = this.escapeRegex(keyword);
      const regex = new RegExp(`(?!<mark[^>]*>)(${escapedKeyword})(?![^<]*</mark>)`, "gi");
      escapedText = escapedText.replace(regex, '<mark class="mitre-search-highlight">$1</mark>');
    });
    element.innerHTML = escapedText;
  }
  async exportToNavigator() {
    console.debug("[MitreModal] ===== EXPORTING =====");
    const iocData = this.timeProcessor.extractFixedIOCData();
    const tactics = await this.aggregateTacticsTechniques(iocData);
    const layer = {
      name: "Cyber Canvas IOC Analysis",
      versions: {
        attack: "14",
        navigator: "4.9.4",
        layer: "4.5"
      },
      domain: "enterprise-attack",
      description: `Generated from ${iocData.length} IOC cards in Obsidian Canvas`,
      filters: {
        platforms: ["windows", "linux", "macos"]
      },
      sorting: 0,
      layout: {
        layout: "side",
        aggregateFunction: "average",
        showID: true,
        showName: true,
        showAggregateScores: false,
        countUnscored: false
      },
      hideDisabled: false,
      techniques: [],
      gradient: {
        colors: ["#ff6666", "#ffe766", "#8ec843"],
        minValue: 0,
        maxValue: 100
      },
      legendItems: [],
      metadata: [],
      links: [],
      showTacticRowBackground: true,
      tacticRowBackground: "#dddddd",
      selectTechniquesAcrossTactics: true,
      selectSubtechniquesWithParent: false
    };
    tactics.forEach((tactic) => {
      tactic.techniques.forEach((technique) => {
        var _a;
        if (!technique.isFound) {
          return;
        }
        const tacticData = (_a = this.mitreDataset) == null ? void 0 : _a.tactics[technique.tacticId];
        const tacticShortName = (tacticData == null ? void 0 : tacticData.short_name) || tactic.name.toLowerCase().replace(/\s+/g, "-");
        let color;
        if (technique.severity === "valid") {
          color = "#66bb6a";
        } else if (this.isCriticalSeverity(technique.severity)) {
          color = "#f44336";
        } else if (technique.severity === "mismatch") {
          color = "#ffa500";
        } else {
          color = "#66bb6a";
        }
        let comment = `Used in ${technique.count} IOC card${technique.count > 1 ? "s" : ""}`;
        if (technique.severity !== "valid" && technique.validationMessage) {
          comment += `
${this.getSeverityIcon(technique.severity)} ${technique.validationMessage}`;
        }
        layer.techniques.push({
          techniqueID: technique.id,
          tactic: tacticShortName,
          color,
          comment,
          enabled: true,
          metadata: [
            {
              name: "severity",
              value: technique.severity
            },
            {
              name: "ioc_cards",
              value: technique.iocCards.join(", ")
            }
          ],
          links: [],
          showSubtechniques: false,
          score: technique.count * 10
          // Scale count for visual weight
        });
      });
    });
    const jsonString = JSON.stringify(layer, null, 2);
    const blob = new Blob([jsonString], { type: "application/json" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = `mitre-navigator-${Date.now()}.json`;
    a.click();
    URL.revokeObjectURL(url);
  }
  onClose() {
    console.debug("[MitreModal] ===== MODAL CLOSED =====");
    const { contentEl } = this;
    contentEl.empty();
  }
  /**
   * Add drag handles and resize functionality to the modal.
   *
   * Creates 8 resize handles (4 corners + 4 edges) and attaches drag listeners.
   * Each handle calculates new dimensions based on mouse movement direction:
   *
   * **Coordinate Math:**
   * - **East (E):** Drag right increases width by deltaX
   * - **West (W):** Drag left decreases width, shifts modal left
   * - **South (S):** Drag down increases height by deltaY
   * - **North (N):** Drag up decreases height, shifts modal up
   * - **Corners:** Combine two directions (e.g., NE = North + East)
   *
   * **Constraints:**
   * - MIN_WIDTH: 600px (prevents crushing tactic columns)
   * - MIN_HEIGHT: 400px (prevents hiding header/controls)
   * - MAX_WIDTH/MAX_HEIGHT: 95% of viewport (prevents overflow)
   *
   * **Position Updates:**
   * When resizing from North or West edges, the modal position must shift
   * to maintain the opposite edge's position. For example, dragging the West
   * edge left by 50px must also move the modal left by 50px.
   */
  makeResizable() {
    const modal = this.modalEl;
    const MIN_WIDTH = 600;
    const MIN_HEIGHT = 400;
    const MAX_WIDTH = window.innerWidth * 0.95;
    const MAX_HEIGHT = window.innerHeight * 0.95;
    const handles = [
      ["resize-handle-n", "ns-resize", false],
      // Top edge
      ["resize-handle-s", "ns-resize", false],
      // Bottom edge
      ["resize-handle-e", "ew-resize", false],
      // Right edge
      ["resize-handle-w", "ew-resize", false],
      // Left edge
      ["resize-handle-ne", "nesw-resize", true],
      // Top-right corner
      ["resize-handle-nw", "nwse-resize", true],
      // Top-left corner
      ["resize-handle-se", "nwse-resize", true],
      // Bottom-right corner
      ["resize-handle-sw", "nesw-resize", true]
      // Bottom-left corner
    ];
    handles.forEach(([className, cursor, isCorner]) => {
      const handle = modal.createDiv(`mitre-resize-handle ${className}`);
      handle.style.cursor = cursor;
      let startX = 0, startY = 0, startWidth = 0, startHeight = 0, startLeft = 0, startTop = 0;
      const onMouseDown = (e) => {
        e.preventDefault();
        e.stopPropagation();
        startX = e.clientX;
        startY = e.clientY;
        const rect = modal.getBoundingClientRect();
        startWidth = rect.width;
        startHeight = rect.height;
        startLeft = rect.left;
        startTop = rect.top;
        document.addEventListener("mousemove", onMouseMove);
        document.addEventListener("mouseup", onMouseUp);
        modal.addClass("mitre-modal-resizing");
      };
      const onMouseMove = (e) => {
        const deltaX = e.clientX - startX;
        const deltaY = e.clientY - startY;
        let newWidth = startWidth;
        let newHeight = startHeight;
        let newLeft = startLeft;
        let newTop = startTop;
        if (className.includes("-e")) {
          newWidth = Math.max(MIN_WIDTH, Math.min(MAX_WIDTH, startWidth + deltaX));
        }
        if (className.includes("-w")) {
          newWidth = Math.max(MIN_WIDTH, Math.min(MAX_WIDTH, startWidth - deltaX));
          newLeft = startLeft + (startWidth - newWidth);
        }
        if (className.includes("-s")) {
          newHeight = Math.max(MIN_HEIGHT, Math.min(MAX_HEIGHT, startHeight + deltaY));
        }
        if (className.includes("-n")) {
          newHeight = Math.max(MIN_HEIGHT, Math.min(MAX_HEIGHT, startHeight - deltaY));
          newTop = startTop + (startHeight - newHeight);
        }
        modal.style.setProperty("width", `${newWidth}px`, "important");
        modal.style.setProperty("height", `${newHeight}px`, "important");
        modal.style.setProperty("max-width", `${newWidth}px`, "important");
        modal.style.setProperty("max-height", `${newHeight}px`, "important");
        if (className.includes("-w") || className.includes("-n")) {
          modal.style.left = `${newLeft}px`;
          modal.style.top = `${newTop}px`;
        }
      };
      const onMouseUp = () => {
        document.removeEventListener("mousemove", onMouseMove);
        document.removeEventListener("mouseup", onMouseUp);
        modal.removeClass("mitre-modal-resizing");
      };
      handle.addEventListener("mousedown", onMouseDown);
    });
  }
};

// src/RenderIOCCardsModal.ts
var import_obsidian3 = require("obsidian");
var RenderIOCCardsModal = class extends import_obsidian3.Modal {
  constructor(app, iocTypes, onSelect) {
    super(app);
    this.iocTypes = iocTypes;
    this.onSelect = onSelect;
  }
  /** Builds the primary IOC type grid view. */
  onOpen() {
    const { contentEl } = this;
    this.modalEl.classList.add("ioc-type-selector-modal");
    this.modalEl.style.maxWidth = "900px";
    this.modalEl.style.width = "90vw";
    contentEl.createEl("h2", { text: "Select IOC Type" });
    const container = contentEl.createDiv("ioc-type-container");
    const typeCount = Object.keys(this.iocTypes).length;
    const cols = Math.min(Math.ceil(Math.sqrt(typeCount)), 5);
    container.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
    Object.keys(this.iocTypes).forEach((iocTypeId) => {
      const iocType = this.iocTypes[iocTypeId];
      const button = container.createEl("button", { cls: "ioc-type-button" });
      button.setAttribute("data-ioc-type", iocTypeId);
      button.style.borderLeft = `4px solid ${iocType.color}`;
      const iconContainer = button.createDiv("ioc-button-icon");
      iconContainer.innerHTML = iocType.svg;
      const textContainer = button.createDiv("ioc-button-text");
      textContainer.textContent = iocType.name;
      button.addEventListener("click", () => {
        if (iocTypeId === "hostname") {
          this.showOSSelector(iocTypeId);
        } else {
          this.onSelect(iocTypeId);
          this.close();
        }
      });
    });
  }
  /**
   * Replaces the type grid with an OS selector sub-view.
   * Only reachable when iocTypeId === 'hostname' and the type has os_icons.
   */
  showOSSelector(iocTypeId) {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h2", { text: "Select Operating System" });
    contentEl.createEl("p", { text: "Choose the operating system for this hostname:" });
    const container = contentEl.createDiv("os-selector-container");
    const iocType = this.iocTypes[iocTypeId];
    if (iocType.os_icons) {
      Object.keys(iocType.os_icons).forEach((osType) => {
        const osButton = container.createEl("button", { cls: "os-type-button" });
        osButton.setAttribute("data-os-type", osType);
        const iconContainer = osButton.createDiv("os-button-icon");
        iconContainer.innerHTML = iocType.os_icons[osType];
        const textContainer = osButton.createDiv("os-button-text");
        textContainer.textContent = osType.charAt(0).toUpperCase() + osType.slice(1);
        osButton.addEventListener("click", () => {
          this.onSelect(iocTypeId, osType);
          this.close();
        });
      });
    }
    const backButton = contentEl.createEl("button", {
      text: "\u2190 Back to IOC Types",
      cls: "back-button"
    });
    backButton.addEventListener("click", () => {
      contentEl.empty();
      this.onOpen();
    });
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/RenderIOCCards.ts
var RenderIOCCards = class {
  /**
   * Builds the full markdown+HTML string for a new IOC card.
   * @param iocType  - The IOCField definition from the type registry
   * @param iocTypeId - The snake_case key (needed to detect "hostname" special case)
   * @param osType   - If iocTypeId is "hostname", which OS variant was selected
   * @param cardId   - Timestamp-based unique ID for the card (format: #YYYYMMDD-HHMM)
   */
  static createCardContent(iocType, iocTypeId, osType = null, cardId = "") {
    const now = new Date();
    const timestamp = now.toISOString().replace("T", " ").substring(0, 19);
    let iconSvg = iocType.svg;
    if (iocTypeId === "hostname" && osType && iocType.os_icons) {
      iconSvg = iocType.os_icons[osType] || iocType.svg;
    }
    let content = `<div class="ioc-card-container"><div class="ioc-card-header"
        style="display: flex; align-items: center; gap: 16px; margin-bottom: 30px; padding: 20px;
        background: linear-gradient(135deg, ${iocType.color}22, transparent);
        border-radius: 8px; border-bottom: 3px solid ${iocType.color};">
        <div class="ioc-header-content" style="display: flex; align-items: center; gap: 16px; width: 100%;">
        <div class="ioc-icon" style="flex-shrink: 0;">${iconSvg}</div><h2 style="margin: 0;
        color: ${iocType.color}; font-size: 24px; font-weight: 700;">${iocType.name}</h2>
        <span class="ioc-card-id" style="margin-left: auto; padding: 2px 8px; font-size: 11px; font-weight: 600; background: var(--background-modifier-border); color: var(--text-muted); border-radius: 4px; font-family: var(--font-monospace);">${cardId}</span>
        </div><!-- IOC_CARD_ID:${cardId} --></div></div>
`;
    iocType.fields.forEach((field) => {
      content += `${field}: 


------------
`;
    });
    content += `Time of Event: ${timestamp}

------------
`;
    content += `Splunk Query: 

------------
`;
    content += `Mitre Tactic: 

------------
`;
    content += `Mitre Technique: 

------------
`;
    return content;
  }
};

// src/PluginSettings.ts
var import_obsidian4 = require("obsidian");
var DEFAULT_SETTINGS = {
  cardSize: "medium",
  showTimelineButton: true
};
var PluginSettings = class extends import_obsidian4.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "IOC Canvas Plugin Settings" });
    new import_obsidian4.Setting(containerEl).setName("Default card size").setDesc("Set the default size for IOC cards").addDropdown(
      (dropdown) => dropdown.addOption("small", "Small").addOption("medium", "Medium").addOption("large", "Large").setValue(this.plugin.settings.cardSize).onChange(async (value) => {
        this.plugin.settings.cardSize = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian4.Setting(containerEl).setName("Show timeline button").setDesc("Display timeline button in canvas toolbar").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.showTimelineButton).onChange(async (value) => {
        this.plugin.settings.showTimelineButton = value;
        await this.plugin.saveSettings();
      })
    );
  }
};

// src/main.ts
var IOCCanvasPlugin = class extends import_obsidian5.Plugin {
  constructor() {
    super(...arguments);
    /** Typed settings object persisted to data.json. */
    this.settings = DEFAULT_SETTINGS;
    /** Whether the canvas IOC cards are currently in compact/reduced view. */
    this.isReducedView = false;
  }
  // ---------------------------------------------------------------
  // Plugin lifecycle
  // ---------------------------------------------------------------
  /**
   * Called by Obsidian when the plugin is activated.
   *
   * Order of operations:
   *   1. Load persisted settings from data.json.
   *   2. Register ribbon icons (sidebar shortcuts).
   *   3. Register commands (accessible via Ctrl/Cmd+P).
   *   4. Register the single settings tab from PluginSettings.ts.
   *   5. Register the canvas context-menu entry.
   *   6. Listen for active-leaf changes to inject floating buttons.
   *   7. Perform an initial button injection for the currently open leaf.
   */
  async onload() {
    console.log("Loading IOC Canvas Plugin");
    await this.loadSettings();
    this.addRibbonIcon("clock", "Show Attack Timelines", () => {
      new RenderTimelinesModal(this.app, this).open();
    });
    this.addCommand({
      id: "show-timelines",
      name: "Show Attack Timelines",
      callback: () => {
        new RenderTimelinesModal(this.app, this).open();
      }
    });
    this.addCommand({
      id: "show-ioc-cards",
      name: "Show All IOC Cards",
      callback: () => {
        this.openIOCCardSelector();
      }
    });
    this.addSettingTab(new PluginSettings(this.app, this));
    this.registerEvent(
      this.app.workspace.on("file-menu", (menu, file) => {
        if (file instanceof import_obsidian5.TFile && file.extension === "canvas") {
          menu.addItem((item) => {
            item.setTitle("Show Attack Timelines").setIcon("clock").onClick(() => {
              new RenderTimelinesModal(this.app, this).open();
            });
          });
        }
      })
    );
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", () => {
        this.addCanvasButtons();
      })
    );
    this.addCanvasButtons();
  }
  /**
   * Called by Obsidian when the plugin is deactivated or Obsidian closes.
   * Cleans up all DOM elements injected by the plugin so they do not
   * persist after disable/uninstall.
   */
  onunload() {
    console.log("Unloading IOC Canvas Plugin");
    document.querySelectorAll(".ioc-toolbar").forEach((el) => el.remove());
    document.querySelectorAll(".ioc-reduced").forEach((el) => el.classList.remove("ioc-reduced"));
  }
  // ---------------------------------------------------------------
  // Settings persistence
  // ---------------------------------------------------------------
  /** Load settings from data.json, falling back to defaults for any missing keys. */
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  /** Persist the current settings object to data.json. */
  async saveSettings() {
    await this.saveData(this.settings);
  }
  // ---------------------------------------------------------------
  // Canvas floating button injection
  // ---------------------------------------------------------------
  /**
   * Injects control buttons into Obsidian's native canvas control bar.
   *
   * Buttons added:
   *   - Timeline button: opens the attack-timeline modal.
   *   - IOC Cards button: opens the IOC card selector.
   *
   * Uses the .ioc-toolbar class as a duplicate-injection guard.
   *
   * The entire method is wrapped in a try/catch so a failure in button
   * creation never takes down the plugin.
   */
  addCanvasButtons() {
    try {
      const activeView = this.app.workspace.getActiveViewOfType(import_obsidian5.ItemView);
      if (!activeView || activeView.getViewType() !== "canvas") {
        return;
      }
      const canvasView = activeView.containerEl;
      if (!canvasView) {
        return;
      }
      const canvasControls = canvasView.querySelector(".canvas-controls");
      if (!canvasControls) {
        return;
      }
      if (canvasControls.querySelector(".ioc-toolbar")) {
        return;
      }
      const iocToolbar = document.createElement("div");
      iocToolbar.className = "ioc-toolbar";
      const TIMELINE_SVG = '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>';
      const CARDS_SVG = '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>';
      const REDUCE_SVG = '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="4 14 10 14 10 20"/><polyline points="20 10 14 10 14 4"/><line x1="14" y1="10" x2="21" y2="3"/><line x1="3" y1="21" x2="10" y2="14"/></svg>';
      const MITRE_SVG = '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>';
      const timelineBtn = this.createToolbarButton(
        "Show Attack Timelines",
        TIMELINE_SVG,
        () => new RenderTimelinesModal(this.app, this).open()
      );
      const cardsBtn = this.createToolbarButton(
        "Add IOC Card",
        CARDS_SVG,
        () => this.openIOCCardSelector()
      );
      const reduceBtn = this.createToolbarButton("Toggle Reduce View", REDUCE_SVG, () => {
        this.toggleReduceView();
        const icon = reduceBtn.querySelector(".clickable-icon");
        if (icon)
          icon.classList.toggle("is-active", this.isReducedView);
      });
      const mitreBtn = this.createToolbarButton(
        "MITRE ATT&CK Mapper",
        MITRE_SVG,
        () => new RenderMitreModal(this.app, this).open()
      );
      iocToolbar.appendChild(timelineBtn);
      iocToolbar.appendChild(cardsBtn);
      iocToolbar.appendChild(reduceBtn);
      iocToolbar.appendChild(mitreBtn);
      canvasControls.appendChild(iocToolbar);
    } catch (err) {
      console.error("IOC Canvas: failed to inject canvas buttons", err);
    }
  }
  /**
   * Creates a single toolbar button with SVG icon for the canvas control bar.
   */
  createToolbarButton(label, svgIcon, onClick) {
    const item = document.createElement("div");
    item.className = "canvas-control-item";
    item.setAttribute("aria-label", label);
    item.setAttribute("title", label);
    item.addEventListener("click", onClick);
    const icon = document.createElement("div");
    icon.className = "clickable-icon";
    icon.innerHTML = svgIcon;
    item.appendChild(icon);
    return item;
  }
  // ---------------------------------------------------------------
  // Reduce view toggle
  // ---------------------------------------------------------------
  /**
   * Toggles the reduced/compact view for IOC cards on the active canvas.
   *
   * **Two-part implementation:**
   *
   * **1. CSS-based content hiding** (via `.ioc-reduced` class):
   * - Hides IOC card headers, field labels, and metadata
   * - Shows only the primary value field
   * - Defined in styles.css (`.ioc-reduced .canvas-node-content`)
   *
   * **2. Node height reduction** (via canvas API):
   * - Stores original height in node._iocOriginalHeight custom property
   * - Resizes all text nodes to 60px height (single-line compact view)
   * - Restores original heights when toggled off
   *
   * **Why 60px?**
   * Enough to show a single line of text with padding, matches typical
   * single-line card height in canvas views.
   *
   * **Algorithm:**
   * 1. Toggle isReducedView flag
   * 2. Add/remove `.ioc-reduced` class on canvas wrapper
   * 3. Loop through all canvas nodes:
   *    - If reducing: store original height, resize to 60px
   *    - If restoring: read stored height, restore original dimensions
   * 4. Call canvas.requestFrame() and canvas.requestSave() to persist
   *
   * **Obsidian Canvas API:**
   * - `canvas.nodes` is a Map of all nodes on the canvas
   * - `node.resize({width, height})` or `node.height =` to change dimensions
   * - `node._iocOriginalHeight` is a custom property we add for state tracking
   */
  toggleReduceView() {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian5.ItemView);
    if (!activeView || activeView.getViewType() !== "canvas")
      return;
    const canvas = activeView.canvas;
    if (!canvas)
      return;
    this.isReducedView = !this.isReducedView;
    const wrapperEl = canvas.wrapperEl;
    if (wrapperEl) {
      if (this.isReducedView) {
        wrapperEl.classList.add("ioc-reduced");
      } else {
        wrapperEl.classList.remove("ioc-reduced");
      }
    }
    if (canvas.nodes) {
      canvas.nodes.forEach((node) => {
        if (!node.text)
          return;
        if (this.isReducedView) {
          if (!node._iocOriginalHeight) {
            node._iocOriginalHeight = node.height;
          }
          if (node.resize) {
            node.resize({ width: node.width, height: 60 });
          } else {
            node.height = 60;
          }
        } else {
          const originalH = node._iocOriginalHeight || 400;
          if (node.resize) {
            node.resize({ width: node.width, height: originalH });
          } else {
            node.height = originalH;
          }
        }
      });
    }
    canvas.requestFrame();
    canvas.requestSave();
  }
  // ---------------------------------------------------------------
  // IOC card creation helpers
  // ---------------------------------------------------------------
  /**
   * Opens the IOC card selector modal. The callback creates the card on
   * the active canvas.
   */
  openIOCCardSelector() {
    new RenderIOCCardsModal(
      this.app,
      IOC_TYPES,
      (iocTypeId, osType) => {
        this.createIOCCard(iocTypeId, osType);
      }
    ).open();
  }
  /**
   * Creates an IOC card on the active canvas.
   *
   * **Card Creation Flow:**
   * 1. **Validate canvas view** - Ensure user is in a canvas view (not markdown/reading)
   * 2. **Access internal canvas API** - Get canvas object from (view as any).canvas
   * 3. **Generate timestamp-based card ID** - Format: #YYYYMMDD-HHMM (e.g., #20260214-1534)
   * 4. **Generate card content** - Call RenderIOCCards.createCardContent()
   * 5. **Create canvas text node** - Use canvas.createTextNode() with random position
   * 6. **Persist to disk** - Call canvas.requestSave() to write .canvas file
   *
   * **Card ID Format:**
   * - Timestamp-based for uniqueness: #YYYYMMDD-HHMM
   * - Example: #20260214-1534 (February 14, 2026 at 3:34 PM)
   * - Displayed as metadata field at bottom of card
   * - Used for referencing cards in validation errors
   *
   * **Random Positioning:**
   * - New cards are placed at random coordinates within a 400x400 area
   * - User can drag cards to desired position after creation
   * - Prevents cards from stacking exactly on top of each other
   *
   * **Obsidian Canvas API:**
   * - `canvas.createTextNode()` creates a markdown text node
   * - `pos`: {x, y} coordinates on the infinite canvas
   * - `size`: {width, height} in pixels (default 400x400)
   * - `text`: Markdown content (generated by RenderIOCCards)
   *
   * @param iocTypeId - The snake_case IOC type key from IOC_TYPES (e.g., "ip_address")
   * @param osType - Optional OS variant for hostname cards ("windows", "macos", "linux")
   */
  createIOCCard(iocTypeId, osType) {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian5.ItemView);
    if (!activeView || activeView.getViewType() !== "canvas") {
      new import_obsidian5.Notice("Please open a canvas first");
      return;
    }
    const canvas = activeView.canvas;
    if (!canvas) {
      new import_obsidian5.Notice("Please open a canvas first");
      return;
    }
    const iocType = IOC_TYPES[iocTypeId];
    if (!iocType) {
      new import_obsidian5.Notice("Unknown IOC type: " + iocTypeId);
      return;
    }
    const now = new Date();
    const year = now.getFullYear();
    const month = String(now.getMonth() + 1).padStart(2, "0");
    const day = String(now.getDate()).padStart(2, "0");
    const hours = String(now.getHours()).padStart(2, "0");
    const minutes = String(now.getMinutes()).padStart(2, "0");
    const cardId = `#${year}${month}${day}-${hours}${minutes}`;
    const content = RenderIOCCards.createCardContent(iocType, iocTypeId, osType || null, cardId);
    canvas.createTextNode({
      pos: { x: Math.random() * 400, y: Math.random() * 400 },
      // Random placement
      size: { width: 400, height: 400 },
      // Standard card size
      text: content
      // Markdown with HTML header
    });
    canvas.requestSave();
    new import_obsidian5.Notice(`Created ${iocType.name} card`);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL1JlbmRlclRpbWVsaW5lc01vZGFsLnRzIiwgInNyYy9JT0NDYXJkc1R5cGVzLnRzIiwgInNyYy9JT0NQYXJzZXIudHMiLCAic3JjL1RpbWVUaW1lbGluZVByb2Nlc3NpbmcudHMiLCAic3JjL1JlbmRlck1pdHJlTW9kYWwudHMiLCAic3JjL01pdHJlTG9hZGVyLnRzIiwgInNyYy9SZW5kZXJJT0NDYXJkc01vZGFsLnRzIiwgInNyYy9SZW5kZXJJT0NDYXJkcy50cyIsICJzcmMvUGx1Z2luU2V0dGluZ3MudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbIi8qKlxuICogSU9DIENhbnZhcyBQbHVnaW4gLSBNYWluIGVudHJ5IHBvaW50XG4gKlxuICogVGhpcyBpcyB0aGUgY29yZSBwbHVnaW4gY2xhc3MgdGhhdCBPYnNpZGlhbiBpbnN0YW50aWF0ZXMgd2hlbiB0aGUgcGx1Z2luIGlzXG4gKiBlbmFibGVkLiBJdCBpcyByZXNwb25zaWJsZSBmb3I6XG4gKiAgIDEuIFJlZ2lzdGVyaW5nIGNvbW1hbmRzIGFuZCByaWJib24gaWNvbnMgdGhhdCBvcGVuIHRoZSB0aW1lbGluZS9JT0MgbW9kYWxzLlxuICogICAyLiBJbmplY3RpbmcgZmxvYXRpbmcgY29udHJvbCBidXR0b25zIGludG8gZXZlcnkgY2FudmFzIHZpZXcgc28gdGhlIHVzZXJcbiAqICAgICAgY2FuIGFjY2VzcyBwbHVnaW4gZmVhdHVyZXMgd2l0aG91dCB0aGUgY29tbWFuZCBwYWxldHRlLlxuICogICAzLiBQZXJzaXN0aW5nIGFuZCBsb2FkaW5nIHVzZXIgc2V0dGluZ3MgdmlhIE9ic2lkaWFuJ3MgZGF0YSBzdG9yZS5cbiAqXG4gKiBDYW52YXMgaW50ZWdyYXRpb24gbm90ZTpcbiAqICAgT2JzaWRpYW4gZG9lcyBub3QgZXhwb3NlIGEgcHVibGljIEFQSSBmb3IgY2FudmFzIHZpZXdzLiBXZSByZWx5IG9uIHRoZVxuICogICBpbnRlcm5hbCBgKHZpZXcgYXMgYW55KS5jYW52YXNgIG9iamVjdCB3aGljaCBleHBvc2VzIGAubm9kZXNgIChNYXApLFxuICogICBgLmVkZ2VzYCwgYW5kIGAud3JhcHBlckVsYC4gVGhpcyBpcyBpbmhlcmVudGx5IGZyYWdpbGUgYW5kIGV2ZXJ5IGFjY2Vzc1xuICogICBpcyBndWFyZGVkIHdpdGggbnVsbCBjaGVja3Mgc28gdGhlIHBsdWdpbiBkZWdyYWRlcyBncmFjZWZ1bGx5IGlmIHRoZVxuICogICBpbnRlcm5hbCBBUEkgY2hhbmdlcy5cbiAqL1xuXG5pbXBvcnQgeyBQbHVnaW4sIE5vdGljZSwgVEZpbGUsIEl0ZW1WaWV3IH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgUmVuZGVyVGltZWxpbmVzTW9kYWwgfSBmcm9tICcuL1JlbmRlclRpbWVsaW5lc01vZGFsJztcbmltcG9ydCB7IFJlbmRlck1pdHJlTW9kYWwgfSBmcm9tICcuL1JlbmRlck1pdHJlTW9kYWwnO1xuaW1wb3J0IHsgUmVuZGVySU9DQ2FyZHNNb2RhbCB9IGZyb20gJy4vUmVuZGVySU9DQ2FyZHNNb2RhbCc7XG5pbXBvcnQgeyBSZW5kZXJJT0NDYXJkcyB9IGZyb20gJy4vUmVuZGVySU9DQ2FyZHMnO1xuaW1wb3J0IHsgSU9DX1RZUEVTIH0gZnJvbSAnLi9JT0NDYXJkc1R5cGVzJztcbmltcG9ydCB7IFBsdWdpblNldHRpbmdzLCBJT0NDYW52YXNQbHVnaW5TZXR0aW5ncywgREVGQVVMVF9TRVRUSU5HUyB9IGZyb20gJy4vUGx1Z2luU2V0dGluZ3MnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBJT0NDYW52YXNQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICAgIC8qKiBUeXBlZCBzZXR0aW5ncyBvYmplY3QgcGVyc2lzdGVkIHRvIGRhdGEuanNvbi4gKi9cbiAgICBzZXR0aW5nczogSU9DQ2FudmFzUGx1Z2luU2V0dGluZ3MgPSBERUZBVUxUX1NFVFRJTkdTO1xuXG4gICAgLyoqIFdoZXRoZXIgdGhlIGNhbnZhcyBJT0MgY2FyZHMgYXJlIGN1cnJlbnRseSBpbiBjb21wYWN0L3JlZHVjZWQgdmlldy4gKi9cbiAgICBpc1JlZHVjZWRWaWV3OiBib29sZWFuID0gZmFsc2U7XG5cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQbHVnaW4gbGlmZWN5Y2xlXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgYnkgT2JzaWRpYW4gd2hlbiB0aGUgcGx1Z2luIGlzIGFjdGl2YXRlZC5cbiAgICAgKlxuICAgICAqIE9yZGVyIG9mIG9wZXJhdGlvbnM6XG4gICAgICogICAxLiBMb2FkIHBlcnNpc3RlZCBzZXR0aW5ncyBmcm9tIGRhdGEuanNvbi5cbiAgICAgKiAgIDIuIFJlZ2lzdGVyIHJpYmJvbiBpY29ucyAoc2lkZWJhciBzaG9ydGN1dHMpLlxuICAgICAqICAgMy4gUmVnaXN0ZXIgY29tbWFuZHMgKGFjY2Vzc2libGUgdmlhIEN0cmwvQ21kK1ApLlxuICAgICAqICAgNC4gUmVnaXN0ZXIgdGhlIHNpbmdsZSBzZXR0aW5ncyB0YWIgZnJvbSBQbHVnaW5TZXR0aW5ncy50cy5cbiAgICAgKiAgIDUuIFJlZ2lzdGVyIHRoZSBjYW52YXMgY29udGV4dC1tZW51IGVudHJ5LlxuICAgICAqICAgNi4gTGlzdGVuIGZvciBhY3RpdmUtbGVhZiBjaGFuZ2VzIHRvIGluamVjdCBmbG9hdGluZyBidXR0b25zLlxuICAgICAqICAgNy4gUGVyZm9ybSBhbiBpbml0aWFsIGJ1dHRvbiBpbmplY3Rpb24gZm9yIHRoZSBjdXJyZW50bHkgb3BlbiBsZWFmLlxuICAgICAqL1xuICAgIGFzeW5jIG9ubG9hZCgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ0xvYWRpbmcgSU9DIENhbnZhcyBQbHVnaW4nKTtcblxuICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXG4gICAgICAgIC8vIC0tLSBSaWJib24gaWNvbjogcXVpY2sgYWNjZXNzIGZyb20gdGhlIGxlZnQgc2lkZWJhciAtLS1cbiAgICAgICAgdGhpcy5hZGRSaWJib25JY29uKCdjbG9jaycsICdTaG93IEF0dGFjayBUaW1lbGluZXMnLCAoKSA9PiB7XG4gICAgICAgICAgICBuZXcgUmVuZGVyVGltZWxpbmVzTW9kYWwodGhpcy5hcHAsIHRoaXMpLm9wZW4oKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gLS0tIENvbW1hbmRzOiBhY2Nlc3NpYmxlIHZpYSB0aGUgY29tbWFuZCBwYWxldHRlIChDdHJsL0NtZCtQKSAtLS1cblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdzaG93LXRpbWVsaW5lcycsXG4gICAgICAgICAgICBuYW1lOiAnU2hvdyBBdHRhY2sgVGltZWxpbmVzJyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgbmV3IFJlbmRlclRpbWVsaW5lc01vZGFsKHRoaXMuYXBwLCB0aGlzKS5vcGVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ3Nob3ctaW9jLWNhcmRzJyxcbiAgICAgICAgICAgIG5hbWU6ICdTaG93IEFsbCBJT0MgQ2FyZHMnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLm9wZW5JT0NDYXJkU2VsZWN0b3IoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gLS0tIFNldHRpbmdzIHRhYjogc2luZ2xlIHNvdXJjZSBvZiB0cnV0aCBmcm9tIFBsdWdpblNldHRpbmdzLnRzIC0tLVxuICAgICAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IFBsdWdpblNldHRpbmdzKHRoaXMuYXBwLCB0aGlzKSk7XG5cbiAgICAgICAgLy8gLS0tIENhbnZhcyBjb250ZXh0IG1lbnU6IHJpZ2h0LWNsaWNrIGEgLmNhbnZhcyBmaWxlIGluIHRoZSBmaWxlIGV4cGxvcmVyIC0tLVxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2ZpbGUtbWVudScsIChtZW51LCBmaWxlKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gJ2NhbnZhcycpIHtcbiAgICAgICAgICAgICAgICAgICAgbWVudS5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNldFRpdGxlKCdTaG93IEF0dGFjayBUaW1lbGluZXMnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKCdjbG9jaycpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgUmVuZGVyVGltZWxpbmVzTW9kYWwodGhpcy5hcHAsIHRoaXMpLm9wZW4oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuICAgICAgICAvLyAtLS0gQ2FudmFzIGJ1dHRvbiBpbmplY3Rpb24gLS0tXG4gICAgICAgIC8vIE9ic2lkaWFuIGZpcmVzICdhY3RpdmUtbGVhZi1jaGFuZ2UnIHdoZW5ldmVyIHRoZSB1c2VyIHN3aXRjaGVzIHRhYnMuXG4gICAgICAgIC8vIFdlIGhvb2sgaW50byB0aGlzIHRvIGluamVjdCBmbG9hdGluZyBjb250cm9sIGJ1dHRvbnMgd2hlbiBhIGNhbnZhc1xuICAgICAgICAvLyB2aWV3IGJlY29tZXMgYWN0aXZlLlxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2FjdGl2ZS1sZWFmLWNoYW5nZScsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZENhbnZhc0J1dHRvbnMoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gSW5qZWN0IGJ1dHRvbnMgaW50byB3aGF0ZXZlciB2aWV3IGlzIGFscmVhZHkgb3BlbiBhdCBwbHVnaW4gbG9hZCB0aW1lLlxuICAgICAgICB0aGlzLmFkZENhbnZhc0J1dHRvbnMoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgYnkgT2JzaWRpYW4gd2hlbiB0aGUgcGx1Z2luIGlzIGRlYWN0aXZhdGVkIG9yIE9ic2lkaWFuIGNsb3Nlcy5cbiAgICAgKiBDbGVhbnMgdXAgYWxsIERPTSBlbGVtZW50cyBpbmplY3RlZCBieSB0aGUgcGx1Z2luIHNvIHRoZXkgZG8gbm90XG4gICAgICogcGVyc2lzdCBhZnRlciBkaXNhYmxlL3VuaW5zdGFsbC5cbiAgICAgKi9cbiAgICBvbnVubG9hZCgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1VubG9hZGluZyBJT0MgQ2FudmFzIFBsdWdpbicpO1xuXG4gICAgICAgIC8vIFJlbW92ZSBhbGwgaW5qZWN0ZWQgdG9vbGJhciBlbGVtZW50cyBmcm9tIGNhbnZhcyBjb250cm9sc1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaW9jLXRvb2xiYXInKS5mb3JFYWNoKGVsID0+IGVsLnJlbW92ZSgpKTtcblxuICAgICAgICAvLyBSZW1vdmUgcmVkdWNlIHZpZXcgY2xhc3MgZnJvbSBhbnkgY2FudmFzIHdyYXBwZXJzXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pb2MtcmVkdWNlZCcpLmZvckVhY2goZWwgPT4gZWwuY2xhc3NMaXN0LnJlbW92ZSgnaW9jLXJlZHVjZWQnKSk7XG4gICAgfVxuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gU2V0dGluZ3MgcGVyc2lzdGVuY2VcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKiBMb2FkIHNldHRpbmdzIGZyb20gZGF0YS5qc29uLCBmYWxsaW5nIGJhY2sgdG8gZGVmYXVsdHMgZm9yIGFueSBtaXNzaW5nIGtleXMuICovXG4gICAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcbiAgICB9XG5cbiAgICAvKiogUGVyc2lzdCB0aGUgY3VycmVudCBzZXR0aW5ncyBvYmplY3QgdG8gZGF0YS5qc29uLiAqL1xuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBDYW52YXMgZmxvYXRpbmcgYnV0dG9uIGluamVjdGlvblxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogSW5qZWN0cyBjb250cm9sIGJ1dHRvbnMgaW50byBPYnNpZGlhbidzIG5hdGl2ZSBjYW52YXMgY29udHJvbCBiYXIuXG4gICAgICpcbiAgICAgKiBCdXR0b25zIGFkZGVkOlxuICAgICAqICAgLSBUaW1lbGluZSBidXR0b246IG9wZW5zIHRoZSBhdHRhY2stdGltZWxpbmUgbW9kYWwuXG4gICAgICogICAtIElPQyBDYXJkcyBidXR0b246IG9wZW5zIHRoZSBJT0MgY2FyZCBzZWxlY3Rvci5cbiAgICAgKlxuICAgICAqIFVzZXMgdGhlIC5pb2MtdG9vbGJhciBjbGFzcyBhcyBhIGR1cGxpY2F0ZS1pbmplY3Rpb24gZ3VhcmQuXG4gICAgICpcbiAgICAgKiBUaGUgZW50aXJlIG1ldGhvZCBpcyB3cmFwcGVkIGluIGEgdHJ5L2NhdGNoIHNvIGEgZmFpbHVyZSBpbiBidXR0b25cbiAgICAgKiBjcmVhdGlvbiBuZXZlciB0YWtlcyBkb3duIHRoZSBwbHVnaW4uXG4gICAgICovXG4gICAgYWRkQ2FudmFzQnV0dG9ucygpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShJdGVtVmlldyk7XG5cbiAgICAgICAgICAgIC8vIE9ubHkgaW5qZWN0IGludG8gY2FudmFzIHZpZXdzXG4gICAgICAgICAgICBpZiAoIWFjdGl2ZVZpZXcgfHwgYWN0aXZlVmlldy5nZXRWaWV3VHlwZSgpICE9PSAnY2FudmFzJykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgY2FudmFzVmlldyA9IGFjdGl2ZVZpZXcuY29udGFpbmVyRWw7XG4gICAgICAgICAgICBpZiAoIWNhbnZhc1ZpZXcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEZpbmQgT2JzaWRpYW4ncyBuYXRpdmUgY2FudmFzIGNvbnRyb2xzIGJhclxuICAgICAgICAgICAgY29uc3QgY2FudmFzQ29udHJvbHMgPSBjYW52YXNWaWV3LnF1ZXJ5U2VsZWN0b3IoJy5jYW52YXMtY29udHJvbHMnKTtcbiAgICAgICAgICAgIGlmICghY2FudmFzQ29udHJvbHMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFByZXZlbnQgZHVwbGljYXRlIGluamVjdGlvblxuICAgICAgICAgICAgaWYgKGNhbnZhc0NvbnRyb2xzLnF1ZXJ5U2VsZWN0b3IoJy5pb2MtdG9vbGJhcicpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBpb2NUb29sYmFyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBpb2NUb29sYmFyLmNsYXNzTmFtZSA9ICdpb2MtdG9vbGJhcic7XG5cbiAgICAgICAgICAgIC8vIFNWRyBpY29uc1xuICAgICAgICAgICAgY29uc3QgVElNRUxJTkVfU1ZHID0gJzxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMThcIiBoZWlnaHQ9XCIxOFwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj48Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjEwXCIvPjxwb2x5bGluZSBwb2ludHM9XCIxMiA2IDEyIDEyIDE2IDE0XCIvPjwvc3ZnPic7XG4gICAgICAgICAgICBjb25zdCBDQVJEU19TVkcgPSAnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCIxOFwiIGhlaWdodD1cIjE4XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPjxyZWN0IHg9XCIyXCIgeT1cIjNcIiB3aWR0aD1cIjIwXCIgaGVpZ2h0PVwiMTRcIiByeD1cIjJcIiByeT1cIjJcIi8+PGxpbmUgeDE9XCI4XCIgeTE9XCIyMVwiIHgyPVwiMTZcIiB5Mj1cIjIxXCIvPjxsaW5lIHgxPVwiMTJcIiB5MT1cIjE3XCIgeDI9XCIxMlwiIHkyPVwiMjFcIi8+PC9zdmc+JztcbiAgICAgICAgICAgIGNvbnN0IFJFRFVDRV9TVkcgPSAnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCIxOFwiIGhlaWdodD1cIjE4XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPjxwb2x5bGluZSBwb2ludHM9XCI0IDE0IDEwIDE0IDEwIDIwXCIvPjxwb2x5bGluZSBwb2ludHM9XCIyMCAxMCAxNCAxMCAxNCA0XCIvPjxsaW5lIHgxPVwiMTRcIiB5MT1cIjEwXCIgeDI9XCIyMVwiIHkyPVwiM1wiLz48bGluZSB4MT1cIjNcIiB5MT1cIjIxXCIgeDI9XCIxMFwiIHkyPVwiMTRcIi8+PC9zdmc+JztcbiAgICAgICAgICAgIGNvbnN0IE1JVFJFX1NWRyA9ICc8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjE4XCIgaGVpZ2h0PVwiMThcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxMFwiLz48Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjZcIi8+PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIyXCIvPjwvc3ZnPic7XG5cbiAgICAgICAgICAgIGNvbnN0IHRpbWVsaW5lQnRuID0gdGhpcy5jcmVhdGVUb29sYmFyQnV0dG9uKCdTaG93IEF0dGFjayBUaW1lbGluZXMnLCBUSU1FTElORV9TVkcsXG4gICAgICAgICAgICAgICAgKCkgPT4gbmV3IFJlbmRlclRpbWVsaW5lc01vZGFsKHRoaXMuYXBwLCB0aGlzKS5vcGVuKCkpO1xuXG4gICAgICAgICAgICBjb25zdCBjYXJkc0J0biA9IHRoaXMuY3JlYXRlVG9vbGJhckJ1dHRvbignQWRkIElPQyBDYXJkJywgQ0FSRFNfU1ZHLFxuICAgICAgICAgICAgICAgICgpID0+IHRoaXMub3BlbklPQ0NhcmRTZWxlY3RvcigpKTtcblxuICAgICAgICAgICAgY29uc3QgcmVkdWNlQnRuID0gdGhpcy5jcmVhdGVUb29sYmFyQnV0dG9uKCdUb2dnbGUgUmVkdWNlIFZpZXcnLCBSRURVQ0VfU1ZHLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy50b2dnbGVSZWR1Y2VWaWV3KCk7XG4gICAgICAgICAgICAgICAgY29uc3QgaWNvbiA9IHJlZHVjZUJ0bi5xdWVyeVNlbGVjdG9yKCcuY2xpY2thYmxlLWljb24nKTtcbiAgICAgICAgICAgICAgICBpZiAoaWNvbikgaWNvbi5jbGFzc0xpc3QudG9nZ2xlKCdpcy1hY3RpdmUnLCB0aGlzLmlzUmVkdWNlZFZpZXcpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IG1pdHJlQnRuID0gdGhpcy5jcmVhdGVUb29sYmFyQnV0dG9uKCdNSVRSRSBBVFQmQ0sgTWFwcGVyJywgTUlUUkVfU1ZHLFxuICAgICAgICAgICAgICAgICgpID0+IG5ldyBSZW5kZXJNaXRyZU1vZGFsKHRoaXMuYXBwLCB0aGlzKS5vcGVuKCkpO1xuXG4gICAgICAgICAgICBpb2NUb29sYmFyLmFwcGVuZENoaWxkKHRpbWVsaW5lQnRuKTtcbiAgICAgICAgICAgIGlvY1Rvb2xiYXIuYXBwZW5kQ2hpbGQoY2FyZHNCdG4pO1xuICAgICAgICAgICAgaW9jVG9vbGJhci5hcHBlbmRDaGlsZChyZWR1Y2VCdG4pO1xuICAgICAgICAgICAgaW9jVG9vbGJhci5hcHBlbmRDaGlsZChtaXRyZUJ0bik7XG4gICAgICAgICAgICBjYW52YXNDb250cm9scy5hcHBlbmRDaGlsZChpb2NUb29sYmFyKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAvLyBCdXR0b24gaW5qZWN0aW9uIGlzIG5vbi1jcml0aWNhbDsgbG9nIGFuZCBjb250aW51ZVxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignSU9DIENhbnZhczogZmFpbGVkIHRvIGluamVjdCBjYW52YXMgYnV0dG9ucycsIGVycik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgc2luZ2xlIHRvb2xiYXIgYnV0dG9uIHdpdGggU1ZHIGljb24gZm9yIHRoZSBjYW52YXMgY29udHJvbCBiYXIuXG4gICAgICovXG4gICAgcHJpdmF0ZSBjcmVhdGVUb29sYmFyQnV0dG9uKGxhYmVsOiBzdHJpbmcsIHN2Z0ljb246IHN0cmluZywgb25DbGljazogKCkgPT4gdm9pZCk6IEhUTUxFbGVtZW50IHtcbiAgICAgICAgY29uc3QgaXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBpdGVtLmNsYXNzTmFtZSA9ICdjYW52YXMtY29udHJvbC1pdGVtJztcbiAgICAgICAgaXRlbS5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBsYWJlbCk7XG4gICAgICAgIGl0ZW0uc2V0QXR0cmlidXRlKCd0aXRsZScsIGxhYmVsKTtcbiAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xpY2spO1xuXG4gICAgICAgIGNvbnN0IGljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgaWNvbi5jbGFzc05hbWUgPSAnY2xpY2thYmxlLWljb24nO1xuICAgICAgICBpY29uLmlubmVySFRNTCA9IHN2Z0ljb247XG4gICAgICAgIGl0ZW0uYXBwZW5kQ2hpbGQoaWNvbik7XG5cbiAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgfVxuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUmVkdWNlIHZpZXcgdG9nZ2xlXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBUb2dnbGVzIHRoZSByZWR1Y2VkL2NvbXBhY3QgdmlldyBmb3IgSU9DIGNhcmRzIG9uIHRoZSBhY3RpdmUgY2FudmFzLlxuICAgICAqXG4gICAgICogKipUd28tcGFydCBpbXBsZW1lbnRhdGlvbjoqKlxuICAgICAqXG4gICAgICogKioxLiBDU1MtYmFzZWQgY29udGVudCBoaWRpbmcqKiAodmlhIGAuaW9jLXJlZHVjZWRgIGNsYXNzKTpcbiAgICAgKiAtIEhpZGVzIElPQyBjYXJkIGhlYWRlcnMsIGZpZWxkIGxhYmVscywgYW5kIG1ldGFkYXRhXG4gICAgICogLSBTaG93cyBvbmx5IHRoZSBwcmltYXJ5IHZhbHVlIGZpZWxkXG4gICAgICogLSBEZWZpbmVkIGluIHN0eWxlcy5jc3MgKGAuaW9jLXJlZHVjZWQgLmNhbnZhcy1ub2RlLWNvbnRlbnRgKVxuICAgICAqXG4gICAgICogKioyLiBOb2RlIGhlaWdodCByZWR1Y3Rpb24qKiAodmlhIGNhbnZhcyBBUEkpOlxuICAgICAqIC0gU3RvcmVzIG9yaWdpbmFsIGhlaWdodCBpbiBub2RlLl9pb2NPcmlnaW5hbEhlaWdodCBjdXN0b20gcHJvcGVydHlcbiAgICAgKiAtIFJlc2l6ZXMgYWxsIHRleHQgbm9kZXMgdG8gNjBweCBoZWlnaHQgKHNpbmdsZS1saW5lIGNvbXBhY3QgdmlldylcbiAgICAgKiAtIFJlc3RvcmVzIG9yaWdpbmFsIGhlaWdodHMgd2hlbiB0b2dnbGVkIG9mZlxuICAgICAqXG4gICAgICogKipXaHkgNjBweD8qKlxuICAgICAqIEVub3VnaCB0byBzaG93IGEgc2luZ2xlIGxpbmUgb2YgdGV4dCB3aXRoIHBhZGRpbmcsIG1hdGNoZXMgdHlwaWNhbFxuICAgICAqIHNpbmdsZS1saW5lIGNhcmQgaGVpZ2h0IGluIGNhbnZhcyB2aWV3cy5cbiAgICAgKlxuICAgICAqICoqQWxnb3JpdGhtOioqXG4gICAgICogMS4gVG9nZ2xlIGlzUmVkdWNlZFZpZXcgZmxhZ1xuICAgICAqIDIuIEFkZC9yZW1vdmUgYC5pb2MtcmVkdWNlZGAgY2xhc3Mgb24gY2FudmFzIHdyYXBwZXJcbiAgICAgKiAzLiBMb29wIHRocm91Z2ggYWxsIGNhbnZhcyBub2RlczpcbiAgICAgKiAgICAtIElmIHJlZHVjaW5nOiBzdG9yZSBvcmlnaW5hbCBoZWlnaHQsIHJlc2l6ZSB0byA2MHB4XG4gICAgICogICAgLSBJZiByZXN0b3Jpbmc6IHJlYWQgc3RvcmVkIGhlaWdodCwgcmVzdG9yZSBvcmlnaW5hbCBkaW1lbnNpb25zXG4gICAgICogNC4gQ2FsbCBjYW52YXMucmVxdWVzdEZyYW1lKCkgYW5kIGNhbnZhcy5yZXF1ZXN0U2F2ZSgpIHRvIHBlcnNpc3RcbiAgICAgKlxuICAgICAqICoqT2JzaWRpYW4gQ2FudmFzIEFQSToqKlxuICAgICAqIC0gYGNhbnZhcy5ub2Rlc2AgaXMgYSBNYXAgb2YgYWxsIG5vZGVzIG9uIHRoZSBjYW52YXNcbiAgICAgKiAtIGBub2RlLnJlc2l6ZSh7d2lkdGgsIGhlaWdodH0pYCBvciBgbm9kZS5oZWlnaHQgPWAgdG8gY2hhbmdlIGRpbWVuc2lvbnNcbiAgICAgKiAtIGBub2RlLl9pb2NPcmlnaW5hbEhlaWdodGAgaXMgYSBjdXN0b20gcHJvcGVydHkgd2UgYWRkIGZvciBzdGF0ZSB0cmFja2luZ1xuICAgICAqL1xuICAgIHRvZ2dsZVJlZHVjZVZpZXcoKSB7XG4gICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShJdGVtVmlldyk7XG4gICAgICAgIGlmICghYWN0aXZlVmlldyB8fCBhY3RpdmVWaWV3LmdldFZpZXdUeXBlKCkgIT09ICdjYW52YXMnKSByZXR1cm47XG5cbiAgICAgICAgY29uc3QgY2FudmFzID0gKGFjdGl2ZVZpZXcgYXMgYW55KS5jYW52YXM7XG4gICAgICAgIGlmICghY2FudmFzKSByZXR1cm47XG5cbiAgICAgICAgdGhpcy5pc1JlZHVjZWRWaWV3ID0gIXRoaXMuaXNSZWR1Y2VkVmlldztcblxuICAgICAgICAvLyBBZGQvcmVtb3ZlIENTUyBjbGFzcyBvbiB0aGUgY2FudmFzIHdyYXBwZXIgZm9yIENTUy1iYXNlZCBjb250ZW50IGhpZGluZ1xuICAgICAgICBjb25zdCB3cmFwcGVyRWwgPSBjYW52YXMud3JhcHBlckVsO1xuICAgICAgICBpZiAod3JhcHBlckVsKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc1JlZHVjZWRWaWV3KSB7XG4gICAgICAgICAgICAgICAgd3JhcHBlckVsLmNsYXNzTGlzdC5hZGQoJ2lvYy1yZWR1Y2VkJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHdyYXBwZXJFbC5jbGFzc0xpc3QucmVtb3ZlKCdpb2MtcmVkdWNlZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmVzaXplIGFsbCB0ZXh0IG5vZGVzXG4gICAgICAgIGlmIChjYW52YXMubm9kZXMpIHtcbiAgICAgICAgICAgIGNhbnZhcy5ub2Rlcy5mb3JFYWNoKChub2RlOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIW5vZGUudGV4dCkgcmV0dXJuOyAvLyBvbmx5IHRleHQgbm9kZXMgKElPQyBjYXJkcyBoYXZlIHRleHQpXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNSZWR1Y2VkVmlldykge1xuICAgICAgICAgICAgICAgICAgICAvLyBTdG9yZSBvcmlnaW5hbCBkaW1lbnNpb25zIGJlZm9yZSByZWR1Y2luZ1xuICAgICAgICAgICAgICAgICAgICBpZiAoIW5vZGUuX2lvY09yaWdpbmFsSGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLl9pb2NPcmlnaW5hbEhlaWdodCA9IG5vZGUuaGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIFJlc2l6ZSB0byBjb21wYWN0IHNpbmdsZS1saW5lIGhlaWdodFxuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5yZXNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUucmVzaXplKHsgd2lkdGg6IG5vZGUud2lkdGgsIGhlaWdodDogNjAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLmhlaWdodCA9IDYwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVzdG9yZSBvcmlnaW5hbCBoZWlnaHRcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWxIID0gbm9kZS5faW9jT3JpZ2luYWxIZWlnaHQgfHwgNDAwO1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5yZXNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUucmVzaXplKHsgd2lkdGg6IG5vZGUud2lkdGgsIGhlaWdodDogb3JpZ2luYWxIIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5oZWlnaHQgPSBvcmlnaW5hbEg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNhbnZhcy5yZXF1ZXN0RnJhbWUoKTtcbiAgICAgICAgY2FudmFzLnJlcXVlc3RTYXZlKCk7XG4gICAgfVxuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gSU9DIGNhcmQgY3JlYXRpb24gaGVscGVyc1xuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogT3BlbnMgdGhlIElPQyBjYXJkIHNlbGVjdG9yIG1vZGFsLiBUaGUgY2FsbGJhY2sgY3JlYXRlcyB0aGUgY2FyZCBvblxuICAgICAqIHRoZSBhY3RpdmUgY2FudmFzLlxuICAgICAqL1xuICAgIG9wZW5JT0NDYXJkU2VsZWN0b3IoKSB7XG4gICAgICAgIG5ldyBSZW5kZXJJT0NDYXJkc01vZGFsKFxuICAgICAgICAgICAgdGhpcy5hcHAsXG4gICAgICAgICAgICBJT0NfVFlQRVMsXG4gICAgICAgICAgICAoaW9jVHlwZUlkOiBzdHJpbmcsIG9zVHlwZT86IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlSU9DQ2FyZChpb2NUeXBlSWQsIG9zVHlwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICkub3BlbigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gSU9DIGNhcmQgb24gdGhlIGFjdGl2ZSBjYW52YXMuXG4gICAgICpcbiAgICAgKiAqKkNhcmQgQ3JlYXRpb24gRmxvdzoqKlxuICAgICAqIDEuICoqVmFsaWRhdGUgY2FudmFzIHZpZXcqKiAtIEVuc3VyZSB1c2VyIGlzIGluIGEgY2FudmFzIHZpZXcgKG5vdCBtYXJrZG93bi9yZWFkaW5nKVxuICAgICAqIDIuICoqQWNjZXNzIGludGVybmFsIGNhbnZhcyBBUEkqKiAtIEdldCBjYW52YXMgb2JqZWN0IGZyb20gKHZpZXcgYXMgYW55KS5jYW52YXNcbiAgICAgKiAzLiAqKkdlbmVyYXRlIHRpbWVzdGFtcC1iYXNlZCBjYXJkIElEKiogLSBGb3JtYXQ6ICNZWVlZTU1ERC1ISE1NIChlLmcuLCAjMjAyNjAyMTQtMTUzNClcbiAgICAgKiA0LiAqKkdlbmVyYXRlIGNhcmQgY29udGVudCoqIC0gQ2FsbCBSZW5kZXJJT0NDYXJkcy5jcmVhdGVDYXJkQ29udGVudCgpXG4gICAgICogNS4gKipDcmVhdGUgY2FudmFzIHRleHQgbm9kZSoqIC0gVXNlIGNhbnZhcy5jcmVhdGVUZXh0Tm9kZSgpIHdpdGggcmFuZG9tIHBvc2l0aW9uXG4gICAgICogNi4gKipQZXJzaXN0IHRvIGRpc2sqKiAtIENhbGwgY2FudmFzLnJlcXVlc3RTYXZlKCkgdG8gd3JpdGUgLmNhbnZhcyBmaWxlXG4gICAgICpcbiAgICAgKiAqKkNhcmQgSUQgRm9ybWF0OioqXG4gICAgICogLSBUaW1lc3RhbXAtYmFzZWQgZm9yIHVuaXF1ZW5lc3M6ICNZWVlZTU1ERC1ISE1NXG4gICAgICogLSBFeGFtcGxlOiAjMjAyNjAyMTQtMTUzNCAoRmVicnVhcnkgMTQsIDIwMjYgYXQgMzozNCBQTSlcbiAgICAgKiAtIERpc3BsYXllZCBhcyBtZXRhZGF0YSBmaWVsZCBhdCBib3R0b20gb2YgY2FyZFxuICAgICAqIC0gVXNlZCBmb3IgcmVmZXJlbmNpbmcgY2FyZHMgaW4gdmFsaWRhdGlvbiBlcnJvcnNcbiAgICAgKlxuICAgICAqICoqUmFuZG9tIFBvc2l0aW9uaW5nOioqXG4gICAgICogLSBOZXcgY2FyZHMgYXJlIHBsYWNlZCBhdCByYW5kb20gY29vcmRpbmF0ZXMgd2l0aGluIGEgNDAweDQwMCBhcmVhXG4gICAgICogLSBVc2VyIGNhbiBkcmFnIGNhcmRzIHRvIGRlc2lyZWQgcG9zaXRpb24gYWZ0ZXIgY3JlYXRpb25cbiAgICAgKiAtIFByZXZlbnRzIGNhcmRzIGZyb20gc3RhY2tpbmcgZXhhY3RseSBvbiB0b3Agb2YgZWFjaCBvdGhlclxuICAgICAqXG4gICAgICogKipPYnNpZGlhbiBDYW52YXMgQVBJOioqXG4gICAgICogLSBgY2FudmFzLmNyZWF0ZVRleHROb2RlKClgIGNyZWF0ZXMgYSBtYXJrZG93biB0ZXh0IG5vZGVcbiAgICAgKiAtIGBwb3NgOiB7eCwgeX0gY29vcmRpbmF0ZXMgb24gdGhlIGluZmluaXRlIGNhbnZhc1xuICAgICAqIC0gYHNpemVgOiB7d2lkdGgsIGhlaWdodH0gaW4gcGl4ZWxzIChkZWZhdWx0IDQwMHg0MDApXG4gICAgICogLSBgdGV4dGA6IE1hcmtkb3duIGNvbnRlbnQgKGdlbmVyYXRlZCBieSBSZW5kZXJJT0NDYXJkcylcbiAgICAgKlxuICAgICAqIEBwYXJhbSBpb2NUeXBlSWQgLSBUaGUgc25ha2VfY2FzZSBJT0MgdHlwZSBrZXkgZnJvbSBJT0NfVFlQRVMgKGUuZy4sIFwiaXBfYWRkcmVzc1wiKVxuICAgICAqIEBwYXJhbSBvc1R5cGUgLSBPcHRpb25hbCBPUyB2YXJpYW50IGZvciBob3N0bmFtZSBjYXJkcyAoXCJ3aW5kb3dzXCIsIFwibWFjb3NcIiwgXCJsaW51eFwiKVxuICAgICAqL1xuICAgIGNyZWF0ZUlPQ0NhcmQoaW9jVHlwZUlkOiBzdHJpbmcsIG9zVHlwZT86IHN0cmluZykge1xuICAgICAgICBjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoSXRlbVZpZXcpO1xuICAgICAgICBpZiAoIWFjdGl2ZVZpZXcgfHwgYWN0aXZlVmlldy5nZXRWaWV3VHlwZSgpICE9PSAnY2FudmFzJykge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnUGxlYXNlIG9wZW4gYSBjYW52YXMgZmlyc3QnKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFjY2VzcyBpbnRlcm5hbCBjYW52YXMgQVBJIChub3QgcHVibGljbHkgZG9jdW1lbnRlZCBieSBPYnNpZGlhbilcbiAgICAgICAgY29uc3QgY2FudmFzID0gKGFjdGl2ZVZpZXcgYXMgYW55KS5jYW52YXM7XG4gICAgICAgIGlmICghY2FudmFzKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdQbGVhc2Ugb3BlbiBhIGNhbnZhcyBmaXJzdCcpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgaW9jVHlwZSA9IElPQ19UWVBFU1tpb2NUeXBlSWRdO1xuICAgICAgICBpZiAoIWlvY1R5cGUpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ1Vua25vd24gSU9DIHR5cGU6ICcgKyBpb2NUeXBlSWQpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gR2VuZXJhdGUgdGltZXN0YW1wLWJhc2VkIGNhcmQgSUQgKGZvcm1hdDogI1lZWVlNTURELUhITU0pXG4gICAgICAgIC8vIEV4YW1wbGU6ICMyMDI2MDIxNC0xNTM0IGZvciBGZWJydWFyeSAxNCwgMjAyNiBhdCAzOjM0IFBNXG4gICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGNvbnN0IHllYXIgPSBub3cuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgY29uc3QgbW9udGggPSBTdHJpbmcobm93LmdldE1vbnRoKCkgKyAxKS5wYWRTdGFydCgyLCAnMCcpO1xuICAgICAgICBjb25zdCBkYXkgPSBTdHJpbmcobm93LmdldERhdGUoKSkucGFkU3RhcnQoMiwgJzAnKTtcbiAgICAgICAgY29uc3QgaG91cnMgPSBTdHJpbmcobm93LmdldEhvdXJzKCkpLnBhZFN0YXJ0KDIsICcwJyk7XG4gICAgICAgIGNvbnN0IG1pbnV0ZXMgPSBTdHJpbmcobm93LmdldE1pbnV0ZXMoKSkucGFkU3RhcnQoMiwgJzAnKTtcbiAgICAgICAgY29uc3QgY2FyZElkID0gYCMke3llYXJ9JHttb250aH0ke2RheX0tJHtob3Vyc30ke21pbnV0ZXN9YDtcblxuICAgICAgICAvLyBHZW5lcmF0ZSBtYXJrZG93biBjb250ZW50IGZvciB0aGUgSU9DIGNhcmRcbiAgICAgICAgY29uc3QgY29udGVudCA9IFJlbmRlcklPQ0NhcmRzLmNyZWF0ZUNhcmRDb250ZW50KGlvY1R5cGUsIGlvY1R5cGVJZCwgb3NUeXBlIHx8IG51bGwsIGNhcmRJZCk7XG5cbiAgICAgICAgLy8gQ3JlYXRlIHRleHQgbm9kZSBvbiBjYW52YXMgd2l0aCByYW5kb20gcG9zaXRpb25cbiAgICAgICAgY2FudmFzLmNyZWF0ZVRleHROb2RlKHtcbiAgICAgICAgICAgIHBvczogeyB4OiBNYXRoLnJhbmRvbSgpICogNDAwLCB5OiBNYXRoLnJhbmRvbSgpICogNDAwIH0sICAvLyBSYW5kb20gcGxhY2VtZW50XG4gICAgICAgICAgICBzaXplOiB7IHdpZHRoOiA0MDAsIGhlaWdodDogNDAwIH0sICAvLyBTdGFuZGFyZCBjYXJkIHNpemVcbiAgICAgICAgICAgIHRleHQ6IGNvbnRlbnQgIC8vIE1hcmtkb3duIHdpdGggSFRNTCBoZWFkZXJcbiAgICAgICAgfSk7XG4gICAgICAgIGNhbnZhcy5yZXF1ZXN0U2F2ZSgpOyAgLy8gUGVyc2lzdCB0byAuY2FudmFzIGZpbGVcblxuICAgICAgICBuZXcgTm90aWNlKGBDcmVhdGVkICR7aW9jVHlwZS5uYW1lfSBjYXJkYCk7XG4gICAgfVxuXG59XG4iLCAiLyoqXHJcbiAqIFJlbmRlclRpbWVsaW5lc01vZGFsLnRzIC0gVGltZWxpbmUgdmlzdWFsaXphdGlvbiBmb3IgSU9DIGNhcmRzLlxyXG4gKlxyXG4gKiBTaG93cyBhbGwgSU9DIGNhcmRzIHNvcnRlZCBjaHJvbm9sb2dpY2FsbHkgYnkgdGhlaXIgXCJUaW1lIG9mIEV2ZW50XCIgZmllbGQuXHJcbiAqIEVhY2ggaXRlbSBpcyBhIGNvbG9yZWQgY2FyZCB3aXRoIHRoZSBJT0MgaWNvbiwgdmFsdWUsIHRpbWVzdGFtcCwgYW5kXHJcbiAqIG9wdGlvbmFsIFNwbHVuay9NSVRSRSBtZXRhZGF0YS5cclxuICpcclxuICogQWxsIERPTSBpcyBidWlsdCB3aXRoIE9ic2lkaWFuJ3MgY3JlYXRlRWwvY3JlYXRlRGl2IEFQSTsgY29sb3JzIGFyZSBhcHBsaWVkXHJcbiAqIHZpYSBpbmxpbmUgc3R5bGVzIHVzaW5nIGVhY2ggSU9DIHR5cGUncyBjb2xvciBmcm9tIHRoZSBjYXJkIGRhdGEuXHJcbiAqL1xyXG5pbXBvcnQgeyBBcHAsIE1vZGFsIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBUaW1lVGltZWxpbmVQcm9jZXNzb3IgfSBmcm9tICcuL1RpbWVUaW1lbGluZVByb2Nlc3NpbmcnO1xyXG5pbXBvcnQgeyBJT0NOb2RlRGF0YSB9IGZyb20gJy4vSU9DUGFyc2VyJztcclxuXHJcbmV4cG9ydCBjbGFzcyBSZW5kZXJUaW1lbGluZXNNb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICAgIHByaXZhdGUgcGx1Z2luOiBhbnk7XHJcbiAgICBwcml2YXRlIHRpbWVQcm9jZXNzb3I6IFRpbWVUaW1lbGluZVByb2Nlc3NvcjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBhbnkpIHtcclxuICAgICAgICBzdXBlcihhcHApO1xyXG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gICAgICAgIHRoaXMudGltZVByb2Nlc3NvciA9IG5ldyBUaW1lVGltZWxpbmVQcm9jZXNzb3IoYXBwLCBwbHVnaW4sIHBsdWdpbi5pb2NUeXBlcyk7XHJcbiAgICB9XHJcblxyXG4gICAgb25PcGVuKCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgICAgIHRoaXMubW9kYWxFbC5jbGFzc0xpc3QuYWRkKCd0aW1lbGluZS1tb2RhbC1mdWxsc2NyZWVuJyk7XHJcblxyXG4gICAgICAgIGNvbnN0IGhlYWRlckNvbnRhaW5lciA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoJ3RpbWVsaW5lLW1vZGFsLWhlYWRlcicpO1xyXG4gICAgICAgIGhlYWRlckNvbnRhaW5lci5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdcdUQ4M0RcdURENTAgVGltZS1CYXNlZCBJT0MgVGltZWxpbmUnIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBjb250ZW50QXJlYSA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoJ3RpbWVsaW5lLXRhYi1jb250ZW50Jyk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJFbmhhbmNlZFRpbWVUaW1lbGluZShjb250ZW50QXJlYSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW5kZXJzIHRoZSBjaHJvbm9sb2dpY2FsIFRpbWUgVGltZWxpbmUuIEV4dHJhY3RzIElPQyBkYXRhIGZyb20gY2FudmFzXHJcbiAgICAgKiBub2RlcyB2aWEgdGhlIHRpbWUgcHJvY2Vzc29yLCBzb3J0cyBieSBldmVudCB0aW1lc3RhbXAsIGFuZCByZW5kZXJzIGVhY2hcclxuICAgICAqIElPQyBhcyBhIGNvbG9yZWQgY2FyZCB3aXRoIGEgZ3JhZGllbnQgY29ubmVjdG9yIHRvIHRoZSBuZXh0IGNhcmQuXHJcbiAgICAgKlxyXG4gICAgICogREVCVUc6IENvbnNvbGUgbG9ncyBzaG93IHRpbWVsaW5lIGRhdGEgZm9yIHRyb3VibGVzaG9vdGluZy5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSByZW5kZXJFbmhhbmNlZFRpbWVUaW1lbGluZShjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICAgICAgY29uc29sZS5kZWJ1ZygnW1RpbWVUaW1lbGluZV0gU3RhcnRpbmcgcmVuZGVyJyk7XHJcblxyXG4gICAgICAgIC8vIEV4dHJhY3QgSU9DIGRhdGEgZnJvbSBjYW52YXMgbm9kZXNcclxuICAgICAgICBjb25zdCBpb2NEYXRhID0gdGhpcy50aW1lUHJvY2Vzc29yLmV4dHJhY3RGaXhlZElPQ0RhdGEoKTtcclxuICAgICAgICBjb25zb2xlLmRlYnVnKCdbVGltZVRpbWVsaW5lXSBFeHRyYWN0ZWQnLCBpb2NEYXRhLmxlbmd0aCwgJ0lPQyBjYXJkcycpO1xyXG5cclxuICAgICAgICAvLyBDaGVjayBpZiB3ZSBoYXZlIGFueSBJT0MgY2FyZHNcclxuICAgICAgICBpZiAoaW9jRGF0YS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgY29udGFpbmVyLmNyZWF0ZUVsKCdwJywge1xyXG4gICAgICAgICAgICAgICAgdGV4dDogJ05vIElPQyBjYXJkcyBmb3VuZCBpbiB0aGUgY3VycmVudCBjYW52YXMuIENyZWF0ZSBzb21lIElPQyBjYXJkcyBmaXJzdCB0byBzZWUgdGhlIHRpbWVsaW5lLicsXHJcbiAgICAgICAgICAgICAgICBjbHM6ICd0aW1lbGluZS1lbXB0eS1tZXNzYWdlJ1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gU29ydCBhc2NlbmRpbmcgYnkgZXZlbnQgdGltZSBzbyB0aGUgZWFybGllc3QgSU9DIGFwcGVhcnMgZmlyc3RcclxuICAgICAgICBpb2NEYXRhLnNvcnQoKGEsIGIpID0+IG5ldyBEYXRlKGEudGltZSkuZ2V0VGltZSgpIC0gbmV3IERhdGUoYi50aW1lKS5nZXRUaW1lKCkpO1xyXG5cclxuICAgICAgICBjb25zdCB0aW1lbGluZUNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoJ3RpbWVsaW5lLWNvbnRhaW5lcicpO1xyXG5cclxuICAgICAgICBpb2NEYXRhLmZvckVhY2goKGlvYywgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdGltZWxpbmVJdGVtID0gdGltZWxpbmVDb250YWluZXIuY3JlYXRlRGl2KCd0aW1lbGluZS1pdGVtJyk7XHJcblxyXG4gICAgICAgICAgICAvLyBBcHBseSB0aGUgSU9DJ3MgY29sb3IgdG8gYmFja2dyb3VuZCBncmFkaWVudCBhbmQgc2hhZG93IGZvciB2aXN1YWwgZ3JvdXBpbmdcclxuICAgICAgICAgICAgdGltZWxpbmVJdGVtLnN0eWxlLnNldFByb3BlcnR5KCctLWlvYy1jb2xvcicsIGlvYy5jb2xvcik7XHJcbiAgICAgICAgICAgIHRpbWVsaW5lSXRlbS5zdHlsZS5zZXRQcm9wZXJ0eSgnLS1pb2MtY29sb3ItMzAnLCBgJHtpb2MuY29sb3J9MzBgKTtcclxuICAgICAgICAgICAgdGltZWxpbmVJdGVtLnN0eWxlLmJhY2tncm91bmQgPSBgbGluZWFyLWdyYWRpZW50KDEzNWRlZywgJHtpb2MuY29sb3J9MTUgMCUsICR7aW9jLmNvbG9yfTA1IDEwMCUpYDtcclxuICAgICAgICAgICAgdGltZWxpbmVJdGVtLnN0eWxlLmJveFNoYWRvdyA9IGAwIDRweCAxMnB4ICR7aW9jLmNvbG9yfTI1YDtcclxuICAgICAgICAgICAgdGltZWxpbmVJdGVtLnN0eWxlLmJvcmRlckNvbG9yID0gaW9jLmNvbG9yO1xyXG5cclxuICAgICAgICAgICAgLy8gR3JhZGllbnQgY29ubmVjdG9yIGJldHdlZW4gdGhpcyBjYXJkIGFuZCB0aGUgbmV4dCBvbmU7IGJsZW5kcyB0aGVcclxuICAgICAgICAgICAgLy8gdHdvIElPQyBjb2xvcnMgdG8gdmlzdWFsbHkgbGluayBjb25zZWN1dGl2ZSB0aW1lbGluZSBldmVudHNcclxuICAgICAgICAgICAgaWYgKGluZGV4IDwgaW9jRGF0YS5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0b3IgPSB0aW1lbGluZUl0ZW0uY3JlYXRlRGl2KCd0aW1lbGluZS1jb25uZWN0b3InKTtcclxuICAgICAgICAgICAgICAgIGNvbm5lY3Rvci5zdHlsZS5iYWNrZ3JvdW5kID0gYGxpbmVhci1ncmFkaWVudCgxODBkZWcsICR7aW9jLmNvbG9yfSAwJSwgJHtpb2NEYXRhW2luZGV4ICsgMV0uY29sb3J9IDEwMCUpYDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3QgaWNvbkNvbnRhaW5lciA9IHRpbWVsaW5lSXRlbS5jcmVhdGVEaXYoJ3RpbWVsaW5lLWljb24nKTtcclxuICAgICAgICAgICAgaWNvbkNvbnRhaW5lci5pbm5lckhUTUwgPSBpb2MuaWNvbjtcclxuICAgICAgICAgICAgaWNvbkNvbnRhaW5lci5zdHlsZS5iYWNrZ3JvdW5kID0gYCR7aW9jLmNvbG9yfTIwYDtcclxuICAgICAgICAgICAgaWNvbkNvbnRhaW5lci5zdHlsZS5ib3JkZXJDb2xvciA9IGlvYy5jb2xvcjtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGRldGFpbHNDb250YWluZXIgPSB0aW1lbGluZUl0ZW0uY3JlYXRlRGl2KCd0aW1lbGluZS1kZXRhaWxzJyk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB0aXRsZUVsID0gZGV0YWlsc0NvbnRhaW5lci5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6IGlvYy50eXBlIH0pO1xyXG4gICAgICAgICAgICB0aXRsZUVsLnN0eWxlLnRleHRTaGFkb3cgPSBgMCAxcHggM3B4ICR7aW9jLmNvbG9yfTQwYDtcclxuXHJcbiAgICAgICAgICAgIC8vIERpc3BsYXkgdGltZSBvbiBmaXJzdCBsaW5lXHJcbiAgICAgICAgICAgIGNvbnN0IHRpbWVFbCA9IGRldGFpbHNDb250YWluZXIuY3JlYXRlRGl2KCd0aW1lbGluZS10aW1lJyk7XHJcbiAgICAgICAgICAgIHRpbWVFbC5pbm5lckhUTUwgPSBgXHVEODNEXHVERDUwIFRpbWU6ICR7aW9jLnRpbWV9YDtcclxuXHJcbiAgICAgICAgICAgIC8vIERpc3BsYXkgdmFsdWUgb24gaXRzIG93biBsaW5lIGJlbG93IGlmIGF2YWlsYWJsZVxyXG4gICAgICAgICAgICBpZiAoaW9jLnZhbHVlICYmIGlvYy52YWx1ZS50cmltKCkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlRWwgPSBkZXRhaWxzQ29udGFpbmVyLmNyZWF0ZURpdigndGltZWxpbmUtdmFsdWUnKTtcclxuICAgICAgICAgICAgICAgIHZhbHVlRWwuaW5uZXJIVE1MID0gYFx1RDgzRFx1RENDQyBWYWx1ZTogJHtpb2MudmFsdWV9YDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGlvYy5zcGx1bmtRdWVyeSAmJiBpb2Muc3BsdW5rUXVlcnkudHJpbSgpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzcGx1bmtFbCA9IGRldGFpbHNDb250YWluZXIuY3JlYXRlRGl2KCd0aW1lbGluZS1zcGx1bmsnKTtcclxuICAgICAgICAgICAgICAgIHNwbHVua0VsLmlubmVySFRNTCA9IGBcdUQ4M0RcdUREMEQgU3BsdW5rIFF1ZXJ5OiAke2lvYy5zcGx1bmtRdWVyeX1gO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoaW9jLnRhY3RpYykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdGFjdGljRWwgPSBkZXRhaWxzQ29udGFpbmVyLmNyZWF0ZURpdigndGltZWxpbmUtdGFjdGljJyk7XHJcbiAgICAgICAgICAgICAgICB0YWN0aWNFbC5pbm5lckhUTUwgPSBgXHUyNjk0XHVGRTBGIFRhY3RpYzogJHtpb2MudGFjdGljfWA7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChpb2MudGVjaG5pcXVlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ZWNobmlxdWVFbCA9IGRldGFpbHNDb250YWluZXIuY3JlYXRlRGl2KCd0aW1lbGluZS10ZWNobmlxdWUnKTtcclxuICAgICAgICAgICAgICAgIHRlY2huaXF1ZUVsLmlubmVySFRNTCA9IGBcdUQ4M0NcdURGQUYgVGVjaG5pcXVlOiAke2lvYy50ZWNobmlxdWV9YDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGltZWxpbmVJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRpbWVsaW5lSXRlbS5zdHlsZS5ib3hTaGFkb3cgPSBgMCA4cHggMjBweCAke2lvYy5jb2xvcn0zNWA7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdGltZWxpbmVJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3V0JywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGltZWxpbmVJdGVtLnN0eWxlLmJveFNoYWRvdyA9IGAwIDRweCAxMnB4ICR7aW9jLmNvbG9yfTI1YDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25DbG9zZSgpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcclxuICAgIH1cclxufVxyXG4iLCAiLyoqXHJcbiAqIElPQ0NhcmRzVHlwZXMudHMgLSBJT0MgKEluZGljYXRvciBvZiBDb21wcm9taXNlKSB0eXBlIGRlZmluaXRpb25zLlxyXG4gKlxyXG4gKiBEZWZpbmVzIHRoZSAxNiBidWlsdC1pbiBJT0MgdHlwZXMgdXNlZCBhY3Jvc3MgdGhlIHBsdWdpbjogSVAgQWRkcmVzcywgRG9tYWluLFxyXG4gKiBGaWxlIEhhc2gsIFVSTCwgRW1haWwsIEhvc3RuYW1lLCBZQVJBIFJ1bGUsIFNpZ21hIFJ1bGUsIFJlZ2lzdHJ5IEtleSxcclxuICogUHJvY2VzcyBOYW1lLCBOZXR3b3JrLCBDb21tYW5kIExpbmUsIEZpbGUsIE5vdGUsIERMTCwgYW5kIEMyLlxyXG4gKlxyXG4gKiBFYWNoIElPQyB0eXBlIGNhcnJpZXMgaXRzIG93biBkaXNwbGF5IG1ldGFkYXRhIChjb2xvciwgaW5saW5lIFNWRyBpY29uKSBhbmQgYVxyXG4gKiBsaXN0IG9mIGZvcmVuc2ljIGZpZWxkcyB0aGF0IGFuYWx5c3RzIGZpbGwgaW4gb24gdGhlIGNhbnZhcyBjYXJkLiBUaGUgdGltZWxpbmVcclxuICogcHJvY2Vzc29ycyBpZGVudGlmeSBjYXJkIHR5cGVzIGJ5IHJlZ2V4LW1hdGNoaW5nIGBJT0NGaWVsZC5uYW1lYCBhZ2FpbnN0IG5vZGVcclxuICogdGV4dCwgc28gdGhlIGBuYW1lYCB2YWx1ZSBkb3VibGVzIGFzIGEgZGlzcGxheSBsYWJlbCBhbmQgYSBkZXRlY3Rpb24ga2V5LlxyXG4gKlxyXG4gKiBTVkcgaWNvbnMgYXJlIHN0b3JlZCBhcyBpbmxpbmUgc3RyaW5ncyBoZXJlIChub3QgbG9hZGVkIGZyb20gdGhlIGljb25zL1xyXG4gKiBkaXJlY3RvcnkpIHNvIHRoZSBjYW52YXMgY2FyZHMgcmVtYWluIHNlbGYtY29udGFpbmVkIG1hcmtkb3duK0hUTUwuXHJcbiAqL1xyXG5cclxuLyoqIERlc2NyaWJlcyBhIHNpbmdsZSBJT0MgdHlwZSBhbmQgaXRzIHZpc3VhbC9zdHJ1Y3R1cmFsIG1ldGFkYXRhLiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIElPQ0ZpZWxkIHtcclxuICAgIC8qKiBIdW1hbi1yZWFkYWJsZSBuYW1lIHNob3duIG9uIHRoZSBjYXJkIGhlYWRlcjsgYWxzbyB1c2VkIGZvciByZWdleCBtYXRjaGluZyBieSB0aW1lbGluZSBwcm9jZXNzb3JzLiAqL1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgLyoqIE9ic2lkaWFuIGljb24gaWRlbnRpZmllciB1c2VkIGZvciByaWJib24vY29tbWFuZCBwYWxldHRlIGVudHJpZXMuICovXHJcbiAgICBpY29uOiBzdHJpbmc7XHJcbiAgICAvKiogSGV4IGNvbG9yIGFwcGxpZWQgdG8gdGhlIGNhcmQgaGVhZGVyIGdyYWRpZW50LCBib3JkZXIsIGFuZCB0aW1lbGluZSBoaWdobGlnaHRzLiAqL1xyXG4gICAgY29sb3I6IHN0cmluZztcclxuICAgIC8qKiBBbmFseXN0LWVkaXRhYmxlIGZpZWxkcyByZW5kZXJlZCBhcyBsYWJlbGVkIGNvZGUgYmxvY2tzIG9uIHRoZSBjYXJkLiAqL1xyXG4gICAgZmllbGRzOiBzdHJpbmdbXTtcclxuICAgIC8qKiBJbmxpbmUgU1ZHIG1hcmt1cCBmb3IgdGhlIGNhcmQgaGVhZGVyIGljb24gKDMyeDMyLCBzdHJva2UtYmFzZWQpLiAqL1xyXG4gICAgc3ZnOiBzdHJpbmc7XHJcbiAgICAvKiogT3B0aW9uYWwgT1Mtc3BlY2lmaWMgaWNvbiB2YXJpYW50cyAtLSBvbmx5IHVzZWQgYnkgdGhlIEhvc3RuYW1lIHR5cGVcclxuICAgICAqICB0byBsZXQgYW5hbHlzdHMgcGljayBhIHBsYXRmb3JtIHdoZW4gY3JlYXRpbmcgdGhlIGNhcmQuICovXHJcbiAgICBvc19pY29ucz86IHtcclxuICAgICAgd2luZG93c193b3Jrc3RhdGlvbjogc3RyaW5nO1xyXG4gICAgICB3aW5kb3dzX3NlcnZlcjogc3RyaW5nO1xyXG4gICAgICBtYWNvczogc3RyaW5nO1xyXG4gICAgICBsaW51eDogc3RyaW5nO1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKiBEaWN0aW9uYXJ5IG1hcHBpbmcgSU9DIHR5cGUga2V5cyAoc25ha2VfY2FzZSBJRHMpIHRvIHRoZWlyIGZpZWxkIGRlZmluaXRpb25zLiAqL1xyXG4gIGV4cG9ydCBpbnRlcmZhY2UgSU9DQ2FyZHNUeXBlcyB7XHJcbiAgICBba2V5OiBzdHJpbmddOiBJT0NGaWVsZDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIE1hc3RlciByZWdpc3RyeSBvZiBhbGwgSU9DIHR5cGVzLiBLZXlzIGFyZSBzdGFibGUgc25ha2VfY2FzZSBpZGVudGlmaWVyc1xyXG4gICAqIChlLmcuIFwiaXBfYWRkcmVzc1wiLCBcImZpbGVfaGFzaFwiKSB1c2VkIGFzIGludGVybmFsIHJlZmVyZW5jZXMgdGhyb3VnaG91dCB0aGVcclxuICAgKiBwbHVnaW4uIFRoaXMgb2JqZWN0IGlzIG11dGFibGUgYXQgcnVudGltZSB2aWEgSU9DQ2FyZEZhY3RvcnkgdG8gc3VwcG9ydFxyXG4gICAqIGN1c3RvbSB1c2VyLWRlZmluZWQgSU9DIHR5cGVzLlxyXG4gICAqL1xyXG4gIGV4cG9ydCBjb25zdCBJT0NfVFlQRVM6IElPQ0NhcmRzVHlwZXMgPSB7XHJcbiAgICAvLyAtLS0gTmV0d29yay1yZWxhdGVkIElPQyB0eXBlcyAtLS1cclxuXHJcbiAgICBpcF9hZGRyZXNzOiB7XHJcbiAgICAgIG5hbWU6ICdJUCBBZGRyZXNzJyxcclxuICAgICAgaWNvbjogJ25ldHdvcmsnLFxyXG4gICAgICBjb2xvcjogJyNGRjZCNkInLFxyXG4gICAgICBmaWVsZHM6IFsnSVAnLCAnY291bnRyeScsICdhc24nXSxcclxuICAgICAgc3ZnOiBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHdpZHRoPVwiMzJcIiBoZWlnaHQ9XCIzMlwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPlxyXG4gIDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTVcIiByPVwiN1wiLz5cclxuICA8cGF0aCBkPVwiTTEyIDhjLTMuOSAwLTcgMy4xLTcgN1wiLz5cclxuICA8cGF0aCBkPVwiTTEyIDhjMy45IDAgNyAzLjEgNyA3XCIvPlxyXG4gIDxsaW5lIHgxPVwiNVwiIHkxPVwiMTVcIiB4Mj1cIjE5XCIgeTI9XCIxNVwiLz5cclxuICA8bGluZSB4MT1cIjEyXCIgeTE9XCI4XCIgeDI9XCIxMlwiIHkyPVwiMjJcIi8+XHJcbiAgPHBhdGggZD1cIk0xMiA4Yy0xLjctMy0xLjctNiAwLTZzMS43IDMgMCA2elwiLz5cclxuICA8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjRcIiByPVwiMlwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XHJcbjwvc3ZnPmBcclxuICAgIH0sXHJcbiAgICBcclxuICAgIGRvbWFpbjoge1xyXG4gICAgICBuYW1lOiAnRG9tYWluIE5hbWUnLFxyXG4gICAgICBpY29uOiAnZ2xvYmUnLFxyXG4gICAgICBjb2xvcjogJyM0RUNEQzQnLFxyXG4gICAgICBmaWVsZHM6IFsnbmFtZScsICdJUCddLFxyXG4gICAgICBzdmc6IGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgd2lkdGg9XCIzMlwiIGhlaWdodD1cIjMyXCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+XHJcbiAgICA8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjEwXCIvPlxyXG4gICAgPGxpbmUgeDE9XCIyXCIgeTE9XCIxMlwiIHgyPVwiMjJcIiB5Mj1cIjEyXCIvPlxyXG4gICAgPHBhdGggZD1cIk0xMiAyYTE1LjMgMTUuMyAwIDAgMSA0IDEwIDE1LjMgMTUuMyAwIDAgMS00IDEwIDE1LjMgMTUuMyAwIDAgMS00LTEwIDE1LjMgMTUuMyAwIDAgMSA0LTEwelwiLz5cclxuICA8L3N2Zz5gXHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICBmaWxlX2hhc2g6IHtcclxuICAgICAgbmFtZTogJ0ZpbGUgSGFzaCcsXHJcbiAgICAgIGljb246ICdoYXNoJyxcclxuICAgICAgY29sb3I6ICcjNDVCN0QxJyxcclxuICAgICAgZmllbGRzOiBbJ2hhc2gnLCAnaGFzaF90eXBlJywgJ2ZpbGVuYW1lJywgJ2ZpbGVfc2l6ZSddLFxyXG4gICAgICBzdmc6IGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgd2lkdGg9XCIzMlwiIGhlaWdodD1cIjMyXCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+XHJcbiAgICA8bGluZSB4MT1cIjRcIiB5MT1cIjlcIiB4Mj1cIjIwXCIgeTI9XCI5XCIvPlxyXG4gICAgPGxpbmUgeDE9XCI0XCIgeTE9XCIxNVwiIHgyPVwiMjBcIiB5Mj1cIjE1XCIvPlxyXG4gICAgPGxpbmUgeDE9XCIxMFwiIHkxPVwiM1wiIHgyPVwiOFwiIHkyPVwiMjFcIi8+XHJcbiAgICA8bGluZSB4MT1cIjE2XCIgeTE9XCIzXCIgeDI9XCIxNFwiIHkyPVwiMjFcIi8+XHJcbiAgPC9zdmc+YFxyXG4gICAgfSxcclxuICAgIFxyXG4gICAgdXJsOiB7XHJcbiAgICAgIG5hbWU6ICdVUkwnLFxyXG4gICAgICBpY29uOiAnbGluaycsXHJcbiAgICAgIGNvbG9yOiAnIzk2Q0VCNCcsXHJcbiAgICAgIGZpZWxkczogWyd1cmwnLCAnZG9tYWluJywgJ2NhdGVnb3J5J10sXHJcbiAgICAgIHN2ZzogYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiB3aWR0aD1cIjMyXCIgaGVpZ2h0PVwiMzJcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj5cclxuICAgIDxwYXRoIGQ9XCJNMTAgMTNhNSA1IDAgMCAwIDcuNTQuNTRsMy0zYTUgNSAwIDAgMC03LjA3LTcuMDdsLTEuNzIgMS43MVwiLz5cclxuICAgIDxwYXRoIGQ9XCJNMTQgMTFhNSA1IDAgMCAwLTcuNTQtLjU0bC0zIDNhNSA1IDAgMCAwIDcuMDcgNy4wN2wxLjcxLTEuNzFcIi8+XHJcbiAgPC9zdmc+YFxyXG4gICAgfSxcclxuICAgIFxyXG4gICAgZW1haWw6IHtcclxuICAgICAgbmFtZTogJ0VtYWlsIEFkZHJlc3MnLFxyXG4gICAgICBpY29uOiAnbWFpbCcsXHJcbiAgICAgIGNvbG9yOiAnI0ZFQ0E1NycsXHJcbiAgICAgIGZpZWxkczogWydlbWFpbCcsICdkb21haW4nXSxcclxuICAgICAgc3ZnOiBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHdpZHRoPVwiMzJcIiBoZWlnaHQ9XCIzMlwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPlxyXG4gICAgPHBhdGggZD1cIk00IDRoMTZjMS4xIDAgMiAuOSAyIDJ2MTJjMCAxLjEtLjkgMi0yIDJINGMtMS4xIDAtMi0uOS0yLTJWNmMwLTEuMS45LTIgMi0yelwiLz5cclxuICAgIDxwb2x5bGluZSBwb2ludHM9XCIyMiw2IDEyLDEzIDIsNlwiLz5cclxuICA8L3N2Zz5gXHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICAvLyBIb3N0bmFtZSBpcyB0aGUgb25seSBJT0MgdHlwZSB3aXRoIG9zX2ljb25zLCB0cmlnZ2VyaW5nIGEgc2Vjb25kYXJ5XHJcbiAgICAvLyBPUyBzZWxlY3RvciBzdWItdmlldyBpbiBSZW5kZXJJT0NDYXJkc01vZGFsIGJlZm9yZSBjYXJkIGNyZWF0aW9uLlxyXG4gICAgaG9zdG5hbWU6IHtcclxuICAgICAgbmFtZTogJ0hvc3RuYW1lJyxcclxuICAgICAgaWNvbjogJ21vbml0b3InLFxyXG4gICAgICBjb2xvcjogJyM5QzI3QjAnLFxyXG4gICAgICBmaWVsZHM6IFsnaG9zdG5hbWUnLCAnb3NfdHlwZScsICdkb21haW4nXSxcclxuICAgICAgc3ZnOiBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHdpZHRoPVwiMzJcIiBoZWlnaHQ9XCIzMlwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPlxyXG4gICAgPHJlY3QgeD1cIjJcIiB5PVwiM1wiIHdpZHRoPVwiMjBcIiBoZWlnaHQ9XCIxNFwiIHJ4PVwiMlwiIHJ5PVwiMlwiLz5cclxuICAgIDxsaW5lIHgxPVwiOFwiIHkxPVwiMjFcIiB4Mj1cIjE2XCIgeTI9XCIyMVwiLz5cclxuICAgIDxsaW5lIHgxPVwiMTJcIiB5MT1cIjE3XCIgeDI9XCIxMlwiIHkyPVwiMjFcIi8+XHJcbiAgPC9zdmc+YCxcclxuICAgICAgb3NfaWNvbnM6IHtcclxuICAgICAgICB3aW5kb3dzX3dvcmtzdGF0aW9uOiBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHdpZHRoPVwiMzJcIiBoZWlnaHQ9XCIzMlwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIj5cclxuICAgIDxwYXRoIGQ9XCJNMCAzLjVMMTAgMnY5LjVIMFYzLjV6TTExIDEuOWwxMy0xLjl2MTFIMTFWMS45ek0wIDEyLjVoMTBWMjJsLTEwLTEuNXYtOHpNMTEgMTJoMTN2MTBsLTEzIDJ2LTEyelwiLz5cclxuICA8L3N2Zz5gLFxyXG4gICAgICAgIHdpbmRvd3Nfc2VydmVyOiBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHdpZHRoPVwiMzJcIiBoZWlnaHQ9XCIzMlwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIj5cclxuICAgIDxwYXRoIGQ9XCJNMCAzLjVMMTAgMnY5LjVIMFYzLjV6TTExIDEuOWwxMy0xLjl2MTFIMTFWMS45ek0wIDEyLjVoMTBWMjJsLTEwLTEuNXYtOHpNMTEgMTJoMTN2MTBsLTEzIDJ2LTEyelwiLz5cclxuICA8L3N2Zz5gLFxyXG4gICAgICAgIG1hY29zOiBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHdpZHRoPVwiMzJcIiBoZWlnaHQ9XCIzMlwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIj5cclxuICAgIDxwYXRoIGQ9XCJNMTcuMDUgMjAuMjhjLS45OC45NS0yLjA1LjgtMy4wOC4zNS0xLjA5LS40Ni0yLjA5LS40OC0zLjI0IDAtMS40NC42Mi0yLjIuNDQtMy4wNi0uMzVDMi43OSAxNS4yNSAzLjUxIDcuNTkgOS4wNSA3LjMxYzEuMzUuMDcgMi4yOS43NCAzLjA4LjggMS4xOC0uMjQgMi4zMS0uOTMgMy41Ny0uODQgMS41MS4xMiAyLjY1LjcyIDMuNCAxLjgtMy4xMiAxLjg3LTIuMzggNS45OC40OCA3LjEzLS41NyAxLjUtMS4zMSAyLjk5LTIuNTQgNC4wOWwuMDEtLjAxek0xMi4wMyA3LjI1Yy0uMTUtMi4yMyAxLjY2LTQuMDcgMy43NC00LjI1LjI5IDIuNTgtMi4zNCA0LjUtMy43NCA0LjI1elwiLz5cclxuICA8L3N2Zz5gLFxyXG4gICAgICAgIGxpbnV4OiBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHdpZHRoPVwiMzJcIiBoZWlnaHQ9XCIzMlwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIj5cclxuICAgIDxwYXRoIGQ9XCJNMTIuNTA0IDBjLS4xNTUgMC0uMzE1LjAwOC0uNDguMDIxLTQuMjI2LjMzMy0zLjEwNSA0LjgwNy0zLjE3IDYuMjk4LS4wNzYgMS4wOTItLjMgMS45NTMtMS4wNSAzLjAyLS44ODUgMS4wNTEtMi4xMjcgMi43NS0yLjcxNiA0LjUyMS0uMjc4Ljg0LS40MSAxLjY4NC0uMjg3IDIuNDg5Ljg0NSA1LjU0OCA1LjY3NiA2LjAxNiA2Ljg1NSA2LjAxNi4xNzggMCAuMjg3LS4wMTYuMjg3LS4wMTZzOC4wMjktLjE5MiA4LjAzLTguMDQ3YzAtNC42NjItMy45MTYtOS42OS03LjQ3LTE0LjMwMnpcIi8+XHJcbiAgPC9zdmc+YFxyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICAvLyAtLS0gRGV0ZWN0aW9uIHJ1bGUgdHlwZXMgLS0tXHJcblxyXG4gICAgeWFyYV9ydWxlOiB7XHJcbiAgICAgIG5hbWU6ICdZQVJBIFJ1bGUnLFxyXG4gICAgICBpY29uOiAnc2hpZWxkJyxcclxuICAgICAgY29sb3I6ICcjRkY5RkYzJyxcclxuICAgICAgZmllbGRzOiBbJ3J1bGVfbmFtZScsICdydWxlX2NvbnRlbnQnXSxcclxuICAgICAgc3ZnOiBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHdpZHRoPVwiMzJcIiBoZWlnaHQ9XCIzMlwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPlxyXG4gICAgPHBhdGggZD1cIk0xMiAyMnM4LTQgOC0xMFY1bC04LTMtOCAzdjdjMCA2IDggMTAgOCAxMHpcIi8+XHJcbiAgICA8dGV4dCB4PVwiMTJcIiB5PVwiMTVcIiBmb250LXNpemU9XCIxMFwiIHRleHQtYW5jaG9yPVwibWlkZGxlXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiIGZvbnQtd2VpZ2h0PVwiYm9sZFwiPlk8L3RleHQ+XHJcbiAgPC9zdmc+YFxyXG4gICAgfSxcclxuICAgIFxyXG4gICAgc2lnbWFfcnVsZToge1xyXG4gICAgICBuYW1lOiAnU2lnbWEgUnVsZScsXHJcbiAgICAgIGljb246ICdzZWFyY2gnLFxyXG4gICAgICBjb2xvcjogJyNBOEU2Q0YnLFxyXG4gICAgICBmaWVsZHM6IFsncnVsZV9uYW1lJywgJ3J1bGVfY29udGVudCddLFxyXG4gICAgICBzdmc6IGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgd2lkdGg9XCIzMlwiIGhlaWdodD1cIjMyXCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+XHJcbiAgICA8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjEwXCIvPlxyXG4gICAgPHRleHQgeD1cIjEyXCIgeT1cIjE3XCIgZm9udC1zaXplPVwiMTRcIiB0ZXh0LWFuY2hvcj1cIm1pZGRsZVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIiBmb250LXdlaWdodD1cImJvbGRcIj5cdTAzQTM8L3RleHQ+XHJcbiAgPC9zdmc+YFxyXG4gICAgfSxcclxuICAgIFxyXG4gICAgLy8gLS0tIEhvc3QtYmFzZWQgSU9DIHR5cGVzIC0tLVxyXG5cclxuICAgIHJlZ2lzdHJ5X2tleToge1xyXG4gICAgICBuYW1lOiAnUmVnaXN0cnkgS2V5JyxcclxuICAgICAgaWNvbjogJ3NldHRpbmdzJyxcclxuICAgICAgY29sb3I6ICcjRkZCNzREJyxcclxuICAgICAgZmllbGRzOiBbJ2tleV9wYXRoJywgJ2tleV9uYW1lJywgJ2tleV9kYXRhJ10sXHJcbiAgICAgIHN2ZzogYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiB3aWR0aD1cIjMyXCIgaGVpZ2h0PVwiMzJcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj5cclxuICAgIDxyZWN0IHg9XCIzXCIgeT1cIjExXCIgd2lkdGg9XCIxOFwiIGhlaWdodD1cIjExXCIgcng9XCIyXCIgcnk9XCIyXCIvPlxyXG4gICAgPHBhdGggZD1cIk03IDExVjdhNSA1IDAgMCAxIDkuOS0xXCIvPlxyXG4gIDwvc3ZnPmBcclxuICAgIH0sXHJcbiAgICBcclxuICAgIHByb2Nlc3NfbmFtZToge1xyXG4gICAgICBuYW1lOiAnUHJvY2VzcyBOYW1lJyxcclxuICAgICAgaWNvbjogJ2NwdScsXHJcbiAgICAgIGNvbG9yOiAnIzgxQzc4NCcsXHJcbiAgICAgIGZpZWxkczogWydwcm9jZXNzX25hbWUnLCAnY29tbWFuZF9saW5lJywgJ3BpZCcsICdwYXJlbnRfcHJvY2VzcyddLFxyXG4gICAgICBzdmc6IGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgd2lkdGg9XCIzMlwiIGhlaWdodD1cIjMyXCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+XHJcbiAgPHJlY3QgeD1cIjNcIiB5PVwiNVwiIHdpZHRoPVwiMThcIiBoZWlnaHQ9XCIxNFwiIHJ4PVwiMlwiIHJ5PVwiMlwiLz5cclxuICA8bGluZSB4MT1cIjNcIiB5MT1cIjlcIiB4Mj1cIjIxXCIgeTI9XCI5XCIvPlxyXG4gIDxjaXJjbGUgY3g9XCI2XCIgY3k9XCI3XCIgcj1cIjAuOFwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XHJcbiAgPGNpcmNsZSBjeD1cIjlcIiBjeT1cIjdcIiByPVwiMC44XCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cclxuICA8bGluZSB4MT1cIjdcIiB5MT1cIjEzXCIgeDI9XCIxN1wiIHkyPVwiMTNcIi8+XHJcbiAgPGxpbmUgeDE9XCI3XCIgeTE9XCIxNlwiIHgyPVwiMTRcIiB5Mj1cIjE2XCIvPlxyXG48L3N2Zz5gXHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICBuZXR3b3JrOiB7XHJcbiAgICAgIG5hbWU6ICdOZXR3b3JrJyxcclxuICAgICAgaWNvbjogJ2FjdGl2aXR5JyxcclxuICAgICAgY29sb3I6ICcjOTU3NUNEJyxcclxuICAgICAgZmllbGRzOiBbJ3Byb3RvY29sJywgJ3BvcnQnLCAnZGlyZWN0aW9uJ10sXHJcbiAgICAgIHN2ZzogYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiB3aWR0aD1cIjMyXCIgaGVpZ2h0PVwiMzJcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj5cclxuICAgIDxwb2x5bGluZSBwb2ludHM9XCIyMiAxMiAxOCAxMiAxNSAyMSA5IDMgNiAxMiAyIDEyXCIvPlxyXG4gIDwvc3ZnPmBcclxuICAgIH0sXHJcbiAgICBcclxuICAgIGNvbW1hbmRfbGluZToge1xyXG4gICAgICBuYW1lOiAnQ29tbWFuZCBMaW5lJyxcclxuICAgICAgaWNvbjogJ3Rlcm1pbmFsJyxcclxuICAgICAgY29sb3I6ICcjMkU4QjU3JyxcclxuICAgICAgZmllbGRzOiBbJ2NvbW1hbmQnLCAncGlkJywgJ3BhcmVudF9wcm9jZXNzJ10sXHJcbiAgICAgIHN2ZzogYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiB3aWR0aD1cIjMyXCIgaGVpZ2h0PVwiMzJcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj5cclxuICAgIDxwb2x5bGluZSBwb2ludHM9XCI0IDE3IDEwIDExIDQgNVwiLz5cclxuICAgIDxsaW5lIHgxPVwiMTJcIiB5MT1cIjE5XCIgeDI9XCIyMFwiIHkyPVwiMTlcIi8+XHJcbiAgPC9zdmc+YFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyAtLS0gRmlsZSBhbmQgYXJ0aWZhY3QgdHlwZXMgLS0tXHJcblxyXG4gICAgZmlsZToge1xyXG4gICAgICBuYW1lOiAnRmlsZScsXHJcbiAgICAgIGljb246ICdmaWxlJyxcclxuICAgICAgY29sb3I6ICcjRTkxRTYzJyxcclxuICAgICAgZmllbGRzOiBbJ25hbWUnLCAndHlwZScsICdwYXRoJywgJ3NpemUnLCAnaGFzaCcsICdwaWQnXSxcclxuICAgICAgc3ZnOiBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHdpZHRoPVwiMzJcIiBoZWlnaHQ9XCIzMlwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPlxyXG4gIDxwYXRoIGQ9XCJNNCA0aDEybDQgNHYxMmEyIDIgMCAwIDEtMiAySDRhMiAyIDAgMCAxLTItMlY2YTIgMiAwIDAgMSAyLTJ6XCIvPlxyXG4gIDxsaW5lIHgxPVwiOFwiIHkxPVwiMTFcIiB4Mj1cIjE2XCIgeTI9XCIxMVwiLz5cclxuICA8bGluZSB4MT1cIjhcIiB5MT1cIjE1XCIgeDI9XCIxNlwiIHkyPVwiMTVcIi8+XHJcbjwvc3ZnPmBcclxuICAgIH0sXHJcblxyXG4gICAgLy8gLS0tIFV0aWxpdHkgdHlwZXMgLS0tXHJcblxyXG4gICAgbm90ZToge1xyXG4gICAgICBuYW1lOiAnTm90ZScsXHJcbiAgICAgIGljb246ICdub3RlJyxcclxuICAgICAgY29sb3I6ICcjRjM5QzEyJyxcclxuICAgICAgZmllbGRzOiBbJ05CJ10sXHJcbiAgICAgIHN2ZzogYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiB3aWR0aD1cIjMyXCIgaGVpZ2h0PVwiMzJcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj5cclxuICA8cmVjdCB4PVwiNFwiIHk9XCI0XCIgd2lkdGg9XCIxNlwiIGhlaWdodD1cIjE2XCIgcng9XCIyXCIgcnk9XCIyXCIvPlxyXG4gIDxsaW5lIHgxPVwiOFwiIHkxPVwiOFwiIHgyPVwiMTZcIiB5Mj1cIjhcIi8+XHJcbiAgPGxpbmUgeDE9XCI4XCIgeTE9XCIxMlwiIHgyPVwiMTZcIiB5Mj1cIjEyXCIvPlxyXG4gIDxsaW5lIHgxPVwiOFwiIHkxPVwiMTZcIiB4Mj1cIjE0XCIgeTI9XCIxNlwiLz5cclxuPC9zdmc+YFxyXG4gICAgfSxcclxuXHJcbiAgICBkbGw6IHtcclxuICAgICAgbmFtZTogJ0RMTCcsXHJcbiAgICAgIGljb246ICdkbGwnLFxyXG4gICAgICBjb2xvcjogJyMzNDk4REInLFxyXG4gICAgICBmaWVsZHM6IFsnbmFtZScsICd0eXBlJywgJ3BhdGgnLCAnc2l6ZScsICdoYXNoJ10sXHJcbiAgICAgIHN2ZzogYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiB3aWR0aD1cIjMyXCIgaGVpZ2h0PVwiMzJcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj5cclxuICA8cGF0aCBkPVwiTTE0IDJINmEyIDIgMCAwIDAtMiAydjE2YTIgMiAwIDAgMCAyIDJoMTJhMiAyIDAgMCAwIDItMlY4bC02LTZ6XCIvPlxyXG4gIDxwb2x5bGluZSBwb2ludHM9XCIxNCAyIDE0IDggMjAgOFwiLz5cclxuICA8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEzXCIgcj1cIjJcIi8+XHJcbiAgPHBhdGggZD1cIk0xMiAxMC41di0xXCIvPlxyXG4gIDxwYXRoIGQ9XCJNMTIgMTUuNXYxXCIvPlxyXG4gIDxwYXRoIGQ9XCJNMTQuNSAxMS41bDAuNy0wLjdcIi8+XHJcbiAgPHBhdGggZD1cIk05LjggMTYuMmwtMC43IDAuN1wiLz5cclxuICA8cGF0aCBkPVwiTTE1LjUgMTNoMVwiLz5cclxuICA8cGF0aCBkPVwiTTguNSAxM2gtMVwiLz5cclxuICA8cGF0aCBkPVwiTTE0LjUgMTQuNWwwLjcgMC43XCIvPlxyXG4gIDxwYXRoIGQ9XCJNOS44IDkuOGwtMC43LTAuN1wiLz5cclxuPC9zdmc+YFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyAtLS0gVGhyZWF0IGluZnJhc3RydWN0dXJlIC0tLVxyXG5cclxuICAgIGMyOiB7XHJcbiAgICAgIG5hbWU6ICdDMicsXHJcbiAgICAgIGljb246ICdjMicsXHJcbiAgICAgIGNvbG9yOiAnI0U3NEMzQycsXHJcbiAgICAgIGZpZWxkczogWydkb21haW4nLCAnSVAnXSxcclxuICAgICAgc3ZnOiBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHdpZHRoPVwiMzJcIiBoZWlnaHQ9XCIzMlwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPlxyXG4gIDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiOVwiLz5cclxuICA8cGF0aCBkPVwiTTEyIDN2MS41XCIvPlxyXG4gIDxwYXRoIGQ9XCJNMTIgMTkuNVYyMVwiLz5cclxuICA8cGF0aCBkPVwiTTMgMTJoMS41XCIvPlxyXG4gIDxwYXRoIGQ9XCJNMTkuNSAxMkgyMVwiLz5cclxuICA8cGF0aCBkPVwiTTUuNiA1LjZsMS4xIDEuMVwiLz5cclxuICA8cGF0aCBkPVwiTTE3LjMgMTcuM2wxLjEgMS4xXCIvPlxyXG4gIDxwYXRoIGQ9XCJNNS42IDE4LjRsMS4xLTEuMVwiLz5cclxuICA8cGF0aCBkPVwiTTE3LjMgNi43bDEuMS0xLjFcIi8+XHJcbiAgPHBvbHlsaW5lIHBvaW50cz1cIjggMTAgMTEgMTMgOCAxNlwiLz5cclxuICA8bGluZSB4MT1cIjEzXCIgeTE9XCIxNlwiIHgyPVwiMTZcIiB5Mj1cIjE2XCIvPlxyXG48L3N2Zz5gXHJcbiAgICB9XHJcbiAgfTtcclxuICAiLCAiLyoqXHJcbiAqIElPQ1BhcnNlci50cyAtIFNoYXJlZCBJT0Mgbm9kZSBwYXJzaW5nIGxvZ2ljXHJcbiAqXHJcbiAqIFRoaXMgbW9kdWxlIGV4dHJhY3RzIHRoZSBjb21tb24gcGFyc2luZyBjb2RlIHRoYXQgd2FzIGR1cGxpY2F0ZWQgaW4gYm90aFxyXG4gKiBUaW1lVGltZWxpbmVQcm9jZXNzaW5nLnRzIGFuZCBMaW5rVGltZWxpbmVQcm9jZXNzaW5nLnRzLiBJdCBwcm92aWRlcyBhXHJcbiAqIHNpbmdsZSBgcGFyc2VJT0NOb2RlYCBmdW5jdGlvbiB0aGF0IGRldGVjdHMgSU9DIHR5cGUsIGV4dHJhY3RzIGZpZWxkXHJcbiAqIHZhbHVlcywgYW5kIGxvb2tzIHVwIGljb24vY29sb3IgZnJvbSB0aGUgSU9DX1RZUEVTIGNvbnN0YW50LlxyXG4gKlxyXG4gKiBUaGUgcGFyc2VyIHdvcmtzIG9uIHRoZSByYXcgbWFya2Rvd24gdGV4dCBjb250ZW50IHN0b3JlZCBpbnNpZGUgT2JzaWRpYW5cclxuICogY2FudmFzIHRleHQgbm9kZXMuIElPQyBjYXJkcyBhcmUgZ2VuZXJhdGVkIGJ5IFJlbmRlcklPQ0NhcmRzLnRzIHdoaWNoXHJcbiAqIHByb2R1Y2VzIG1hcmtkb3duIHdpdGggYW4gSFRNTCBoZWFkZXIgKGNvbnRhaW5pbmcgdGhlIElPQyB0eXBlIG5hbWUgYW5kXHJcbiAqIGlubGluZSBTVkcpIGZvbGxvd2VkIGJ5IGZpZWxkIHZhbHVlcyBpbiBjb2RlIGJsb2NrcyBhbmQgbWV0YWRhdGEgZmllbGRzXHJcbiAqIGZvcm1hdHRlZCBhcyAqKkxhYmVsOioqIHZhbHVlLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IElPQ19UWVBFUyB9IGZyb20gJy4vSU9DQ2FyZHNUeXBlcyc7XHJcblxyXG4vKipcclxuICogU3RydWN0dXJlZCBkYXRhIGV4dHJhY3RlZCBmcm9tIGEgc2luZ2xlIElPQyBjYW52YXMgbm9kZS5cclxuICogUmV0dXJuZWQgYnkgYHBhcnNlSU9DTm9kZWAgd2hlbiB0aGUgbm9kZSB0ZXh0IG1hdGNoZXMgYSBrbm93biBJT0MgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgSU9DTm9kZURhdGEge1xyXG4gICAgLyoqIENhbnZhcyBub2RlIElEICovXHJcbiAgICBpZDogc3RyaW5nO1xyXG4gICAgLyoqIFRpbWVzdGFtcC1iYXNlZCBjYXJkIElEIChlLmcuIFwiIzIwMjYwMjE0LTE1MzRcIikgKi9cclxuICAgIGNhcmRJZD86IHN0cmluZztcclxuICAgIC8qKiBJT0MgdHlwZSBuYW1lIChlLmcuIFwiSVAgQWRkcmVzc1wiLCBcIkZpbGUgSGFzaFwiKSAqL1xyXG4gICAgdHlwZTogc3RyaW5nO1xyXG4gICAgLyoqIFByaW1hcnkgdmFsdWUgZXh0cmFjdGVkIGZyb20gdGhlIGZpcnN0IGNvZGUgYmxvY2sgKi9cclxuICAgIHZhbHVlOiBzdHJpbmc7XHJcbiAgICAvKiogVGltZSBvZiBFdmVudCB0aW1lc3RhbXAgc3RyaW5nICovXHJcbiAgICB0aW1lOiBzdHJpbmc7XHJcbiAgICAvKiogU3BsdW5rIHF1ZXJ5IHN0cmluZyAqL1xyXG4gICAgc3BsdW5rUXVlcnk6IHN0cmluZztcclxuICAgIC8qKiBNSVRSRSBBVFQmQ0sgdGFjdGljICovXHJcbiAgICB0YWN0aWM6IHN0cmluZztcclxuICAgIC8qKiBNSVRSRSBBVFQmQ0sgdGVjaG5pcXVlICovXHJcbiAgICB0ZWNobmlxdWU6IHN0cmluZztcclxuICAgIC8qKiBJbmxpbmUgU1ZHIHN0cmluZyBmb3IgdGhlIElPQyB0eXBlIGljb24gKi9cclxuICAgIGljb246IHN0cmluZztcclxuICAgIC8qKiBIZXggY29sb3Igc3RyaW5nIGZvciB0aGUgSU9DIHR5cGUgKi9cclxuICAgIGNvbG9yOiBzdHJpbmc7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJT0MgdHlwZSBkZXRlY3Rpb24gcGF0dGVybnMuXHJcbiAqXHJcbiAqIE9SREVSIE1BVFRFUlM6IE1vcmUgc3BlY2lmaWMgcGF0dGVybnMgbXVzdCBjb21lIGJlZm9yZSBsZXNzIHNwZWNpZmljIG9uZXMuXHJcbiAqIEZvciBleGFtcGxlOlxyXG4gKiAgIC0gXCJGaWxlIEhhc2hcIiBtdXN0IGFwcGVhciBiZWZvcmUgXCJGaWxlXCIgdG8gYXZvaWQgXCJGaWxlXCIgbWF0Y2hpbmcgZmlyc3RcclxuICogICAtIFwiRG9tYWluIE5hbWVcIiBtdXN0IGFwcGVhciBiZWZvcmUgZ2VuZXJpYyBwYXR0ZXJuc1xyXG4gKiAgIC0gXCJJUCBBZGRyZXNzXCIgYW5kIFwiRW1haWwgQWRkcmVzc1wiIG11c3QgYXBwZWFyIGJlZm9yZSBnZW5lcmljIHdvcmRzXHJcbiAqICAgLSBcIk5ldHdvcmtcIiBtYXRjaGVzIHRoZSBJT0NfVFlQRVMgY29uc3RhbnQga2V5IG5hbWUgKG5vdCBcIk5ldHdvcmsgVHJhZmZpY1wiKVxyXG4gKiAgIC0gXCJDb21tYW5kIExpbmVcIiBtdXN0IGFwcGVhciBiZWZvcmUgc2hvcnQgZ2VuZXJpYyBwYXR0ZXJuc1xyXG4gKlxyXG4gKiBFYWNoIHBhdHRlcm4gdXNlcyBjYXNlLWluc2Vuc2l0aXZlIG1hdGNoaW5nIGFnYWluc3QgdGhlIGZ1bGwgbm9kZSB0ZXh0LlxyXG4gKi9cclxuY29uc3QgSU9DX1RZUEVfUEFUVEVSTlM6IHsgcGF0dGVybjogUmVnRXhwOyB0eXBlOiBzdHJpbmcgfVtdID0gW1xyXG4gICAgeyBwYXR0ZXJuOiAvSVAgQWRkcmVzcy9pLCB0eXBlOiBcIklQIEFkZHJlc3NcIiB9LFxyXG4gICAgeyBwYXR0ZXJuOiAvRG9tYWluIE5hbWUvaSwgdHlwZTogXCJEb21haW4gTmFtZVwiIH0sXHJcbiAgICB7IHBhdHRlcm46IC9GaWxlIEhhc2gvaSwgdHlwZTogXCJGaWxlIEhhc2hcIiB9LFxyXG4gICAgeyBwYXR0ZXJuOiAvVVJML2ksIHR5cGU6IFwiVVJMXCIgfSxcclxuICAgIHsgcGF0dGVybjogL0VtYWlsIEFkZHJlc3MvaSwgdHlwZTogXCJFbWFpbCBBZGRyZXNzXCIgfSxcclxuICAgIHsgcGF0dGVybjogL0hvc3RuYW1lL2ksIHR5cGU6IFwiSG9zdG5hbWVcIiB9LFxyXG4gICAgeyBwYXR0ZXJuOiAvWUFSQSBSdWxlL2ksIHR5cGU6IFwiWUFSQSBSdWxlXCIgfSxcclxuICAgIHsgcGF0dGVybjogL1NpZ21hIFJ1bGUvaSwgdHlwZTogXCJTaWdtYSBSdWxlXCIgfSxcclxuICAgIHsgcGF0dGVybjogL1JlZ2lzdHJ5IEtleS9pLCB0eXBlOiBcIlJlZ2lzdHJ5IEtleVwiIH0sXHJcbiAgICB7IHBhdHRlcm46IC9Qcm9jZXNzIE5hbWUvaSwgdHlwZTogXCJQcm9jZXNzIE5hbWVcIiB9LFxyXG4gICAgLy8gRklYOiBUaGUgSU9DX1RZUEVTIGNvbnN0YW50IHVzZXMgXCJOZXR3b3JrXCIgKG5vdCBcIk5ldHdvcmsgVHJhZmZpY1wiKS5cclxuICAgIC8vIFRoZSBvbGQgY29kZSB1c2VkIFwiTmV0d29yayBUcmFmZmljXCIgd2hpY2ggd291bGQgbmV2ZXIgbWF0Y2ggdGhlXHJcbiAgICAvLyBJT0NfVFlQRVMgbG9va3VwLCBzbyBjb2xvciBhbmQgaWNvbiB3ZXJlIG5ldmVyIHJlc29sdmVkIGZvciB0aGlzIHR5cGUuXHJcbiAgICB7IHBhdHRlcm46IC9OZXR3b3JrL2ksIHR5cGU6IFwiTmV0d29ya1wiIH0sXHJcbiAgICB7IHBhdHRlcm46IC9Db21tYW5kIExpbmUvaSwgdHlwZTogXCJDb21tYW5kIExpbmVcIiB9LFxyXG4gICAgeyBwYXR0ZXJuOiAvRmlsZS9pLCB0eXBlOiBcIkZpbGVcIiB9LFxyXG4gICAgeyBwYXR0ZXJuOiAvTm90ZS9pLCB0eXBlOiBcIk5vdGVcIiB9LFxyXG4gICAgeyBwYXR0ZXJuOiAvRExML2ksIHR5cGU6IFwiRExMXCIgfSxcclxuICAgIHsgcGF0dGVybjogL0MyL2ksIHR5cGU6IFwiQzJcIiB9XHJcbl07XHJcblxyXG4vKipcclxuICogRGV0ZWN0IHRoZSBJT0MgdHlwZSBmcm9tIG5vZGUgdGV4dCBjb250ZW50LlxyXG4gKlxyXG4gKiBJdGVyYXRlcyB0aHJvdWdoIElPQ19UWVBFX1BBVFRFUk5TIGluIG9yZGVyLCByZXR1cm5pbmcgdGhlIGZpcnN0IG1hdGNoLlxyXG4gKiBCZWNhdXNlIHBhdHRlcm5zIGFyZSB0ZXN0ZWQgaW4gc2VxdWVuY2UsIHNwZWNpZmljaXR5IG9yZGVyaW5nIHByZXZlbnRzXHJcbiAqIGZhbHNlIHBvc2l0aXZlcyAoZS5nLiBcIkZpbGUgSGFzaFwiIG5vZGUgd29uJ3QgbWF0Y2ggZ2VuZXJpYyBcIkZpbGVcIikuXHJcbiAqL1xyXG5mdW5jdGlvbiBkZXRlY3RJT0NUeXBlKHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICBmb3IgKGNvbnN0IHsgcGF0dGVybiwgdHlwZSB9IG9mIElPQ19UWVBFX1BBVFRFUk5TKSB7XHJcbiAgICAgICAgaWYgKHBhdHRlcm4udGVzdCh0ZXh0KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHlwZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gJyc7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFeHRyYWN0IHRoZSBwcmltYXJ5IHZhbHVlIGZyb20gSU9DIGNhcmQgdGV4dC5cclxuICpcclxuICogVGhlIEZJUlNUIEZJRUxEIG9mIGVhY2ggY2FyZCBpcyBhbHdheXMgY29uc2lkZXJlZCB0aGUgXCJ2YWx1ZVwiIGZvciB0aW1lbGluZSBkaXNwbGF5LFxyXG4gKiByZWdhcmRsZXNzIG9mIHdoYXQgdGhlIGZpZWxkIGlzIG5hbWVkIChJUCwgRG9tYWluLCBIYXNoLCBldGMuKS5cclxuICpcclxuICogRm9ybWF0IHdpdGggLS0tLS0gc2VwYXJhdG9yczpcclxuICogICA8L2Rpdj48L2Rpdj5cclxuICogICBGaXJzdEZpZWxkTmFtZTpcclxuICpcclxuICogICB2YWx1ZV90ZXh0X2hlcmVcclxuICogICAtLS0tLVxyXG4gKlxyXG4gKiAgIFNlY29uZEZpZWxkTmFtZTpcclxuICogICAuLi5cclxuICpcclxuICogVGhpcyBleHRyYWN0cyB0aGUgdGV4dCBiZXR3ZWVuIHRoZSBmaXJzdCBmaWVsZCBsYWJlbCBhbmQgdGhlIGZpcnN0IFwiLS0tLS1cIiBzZXBhcmF0b3IuXHJcbiAqXHJcbiAqIERFQlVHOiBDb25zb2xlIGxvZ3Mgc2hvdyBleHRyYWN0aW9uIHN0ZXBzIGZvciB0cm91Ymxlc2hvb3RpbmcuXHJcbiAqL1xyXG5mdW5jdGlvbiBleHRyYWN0VmFsdWUodGV4dDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIGNvbnNvbGUuZGVidWcoJ1tJT0NQYXJzZXJdIGV4dHJhY3RWYWx1ZSAtIGlucHV0IGxlbmd0aDonLCB0ZXh0Lmxlbmd0aCk7XHJcblxyXG4gICAgLy8gRmlyc3QgdHJ5IGNvZGUgYmxvY2tzIChsZWdhY3kgZm9ybWF0IGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5KVxyXG4gICAgY29uc3QgY29kZUJsb2NrTWF0Y2ggPSB0ZXh0Lm1hdGNoKC9gYGAoW1xcc1xcU10qPylgYGAvKTtcclxuICAgIGlmIChjb2RlQmxvY2tNYXRjaCAmJiBjb2RlQmxvY2tNYXRjaFsxXSAmJiBjb2RlQmxvY2tNYXRjaFsxXS50cmltKCkpIHtcclxuICAgICAgICBjb25zdCB2YWx1ZSA9IGNvZGVCbG9ja01hdGNoWzFdLnRyaW0oKTtcclxuICAgICAgICBjb25zb2xlLmRlYnVnKCdbSU9DUGFyc2VyXSBleHRyYWN0VmFsdWUgLSBmb3VuZCBjb2RlIGJsb2NrOicsIHZhbHVlKTtcclxuICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU3BsaXQgYnkgSFRNTCBoZWFkZXIgY2xvc2luZyB0YWcgdG8gZ2V0IGNvbnRlbnQgYWZ0ZXIgaGVhZGVyXHJcbiAgICBjb25zdCBwYXJ0cyA9IHRleHQuc3BsaXQoJzwvZGl2PjwvZGl2PicpO1xyXG4gICAgaWYgKHBhcnRzLmxlbmd0aCA8IDIpIHtcclxuICAgICAgICBjb25zb2xlLmRlYnVnKCdbSU9DUGFyc2VyXSBleHRyYWN0VmFsdWUgLSBubyBIVE1MIGhlYWRlciBmb3VuZCcpO1xyXG4gICAgICAgIHJldHVybiAnJztcclxuICAgIH1cclxuXHJcbiAgICBsZXQgYWZ0ZXJIZWFkZXIgPSBwYXJ0c1sxXS50cmltKCk7XHJcbiAgICBjb25zb2xlLmRlYnVnKCdbSU9DUGFyc2VyXSBleHRyYWN0VmFsdWUgLSBjb250ZW50IGFmdGVyIGhlYWRlciBsZW5ndGg6JywgYWZ0ZXJIZWFkZXIubGVuZ3RoKTtcclxuXHJcbiAgICAvLyBGaW5kIGZpcnN0IGZpZWxkIGxhYmVsICh0ZXh0IGVuZGluZyB3aXRoIGNvbG9uKVxyXG4gICAgY29uc3QgZmllbGRNYXRjaCA9IGFmdGVySGVhZGVyLm1hdGNoKC9bXjpcXG5dKzpcXHMqLyk7XHJcbiAgICBpZiAoIWZpZWxkTWF0Y2gpIHtcclxuICAgICAgICBjb25zb2xlLmRlYnVnKCdbSU9DUGFyc2VyXSBleHRyYWN0VmFsdWUgLSBubyBmaWVsZCBsYWJlbCBmb3VuZCcpO1xyXG4gICAgICAgIHJldHVybiAnJztcclxuICAgIH1cclxuXHJcbiAgICBjb25zb2xlLmRlYnVnKCdbSU9DUGFyc2VyXSBleHRyYWN0VmFsdWUgLSBmaXJzdCBmaWVsZDonLCBmaWVsZE1hdGNoWzBdLnRyaW0oKSk7XHJcblxyXG4gICAgLy8gR2V0IGNvbnRlbnQgYWZ0ZXIgdGhlIGZpZWxkIGxhYmVsXHJcbiAgICBjb25zdCBhZnRlckZpZWxkTGFiZWwgPSBhZnRlckhlYWRlci5zdWJzdHJpbmcoZmllbGRNYXRjaC5pbmRleCEgKyBmaWVsZE1hdGNoWzBdLmxlbmd0aCk7XHJcblxyXG4gICAgLy8gRmluZCB0aGUgZmlyc3QgXCItLS0tLVwiIHNlcGFyYXRvciBPUiB0aGUgZmlyc3QgbmV3bGluZSBmb2xsb3dlZCBieSBhbm90aGVyIGZpZWxkXHJcbiAgICBjb25zdCBzZXBhcmF0b3JNYXRjaCA9IGFmdGVyRmllbGRMYWJlbC5tYXRjaCgvXFxuPy0tLS0tLyk7XHJcbiAgICBjb25zdCBuZXh0RmllbGRNYXRjaCA9IGFmdGVyRmllbGRMYWJlbC5tYXRjaCgvXFxuKFteOlxcbl0rOlxccyopLyk7XHJcblxyXG4gICAgbGV0IHZhbHVlOiBzdHJpbmc7XHJcbiAgICBsZXQgZGVsaW1pdGVySW5kZXg6IG51bWJlciB8IHVuZGVmaW5lZDtcclxuXHJcbiAgICAvLyBEZXRlcm1pbmUgd2hpY2ggZGVsaW1pdGVyIGNvbWVzIGZpcnN0XHJcbiAgICBpZiAoc2VwYXJhdG9yTWF0Y2ggJiYgc2VwYXJhdG9yTWF0Y2guaW5kZXggIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGRlbGltaXRlckluZGV4ID0gc2VwYXJhdG9yTWF0Y2guaW5kZXg7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKG5leHRGaWVsZE1hdGNoICYmIG5leHRGaWVsZE1hdGNoLmluZGV4ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBpZiAoZGVsaW1pdGVySW5kZXggPT09IHVuZGVmaW5lZCB8fCBuZXh0RmllbGRNYXRjaC5pbmRleCA8IGRlbGltaXRlckluZGV4KSB7XHJcbiAgICAgICAgICAgIGRlbGltaXRlckluZGV4ID0gbmV4dEZpZWxkTWF0Y2guaW5kZXg7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChkZWxpbWl0ZXJJbmRleCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgLy8gTm8gc2VwYXJhdG9yIG9yIG5leHQgZmllbGQgZm91bmQgLSBleHRyYWN0IGV2ZXJ5dGhpbmcgdW50aWwgVGltZSBvZiBFdmVudFxyXG4gICAgICAgIGNvbnN0IHRpbWVJbmRleCA9IGFmdGVyRmllbGRMYWJlbC5pbmRleE9mKCdUaW1lIG9mIEV2ZW50OicpO1xyXG4gICAgICAgIHZhbHVlID0gdGltZUluZGV4ID09PSAtMSA/IGFmdGVyRmllbGRMYWJlbCA6IGFmdGVyRmllbGRMYWJlbC5zdWJzdHJpbmcoMCwgdGltZUluZGV4KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gRXh0cmFjdCBjb250ZW50IGJlZm9yZSBmaXJzdCBkZWxpbWl0ZXJcclxuICAgICAgICB2YWx1ZSA9IGFmdGVyRmllbGRMYWJlbC5zdWJzdHJpbmcoMCwgZGVsaW1pdGVySW5kZXgpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHRyaW1tZWRWYWx1ZSA9IHZhbHVlLnRyaW0oKTtcclxuICAgIGNvbnNvbGUuZGVidWcoJ1tJT0NQYXJzZXJdIGV4dHJhY3RWYWx1ZSAtIHJlc3VsdDonLCB0cmltbWVkVmFsdWUgfHwgJyhlbXB0eSknKTtcclxuICAgIHJldHVybiB0cmltbWVkVmFsdWU7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFeHRyYWN0IHRoZSBcIlRpbWUgb2YgRXZlbnRcIiB0aW1lc3RhbXAgZnJvbSBub2RlIHRleHQuXHJcbiAqXHJcbiAqIFJlbmRlcklPQ0NhcmRzLnRzIGdlbmVyYXRlcyB0aW1lc3RhbXBzIGluIFwiWVlZWS1NTS1ERCBISDpNTTpTU1wiIGZvcm1hdFxyXG4gKiAodmlhIHRvSVNPU3RyaW5nIHdpdGggVCByZXBsYWNlZCBieSBzcGFjZSkuIFRoZSBwYXR0ZXJucyB0cnkgcHJvZ3Jlc3NpdmVseVxyXG4gKiBsZXNzIHNwZWNpZmljIGZvcm1hdHM6XHJcbiAqICAgMS4gKipUaW1lIG9mIEV2ZW50OioqIGZvbGxvd2VkIGJ5IGRhdGV0aW1lXHJcbiAqICAgMi4gKipUaW1lIG9mIEV2ZW50OioqIGZvbGxvd2VkIGJ5IGRhdGUgb25seVxyXG4gKiAgIDMuIEJhcmUgXCJUaW1lXCIgbGFiZWwgZm9sbG93ZWQgYnkgZGF0ZXRpbWVcclxuICogICA0LiBBbnkgc3RhbmRhbG9uZSBkYXRldGltZSBwYXR0ZXJuIGluIHRoZSB0ZXh0XHJcbiAqL1xyXG5mdW5jdGlvbiBleHRyYWN0VGltZSh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgY29uc3QgdGltZVBhdHRlcm5zID0gW1xyXG4gICAgICAgIC9cXCpcXCpUaW1lIG9mIEV2ZW50OlxcKlxcKlxccyooXFxkezR9LVxcZHsyfS1cXGR7Mn1cXHNcXGR7Mn06XFxkezJ9OlxcZHsyfSkvaSxcclxuICAgICAgICAvXFwqXFwqVGltZSBvZiBFdmVudDpcXCpcXCpcXHMqKFxcZHs0fS1cXGR7Mn0tXFxkezJ9KS9pLFxyXG4gICAgICAgIC9UaW1lIG9mIEV2ZW50WzpcXHNdKihcXGR7NH0tXFxkezJ9LVxcZHsyfVtUXFxzXVxcZHsyfTpcXGR7Mn06XFxkezJ9KS9pLFxyXG4gICAgICAgIC9UaW1lIG9mIEV2ZW50WzpcXHNdKihcXGR7NH0tXFxkezJ9LVxcZHsyfSkvaSxcclxuICAgICAgICAvVGltZVs6XFxzXSooXFxkezR9LVxcZHsyfS1cXGR7Mn1bVFxcc11cXGR7Mn06XFxkezJ9OlxcZHsyfSkvaSxcclxuICAgICAgICAvKFxcZHs0fS1cXGR7Mn0tXFxkezJ9W1RcXHNdXFxkezJ9OlxcZHsyfTpcXGR7Mn0pL2lcclxuICAgIF07XHJcblxyXG4gICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIHRpbWVQYXR0ZXJucykge1xyXG4gICAgICAgIGNvbnN0IG1hdGNoID0gdGV4dC5tYXRjaChwYXR0ZXJuKTtcclxuICAgICAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMV0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIG1hdGNoWzFdLnRyaW0oKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gJyc7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFeHRyYWN0IHRoZSBTcGx1bmsgcXVlcnkgZnJvbSBub2RlIHRleHQuXHJcbiAqXHJcbiAqIFJlbmRlcklPQ0NhcmRzLnRzIHByb2R1Y2VzOiAqKlNwbHVuayBRdWVyeToqKiA8cXVlcnkgdGV4dD5cclxuICogVGhlIHJlZ2V4IG1hdGNoZXMgZXZlcnl0aGluZyBhZnRlciB0aGUgbGFiZWwgdXAgdG8gdGhlIG5leHQgYm9sZCBtYXJrZXJcclxuICogb3IgZW5kIG9mIHN0cmluZyAobm9uLWdyZWVkeSB2aWEgW1xcc1xcU10qPykuXHJcbiAqL1xyXG5mdW5jdGlvbiBleHRyYWN0U3BsdW5rUXVlcnkodGV4dDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IG1hdGNoID0gdGV4dC5tYXRjaCgvXFwqXFwqU3BsdW5rIFF1ZXJ5OlxcKlxcKls6XFxzXSooW1xcc1xcU10qPykoPz1cXCpcXCp8JCkvaSk7XHJcbiAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMV0gJiYgbWF0Y2hbMV0udHJpbSgpKSB7XHJcbiAgICAgICAgcmV0dXJuIG1hdGNoWzFdLnRyaW0oKTtcclxuICAgIH1cclxuICAgIHJldHVybiAnJztcclxufVxyXG5cclxuLyoqXHJcbiAqIEV4dHJhY3QgdGhlIE1JVFJFIEFUVCZDSyB0YWN0aWMgZnJvbSBub2RlIHRleHQuXHJcbiAqXHJcbiAqIEhhbmRsZXMgYm90aCBmb3JtYXRzOlxyXG4gKiAgIC0gUGxhaW4gdGV4dDogTWl0cmUgVGFjdGljOiA8dGFjdGljPlxyXG4gKiAgIC0gQm9sZCBtYXJrZG93bjogKipNaXRyZSBUYWN0aWM6KiogPHRhY3RpYz5cclxuICpcclxuICogSU1QT1JUQU5UOiBVc2UgWyBcXHRdKiBpbnN0ZWFkIG9mIFxccyogdG8gYXZvaWQgbWF0Y2hpbmcgbmV3bGluZXMuXHJcbiAqIFRoaXMgcHJldmVudHMgdGhlIHJlZ2V4IGZyb20gc2tpcHBpbmcgZW1wdHkgbGluZXMgYW5kIGNhcHR1cmluZyB0aGUgbmV4dCBmaWVsZC5cclxuICpcclxuICogQHJldHVybnMgTm9ybWFsaXplZCB0YWN0aWMgdmFsdWUgaW4gVVBQRVJDQVNFIGZvciBjb25zaXN0ZW50IG1hdGNoaW5nXHJcbiAqL1xyXG5mdW5jdGlvbiBleHRyYWN0VGFjdGljKHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAvLyBUcnkgcGxhaW4gdGV4dCBmb3JtYXQgZmlyc3QgKGN1cnJlbnQgdGVtcGxhdGUgZm9ybWF0KVxyXG4gICAgLy8gVXNlIFsgXFx0XSogdG8gbWF0Y2ggc3BhY2VzL3RhYnMgYnV0IE5PVCBuZXdsaW5lc1xyXG4gICAgLy8gVXNlIFteXFxuXSogKG5vdCArKSB0byBhbGxvdyBjYXB0dXJpbmcgZW1wdHkgdmFsdWVzXHJcbiAgICBsZXQgbWF0Y2ggPSB0ZXh0Lm1hdGNoKC9NaXRyZSBUYWN0aWM6WyBcXHRdKihbXlxcbl0qKS9pKTtcclxuICAgIGlmIChtYXRjaCAmJiBtYXRjaFsxXSAmJiBtYXRjaFsxXS50cmltKCkpIHtcclxuICAgICAgICByZXR1cm4gbWF0Y2hbMV0udHJpbSgpLnRvVXBwZXJDYXNlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRmFsbCBiYWNrIHRvIGJvbGQgbWFya2Rvd24gZm9ybWF0IChiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSlcclxuICAgIG1hdGNoID0gdGV4dC5tYXRjaCgvXFwqXFwqTWl0cmUgVGFjdGljOlxcKlxcKlsgXFx0XSooW15cXG5dKikvaSlcclxuICAgICAgICB8fCB0ZXh0Lm1hdGNoKC9cXCpcXCpNaXRyZSBUYWN0aWM6XFwqXFwqWzpcXHNdKihbXFxzXFxTXSo/KSg/PVxcKlxcKnwkKS9pKTtcclxuICAgIGlmIChtYXRjaCAmJiBtYXRjaFsxXSAmJiBtYXRjaFsxXS50cmltKCkpIHtcclxuICAgICAgICByZXR1cm4gbWF0Y2hbMV0udHJpbSgpLnRvVXBwZXJDYXNlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuICcnO1xyXG59XHJcblxyXG4vKipcclxuICogRXh0cmFjdCB0aGUgTUlUUkUgQVRUJkNLIHRlY2huaXF1ZSBmcm9tIG5vZGUgdGV4dC5cclxuICpcclxuICogSGFuZGxlcyBib3RoIGZvcm1hdHM6XHJcbiAqICAgLSBQbGFpbiB0ZXh0OiBNaXRyZSBUZWNobmlxdWU6IDx0ZWNobmlxdWU+XHJcbiAqICAgLSBCb2xkIG1hcmtkb3duOiAqKk1pdHJlIFRlY2huaXF1ZToqKiA8dGVjaG5pcXVlPlxyXG4gKlxyXG4gKiBJTVBPUlRBTlQ6IFVzZSBbIFxcdF0qIGluc3RlYWQgb2YgXFxzKiB0byBhdm9pZCBtYXRjaGluZyBuZXdsaW5lcy5cclxuICogVGhpcyBwcmV2ZW50cyB0aGUgcmVnZXggZnJvbSBza2lwcGluZyBlbXB0eSBsaW5lcyBhbmQgY2FwdHVyaW5nIHRoZSBuZXh0IGZpZWxkLlxyXG4gKlxyXG4gKiBAcmV0dXJucyBOb3JtYWxpemVkIHRlY2huaXF1ZSB2YWx1ZSBpbiBVUFBFUkNBU0UgZm9yIGNvbnNpc3RlbnQgbWF0Y2hpbmdcclxuICovXHJcbmZ1bmN0aW9uIGV4dHJhY3RUZWNobmlxdWUodGV4dDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIC8vIFRyeSBwbGFpbiB0ZXh0IGZvcm1hdCBmaXJzdCAoY3VycmVudCB0ZW1wbGF0ZSBmb3JtYXQpXHJcbiAgICAvLyBVc2UgWyBcXHRdKiB0byBtYXRjaCBzcGFjZXMvdGFicyBidXQgTk9UIG5ld2xpbmVzXHJcbiAgICAvLyBVc2UgW15cXG5dKiAobm90ICspIHRvIGFsbG93IGNhcHR1cmluZyBlbXB0eSB2YWx1ZXNcclxuICAgIGxldCBtYXRjaCA9IHRleHQubWF0Y2goL01pdHJlIFRlY2huaXF1ZTpbIFxcdF0qKFteXFxuXSopL2kpO1xyXG4gICAgaWYgKG1hdGNoICYmIG1hdGNoWzFdICYmIG1hdGNoWzFdLnRyaW0oKSkge1xyXG4gICAgICAgIHJldHVybiBtYXRjaFsxXS50cmltKCkudG9VcHBlckNhc2UoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBGYWxsIGJhY2sgdG8gYm9sZCBtYXJrZG93biBmb3JtYXQgKGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5KVxyXG4gICAgbWF0Y2ggPSB0ZXh0Lm1hdGNoKC9cXCpcXCpNaXRyZSBUZWNobmlxdWU6XFwqXFwqWyBcXHRdKihbXlxcbl0qKS9pKVxyXG4gICAgICAgIHx8IHRleHQubWF0Y2goL1xcKlxcKk1pdHJlIFRlY2huaXF1ZTpcXCpcXCpbOlxcc10qKFtcXHNcXFNdKj8pKD89XFwqXFwqfCQpL2kpO1xyXG4gICAgaWYgKG1hdGNoICYmIG1hdGNoWzFdICYmIG1hdGNoWzFdLnRyaW0oKSkge1xyXG4gICAgICAgIHJldHVybiBtYXRjaFsxXS50cmltKCkudG9VcHBlckNhc2UoKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gJyc7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFeHRyYWN0IHRoZSBDYXJkIElEIGZpZWxkIGZyb20gSU9DIGNhcmQgbWFya2Rvd24uXHJcbiAqIEZvcm1hdDogSFRNTCBjb21tZW50IChuZXcpIG9yIGxlZ2FjeSBmaWVsZCAoYmFja3dhcmQgY29tcGF0aWJpbGl0eSlcclxuICogTmV3IGZvcm1hdDogPCEtLSBJT0NfQ0FSRF9JRDojWVlZWU1NREQtSEhNTSAtLT5cclxuICogTGVnYWN5IGZvcm1hdDogXCJDYXJkIElEOiAjWVlZWU1NREQtSEhNTVwiXHJcbiAqL1xyXG5mdW5jdGlvbiBleHRyYWN0Q2FyZElkKHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICBjb25zb2xlLmRlYnVnKCdbSU9DUGFyc2VyXSBFeHRyYWN0aW5nIENhcmQgSUQuLi4nKTtcclxuXHJcbiAgICAvLyBORVcgRk9STUFUOiBUcnkgSFRNTCBjb21tZW50IGZpcnN0IChwcmVmZXJyZWQpXHJcbiAgICBjb25zdCBjb21tZW50TWF0Y2ggPSB0ZXh0Lm1hdGNoKC88IS0tIElPQ19DQVJEX0lEOihbXj5dKykgLS0+Lyk7XHJcbiAgICBpZiAoY29tbWVudE1hdGNoICYmIGNvbW1lbnRNYXRjaFsxXSkge1xyXG4gICAgICAgIGNvbnN0IGNhcmRJZCA9IGNvbW1lbnRNYXRjaFsxXS50cmltKCk7XHJcbiAgICAgICAgY29uc29sZS5kZWJ1ZygnW0lPQ1BhcnNlcl0gRm91bmQgQ2FyZCBJRCBpbiBIVE1MIGNvbW1lbnQ6JywgY2FyZElkKTtcclxuICAgICAgICByZXR1cm4gY2FyZElkO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIExFR0FDWSBGT1JNQVQ6IEZhbGwgYmFjayB0byBtYXJrZG93biBmaWVsZCBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxyXG4gICAgY29uc3QgY2FyZElkTWF0Y2ggPSB0ZXh0Lm1hdGNoKC9DYXJkIElEOlxccyooW15cXG5dKykvaSk7XHJcbiAgICBpZiAoY2FyZElkTWF0Y2ggJiYgY2FyZElkTWF0Y2hbMV0pIHtcclxuICAgICAgICBjb25zdCBjYXJkSWQgPSBjYXJkSWRNYXRjaFsxXS50cmltKCk7XHJcbiAgICAgICAgY29uc29sZS5kZWJ1ZygnW0lPQ1BhcnNlcl0gRm91bmQgQ2FyZCBJRCBpbiBsZWdhY3kgZmllbGQgZm9ybWF0OicsIGNhcmRJZCk7XHJcbiAgICAgICAgcmV0dXJuIGNhcmRJZDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zb2xlLmRlYnVnKCdbSU9DUGFyc2VyXSBObyBDYXJkIElEIGZvdW5kJyk7XHJcbiAgICByZXR1cm4gJyc7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMb29rIHVwIHRoZSBTVkcgaWNvbiBhbmQgaGV4IGNvbG9yIGZvciBhIGdpdmVuIElPQyB0eXBlIG5hbWUuXHJcbiAqXHJcbiAqIFNlYXJjaGVzIHRoZSBJT0NfVFlQRVMgY29uc3RhbnQgKGZyb20gSU9DQ2FyZHNUeXBlcy50cykgYnkgY29tcGFyaW5nXHJcbiAqIGVhY2ggZW50cnkncyBgbmFtZWAgcHJvcGVydHkgYWdhaW5zdCB0aGUgZGV0ZWN0ZWQgdHlwZSBzdHJpbmcuXHJcbiAqIFJldHVybnMgZGVmYXVsdHMgaWYgbm8gbWF0Y2ggaXMgZm91bmQgKGVtcHR5IGljb24sIGZhbGxiYWNrIGNvbG9yKS5cclxuICovXHJcbmZ1bmN0aW9uIGxvb2t1cFR5cGVWaXN1YWxzKGlvY1R5cGU6IHN0cmluZywgZmFsbGJhY2tDb2xvcjogc3RyaW5nKTogeyBpY29uOiBzdHJpbmc7IGNvbG9yOiBzdHJpbmcgfSB7XHJcbiAgICBsZXQgaWNvbiA9ICcnO1xyXG4gICAgbGV0IGNvbG9yID0gZmFsbGJhY2tDb2xvcjtcclxuXHJcbiAgICBpZiAoSU9DX1RZUEVTICYmIHR5cGVvZiBJT0NfVFlQRVMgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgZm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXMoSU9DX1RZUEVTKSkge1xyXG4gICAgICAgICAgICBpZiAoSU9DX1RZUEVTW2tleV0ubmFtZSA9PT0gaW9jVHlwZSkge1xyXG4gICAgICAgICAgICAgICAgaWNvbiA9IElPQ19UWVBFU1trZXldLnN2ZztcclxuICAgICAgICAgICAgICAgIGNvbG9yID0gSU9DX1RZUEVTW2tleV0uY29sb3I7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBpY29uLCBjb2xvciB9O1xyXG59XHJcblxyXG4vKipcclxuICogUGFyc2UgYW4gT2JzaWRpYW4gY2FudmFzIHRleHQgbm9kZSBhbmQgZXh0cmFjdCBzdHJ1Y3R1cmVkIElPQyBkYXRhLlxyXG4gKlxyXG4gKiBUaGlzIGlzIHRoZSBtYWluIGVudHJ5IHBvaW50IHVzZWQgYnkgYm90aCBUaW1lVGltZWxpbmVQcm9jZXNzaW5nIGFuZFxyXG4gKiBMaW5rVGltZWxpbmVQcm9jZXNzaW5nLiBJdCBjb21iaW5lcyBhbGwgZXh0cmFjdGlvbiBzdGVwczpcclxuICogICAxLiBEZXRlY3QgSU9DIHR5cGUgZnJvbSB0aGUgbm9kZSdzIHRleHQgY29udGVudFxyXG4gKiAgIDIuIEV4dHJhY3QgdmFsdWUsIHRpbWUsIHNwbHVuayBxdWVyeSwgdGFjdGljLCBhbmQgdGVjaG5pcXVlXHJcbiAqICAgMy4gTG9vayB1cCB0aGUgU1ZHIGljb24gYW5kIGNvbG9yIGZyb20gSU9DX1RZUEVTXHJcbiAqXHJcbiAqIERFQlVHOiBDb25zb2xlIGxvZ3Mgc2hvdyBwYXJzaW5nIHN0ZXBzIGZvciB0cm91Ymxlc2hvb3RpbmcuXHJcbiAqXHJcbiAqIEBwYXJhbSBub2RlIC0gQW4gT2JzaWRpYW4gY2FudmFzIG5vZGUgb2JqZWN0IHdpdGggYGlkYCwgYHRleHRgLCBhbmRcclxuICogICAgICAgICAgICAgICBvcHRpb25hbCBgY29sb3JgIHByb3BlcnRpZXNcclxuICogQHJldHVybnMgSU9DTm9kZURhdGEgd2l0aCBhbGwgZmllbGRzIHBvcHVsYXRlZCwgb3IgbnVsbCBpZiB0aGUgbm9kZVxyXG4gKiAgICAgICAgICB0ZXh0IGRvZXMgbm90IG1hdGNoIGFueSBrbm93biBJT0MgdHlwZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlSU9DTm9kZShub2RlOiBhbnkpOiBJT0NOb2RlRGF0YSB8IG51bGwge1xyXG4gICAgY29uc29sZS5kZWJ1ZygnW0lPQ1BhcnNlcl0gcGFyc2VJT0NOb2RlIC0gbm9kZTonLCBub2RlLmlkKTtcclxuXHJcbiAgICBpZiAoIW5vZGUudGV4dCkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFN0ZXAgMTogRGV0ZWN0IElPQyB0eXBlXHJcbiAgICBjb25zdCBpb2NUeXBlID0gZGV0ZWN0SU9DVHlwZShub2RlLnRleHQpO1xyXG4gICAgaWYgKCFpb2NUeXBlKSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU3RlcCAyOiBFeHRyYWN0IGZpZWxkIHZhbHVlc1xyXG4gICAgY29uc3QgdmFsdWUgPSBleHRyYWN0VmFsdWUobm9kZS50ZXh0KTtcclxuICAgIGNvbnN0IHRpbWUgPSBleHRyYWN0VGltZShub2RlLnRleHQpO1xyXG4gICAgY29uc3Qgc3BsdW5rUXVlcnkgPSBleHRyYWN0U3BsdW5rUXVlcnkobm9kZS50ZXh0KTtcclxuICAgIGNvbnN0IHRhY3RpYyA9IGV4dHJhY3RUYWN0aWMobm9kZS50ZXh0KTtcclxuICAgIGNvbnN0IHRlY2huaXF1ZSA9IGV4dHJhY3RUZWNobmlxdWUobm9kZS50ZXh0KTtcclxuICAgIGNvbnN0IGNhcmRJZCA9IGV4dHJhY3RDYXJkSWQobm9kZS50ZXh0KTtcclxuXHJcbiAgICAvLyBTdGVwIDM6IExvb2sgdXAgaWNvbiBhbmQgY29sb3IgZnJvbSB0aGUgSU9DX1RZUEVTIGNvbnN0YW50XHJcbiAgICBjb25zdCBmYWxsYmFja0NvbG9yID0gbm9kZS5jb2xvciB8fCAnIzMzMyc7XHJcbiAgICBjb25zdCB7IGljb24sIGNvbG9yIH0gPSBsb29rdXBUeXBlVmlzdWFscyhpb2NUeXBlLCBmYWxsYmFja0NvbG9yKTtcclxuXHJcbiAgICBjb25zdCByZXN1bHQgPSB7XHJcbiAgICAgICAgaWQ6IG5vZGUuaWQsXHJcbiAgICAgICAgY2FyZElkOiBjYXJkSWQsXHJcbiAgICAgICAgdHlwZTogaW9jVHlwZSxcclxuICAgICAgICB2YWx1ZSxcclxuICAgICAgICB0aW1lLFxyXG4gICAgICAgIHNwbHVua1F1ZXJ5LFxyXG4gICAgICAgIHRhY3RpYyxcclxuICAgICAgICB0ZWNobmlxdWUsXHJcbiAgICAgICAgaWNvbixcclxuICAgICAgICBjb2xvclxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zb2xlLmRlYnVnKCdbSU9DUGFyc2VyXSBwYXJzZUlPQ05vZGUgLSByZXN1bHQ6JywgaW9jVHlwZSwgJ3ZhbHVlOicsIHZhbHVlIHx8ICcoZW1wdHkpJyk7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcbiIsICIvKipcclxuICogVGltZVRpbWVsaW5lUHJvY2Vzc2luZy50cyAtIENocm9ub2xvZ2ljYWwgSU9DIHRpbWVsaW5lIGV4dHJhY3Rpb25cclxuICpcclxuICogVGhpcyBwcm9jZXNzb3IgcmVhZHMgYWxsIHRleHQgbm9kZXMgZnJvbSB0aGUgYWN0aXZlIE9ic2lkaWFuIGNhbnZhcyxcclxuICogcGFyc2VzIGVhY2ggb25lIGZvciBJT0MgZGF0YSB1c2luZyB0aGUgc2hhcmVkIElPQ1BhcnNlciwgYW5kIHJldHVybnNcclxuICogdGhlbSBhcyBhIGZsYXQgYXJyYXkgc3VpdGFibGUgZm9yIHRpbWUtYmFzZWQgc29ydGluZyBhbmQgZGlzcGxheS5cclxuICpcclxuICogVGhlIFJlbmRlclRpbWVsaW5lc01vZGFsIHNvcnRzIHRoZSByZXR1cm5lZCBhcnJheSBieSB0aGUgYHRpbWVgIGZpZWxkXHJcbiAqIHRvIHByb2R1Y2UgYSBjaHJvbm9sb2dpY2FsIGF0dGFjayB0aW1lbGluZSB2aWV3LlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgSU9DQ2FyZHNUeXBlcyB9IGZyb20gJy4vSU9DQ2FyZHNUeXBlcyc7XHJcbmltcG9ydCB7IHBhcnNlSU9DTm9kZSwgSU9DTm9kZURhdGEgfSBmcm9tICcuL0lPQ1BhcnNlcic7XHJcblxyXG5leHBvcnQgY2xhc3MgVGltZVRpbWVsaW5lUHJvY2Vzc29yIHtcclxuICAgIHByaXZhdGUgYXBwOiBBcHA7XHJcbiAgICBwcml2YXRlIHBsdWdpbjogYW55O1xyXG4gICAgcHJpdmF0ZSBJT0NDYXJkc1R5cGVzOiBJT0NDYXJkc1R5cGVzO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IGFueSwgSU9DQ2FyZHNUeXBlczogSU9DQ2FyZHNUeXBlcykge1xyXG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xyXG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gICAgICAgIHRoaXMuSU9DQ2FyZHNUeXBlcyA9IElPQ0NhcmRzVHlwZXM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBFeHRyYWN0IElPQyBkYXRhIGZyb20gYWxsIGNhbnZhcyB0ZXh0IG5vZGVzIGZvciB0aW1lLWJhc2VkIHRpbWVsaW5lLlxyXG4gICAgICpcclxuICAgICAqIEl0ZXJhdGVzIG92ZXIgZXZlcnkgbm9kZSBpbiB0aGUgYWN0aXZlIGNhbnZhcy4gRWFjaCBub2RlIHdpdGggYSBgdGV4dGBcclxuICAgICAqIHByb3BlcnR5IGlzIHBhcnNlZCB2aWEgdGhlIHNoYXJlZCBJT0NQYXJzZXIuIE5vZGVzIHRoYXQgbWF0Y2ggYSBrbm93blxyXG4gICAgICogSU9DIHR5cGUgYXJlIGluY2x1ZGVkIGluIHRoZSByZXR1cm5lZCBhcnJheS5cclxuICAgICAqXHJcbiAgICAgKiBUaGUgY2FsbGVyIChSZW5kZXJUaW1lbGluZXNNb2RhbCkgc29ydHMgdGhlIHJlc3VsdCBieSB0aW1lIGZvciBkaXNwbGF5LlxyXG4gICAgICpcclxuICAgICAqIERFQlVHOiBDb25zb2xlIGxvZ3Mgc2hvdyBwcm9jZXNzaW5nIHN0ZXBzIGZvciB0cm91Ymxlc2hvb3RpbmcuXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMgQXJyYXkgb2YgcGFyc2VkIElPQyBub2RlIGRhdGEgb2JqZWN0cywgdW5zb3J0ZWRcclxuICAgICAqL1xyXG4gICAgZXh0cmFjdEZpeGVkSU9DRGF0YSgpOiBJT0NOb2RlRGF0YVtdIHtcclxuICAgICAgICBjb25zb2xlLmRlYnVnKCdbVGltZVByb2Nlc3Nvcl0gU3RhcnRpbmcgZXh0cmFjdGlvbicpO1xyXG5cclxuICAgICAgICBjb25zdCBhY3RpdmVMZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmFjdGl2ZUxlYWY7XHJcbiAgICAgICAgaWYgKCFhY3RpdmVMZWFmIHx8ICFhY3RpdmVMZWFmLnZpZXcgfHwgYWN0aXZlTGVhZi52aWV3LmdldFZpZXdUeXBlKCkgIT09ICdjYW52YXMnKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ1tUaW1lUHJvY2Vzc29yXSBObyBhY3RpdmUgY2FudmFzIHZpZXcnKTtcclxuICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgY2FudmFzVmlldyA9IGFjdGl2ZUxlYWYudmlldyBhcyBhbnk7XHJcbiAgICAgICAgY29uc3QgY2FudmFzID0gY2FudmFzVmlldy5jYW52YXM7XHJcbiAgICAgICAgaWYgKCFjYW52YXMgfHwgIWNhbnZhcy5ub2Rlcykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdbVGltZVByb2Nlc3Nvcl0gTm8gY2FudmFzIG9yIG5vZGVzJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBbXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHRvdGFsTm9kZXMgPSBjYW52YXMubm9kZXMuc2l6ZSB8fCBjYW52YXMubm9kZXMubGVuZ3RoIHx8IDA7XHJcbiAgICAgICAgY29uc29sZS5kZWJ1ZygnW1RpbWVQcm9jZXNzb3JdIFByb2Nlc3NpbmcnLCB0b3RhbE5vZGVzLCAnbm9kZXMnKTtcclxuXHJcbiAgICAgICAgLy8gUGFyc2UgZWFjaCBjYW52YXMgdGV4dCBub2RlIGFuZCBjb2xsZWN0IHRob3NlIHdpdGggdmFsaWQgSU9DIHR5cGVzXHJcbiAgICAgICAgY29uc3QgaW9jRGF0YTogSU9DTm9kZURhdGFbXSA9IFtdO1xyXG4gICAgICAgIGxldCBlbXB0eVZhbHVlQ291bnQgPSAwO1xyXG5cclxuICAgICAgICBjYW52YXMubm9kZXMuZm9yRWFjaCgobm9kZTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChub2RlLnRleHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBhcnNlZERhdGEgPSBwYXJzZUlPQ05vZGUobm9kZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAocGFyc2VkRGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghcGFyc2VkRGF0YS52YWx1ZSB8fCAhcGFyc2VkRGF0YS52YWx1ZS50cmltKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW1wdHlWYWx1ZUNvdW50Kys7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlvY0RhdGEucHVzaChwYXJzZWREYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zb2xlLmRlYnVnKCdbVGltZVByb2Nlc3Nvcl0gRXh0cmFjdGlvbiBjb21wbGV0ZSAtIGZvdW5kOicsIGlvY0RhdGEubGVuZ3RoLCAnSU9DcywnLCBlbXB0eVZhbHVlQ291bnQsICdlbXB0eSB2YWx1ZXMnKTtcclxuICAgICAgICByZXR1cm4gaW9jRGF0YTtcclxuICAgIH1cclxufVxyXG4iLCAiLyoqXHJcbiAqIFJlbmRlck1pdHJlTW9kYWwudHMgLSBNSVRSRSBBVFQmQ0sgVGVjaG5pcXVlIE1hcHBlclxyXG4gKlxyXG4gKiBBZ2dyZWdhdGVzIHRhY3RpY3MgYW5kIHRlY2huaXF1ZXMgZnJvbSBJT0MgY2FyZHMgYW5kIGRpc3BsYXlzIHRoZW1cclxuICogaW4gYSBjb21wYWN0IHZpZXcgZ3JvdXBlZCBieSB0YWN0aWMuIEFsbG93cyBleHBvcnQgdG8gTUlUUkUgQVRUJkNLXHJcbiAqIE5hdmlnYXRvciBmb3JtYXQgZm9yIHZpc3VhbGl6YXRpb24uXHJcbiAqL1xyXG5pbXBvcnQgeyBBcHAsIE1vZGFsIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBUaW1lVGltZWxpbmVQcm9jZXNzb3IgfSBmcm9tICcuL1RpbWVUaW1lbGluZVByb2Nlc3NpbmcnO1xyXG5pbXBvcnQgeyBJT0NOb2RlRGF0YSB9IGZyb20gJy4vSU9DUGFyc2VyJztcclxuaW1wb3J0IHsgSU9DX1RZUEVTIH0gZnJvbSAnLi9JT0NDYXJkc1R5cGVzJztcclxuaW1wb3J0IHtcclxuICAgIGxvYWRNaXRyZURhdGFzZXQsXHJcbiAgICB2YWxpZGF0ZVRlY2huaXF1ZVRhY3RpYyxcclxuICAgIE1pdHJlRGF0YXNldFxyXG59IGZyb20gJy4vTWl0cmVMb2FkZXInO1xyXG5cclxuaW50ZXJmYWNlIE1pdHJlVGVjaG5pcXVlIHtcclxuICAgIGlkOiBzdHJpbmc7ICAgICAgICAgICAvLyBlLmcuLCBcIlQxNTY2XCJcclxuICAgIG5hbWU6IHN0cmluZzsgICAgICAgICAvLyBlLmcuLCBcIlBoaXNoaW5nXCJcclxuICAgIHRhY3RpYzogc3RyaW5nOyAgICAgICAvLyBlLmcuLCBcIkluaXRpYWwgQWNjZXNzXCIgKG9yaWdpbmFsIGZyb20gSU9DKVxyXG4gICAgdGFjdGljSWQ6IHN0cmluZzsgICAgIC8vIGUuZy4sIFwiVEEwMDA2XCIgKE1JVFJFIHRhY3RpYyBJRClcclxuICAgIGNvdW50OiBudW1iZXI7ICAgICAgICAvLyBIb3cgbWFueSBJT0MgY2FyZHMgcmVmZXJlbmNlIHRoaXNcclxuICAgIGlvY0NhcmRzOiBzdHJpbmdbXTsgICAvLyBJT0MgY2FyZCBJRHMgdGhhdCB1c2UgdGhpcyB0ZWNobmlxdWVcclxuICAgIHNldmVyaXR5OiAndmFsaWQnIHwgJ3Vua25vd25fdGVjaG5pcXVlJyB8ICd1bmtub3duX3RhY3RpYycgfCAnbWlzbWF0Y2gnIHwgJ2VtcHR5X3RhY3RpYycgfCAnbm90X2ZvdW5kJzsgLy8gVmFsaWRhdGlvbiBzZXZlcml0eVxyXG4gICAgdmFsaWRhdGlvbk1lc3NhZ2U/OiBzdHJpbmc7IC8vIEVycm9yIG1lc3NhZ2UgaWYgaW52YWxpZFxyXG4gICAgZGVzY3JpcHRpb24/OiBzdHJpbmc7IC8vIFRlY2huaXF1ZSBkZXNjcmlwdGlvblxyXG4gICAgaXNGb3VuZDogYm9vbGVhbjsgICAgIC8vIFdoZXRoZXIgdGhpcyB0ZWNobmlxdWUgaGFzIElPQyBjYXJkc1xyXG59XHJcblxyXG5pbnRlcmZhY2UgTWl0cmVUYWN0aWMge1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgZGlzcGxheU5hbWU/OiBzdHJpbmc7XHJcbiAgICB0ZWNobmlxdWVzOiBNaXRyZVRlY2huaXF1ZVtdO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU2VhcmNoU3RhdGUge1xyXG4gICAgcXVlcnk6IHN0cmluZztcclxuICAgIGtleXdvcmRzOiBzdHJpbmdbXTtcclxuICAgIHBocmFzZXM6IHN0cmluZ1tdO1xyXG4gICAgaXNBY3RpdmU6IGJvb2xlYW47XHJcbn1cclxuXHJcbmludGVyZmFjZSBTZWFyY2hNYXRjaCB7XHJcbiAgICBtYXRjaGVkOiBib29sZWFuO1xyXG4gICAgbWF0Y2hUeXBlPzogJ2lkJyB8ICduYW1lJyB8ICdkZXNjcmlwdGlvbicgfCAnc3VidGVjaG5pcXVlJztcclxuICAgIG1hdGNoVGV4dD86IHN0cmluZztcclxufVxyXG5cclxuaW50ZXJmYWNlIFZhbGlkYXRpb25FcnJvciB7XHJcbiAgICB0ZWNobmlxdWVJZDogc3RyaW5nO1xyXG4gICAgdGVjaG5pcXVlTmFtZTogc3RyaW5nO1xyXG4gICAgc2V2ZXJpdHk6ICd1bmtub3duX3RlY2huaXF1ZScgfCAndW5rbm93bl90YWN0aWMnIHwgJ21pc21hdGNoJyB8ICdlbXB0eV90YWN0aWMnO1xyXG4gICAgbWVzc2FnZTogc3RyaW5nO1xyXG4gICAgaW9jQ2FyZHM6IEFycmF5PHtcclxuICAgICAgICBjYXJkSWQ6IHN0cmluZztcclxuICAgICAgICBpb2NUeXBlOiBzdHJpbmc7XHJcbiAgICAgICAgbm9kZUlkOiBzdHJpbmc7XHJcbiAgICB9PjtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFJlbmRlck1pdHJlTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgICBwcml2YXRlIHBsdWdpbjogYW55O1xyXG4gICAgcHJpdmF0ZSB0aW1lUHJvY2Vzc29yOiBUaW1lVGltZWxpbmVQcm9jZXNzb3I7XHJcbiAgICBwcml2YXRlIG1pdHJlRGF0YXNldDogTWl0cmVEYXRhc2V0IHwgbnVsbCA9IG51bGw7XHJcbiAgICBwcml2YXRlIHN1YnRlY2huaXF1ZXNNYXA6IE1hcDxzdHJpbmcsIE1pdHJlVGVjaG5pcXVlW10+ID0gbmV3IE1hcCgpO1xyXG4gICAgcHJpdmF0ZSBjdXJyZW50U2VhcmNoU3RhdGU6IFNlYXJjaFN0YXRlIHwgbnVsbCA9IG51bGw7XHJcbiAgICBwcml2YXRlIGN1cnJlbnRUYWN0aWNzOiBNaXRyZVRhY3RpY1tdIHwgbnVsbCA9IG51bGw7XHJcbiAgICBwcml2YXRlIHNlYXJjaEJhcjogSFRNTElucHV0RWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBzZWFyY2hDbGVhckJ1dHRvbjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcclxuICAgIHByaXZhdGUgc2VhcmNoTWF0Y2hDb3VudDogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcclxuICAgIHByaXZhdGUgdmFsaWRhdGlvbkVycm9yczogVmFsaWRhdGlvbkVycm9yW10gPSBbXTtcclxuXHJcbiAgICAvLyBUcnVuY2F0aW9uIGxpbWl0c1xyXG4gICAgcHJpdmF0ZSByZWFkb25seSBURUNITklRVUVfVFJVTkNBVEVfTElNSVQgPSAxODA7XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IFNVQlRFQ0hOSVFVRV9UUlVOQ0FURV9MSU1JVCA9IDEwMDtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFdoZXRoZXIgdGhlIHNldmVyaXR5IHJlcHJlc2VudHMgYSBjcml0aWNhbCBlcnJvciAocmVkIGluZGljYXRvcikuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgaXNDcml0aWNhbFNldmVyaXR5KHNldmVyaXR5OiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gc2V2ZXJpdHkgPT09ICd1bmtub3duX3RlY2huaXF1ZSdcclxuICAgICAgICAgICAgfHwgc2V2ZXJpdHkgPT09ICd1bmtub3duX3RhY3RpYydcclxuICAgICAgICAgICAgfHwgc2V2ZXJpdHkgPT09ICdlbXB0eV90YWN0aWMnO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IHRoZSBhcHByb3ByaWF0ZSBpY29uIGZvciBhIHZhbGlkYXRpb24gc2V2ZXJpdHkgbGV2ZWwuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZ2V0U2V2ZXJpdHlJY29uKHNldmVyaXR5OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmlzQ3JpdGljYWxTZXZlcml0eShzZXZlcml0eSkgPyAnXHVEODNEXHVERDM0JyA6ICdcdTI2QTBcdUZFMEYnO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQXBwbHkgdGhlIGFwcHJvcHJpYXRlIENTUyB2YWxpZGF0aW9uIGNsYXNzIGJhc2VkIG9uIHNldmVyaXR5LlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGFwcGx5U2V2ZXJpdHlDbGFzcyhlbGVtZW50OiBIVE1MRWxlbWVudCwgc2V2ZXJpdHk6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLmlzQ3JpdGljYWxTZXZlcml0eShzZXZlcml0eSkpIHtcclxuICAgICAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnbWl0cmUtdGVjaG5pcXVlLWVycm9yJyk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChzZXZlcml0eSA9PT0gJ21pc21hdGNoJykge1xyXG4gICAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdtaXRyZS10ZWNobmlxdWUtd2FybmluZycpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBhbnkpIHtcclxuICAgICAgICBzdXBlcihhcHApO1xyXG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gICAgICAgIHRoaXMudGltZVByb2Nlc3NvciA9IG5ldyBUaW1lVGltZWxpbmVQcm9jZXNzb3IoYXBwLCBwbHVnaW4sIElPQ19UWVBFUyk7XHJcbiAgICAgICAgdGhpcy5sb2FkRGF0YXNldCgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2xlYW4gTUlUUkUgZGVzY3JpcHRpb24gdGV4dCBieSByZW1vdmluZyBtYXJrZG93biBsaW5rcyBhbmQgc3F1YXJlIGJyYWNrZXRzLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBkZXNjcmlwdGlvbiAtIFJhdyBkZXNjcmlwdGlvbiBmcm9tIE1JVFJFIGRhdGFzZXRcclxuICAgICAqIEByZXR1cm5zIENsZWFuZWQgZGVzY3JpcHRpb24gdGV4dFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGNsZWFuRGVzY3JpcHRpb24oZGVzY3JpcHRpb246IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgICAgaWYgKCFkZXNjcmlwdGlvbikgcmV0dXJuICcnO1xyXG5cclxuICAgICAgICBsZXQgY2xlYW5lZCA9IGRlc2NyaXB0aW9uO1xyXG5cclxuICAgICAgICAvLyBSZW1vdmUgbWFya2Rvd24gbGlua3MgW3RleHRdKHVybCkgLSByZW1vdmUgZW50aXJlbHlcclxuICAgICAgICBjbGVhbmVkID0gY2xlYW5lZC5yZXBsYWNlKC9cXFsoW15cXF1dKylcXF1cXChbXildK1xcKS9nLCAnJyk7XHJcblxyXG4gICAgICAgIC8vIFJlbW92ZSBhbGwgc3F1YXJlIGJyYWNrZXRzIGFuZCB0aGVpciBjb250ZW50IFthbnl0aGluZ11cclxuICAgICAgICBjbGVhbmVkID0gY2xlYW5lZC5yZXBsYWNlKC9cXFtbXlxcXV0qXFxdL2csICcnKTtcclxuXHJcbiAgICAgICAgLy8gQ2xlYW4gdXAgbXVsdGlwbGUgc3BhY2VzIGFuZCB0cmltXHJcbiAgICAgICAgY2xlYW5lZCA9IGNsZWFuZWQucmVwbGFjZSgvXFxzKy9nLCAnICcpLnRyaW0oKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGNsZWFuZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUcnVuY2F0ZSBkZXNjcmlwdGlvbiB0byBtYXhpbXVtIGNoYXJhY3RlciBsZW5ndGggd2l0aCBlbGxpcHNpcy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZGVzY3JpcHRpb24gLSBDbGVhbmVkIGRlc2NyaXB0aW9uIHRleHRcclxuICAgICAqIEBwYXJhbSBtYXhDaGFycyAtIE1heGltdW0gY2hhcmFjdGVycyAoZGVmYXVsdDogMTgwKVxyXG4gICAgICogQHJldHVybnMgVHJ1bmNhdGVkIGRlc2NyaXB0aW9uIHdpdGggXCIuLi5cIiBpZiBuZWVkZWRcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSB0cnVuY2F0ZURlc2NyaXB0aW9uKGRlc2NyaXB0aW9uOiBzdHJpbmcsIG1heENoYXJzOiBudW1iZXIgPSAxODApOiBzdHJpbmcge1xyXG4gICAgICAgIGlmICghZGVzY3JpcHRpb24gfHwgZGVzY3JpcHRpb24ubGVuZ3RoIDw9IG1heENoYXJzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkZXNjcmlwdGlvbjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFRydW5jYXRlIGF0IGxhc3Qgc3BhY2UgYmVmb3JlIG1heENoYXJzIHRvIGF2b2lkIGN1dHRpbmcgd29yZHNcclxuICAgICAgICBjb25zdCB0cnVuY2F0ZWQgPSBkZXNjcmlwdGlvbi5zdWJzdHJpbmcoMCwgbWF4Q2hhcnMpO1xyXG4gICAgICAgIGNvbnN0IGxhc3RTcGFjZSA9IHRydW5jYXRlZC5sYXN0SW5kZXhPZignICcpO1xyXG5cclxuICAgICAgICBpZiAobGFzdFNwYWNlID4gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1bmNhdGVkLnN1YnN0cmluZygwLCBsYXN0U3BhY2UpICsgJy4uLic7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdHJ1bmNhdGVkICsgJy4uLic7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUb2dnbGUgZXhwYW5zaW9uIChleHBhbmQvY29sbGFwc2UpIGZvciB0ZWNobmlxdWVzIG9yIHN1YnRlY2huaXF1ZXMuXHJcbiAgICAgKiBIYW5kbGVzIGRlc2NyaXB0aW9uIHN3YXAgYW5kIG9wdGlvbmFsIHN1YnRlY2huaXF1ZXMgcmVuZGVyaW5nLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBlbGVtZW50IC0gVGhlIHRlY2huaXF1ZS9zdWJ0ZWNobmlxdWUgRE9NIGVsZW1lbnRcclxuICAgICAqIEBwYXJhbSBzdWJ0ZWNobmlxdWVzIC0gU3VidGVjaG5pcXVlcyB0byByZW5kZXIgKG9ubHkgZm9yIHBhcmVudCB0ZWNobmlxdWVzKVxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHRvZ2dsZUV4cGFuc2lvbihcclxuICAgICAgICBlbGVtZW50OiBIVE1MRWxlbWVudCxcclxuICAgICAgICBzdWJ0ZWNobmlxdWVzPzogTWl0cmVUZWNobmlxdWVbXVxyXG4gICAgKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgaXNDb2xsYXBzZWQgPSBlbGVtZW50Lmhhc0NsYXNzKCdjb2xsYXBzZWQnKTtcclxuICAgICAgICBjb25zdCBleHBhbmRJY29uID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubWl0cmUtZXhwYW5kLWljb24nKSBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgICBjb25zdCBkZXNjRWwgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5taXRyZS10ZWNobmlxdWUtZGVzY3JpcHRpb24nKSBhcyBIVE1MRWxlbWVudDtcclxuXHJcbiAgICAgICAgaWYgKGlzQ29sbGFwc2VkKSB7XHJcbiAgICAgICAgICAgIC8vIEVYUEFORFxyXG4gICAgICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdjb2xsYXBzZWQnKTtcclxuICAgICAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnZXhwYW5kZWQnKTtcclxuICAgICAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtaXMtZXhwYW5kZWQnLCAndHJ1ZScpO1xyXG4gICAgICAgICAgICBpZiAoZXhwYW5kSWNvbikgZXhwYW5kSWNvbi5zZXRUZXh0KCdcdTI1QkMnKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlbmRlciBzdWJ0ZWNobmlxdWVzIGlmIHByb3ZpZGVkIChvbmx5IGZvciBwYXJlbnQgdGVjaG5pcXVlcylcclxuICAgICAgICAgICAgaWYgKHN1YnRlY2huaXF1ZXMgJiYgc3VidGVjaG5pcXVlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclN1YnRlY2huaXF1ZXMoZWxlbWVudCwgc3VidGVjaG5pcXVlcywgdGhpcy5jdXJyZW50U2VhcmNoU3RhdGUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBTaG93IGZ1bGwgZGVzY3JpcHRpb25cclxuICAgICAgICAgICAgaWYgKGRlc2NFbCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZnVsbERlc2MgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1mdWxsLWRlc2NyaXB0aW9uJyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZnVsbERlc2MpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZXNjRWwudGV4dENvbnRlbnQgPSBmdWxsRGVzYztcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50U2VhcmNoU3RhdGU/LmlzQWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGlnaGxpZ2h0TWF0Y2hlcyhkZXNjRWwsIGZ1bGxEZXNjLCB0aGlzLmN1cnJlbnRTZWFyY2hTdGF0ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gQ09MTEFQU0VcclxuICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcygnZXhwYW5kZWQnKTtcclxuICAgICAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnY29sbGFwc2VkJyk7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLWlzLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XHJcbiAgICAgICAgICAgIGlmIChleHBhbmRJY29uKSBleHBhbmRJY29uLnNldFRleHQoJ1x1MjVCNicpO1xyXG5cclxuICAgICAgICAgICAgLy8gUmVtb3ZlIHN1YnRlY2huaXF1ZXMgY29udGFpbmVyIGlmIHByZXNlbnRcclxuICAgICAgICAgICAgZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubWl0cmUtc3VidGVjaG5pcXVlcy1jb250YWluZXInKT8ucmVtb3ZlKCk7XHJcblxyXG4gICAgICAgICAgICAvLyBTaG93IHRydW5jYXRlZCBkZXNjcmlwdGlvblxyXG4gICAgICAgICAgICBpZiAoZGVzY0VsKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBmdWxsRGVzYyA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLWZ1bGwtZGVzY3JpcHRpb24nKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRydW5jYXRlZERlc2MgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS10cnVuY2F0ZWQtZGVzY3JpcHRpb24nKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRpc3BsYXlUZXh0ID0gdHJ1bmNhdGVkRGVzYyB8fCAoZnVsbERlc2MgPyB0aGlzLnRydW5jYXRlRGVzY3JpcHRpb24oZnVsbERlc2MpIDogbnVsbCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGlzcGxheVRleHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZXNjRWwudGV4dENvbnRlbnQgPSBkaXNwbGF5VGV4dDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50U2VhcmNoU3RhdGU/LmlzQWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGlnaGxpZ2h0TWF0Y2hlcyhkZXNjRWwsIGRpc3BsYXlUZXh0LCB0aGlzLmN1cnJlbnRTZWFyY2hTdGF0ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogTG9hZCBNSVRSRSBkYXRhc2V0IGFzeW5jaHJvbm91c2x5XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgYXN5bmMgbG9hZERhdGFzZXQoKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgdGhpcy5taXRyZURhdGFzZXQgPSBhd2FpdCBsb2FkTWl0cmVEYXRhc2V0KHRoaXMuYXBwKTtcclxuICAgICAgICAgICAgY29uc29sZS5kZWJ1ZygnW01pdHJlTW9kYWxdIERhdGFzZXQgbG9hZGVkOicsIHRoaXMubWl0cmVEYXRhc2V0LnZlcnNpb24sICctIFRlY2huaXF1ZXM6JywgT2JqZWN0LmtleXModGhpcy5taXRyZURhdGFzZXQudGVjaG5pcXVlcykubGVuZ3RoKTtcclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignW01pdHJlTW9kYWxdIEZhaWxlZCB0byBsb2FkIGRhdGFzZXQ6JywgZXJyKTtcclxuICAgICAgICAgICAgdGhpcy5taXRyZURhdGFzZXQgPSBudWxsO1xyXG4gICAgICAgICAgICAvLyBFcnJvciB3aWxsIGJlIGRpc3BsYXllZCBpbiByZW5kZXJNaXRyZU1hcHBpbmcgd2hlbiBkYXRhc2V0IGlzIG51bGxcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25PcGVuKCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnNvbGUuZGVidWcoJ1tNaXRyZU1vZGFsXSA9PT09PSBNT0RBTCBPUEVORUQgPT09PT0nKTtcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgICB0aGlzLm1vZGFsRWwuY2xhc3NMaXN0LmFkZCgnbWl0cmUtbW9kYWwtZnVsbHNjcmVlbicpO1xyXG5cclxuICAgICAgICAvLyBBZGQgcmVzaXplIGZ1bmN0aW9uYWxpdHlcclxuICAgICAgICB0aGlzLm1ha2VSZXNpemFibGUoKTtcclxuXHJcbiAgICAgICAgY29uc3QgaGVhZGVyQ29udGFpbmVyID0gY29udGVudEVsLmNyZWF0ZURpdignbWl0cmUtbW9kYWwtaGVhZGVyJyk7XHJcblxyXG4gICAgICAgIGNvbnN0IHRpdGxlUm93ID0gaGVhZGVyQ29udGFpbmVyLmNyZWF0ZURpdignbWl0cmUtdGl0bGUtcm93Jyk7XHJcbiAgICAgICAgdGl0bGVSb3cuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnXHVEODNDXHVERkFGIE1JVFJFIEFUVCZDSyBUZWNobmlxdWUgTWFwcGVyJyB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgZXhwb3J0QnRuID0gdGl0bGVSb3cuY3JlYXRlRWwoJ2J1dHRvbicsIHtcclxuICAgICAgICAgICAgdGV4dDogJ0V4cG9ydCB0byBOYXZpZ2F0b3InLFxyXG4gICAgICAgICAgICBjbHM6ICdtaXRyZS1leHBvcnQtYnV0dG9uJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGV4cG9ydEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuZXhwb3J0VG9OYXZpZ2F0b3IoKSk7XHJcblxyXG4gICAgICAgIC8vIFJlbmRlciBzZWFyY2ggYmFyXHJcbiAgICAgICAgdGhpcy5yZW5kZXJTZWFyY2hCYXIoaGVhZGVyQ29udGFpbmVyKTtcclxuXHJcbiAgICAgICAgY29uc3Qgc3RhdHNDb250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRGl2KCdtaXRyZS1zdGF0cycpO1xyXG4gICAgICAgIGNvbnN0IGNvbnRlbnRBcmVhID0gY29udGVudEVsLmNyZWF0ZURpdignbWl0cmUtY29udGVudC1hcmVhJyk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJNaXRyZU1hcHBpbmcoY29udGVudEFyZWEsIHN0YXRzQ29udGFpbmVyKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlbmRlciBzZWFyY2ggYmFyIGluIG1vZGFsIGhlYWRlci5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gaGVhZGVyQ29udGFpbmVyIC0gSGVhZGVyIGNvbnRhaW5lciBlbGVtZW50XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgcmVuZGVyU2VhcmNoQmFyKGhlYWRlckNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBzZWFyY2hDb250YWluZXIgPSBoZWFkZXJDb250YWluZXIuY3JlYXRlRGl2KCdtaXRyZS1zZWFyY2gtY29udGFpbmVyJyk7XHJcblxyXG4gICAgICAgIGNvbnN0IHNlYXJjaElucHV0ID0gc2VhcmNoQ29udGFpbmVyLmNyZWF0ZUVsKCdpbnB1dCcsIHtcclxuICAgICAgICAgICAgdHlwZTogJ3RleHQnLFxyXG4gICAgICAgICAgICBwbGFjZWhvbGRlcjogJ1NlYXJjaCB0ZWNobmlxdWVzICh1c2UgXCJxdW90ZXNcIiBmb3IgZXhhY3QgcGhyYXNlcykuLi4nLFxyXG4gICAgICAgICAgICBjbHM6ICdtaXRyZS1zZWFyY2gtaW5wdXQnXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IGNsZWFyQnV0dG9uID0gc2VhcmNoQ29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7XHJcbiAgICAgICAgICAgIHRleHQ6ICdcdTI3MTUnLFxyXG4gICAgICAgICAgICBjbHM6ICdtaXRyZS1zZWFyY2gtY2xlYXInLFxyXG4gICAgICAgICAgICBhdHRyOiB7ICdhcmlhLWxhYmVsJzogJ0NsZWFyIHNlYXJjaCcgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNsZWFyQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcblxyXG4gICAgICAgIGNvbnN0IG1hdGNoQ291bnQgPSBzZWFyY2hDb250YWluZXIuY3JlYXRlRGl2KCdtaXRyZS1zZWFyY2gtbWF0Y2gtY291bnQnKTtcclxuICAgICAgICBtYXRjaENvdW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcblxyXG4gICAgICAgIHRoaXMuc2VhcmNoQmFyID0gc2VhcmNoSW5wdXQ7XHJcbiAgICAgICAgdGhpcy5zZWFyY2hDbGVhckJ1dHRvbiA9IGNsZWFyQnV0dG9uO1xyXG4gICAgICAgIHRoaXMuc2VhcmNoTWF0Y2hDb3VudCA9IG1hdGNoQ291bnQ7XHJcblxyXG4gICAgICAgIC8vIERlYm91bmNlZCBzZWFyY2ggaGFuZGxlclxyXG4gICAgICAgIGxldCBkZWJvdW5jZVRpbWVyOiBudW1iZXIgfCBudWxsID0gbnVsbDtcclxuICAgICAgICBzZWFyY2hJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcclxuICAgICAgICAgICAgaWYgKGRlYm91bmNlVGltZXIgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChkZWJvdW5jZVRpbWVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBkZWJvdW5jZVRpbWVyID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVTZWFyY2hJbnB1dChzZWFyY2hJbnB1dC52YWx1ZSk7XHJcbiAgICAgICAgICAgIH0sIDMwMCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNsZWFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBzZWFyY2hJbnB1dC52YWx1ZSA9ICcnO1xyXG4gICAgICAgICAgICB0aGlzLmhhbmRsZVNlYXJjaElucHV0KCcnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgc2VhcmNoSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHtcclxuICAgICAgICAgICAgICAgIHNlYXJjaElucHV0LnZhbHVlID0gJyc7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZVNlYXJjaElucHV0KCcnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSGFuZGxlIHNlYXJjaCBpbnB1dCBjaGFuZ2VzIGFuZCByZS1yZW5kZXIgY29udGVudC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gcXVlcnkgLSBTZWFyY2ggcXVlcnkgc3RyaW5nXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgaGFuZGxlU2VhcmNoSW5wdXQocXVlcnk6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IHNlYXJjaFN0YXRlID0gdGhpcy5wYXJzZVNlYXJjaFF1ZXJ5KHF1ZXJ5KTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRTZWFyY2hTdGF0ZSA9IHNlYXJjaFN0YXRlO1xyXG5cclxuICAgICAgICBjb25zb2xlLmRlYnVnKCdbTWl0cmVNb2RhbF0gU2VhcmNoIHF1ZXJ5OicsIHF1ZXJ5LCAnLSBQYXJzZWQ6Jywgc2VhcmNoU3RhdGUpO1xyXG5cclxuICAgICAgICAvLyBVcGRhdGUgY2xlYXIgYnV0dG9uIHZpc2liaWxpdHlcclxuICAgICAgICBpZiAodGhpcy5zZWFyY2hDbGVhckJ1dHRvbikge1xyXG4gICAgICAgICAgICB0aGlzLnNlYXJjaENsZWFyQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSBzZWFyY2hTdGF0ZS5pc0FjdGl2ZSA/ICdibG9jaycgOiAnbm9uZSc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBSZS1yZW5kZXIgY29udGVudCBhcmVhIHdpdGggc2VhcmNoIGZpbHRlclxyXG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMubW9kYWxFbC5xdWVyeVNlbGVjdG9yKCcubWl0cmUtY29udGVudC1hcmVhJykgYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICAgICAgaWYgKGNvbnRhaW5lciAmJiB0aGlzLmN1cnJlbnRUYWN0aWNzKSB7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lci5lbXB0eSgpO1xyXG5cclxuICAgICAgICAgICAgbGV0IG1hdGNoQ291bnQgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRUYWN0aWNzLmZvckVhY2godGFjdGljID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIEZpbHRlciB0ZWNobmlxdWVzIGJ5IHNlYXJjaFxyXG4gICAgICAgICAgICAgICAgY29uc3QgbWF0Y2hpbmdUZWNobmlxdWVzID0gdGFjdGljLnRlY2huaXF1ZXMuZmlsdGVyKHRlY2ggPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghc2VhcmNoU3RhdGUuaXNBY3RpdmUpIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gdGhpcy5tYXRjaGVzU2VhcmNoKHRlY2gsIHNlYXJjaFN0YXRlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobWF0Y2gubWF0Y2hlZCkgbWF0Y2hDb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtYXRjaC5tYXRjaGVkO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gT25seSByZW5kZXIgdGFjdGljIGlmIGl0IGhhcyBtYXRjaGluZyB0ZWNobmlxdWVzXHJcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2hpbmdUZWNobmlxdWVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWx0ZXJlZFRhY3RpYyA9IHsgLi4udGFjdGljLCB0ZWNobmlxdWVzOiBtYXRjaGluZ1RlY2huaXF1ZXMgfTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclRhY3RpY1NlY3Rpb24oY29udGFpbmVyLCBmaWx0ZXJlZFRhY3RpYywgc2VhcmNoU3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBtYXRjaCBjb3VudCBkaXNwbGF5XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNlYXJjaE1hdGNoQ291bnQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChzZWFyY2hTdGF0ZS5pc0FjdGl2ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoTWF0Y2hDb3VudC50ZXh0Q29udGVudCA9IGAke21hdGNoQ291bnR9IHRlY2huaXF1ZSR7bWF0Y2hDb3VudCAhPT0gMSA/ICdzJyA6ICcnfSBmb3VuZGA7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWFyY2hNYXRjaENvdW50LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaE1hdGNoQ291bnQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gU2hvdyBcIm5vIHJlc3VsdHNcIiBtZXNzYWdlIGlmIG5vIG1hdGNoZXNcclxuICAgICAgICAgICAgaWYgKG1hdGNoQ291bnQgPT09IDAgJiYgc2VhcmNoU3RhdGUuaXNBY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRhaW5lci5jcmVhdGVEaXYoe1xyXG4gICAgICAgICAgICAgICAgICAgIGNsczogJ21pdHJlLW5vLXJlc3VsdHMnLFxyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdObyB0ZWNobmlxdWVzIG1hdGNoIHlvdXIgc2VhcmNoJ1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBhc3luYyByZW5kZXJNaXRyZU1hcHBpbmcoY29udGFpbmVyOiBIVE1MRWxlbWVudCwgc3RhdHNDb250YWluZXI6IEhUTUxFbGVtZW50KTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICAgICAgY29uc29sZS5kZWJ1ZygnW01pdHJlTW9kYWxdID09PT09IFNUQVJUSU5HIERBVEEgRVhUUkFDVElPTiA9PT09PScpO1xyXG4gICAgICAgIC8vIEV4dHJhY3QgSU9DIGRhdGFcclxuICAgICAgICBjb25zdCBpb2NEYXRhID0gdGhpcy50aW1lUHJvY2Vzc29yLmV4dHJhY3RGaXhlZElPQ0RhdGEoKTtcclxuICAgICAgICBjb25zb2xlLmRlYnVnKCdbTWl0cmVNb2RhbF0gRXh0cmFjdGVkIElPQyBjb3VudDonLCBpb2NEYXRhLmxlbmd0aCk7XHJcblxyXG4gICAgICAgIGlmIChpb2NEYXRhLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICBjb250YWluZXIuY3JlYXRlRWwoJ3AnLCB7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OiAnTm8gSU9DIGNhcmRzIGZvdW5kIGluIHRoZSBjdXJyZW50IGNhbnZhcy4nLFxyXG4gICAgICAgICAgICAgICAgY2xzOiAnbWl0cmUtZW1wdHktbWVzc2FnZSdcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEFnZ3JlZ2F0ZSB0YWN0aWNzIGFuZCB0ZWNobmlxdWVzIChhc3luYyBub3cpXHJcbiAgICAgICAgY29uc3QgdGFjdGljcyA9IGF3YWl0IHRoaXMuYWdncmVnYXRlVGFjdGljc1RlY2huaXF1ZXMoaW9jRGF0YSk7XHJcbiAgICAgICAgY29uc29sZS5kZWJ1ZygnW01pdHJlTW9kYWxdID09PT09IEFHR1JFR0FUSU9OIENPTVBMRVRFID09PT09Jyk7XHJcbiAgICAgICAgY29uc29sZS5kZWJ1ZygnW01pdHJlTW9kYWxdIFRhY3RpY3M6JywgdGFjdGljcy5sZW5ndGgpO1xyXG5cclxuICAgICAgICAvLyBTaG93IGVycm9yIGlmIGRhdGFzZXQgY291bGRuJ3QgYmUgbG9hZGVkXHJcbiAgICAgICAgaWYgKCF0aGlzLm1pdHJlRGF0YXNldCkge1xyXG4gICAgICAgICAgICBjb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHtcclxuICAgICAgICAgICAgICAgIGNsczogJ21pdHJlLWVycm9yLW1lc3NhZ2UnLFxyXG4gICAgICAgICAgICAgICAgdGV4dDogJ1x1Mjc0QyBNSVRSRSBBVFQmQ0sgZGF0YXNldCBjb3VsZCBub3QgYmUgbG9hZGVkLidcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lci5jcmVhdGVFbCgncCcsIHtcclxuICAgICAgICAgICAgICAgIHRleHQ6ICdQbGVhc2UgZW5zdXJlIGVudGVycHJpc2UtYXR0YWNrLmpzb24gZXhpc3RzIGluIHRoZSBNSVRSRSBmb2xkZXIuJ1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29udGFpbmVyLmNyZWF0ZUVsKCdhJywge1xyXG4gICAgICAgICAgICAgICAgdGV4dDogJ0Rvd25sb2FkIGRhdGFzZXQgZnJvbSBNSVRSRScsXHJcbiAgICAgICAgICAgICAgICBhdHRyOiB7IGhyZWY6ICdodHRwczovL2dpdGh1Yi5jb20vbWl0cmUtYXR0YWNrL2F0dGFjay1zdGl4LWRhdGEnLCB0YXJnZXQ6ICdfYmxhbmsnIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0YWN0aWNzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICBjb250YWluZXIuY3JlYXRlRWwoJ3AnLCB7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OiAnTm8gTUlUUkUgdGFjdGljcyBvciB0ZWNobmlxdWVzIGZvdW5kIGluIElPQyBjYXJkcy4gQWRkIFwiTWl0cmUgVGFjdGljXCIgYW5kIFwiTWl0cmUgVGVjaG5pcXVlXCIgZmllbGRzIHRvIHlvdXIgY2FyZHMuJyxcclxuICAgICAgICAgICAgICAgIGNsczogJ21pdHJlLWVtcHR5LW1lc3NhZ2UnXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBTdW1tYXJ5IHN0YXRzIHdpdGggY292ZXJhZ2UgKHJlbmRlciBpbnRvIHBhc3NlZCBzdGF0c0NvbnRhaW5lcilcclxuXHJcbiAgICAgICAgY29uc3QgdG90YWxUZWNobmlxdWVzID0gdGFjdGljcy5yZWR1Y2UoKHN1bSwgdCkgPT4gc3VtICsgdC50ZWNobmlxdWVzLmxlbmd0aCwgMCk7XHJcbiAgICAgICAgY29uc3QgZm91bmRUZWNobmlxdWVzID0gdGFjdGljcy5yZWR1Y2UoKHN1bSwgdCkgPT4gc3VtICsgdC50ZWNobmlxdWVzLmZpbHRlcih0ZWNoID0+IHRlY2guaXNGb3VuZCkubGVuZ3RoLCAwKTtcclxuICAgICAgICBjb25zdCBjb3ZlcmFnZVBlcmNlbnQgPSB0b3RhbFRlY2huaXF1ZXMgPiAwID8gTWF0aC5yb3VuZCgoZm91bmRUZWNobmlxdWVzIC8gdG90YWxUZWNobmlxdWVzKSAqIDEwMCkgOiAwO1xyXG5cclxuICAgICAgICBzdGF0c0NvbnRhaW5lci5jcmVhdGVFbCgnZGl2Jywge1xyXG4gICAgICAgICAgICB0ZXh0OiBgXHVEODNEXHVEQ0NBIENvdmVyYWdlOiAke2ZvdW5kVGVjaG5pcXVlc30vJHt0b3RhbFRlY2huaXF1ZXN9IHRlY2huaXF1ZXMgKCR7Y292ZXJhZ2VQZXJjZW50fSUpYCxcclxuICAgICAgICAgICAgY2xzOiAnbWl0cmUtc3RhdC1pdGVtJ1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBhY3RpdmVUYWN0aWNzID0gdGFjdGljcy5maWx0ZXIodCA9PiB0LnRlY2huaXF1ZXMuc29tZSh0ZWNoID0+IHRlY2guaXNGb3VuZCkpLmxlbmd0aDtcclxuICAgICAgICBzdGF0c0NvbnRhaW5lci5jcmVhdGVFbCgnZGl2Jywge1xyXG4gICAgICAgICAgICB0ZXh0OiBgXHUyNjk0XHVGRTBGIFRhY3RpY3M6ICR7YWN0aXZlVGFjdGljc30vJHt0YWN0aWNzLmxlbmd0aH0gYWN0aXZlYCxcclxuICAgICAgICAgICAgY2xzOiAnbWl0cmUtc3RhdC1pdGVtJ1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBzdGF0c0NvbnRhaW5lci5jcmVhdGVFbCgnZGl2Jywge1xyXG4gICAgICAgICAgICB0ZXh0OiBgXHVEODNEXHVEQ0M3IElPQyBDYXJkczogJHtpb2NEYXRhLmxlbmd0aH0gdG90YWxgLFxyXG4gICAgICAgICAgICBjbHM6ICdtaXRyZS1zdGF0LWl0ZW0nXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFN0b3JlIHRhY3RpY3MgZm9yIHNlYXJjaCBmaWx0ZXJpbmdcclxuICAgICAgICB0aGlzLmN1cnJlbnRUYWN0aWNzID0gdGFjdGljcztcclxuXHJcbiAgICAgICAgLy8gUmVuZGVyIHZhbGlkYXRpb24gZXJyb3JzIHNlY3Rpb24gaWYgYW55IGV4aXN0XHJcbiAgICAgICAgdGhpcy5yZW5kZXJWYWxpZGF0aW9uRXJyb3JzKGNvbnRhaW5lcik7XHJcblxyXG4gICAgICAgIC8vIFJlbmRlciB0YWN0aWNzIGFzIGNvbHVtbnNcclxuICAgICAgICB0YWN0aWNzLmZvckVhY2godGFjdGljID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJUYWN0aWNTZWN0aW9uKGNvbnRhaW5lciwgdGFjdGljLCB0aGlzLmN1cnJlbnRTZWFyY2hTdGF0ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW5kZXIgdmFsaWRhdGlvbiBlcnJvcnMgc2VjdGlvbiB3aXRoIGNhcmQgcmVmZXJlbmNlcy5cclxuICAgICAqIEdyb3VwcyBlcnJvcnMgYnkgdHlwZSAoVGFjdGljIEVycm9ycywgVGVjaG5pcXVlIEVycm9ycywgVmFsaWRhdGlvbiBNaXNtYXRjaGVzKS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gY29udGFpbmVyIC0gQ29udGFpbmVyIGVsZW1lbnQgZm9yIGVycm9yIHNlY3Rpb25cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSByZW5kZXJWYWxpZGF0aW9uRXJyb3JzKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy52YWxpZGF0aW9uRXJyb3JzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm47IC8vIE5vIGVycm9ycyB0byBkaXNwbGF5XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zb2xlLmRlYnVnKCdbTWl0cmVNb2RhbF0gUmVuZGVyaW5nJywgdGhpcy52YWxpZGF0aW9uRXJyb3JzLmxlbmd0aCwgJ3ZhbGlkYXRpb24gZXJyb3JzJyk7XHJcblxyXG4gICAgICAgIC8vIEdyb3VwIGVycm9ycyBieSB0eXBlXHJcbiAgICAgICAgY29uc3QgZW1wdHlUYWN0aWNFcnJvcnMgPSB0aGlzLnZhbGlkYXRpb25FcnJvcnMuZmlsdGVyKGUgPT4gZS5zZXZlcml0eSA9PT0gJ2VtcHR5X3RhY3RpYycpO1xyXG4gICAgICAgIGNvbnN0IHRhY3RpY0Vycm9ycyA9IHRoaXMudmFsaWRhdGlvbkVycm9ycy5maWx0ZXIoZSA9PiBlLnNldmVyaXR5ID09PSAndW5rbm93bl90YWN0aWMnKTtcclxuICAgICAgICBjb25zdCB0ZWNobmlxdWVFcnJvcnMgPSB0aGlzLnZhbGlkYXRpb25FcnJvcnMuZmlsdGVyKGUgPT4gZS5zZXZlcml0eSA9PT0gJ3Vua25vd25fdGVjaG5pcXVlJyk7XHJcbiAgICAgICAgY29uc3QgbWlzbWF0Y2hFcnJvcnMgPSB0aGlzLnZhbGlkYXRpb25FcnJvcnMuZmlsdGVyKGUgPT4gZS5zZXZlcml0eSA9PT0gJ21pc21hdGNoJyk7XHJcblxyXG4gICAgICAgIGNvbnN0IGVycm9yU2VjdGlvbiA9IGNvbnRhaW5lci5jcmVhdGVEaXYoJ21pdHJlLXZhbGlkYXRpb24tZXJyb3JzJyk7XHJcblxyXG4gICAgICAgIC8vIEhlYWRlciB3aXRoIHRvdGFsIGNvdW50XHJcbiAgICAgICAgY29uc3QgaGVhZGVyID0gZXJyb3JTZWN0aW9uLmNyZWF0ZURpdignbWl0cmUtZXJyb3JzLWhlYWRlcicpO1xyXG4gICAgICAgIGhlYWRlci5jcmVhdGVFbCgnaDMnLCB7XHJcbiAgICAgICAgICAgIHRleHQ6IGBcdTI2QTBcdUZFMEYgVmFsaWRhdGlvbiBJc3N1ZXMgKCR7dGhpcy52YWxpZGF0aW9uRXJyb3JzLmxlbmd0aH0pYFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBDb2xsYXBzaWJsZSB0b2dnbGVcclxuICAgICAgICBjb25zdCB0b2dnbGVCdG4gPSBoZWFkZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHtcclxuICAgICAgICAgICAgdGV4dDogJ0hpZGUnLFxyXG4gICAgICAgICAgICBjbHM6ICdtaXRyZS1lcnJvcnMtdG9nZ2xlJ1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBlcnJvcnNMaXN0ID0gZXJyb3JTZWN0aW9uLmNyZWF0ZURpdignbWl0cmUtZXJyb3JzLWxpc3QnKTtcclxuICAgICAgICBlcnJvclNlY3Rpb24uYWRkQ2xhc3MoJ2V4cGFuZGVkJyk7XHJcblxyXG4gICAgICAgIC8vIFRvZ2dsZSBjb2xsYXBzZS9leHBhbmRcclxuICAgICAgICB0b2dnbGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlcnJvclNlY3Rpb24uaGFzQ2xhc3MoJ2V4cGFuZGVkJykpIHtcclxuICAgICAgICAgICAgICAgIGVycm9yU2VjdGlvbi5yZW1vdmVDbGFzcygnZXhwYW5kZWQnKTtcclxuICAgICAgICAgICAgICAgIGVycm9yU2VjdGlvbi5hZGRDbGFzcygnY29sbGFwc2VkJyk7XHJcbiAgICAgICAgICAgICAgICB0b2dnbGVCdG4uc2V0VGV4dCgnU2hvdycpO1xyXG4gICAgICAgICAgICAgICAgZXJyb3JzTGlzdC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZXJyb3JTZWN0aW9uLnJlbW92ZUNsYXNzKCdjb2xsYXBzZWQnKTtcclxuICAgICAgICAgICAgICAgIGVycm9yU2VjdGlvbi5hZGRDbGFzcygnZXhwYW5kZWQnKTtcclxuICAgICAgICAgICAgICAgIHRvZ2dsZUJ0bi5zZXRUZXh0KCdIaWRlJyk7XHJcbiAgICAgICAgICAgICAgICBlcnJvcnNMaXN0LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFJlbmRlciBlYWNoIGVycm9yIGNhdGVnb3J5IHdpdGggaXRzIG93biBzZWN0aW9uIChlbXB0eV90YWN0aWMgYmVmb3JlIHVua25vd25fdGFjdGljKVxyXG4gICAgICAgIGlmIChlbXB0eVRhY3RpY0Vycm9ycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyRXJyb3JDYXRlZ29yeShlcnJvcnNMaXN0LCAnTWlzc2luZyBUYWN0aWMnLCBlbXB0eVRhY3RpY0Vycm9ycywgJ1x1RDgzRFx1REQzNCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRhY3RpY0Vycm9ycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyRXJyb3JDYXRlZ29yeShlcnJvcnNMaXN0LCAnVW5rbm93biBUYWN0aWMnLCB0YWN0aWNFcnJvcnMsICdcdUQ4M0RcdUREMzQnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0ZWNobmlxdWVFcnJvcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlckVycm9yQ2F0ZWdvcnkoZXJyb3JzTGlzdCwgJ1RlY2huaXF1ZSBFcnJvcnMnLCB0ZWNobmlxdWVFcnJvcnMsICdcdUQ4M0RcdUREMzQnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChtaXNtYXRjaEVycm9ycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyRXJyb3JDYXRlZ29yeShlcnJvcnNMaXN0LCAnVmFsaWRhdGlvbiBNaXNtYXRjaGVzJywgbWlzbWF0Y2hFcnJvcnMsICdcdTI2QTBcdUZFMEYnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW5kZXIgYSBjYXRlZ29yeSBvZiB2YWxpZGF0aW9uIGVycm9ycyB3aXRoIGhlYWRlciBhbmQgaXRlbXMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGNvbnRhaW5lciAtIFBhcmVudCBjb250YWluZXIgZWxlbWVudFxyXG4gICAgICogQHBhcmFtIGNhdGVnb3J5VGl0bGUgLSBEaXNwbGF5IHRpdGxlIGZvciB0aGlzIGVycm9yIGNhdGVnb3J5XHJcbiAgICAgKiBAcGFyYW0gZXJyb3JzIC0gQXJyYXkgb2YgZXJyb3JzIGluIHRoaXMgY2F0ZWdvcnlcclxuICAgICAqIEBwYXJhbSBpY29uIC0gSWNvbiB0byB1c2UgZm9yIHRoaXMgY2F0ZWdvcnlcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSByZW5kZXJFcnJvckNhdGVnb3J5KFxyXG4gICAgICAgIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsXHJcbiAgICAgICAgY2F0ZWdvcnlUaXRsZTogc3RyaW5nLFxyXG4gICAgICAgIGVycm9yczogVmFsaWRhdGlvbkVycm9yW10sXHJcbiAgICAgICAgaWNvbjogc3RyaW5nXHJcbiAgICApOiB2b2lkIHtcclxuICAgICAgICAvLyBDYXRlZ29yeSBoZWFkZXJcclxuICAgICAgICBjb25zdCBjYXRlZ29yeVNlY3Rpb24gPSBjb250YWluZXIuY3JlYXRlRGl2KCdtaXRyZS1lcnJvci1jYXRlZ29yeScpO1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3J5SGVhZGVyID0gY2F0ZWdvcnlTZWN0aW9uLmNyZWF0ZURpdignbWl0cmUtZXJyb3ItY2F0ZWdvcnktaGVhZGVyJyk7XHJcbiAgICAgICAgY2F0ZWdvcnlIZWFkZXIuY3JlYXRlRWwoJ2g0Jywge1xyXG4gICAgICAgICAgICB0ZXh0OiBgJHtpY29ufSAke2NhdGVnb3J5VGl0bGV9ICgke2Vycm9ycy5sZW5ndGh9KWBcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gUmVuZGVyIGVhY2ggZXJyb3IgaW4gdGhpcyBjYXRlZ29yeVxyXG4gICAgICAgIGVycm9ycy5mb3JFYWNoKGVycm9yID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZXJyb3JJdGVtID0gY2F0ZWdvcnlTZWN0aW9uLmNyZWF0ZURpdignbWl0cmUtZXJyb3ItaXRlbScpO1xyXG5cclxuICAgICAgICAgICAgLy8gQXBwbHkgc2V2ZXJpdHkgc3R5bGluZ1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pc0NyaXRpY2FsU2V2ZXJpdHkoZXJyb3Iuc2V2ZXJpdHkpKSB7XHJcbiAgICAgICAgICAgICAgICBlcnJvckl0ZW0uYWRkQ2xhc3MoJ21pdHJlLWVycm9yLWNyaXRpY2FsJyk7ICAvLyBSZWRcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvci5zZXZlcml0eSA9PT0gJ21pc21hdGNoJykge1xyXG4gICAgICAgICAgICAgICAgZXJyb3JJdGVtLmFkZENsYXNzKCdtaXRyZS1lcnJvci13YXJuaW5nJyk7ICAgLy8gT3JhbmdlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIEVycm9yIGhlYWRlciB3aXRoIHRlY2huaXF1ZSBJRCBhbmQgbmFtZVxyXG4gICAgICAgICAgICBjb25zdCBlcnJvckhlYWRlciA9IGVycm9ySXRlbS5jcmVhdGVEaXYoJ21pdHJlLWVycm9yLWhlYWRlcicpO1xyXG4gICAgICAgICAgICBlcnJvckhlYWRlci5jcmVhdGVFbCgnc3BhbicsIHtcclxuICAgICAgICAgICAgICAgIHRleHQ6IGVycm9yLnRlY2huaXF1ZUlkLFxyXG4gICAgICAgICAgICAgICAgY2xzOiAnbWl0cmUtZXJyb3ItdGVjaG5pcXVlLWlkJ1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgZXJyb3JIZWFkZXIuY3JlYXRlRWwoJ3NwYW4nLCB7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OiBlcnJvci50ZWNobmlxdWVOYW1lLFxyXG4gICAgICAgICAgICAgICAgY2xzOiAnbWl0cmUtZXJyb3ItdGVjaG5pcXVlLW5hbWUnXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gRXJyb3IgbWVzc2FnZVxyXG4gICAgICAgICAgICBlcnJvckl0ZW0uY3JlYXRlRGl2KHtcclxuICAgICAgICAgICAgICAgIHRleHQ6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICAgICAgICAgICAgICBjbHM6ICdtaXRyZS1lcnJvci1tZXNzYWdlJ1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIENhcmQgcmVmZXJlbmNlc1xyXG4gICAgICAgICAgICBjb25zdCBjYXJkc1NlY3Rpb24gPSBlcnJvckl0ZW0uY3JlYXRlRGl2KCdtaXRyZS1lcnJvci1jYXJkcycpO1xyXG4gICAgICAgICAgICBjYXJkc1NlY3Rpb24uY3JlYXRlRWwoJ3NwYW4nLCB7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OiAnQWZmZWN0ZWQgY2FyZHM6ICcsXHJcbiAgICAgICAgICAgICAgICBjbHM6ICdtaXRyZS1lcnJvci1jYXJkcy1sYWJlbCdcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBlcnJvci5pb2NDYXJkcy5mb3JFYWNoKChjYXJkLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FyZEJhZGdlID0gY2FyZHNTZWN0aW9uLmNyZWF0ZUVsKCdzcGFuJywge1xyXG4gICAgICAgICAgICAgICAgICAgIGNsczogJ21pdHJlLWVycm9yLWNhcmQtYmFkZ2UnLFxyXG4gICAgICAgICAgICAgICAgICAgIGF0dHI6IHsgJ3RpdGxlJzogYE5vZGUgSUQ6ICR7Y2FyZC5ub2RlSWR9YCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBGb3JtYXQ6IFwiSVAgQWRkcmVzcyAjMjAyNjAyMTQtMTUzNFwiXHJcbiAgICAgICAgICAgICAgICBjYXJkQmFkZ2UuY3JlYXRlRWwoJ3NwYW4nLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogY2FyZC5pb2NUeXBlLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsczogJ21pdHJlLWVycm9yLWNhcmQtdHlwZSdcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY2FyZEJhZGdlLmNyZWF0ZUVsKCdzcGFuJywge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IGAgJHtjYXJkLmNhcmRJZH1gLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsczogJ21pdHJlLWVycm9yLWNhcmQtaWQnXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBBZGQgY29tbWEgc2VwYXJhdG9yIGV4Y2VwdCBmb3IgbGFzdCBjYXJkXHJcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPCBlcnJvci5pb2NDYXJkcy5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FyZHNTZWN0aW9uLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiAnLCAnIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIERldGVybWluZXMgaWYgbmV3U2V2ZXJpdHkgc2hvdWxkIG92ZXJyaWRlIGV4aXN0aW5nU2V2ZXJpdHkgd2hlbiBhZ2dyZWdhdGluZy5cclxuICAgICAqXHJcbiAgICAgKiBXaGVuIG11bHRpcGxlIElPQyBjYXJkcyByZWZlcmVuY2UgdGhlIHNhbWUgdGVjaG5pcXVlIHdpdGggZGlmZmVyZW50IHZhbGlkYXRpb25cclxuICAgICAqIHJlc3VsdHMsIHdlIG5lZWQgdG8gZGVjaWRlIHdoaWNoIHNldmVyaXR5IHRvIGRpc3BsYXkgaW4gdGhlIG1hdHJpeC4gVGhpcyB1c2VzXHJcbiAgICAgKiBhIHByaW9yaXR5IHJhbmtpbmcgc3lzdGVtIHdoZXJlIG1vcmUgY3JpdGljYWwgZXJyb3JzIG92ZXJyaWRlIGxlc3MgY3JpdGljYWwgb25lcy5cclxuICAgICAqXHJcbiAgICAgKiAqKlJhbmtpbmcgKGhpZ2hlc3QgdG8gbG93ZXN0IHByaW9yaXR5KToqKlxyXG4gICAgICogMS4gYHVua25vd25fdGVjaG5pcXVlYCAoNSkgLSBUZWNobmlxdWUgSUQgbm90IGluIGRhdGFzZXQgKENSSVRJQ0FMIC0gcmVkKVxyXG4gICAgICogMi4gYHVua25vd25fdGFjdGljYCAoNCkgLSBUYWN0aWMgbmFtZSBub3QgcmVjb2duaXplZCAoQ1JJVElDQUwgLSByZWQpXHJcbiAgICAgKiAzLiBgZW1wdHlfdGFjdGljYCAoMykgLSBUZWNobmlxdWUgZmlsbGVkIGJ1dCB0YWN0aWMgZW1wdHkgKENSSVRJQ0FMIC0gcmVkKVxyXG4gICAgICogNC4gYG1pc21hdGNoYCAoMikgLSBCb3RoIHZhbGlkIGJ1dCBkb24ndCBiZWxvbmcgdG9nZXRoZXIgKFdBUk5JTkcgLSBvcmFuZ2UpXHJcbiAgICAgKiA1LiBgdmFsaWRgICgxKSAtIENvcnJlY3QgcGFpcmluZyAoU1VDQ0VTUyAtIGdyZWVuKVxyXG4gICAgICpcclxuICAgICAqICoqRXhhbXBsZToqKiBJZiAzIGNhcmRzIHJlZmVyZW5jZSBUMTU2Niwgb25lIHdpdGggdmFsaWQgcGFpcmluZywgb25lIHdpdGggbWlzbWF0Y2gsXHJcbiAgICAgKiBhbmQgb25lIHdpdGggdW5rbm93bl90YWN0aWMsIHRoZSBmaW5hbCBzZXZlcml0eSBzaG93biBpcyBgdW5rbm93bl90YWN0aWNgIChoaWdoZXN0IHJhbmspLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBuZXdTZXZlcml0eSAtIFNldmVyaXR5IGZyb20gbmV3bHkgcHJvY2Vzc2VkIGNhcmRcclxuICAgICAqIEBwYXJhbSBleGlzdGluZ1NldmVyaXR5IC0gQ3VycmVudCBhZ2dyZWdhdGVkIHNldmVyaXR5IGZvciB0aGlzIHRlY2huaXF1ZVxyXG4gICAgICogQHJldHVybnMgdHJ1ZSBpZiBuZXdTZXZlcml0eSBzaG91bGQgcmVwbGFjZSBleGlzdGluZ1NldmVyaXR5XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgc2hvdWxkT3ZlcnJpZGVTZXZlcml0eShcclxuICAgICAgICBuZXdTZXZlcml0eTogJ3ZhbGlkJyB8ICd1bmtub3duX3RlY2huaXF1ZScgfCAndW5rbm93bl90YWN0aWMnIHwgJ21pc21hdGNoJyB8ICdlbXB0eV90YWN0aWMnLFxyXG4gICAgICAgIGV4aXN0aW5nU2V2ZXJpdHk6ICd2YWxpZCcgfCAndW5rbm93bl90ZWNobmlxdWUnIHwgJ3Vua25vd25fdGFjdGljJyB8ICdtaXNtYXRjaCcgfCAnZW1wdHlfdGFjdGljJ1xyXG4gICAgKTogYm9vbGVhbiB7XHJcbiAgICAgICAgLy8gTnVtZXJpY2FsIHJhbmtpbmc6IGhpZ2hlciBudW1iZXIgPSBtb3JlIGNyaXRpY2FsIGVycm9yXHJcbiAgICAgICAgY29uc3Qgc2V2ZXJpdHlSYW5rID0ge1xyXG4gICAgICAgICAgICAndW5rbm93bl90ZWNobmlxdWUnOiA1LCAgLy8gUmVkIC0gdGVjaG5pcXVlIGRvZXNuJ3QgZXhpc3RcclxuICAgICAgICAgICAgJ3Vua25vd25fdGFjdGljJzogNCwgICAgIC8vIFJlZCAtIHRhY3RpYyBuYW1lL2FiYnJldiBub3QgZm91bmRcclxuICAgICAgICAgICAgJ2VtcHR5X3RhY3RpYyc6IDMsICAgICAgIC8vIFJlZCAtIG1pc3NpbmcgcmVxdWlyZWQgZmllbGRcclxuICAgICAgICAgICAgJ21pc21hdGNoJzogMiwgICAgICAgICAgIC8vIE9yYW5nZSAtIHdyb25nIHRhY3RpYyBmb3IgdGVjaG5pcXVlXHJcbiAgICAgICAgICAgICd2YWxpZCc6IDEgICAgICAgICAgICAgICAvLyBHcmVlbiAtIGNvcnJlY3QgcGFpcmluZ1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHNldmVyaXR5UmFua1tuZXdTZXZlcml0eV0gPiBzZXZlcml0eVJhbmtbZXhpc3RpbmdTZXZlcml0eV07XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBZ2dyZWdhdGUgTUlUUkUgdGFjdGljcyBhbmQgdGVjaG5pcXVlcyBmcm9tIElPQyBjYXJkcyBpbnRvIGZ1bGwgbWF0cml4IHN0cnVjdHVyZS5cclxuICAgICAqXHJcbiAgICAgKiBUaGlzIGlzIHRoZSBjb3JlIGFnZ3JlZ2F0aW9uIGFsZ29yaXRobSB0aGF0IGJ1aWxkcyB0aGUgY29tcGxldGUgTUlUUkUgQVRUJkNLIG1hdHJpeFxyXG4gICAgICogc2hvd2luZyBBTEwgMTQgdGFjdGljcyBhbmQgQUxMIH44MDArIHRlY2huaXF1ZXMsIHdpdGggZm91bmQgdGVjaG5pcXVlcyBoaWdobGlnaHRlZFxyXG4gICAgICogYW5kIHZhbGlkYXRlZC4gVXNlcyBhIDUtc3RlcCBwcm9jZXNzIGZvciBidWlsZGluZyB0aGUgbWF0cml4IGFuZCBjb2xsZWN0aW5nIGVycm9ycy5cclxuICAgICAqXHJcbiAgICAgKiAqKkFsZ29yaXRobSBPdmVydmlldzoqKlxyXG4gICAgICogMS4gQnVpbGQgbWFwIG9mIGZvdW5kIHRlY2huaXF1ZXMgZnJvbSBJT0MgY2FyZHMgKHdpdGggdmFsaWRhdGlvbiBwZXIgY2FyZClcclxuICAgICAqIDIuIEJ1aWxkIGZ1bGwgdGFjdGljIHN0cnVjdHVyZSBmcm9tIGRhdGFzZXQgKGFsbCAxNCB0YWN0aWNzKVxyXG4gICAgICogMy4gUG9wdWxhdGUgQUxMIHRlY2huaXF1ZXMgZnJvbSBkYXRhc2V0IChmb3VuZCBhbmQgdW5mb3VuZClcclxuICAgICAqIDQuIENvbnZlcnQgdG8gYXJyYXkgYW5kIHNvcnQgYnkga2lsbCBjaGFpbiBvcmRlclxyXG4gICAgICogNS4gQ29sbGVjdCB2YWxpZGF0aW9uIGVycm9ycyBmb3IgZGlzcGxheVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBpb2NEYXRhIC0gQXJyYXkgb2YgcGFyc2VkIElPQyBub2RlcyBmcm9tIGNhbnZhc1xyXG4gICAgICogQHJldHVybnMgQXJyYXkgb2YgTWl0cmVUYWN0aWMgb2JqZWN0cyB3aXRoIG5lc3RlZCB0ZWNobmlxdWVzXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgYXN5bmMgYWdncmVnYXRlVGFjdGljc1RlY2huaXF1ZXMoaW9jRGF0YTogSU9DTm9kZURhdGFbXSk6IFByb21pc2U8TWl0cmVUYWN0aWNbXT4ge1xyXG4gICAgICAgIC8vIFdhaXQgZm9yIGRhdGFzZXQgdG8gbG9hZFxyXG4gICAgICAgIGlmICghdGhpcy5taXRyZURhdGFzZXQpIHtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5sb2FkRGF0YXNldCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gSWYgZGF0YXNldCBpcyBzdGlsbCBudWxsIGFmdGVyIGxvYWRpbmcsIHNob3cgZXJyb3IgaW4gVUlcclxuICAgICAgICBpZiAoIXRoaXMubWl0cmVEYXRhc2V0KSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tNaXRyZU1vZGFsXSBGYWlsZWQgdG8gbG9hZCBkYXRhc2V0Jyk7XHJcbiAgICAgICAgICAgIHJldHVybiBbXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKCdbTWl0cmVNb2RhbF0gU3RhcnRpbmcgZnVsbCBtYXRyaXggYWdncmVnYXRpb24gd2l0aCcsIGlvY0RhdGEubGVuZ3RoLCAnSU9DIGNhcmRzJyk7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ1tNaXRyZU1vZGFsXSBEYXRhc2V0IGhhcycsIE9iamVjdC5rZXlzKHRoaXMubWl0cmVEYXRhc2V0IS50ZWNobmlxdWVzKS5sZW5ndGgsICd0ZWNobmlxdWVzJyk7XHJcblxyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgIC8vIFNURVAgMTogQnVpbGQgbWFwIG9mIGZvdW5kIHRlY2huaXF1ZXMgZnJvbSBJT0MgY2FyZHNcclxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgICAvLyBMb29wIHRocm91Z2ggYWxsIElPQyBjYXJkcyBhbmQgZXh0cmFjdCBNSVRSRSB0YWN0aWMvdGVjaG5pcXVlIGZpZWxkcy5cclxuICAgICAgICAvLyBGb3IgZWFjaCB1bmlxdWUgdGVjaG5pcXVlIElELCB0cmFjazpcclxuICAgICAgICAvLyAgIC0gY291bnQ6IGhvdyBtYW55IElPQyBjYXJkcyByZWZlcmVuY2UgaXRcclxuICAgICAgICAvLyAgIC0gaW9jQ2FyZHM6IGFycmF5IG9mIG5vZGUgSURzXHJcbiAgICAgICAgLy8gICAtIHNldmVyaXR5OiB3b3JzdCB2YWxpZGF0aW9uIHJlc3VsdCAodXNpbmcgc2hvdWxkT3ZlcnJpZGVTZXZlcml0eSlcclxuICAgICAgICAvLyAgIC0gdmFsaWRhdGlvbk1lc3NhZ2U6IGVycm9yIG1lc3NhZ2UgaWYgaW52YWxpZFxyXG4gICAgICAgIC8vICAgLSB1c2VyUHJvdmlkZWRUYWN0aWM6IG9yaWdpbmFsIHRhY3RpYyBzdHJpbmcgZnJvbSBJT0MgY2FyZFxyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gQWxzbyBidWlsZCBjYXJkVmFsaWRhdGlvbnMgbWFwIGZvciBwZXItY2FyZCBlcnJvciByZXBvcnRpbmcuXHJcbiAgICAgICAgY29uc3QgZm91bmRUZWNobmlxdWVzID0gbmV3IE1hcDxzdHJpbmcsIHtcclxuICAgICAgICAgICAgY291bnQ6IG51bWJlcjtcclxuICAgICAgICAgICAgaW9jQ2FyZHM6IHN0cmluZ1tdO1xyXG4gICAgICAgICAgICBzZXZlcml0eTogJ3ZhbGlkJyB8ICd1bmtub3duX3RlY2huaXF1ZScgfCAndW5rbm93bl90YWN0aWMnIHwgJ21pc21hdGNoJyB8ICdlbXB0eV90YWN0aWMnO1xyXG4gICAgICAgICAgICB2YWxpZGF0aW9uTWVzc2FnZT86IHN0cmluZztcclxuICAgICAgICAgICAgdXNlclByb3ZpZGVkVGFjdGljOiBzdHJpbmc7IC8vIE9yaWdpbmFsIHRhY3RpYyBzdHJpbmcgZnJvbSBJT0MgY2FyZFxyXG4gICAgICAgIH0+KCk7XHJcblxyXG4gICAgICAgIC8vIE5FVzogVHJhY2sgdmFsaWRhdGlvbiBwZXIgY2FyZCBmb3IgYWNjdXJhdGUgZXJyb3IgcmVwb3J0aW5nXHJcbiAgICAgICAgY29uc3QgY2FyZFZhbGlkYXRpb25zID0gbmV3IE1hcDxzdHJpbmcsIHtcclxuICAgICAgICAgICAgY2FyZElkOiBzdHJpbmc7XHJcbiAgICAgICAgICAgIHRlY2huaXF1ZUlkOiBzdHJpbmc7XHJcbiAgICAgICAgICAgIHRlY2huaXF1ZU5hbWU6IHN0cmluZztcclxuICAgICAgICAgICAgdGFjdGljOiBzdHJpbmc7XHJcbiAgICAgICAgICAgIHNldmVyaXR5OiAndmFsaWQnIHwgJ3Vua25vd25fdGVjaG5pcXVlJyB8ICd1bmtub3duX3RhY3RpYycgfCAnbWlzbWF0Y2gnIHwgJ2VtcHR5X3RhY3RpYyc7XHJcbiAgICAgICAgICAgIHZhbGlkYXRpb25NZXNzYWdlPzogc3RyaW5nO1xyXG4gICAgICAgICAgICBpb2NUeXBlOiBzdHJpbmc7XHJcbiAgICAgICAgICAgIG5vZGVJZDogc3RyaW5nO1xyXG4gICAgICAgIH0+KCk7XHJcblxyXG4gICAgICAgIGlvY0RhdGEuZm9yRWFjaChpb2MgPT4ge1xyXG4gICAgICAgICAgICAvLyBFeHBsaWNpdGx5IHRyaW0gYW5kIGNvbnZlcnQgZmFsc3kgdmFsdWVzIHRvIGVtcHR5IHN0cmluZ1xyXG4gICAgICAgICAgICBjb25zdCByYXdUYWN0aWMgPSAoaW9jLnRhY3RpYyB8fCAnJykudHJpbSgpO1xyXG4gICAgICAgICAgICBjb25zdCByYXdUZWNobmlxdWUgPSAoaW9jLnRlY2huaXF1ZSB8fCAnJykudHJpbSgpO1xyXG5cclxuICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgICAgIC8vIFZBTElEQVRJT04gQ0FTRSAxOiBFbXB0eSB0ZWNobmlxdWUgLSBhbHdheXMgc2tpcFxyXG4gICAgICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgICAgICAgLy8gSWYgdGhlIHRlY2huaXF1ZSBmaWVsZCBpcyBlbXB0eSwgd2UgY2Fubm90IHZhbGlkYXRlIGFueXRoaW5nLlxyXG4gICAgICAgICAgICAvLyBUaGVzZSBjYXJkcyBhcmUgc2lsZW50bHkgaWdub3JlZCAobm90IGNvdW50ZWQgYXMgZXJyb3JzKSBiZWNhdXNlXHJcbiAgICAgICAgICAgIC8vIGFuIGVtcHR5IHRlY2huaXF1ZSBtZWFucyB0aGUgYW5hbHlzdCBoYXNuJ3QgZmlsbGVkIGluIHRoZSBNSVRSRVxyXG4gICAgICAgICAgICAvLyBmaWVsZHMgeWV0LiBXZSBvbmx5IHZhbGlkYXRlIGNhcmRzIHdoZXJlIHRoZSBhbmFseXN0IGhhcyBwcm92aWRlZFxyXG4gICAgICAgICAgICAvLyBhdCBsZWFzdCBhIHRlY2huaXF1ZSBJRC5cclxuICAgICAgICAgICAgaWYgKCFyYXdUZWNobmlxdWUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ1tNaXRyZU1vZGFsXSBTa2lwcGluZyBJT0MgY2FyZCB3aXRoIGVtcHR5IHRlY2huaXF1ZTonLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGlvYy5pZCxcclxuICAgICAgICAgICAgICAgICAgICBjYXJkSWQ6IGlvYy5jYXJkSWQgfHwgJyhubyBJRCknLFxyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IGlvYy50eXBlLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhc1RhY3RpYzogISFyYXdUYWN0aWMsXHJcbiAgICAgICAgICAgICAgICAgICAgaGFzVGVjaG5pcXVlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICB0YWN0aWNWYWx1ZTogcmF3VGFjdGljIHx8ICcoZW1wdHkpJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZWNobmlxdWVWYWx1ZTogJyhlbXB0eSknXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3QgdGVjaG5pcXVlID0gcmF3VGVjaG5pcXVlO1xyXG4gICAgICAgICAgICBjb25zdCB0ZWNobmlxdWVJZCA9IHRoaXMuZXh0cmFjdFRlY2huaXF1ZUlkKHRlY2huaXF1ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRlY2huaXF1ZU5hbWUgPSB0aGlzLmV4dHJhY3RUZWNobmlxdWVOYW1lKHRlY2huaXF1ZSk7XHJcblxyXG4gICAgICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgICAgICAgLy8gVkFMSURBVElPTiBDQVNFIDI6IEZpbGxlZCB0ZWNobmlxdWUgYnV0IGVtcHR5IHRhY3RpYyAtIGVycm9yXHJcbiAgICAgICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgICAgICAvLyBUaGUgYW5hbHlzdCBwcm92aWRlZCBhIHRlY2huaXF1ZSBidXQgbGVmdCB0aGUgdGFjdGljIGZpZWxkIGVtcHR5LlxyXG4gICAgICAgICAgICAvLyBUaGlzIGlzIGFuIEVSUk9SIGJlY2F1c2Ugd2UgY2Fubm90IHZhbGlkYXRlIHRoZSB0ZWNobmlxdWUtdGFjdGljXHJcbiAgICAgICAgICAgIC8vIHBhaXJpbmcgd2l0aG91dCBib3RoIGZpZWxkcy4gVGhlIHRlY2huaXF1ZSB3aWxsIGJlIHNob3duIGluIHRoZVxyXG4gICAgICAgICAgICAvLyBtYXRyaXggd2l0aCBcImVtcHR5X3RhY3RpY1wiIHNldmVyaXR5IChyZWQpIGFuZCBhbiBleHBsaWNpdCBlcnJvclxyXG4gICAgICAgICAgICAvLyBtZXNzYWdlOiBcIlRhY3RpYyBmaWVsZCBpcyBlbXB0eVwiLlxyXG4gICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAvLyBUaGlzIGlzIGRpZmZlcmVudCBmcm9tIENhc2UgMSAoYm90aCBlbXB0eSkgd2hlcmUgd2Ugc2lsZW50bHkgc2tpcC5cclxuICAgICAgICAgICAgLy8gSGVyZSwgdGhlIGFuYWx5c3QgaGFzIHN0YXJ0ZWQgZmlsbGluZyBpbiBNSVRSRSBmaWVsZHMgYnV0IGZvcmdvdFxyXG4gICAgICAgICAgICAvLyB0aGUgdGFjdGljLCBzbyB3ZSBmbGFnIGl0IGFzIGFuIGlzc3VlLlxyXG4gICAgICAgICAgICBpZiAoIXJhd1RhY3RpYykge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1ZygnW01pdHJlTW9kYWxdIEZvdW5kIElPQyBjYXJkIHdpdGggZW1wdHkgdGFjdGljOicsIHtcclxuICAgICAgICAgICAgICAgICAgICBpZDogaW9jLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhcmRJZDogaW9jLmNhcmRJZCB8fCAnKG5vIElEKScsXHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogaW9jLnR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVjaG5pcXVlSWQ6IHRlY2huaXF1ZUlkLFxyXG4gICAgICAgICAgICAgICAgICAgIHRlY2huaXF1ZTogdGVjaG5pcXVlXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgdmFsaWRhdGlvbiByZXN1bHQgd2l0aCBlbXB0eV90YWN0aWMgc2V2ZXJpdHlcclxuICAgICAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICdlbXB0eV90YWN0aWMnIGFzIGNvbnN0LFxyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdUYWN0aWMgZmllbGQgaXMgZW1wdHknLFxyXG4gICAgICAgICAgICAgICAgICAgIHRhY3RpY0lkOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gTkVXOiBTdG9yZSBpbmRpdmlkdWFsIGNhcmQgdmFsaWRhdGlvblxyXG4gICAgICAgICAgICAgICAgY2FyZFZhbGlkYXRpb25zLnNldChpb2MuaWQsIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXJkSWQ6IGlvYy5jYXJkSWQgfHwgaW9jLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIHRlY2huaXF1ZUlkOiB0ZWNobmlxdWVJZCxcclxuICAgICAgICAgICAgICAgICAgICB0ZWNobmlxdWVOYW1lOiB0ZWNobmlxdWVOYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIHRhY3RpYzogJyhlbXB0eSknLFxyXG4gICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiB2YWxpZGF0aW9uLnNldmVyaXR5LFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbGlkYXRpb25NZXNzYWdlOiB2YWxpZGF0aW9uLm1lc3NhZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgaW9jVHlwZTogaW9jLnR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZUlkOiBpb2MuaWRcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIEFkZCB0byBmb3VuZFRlY2huaXF1ZXMgbWFwIChmb3IgdGVjaG5pcXVlLWxldmVsIGFnZ3JlZ2F0aW9uKVxyXG4gICAgICAgICAgICAgICAgaWYgKGZvdW5kVGVjaG5pcXVlcy5oYXModGVjaG5pcXVlSWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmcgPSBmb3VuZFRlY2huaXF1ZXMuZ2V0KHRlY2huaXF1ZUlkKSE7XHJcbiAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmcuY291bnQrKztcclxuICAgICAgICAgICAgICAgICAgICBleGlzdGluZy5pb2NDYXJkcy5wdXNoKGlvYy5pZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gS2VlcCB3b3JzdCBzZXZlcml0eSB1c2luZyBoZWxwZXIgZnVuY3Rpb25cclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zaG91bGRPdmVycmlkZVNldmVyaXR5KHZhbGlkYXRpb24uc2V2ZXJpdHksIGV4aXN0aW5nLnNldmVyaXR5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBleGlzdGluZy5zZXZlcml0eSA9IHZhbGlkYXRpb24uc2V2ZXJpdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nLnZhbGlkYXRpb25NZXNzYWdlID0gdmFsaWRhdGlvbi5tZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm91bmRUZWNobmlxdWVzLnNldCh0ZWNobmlxdWVJZCwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW9jQ2FyZHM6IFtpb2MuaWRdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogdmFsaWRhdGlvbi5zZXZlcml0eSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGlvbk1lc3NhZ2U6IHZhbGlkYXRpb24ubWVzc2FnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlclByb3ZpZGVkVGFjdGljOiAnKGVtcHR5KSdcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgICAgIC8vIFZBTElEQVRJT04gQ0FTRSAzOiBCb3RoIHRhY3RpYyBhbmQgdGVjaG5pcXVlIGZpbGxlZCAtIG5vcm1hbCB2YWxpZGF0aW9uXHJcbiAgICAgICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgICAgICAvLyBUaGlzIGlzIHRoZSBzdGFuZGFyZCB2YWxpZGF0aW9uIHBhdGguIEJvdGggZmllbGRzIGFyZSBmaWxsZWQsIHNvXHJcbiAgICAgICAgICAgIC8vIHdlIGNhbiBjaGVjazpcclxuICAgICAgICAgICAgLy8gICAxLiBEb2VzIHRoZSB0ZWNobmlxdWUgSUQgZXhpc3QgaW4gdGhlIGRhdGFzZXQ/ICh1bmtub3duX3RlY2huaXF1ZSlcclxuICAgICAgICAgICAgLy8gICAyLiBEb2VzIHRoZSB0YWN0aWMgbmFtZS9hYmJyZXZpYXRpb24gZXhpc3Q/ICh1bmtub3duX3RhY3RpYylcclxuICAgICAgICAgICAgLy8gICAzLiBEb2VzIHRoaXMgdGVjaG5pcXVlIGJlbG9uZyB0byB0aGlzIHRhY3RpYz8gKG1pc21hdGNoKVxyXG4gICAgICAgICAgICAvLyAgIDQuIElmIGFsbCBjaGVja3MgcGFzcywgbWFyayBhcyB2YWxpZFxyXG4gICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAvLyBWYWxpZGF0aW9uIGlzIHBlcmZvcm1lZCBieSBNaXRyZUxvYWRlci52YWxpZGF0ZVRlY2huaXF1ZVRhY3RpYygpXHJcbiAgICAgICAgICAgIC8vIHdoaWNoIHJldHVybnMgYSBzZXZlcml0eSBlbnVtIGFuZCBvcHRpb25hbCBlcnJvciBtZXNzYWdlLlxyXG4gICAgICAgICAgICBjb25zdCB0YWN0aWMgPSByYXdUYWN0aWM7XHJcblxyXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSB0ZWNobmlxdWUtdGFjdGljIG1hcHBpbmcgdXNpbmcgTWl0cmVMb2FkZXJcclxuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHZhbGlkYXRlVGVjaG5pcXVlVGFjdGljKHRlY2huaXF1ZUlkLCB0YWN0aWMsIHRoaXMubWl0cmVEYXRhc2V0ISk7XHJcblxyXG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdbTWl0cmVNb2RhbF0gRm91bmQgdGVjaG5pcXVlOicsIHtcclxuICAgICAgICAgICAgICAgIHRlY2huaXF1ZUlkLFxyXG4gICAgICAgICAgICAgICAgdGFjdGljLFxyXG4gICAgICAgICAgICAgICAgc2V2ZXJpdHk6IHZhbGlkYXRpb24uc2V2ZXJpdHlcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBORVc6IEFsd2F5cyBzdG9yZSBpbmRpdmlkdWFsIGNhcmQgdmFsaWRhdGlvblxyXG4gICAgICAgICAgICBjYXJkVmFsaWRhdGlvbnMuc2V0KGlvYy5pZCwge1xyXG4gICAgICAgICAgICAgICAgY2FyZElkOiBpb2MuY2FyZElkIHx8IGlvYy5pZCxcclxuICAgICAgICAgICAgICAgIHRlY2huaXF1ZUlkOiB0ZWNobmlxdWVJZCxcclxuICAgICAgICAgICAgICAgIHRlY2huaXF1ZU5hbWU6IHRlY2huaXF1ZU5hbWUsXHJcbiAgICAgICAgICAgICAgICB0YWN0aWM6IHRhY3RpYyxcclxuICAgICAgICAgICAgICAgIHNldmVyaXR5OiB2YWxpZGF0aW9uLnNldmVyaXR5LFxyXG4gICAgICAgICAgICAgICAgdmFsaWRhdGlvbk1lc3NhZ2U6IHZhbGlkYXRpb24ubWVzc2FnZSxcclxuICAgICAgICAgICAgICAgIGlvY1R5cGU6IGlvYy50eXBlLFxyXG4gICAgICAgICAgICAgICAgbm9kZUlkOiBpb2MuaWRcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBFeGlzdGluZyBmb3VuZFRlY2huaXF1ZXMgYWdncmVnYXRpb24gKGZvciBtYXRyaXggY29sb3JpbmcpXHJcbiAgICAgICAgICAgIGlmIChmb3VuZFRlY2huaXF1ZXMuaGFzKHRlY2huaXF1ZUlkKSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmcgPSBmb3VuZFRlY2huaXF1ZXMuZ2V0KHRlY2huaXF1ZUlkKSE7XHJcbiAgICAgICAgICAgICAgICBleGlzdGluZy5jb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgZXhpc3RpbmcuaW9jQ2FyZHMucHVzaChpb2MuaWQpO1xyXG4gICAgICAgICAgICAgICAgLy8gS2VlcCB3b3JzdCBzZXZlcml0eSB1c2luZyBoZWxwZXIgZnVuY3Rpb25cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNob3VsZE92ZXJyaWRlU2V2ZXJpdHkodmFsaWRhdGlvbi5zZXZlcml0eSwgZXhpc3Rpbmcuc2V2ZXJpdHkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXhpc3Rpbmcuc2V2ZXJpdHkgPSB2YWxpZGF0aW9uLnNldmVyaXR5O1xyXG4gICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nLnZhbGlkYXRpb25NZXNzYWdlID0gdmFsaWRhdGlvbi5tZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZm91bmRUZWNobmlxdWVzLnNldCh0ZWNobmlxdWVJZCwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvdW50OiAxLFxyXG4gICAgICAgICAgICAgICAgICAgIGlvY0NhcmRzOiBbaW9jLmlkXSxcclxuICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogdmFsaWRhdGlvbi5zZXZlcml0eSxcclxuICAgICAgICAgICAgICAgICAgICB2YWxpZGF0aW9uTWVzc2FnZTogdmFsaWRhdGlvbi5tZXNzYWdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJQcm92aWRlZFRhY3RpYzogdGFjdGljXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZygnW01pdHJlTW9kYWxdIEZvdW5kJywgZm91bmRUZWNobmlxdWVzLnNpemUsICd1bmlxdWUgdGVjaG5pcXVlcyBpbiBJT0MgY2FyZHMnKTtcclxuXHJcbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgLy8gU1RFUCAyOiBCdWlsZCBmdWxsIHRhY3RpYyBzdHJ1Y3R1cmUgZnJvbSBkYXRhc2V0XHJcbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgLy8gQ3JlYXRlIGEgTWl0cmVUYWN0aWMgZW50cnkgZm9yIEFMTCAxNCB0YWN0aWNzIGluIHRoZSBBVFQmQ0sgZnJhbWV3b3JrLFxyXG4gICAgICAgIC8vIHJlZ2FyZGxlc3Mgb2Ygd2hldGhlciBhbnkgSU9DIGNhcmRzIHJlZmVyZW5jZSB0aGVtLiBUaGlzIGVuc3VyZXMgdGhlXHJcbiAgICAgICAgLy8gbW9kYWwgZGlzcGxheXMgdGhlIGNvbXBsZXRlIG1hdHJpeCB3aXRoIGVtcHR5IHRhY3RpY3Mgc2hvd24gZm9yIGNvbnRleHQuXHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBFYWNoIHRhY3RpYyBzdGFydHMgd2l0aCBhbiBlbXB0eSB0ZWNobmlxdWVzIGFycmF5IHRoYXQgd2lsbCBiZSBwb3B1bGF0ZWRcclxuICAgICAgICAvLyBpbiBTVEVQIDMuXHJcbiAgICAgICAgY29uc3QgdGFjdGljTWFwID0gbmV3IE1hcDxzdHJpbmcsIE1pdHJlVGFjdGljPigpO1xyXG5cclxuICAgICAgICAvLyBJbml0aWFsaXplIEFMTCAxNCB0YWN0aWNzIGZyb20gdGhlIGRhdGFzZXRcclxuICAgICAgICBPYmplY3QudmFsdWVzKHRoaXMubWl0cmVEYXRhc2V0IS50YWN0aWNzKS5mb3JFYWNoKHRhY3RpY0RhdGEgPT4ge1xyXG4gICAgICAgICAgICB0YWN0aWNNYXAuc2V0KHRhY3RpY0RhdGEuaWQsIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IHRhY3RpY0RhdGEuaWQsXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogYCR7dGFjdGljRGF0YS5uYW1lfSAoJHt0YWN0aWNEYXRhLmlkfSlgLFxyXG4gICAgICAgICAgICAgICAgdGVjaG5pcXVlczogW11cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgIC8vIFNURVAgMzogUG9wdWxhdGUgQUxMIHRlY2huaXF1ZXMgZnJvbSBkYXRhc2V0XHJcbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgLy8gTG9vcCB0aHJvdWdoIEFMTCB+ODAwKyB0ZWNobmlxdWVzIGluIHRoZSBNSVRSRSBkYXRhc2V0IGFuZCBhZGQgdGhlbVxyXG4gICAgICAgIC8vIHRvIHRoZWlyIHJlc3BlY3RpdmUgdGFjdGljcy4gVGhpcyBjcmVhdGVzIHRoZSBjb21wbGV0ZSBtYXRyaXggc2hvd2luZ1xyXG4gICAgICAgIC8vIGJvdGggZm91bmQgYW5kIHVuZm91bmQgdGVjaG5pcXVlcy5cclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vIEZvciBlYWNoIHRlY2huaXF1ZTpcclxuICAgICAgICAvLyAgIC0gQ2hlY2sgaWYgaXQgd2FzIGZvdW5kIGluIElPQyBjYXJkcyAodXNpbmcgZm91bmRUZWNobmlxdWVzIG1hcClcclxuICAgICAgICAvLyAgIC0gSWYgZm91bmQ6IHVzZSBhZ2dyZWdhdGVkIGNvdW50L3NldmVyaXR5L3ZhbGlkYXRpb24gZnJvbSBTVEVQIDFcclxuICAgICAgICAvLyAgIC0gSWYgbm90IGZvdW5kOiBtYXJrIGFzIHNldmVyaXR5PSdub3RfZm91bmQnICh3aWxsIHJlbmRlciBncmF5KVxyXG4gICAgICAgIC8vICAgLSBJZiBzdWJ0ZWNobmlxdWU6IHN0b3JlIHNlcGFyYXRlbHkgaW4gc3VidGVjaG5pcXVlc01hcFxyXG4gICAgICAgIC8vICAgLSBJZiBwYXJlbnQgdGVjaG5pcXVlOiBhZGQgdG8gQUxMIHRhY3RpY3MgaXQgYmVsb25ncyB0b1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gQ2xlYXIgc3VidGVjaG5pcXVlcyBtYXAgZm9yIGZyZXNoIGFnZ3JlZ2F0aW9uXHJcbiAgICAgICAgdGhpcy5zdWJ0ZWNobmlxdWVzTWFwLmNsZWFyKCk7XHJcblxyXG4gICAgICAgIE9iamVjdC52YWx1ZXModGhpcy5taXRyZURhdGFzZXQhLnRlY2huaXF1ZXMpLmZvckVhY2godGVjaERhdGEgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBmb3VuZERhdGEgPSBmb3VuZFRlY2huaXF1ZXMuZ2V0KHRlY2hEYXRhLmlkKTtcclxuICAgICAgICAgICAgY29uc3QgaXNGb3VuZCA9ICEhZm91bmREYXRhO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgdGVjaG5pcXVlT2JqOiBNaXRyZVRlY2huaXF1ZSA9IHtcclxuICAgICAgICAgICAgICAgIGlkOiB0ZWNoRGF0YS5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IHRlY2hEYXRhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICB0YWN0aWM6ICcnLCAvLyBXaWxsIGJlIHNldCBwZXItdGFjdGljIGJlbG93XHJcbiAgICAgICAgICAgICAgICB0YWN0aWNJZDogJycsIC8vIFdpbGwgYmUgc2V0IHBlci10YWN0aWMgYmVsb3dcclxuICAgICAgICAgICAgICAgIGNvdW50OiBmb3VuZERhdGE/LmNvdW50IHx8IDAsXHJcbiAgICAgICAgICAgICAgICBpb2NDYXJkczogZm91bmREYXRhPy5pb2NDYXJkcyB8fCBbXSxcclxuICAgICAgICAgICAgICAgIHNldmVyaXR5OiBmb3VuZERhdGE/LnNldmVyaXR5IHx8ICdub3RfZm91bmQnLFxyXG4gICAgICAgICAgICAgICAgdmFsaWRhdGlvbk1lc3NhZ2U6IGZvdW5kRGF0YT8udmFsaWRhdGlvbk1lc3NhZ2UsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdGVjaERhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICBpc0ZvdW5kOiBpc0ZvdW5kXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAvLyBJZiB0aGlzIGlzIGEgc3VidGVjaG5pcXVlLCBzdG9yZSBpdCBzZXBhcmF0ZWx5XHJcbiAgICAgICAgICAgIGlmICh0ZWNoRGF0YS5wYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5zdWJ0ZWNobmlxdWVzTWFwLmhhcyh0ZWNoRGF0YS5wYXJlbnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWJ0ZWNobmlxdWVzTWFwLnNldCh0ZWNoRGF0YS5wYXJlbnQsIFtdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIFN0b3JlIHN1YnRlY2huaXF1ZSB3aXRoIGZpcnN0IHRhY3RpYyAoZm9yIHJlbmRlcmluZyBjb250ZXh0KVxyXG4gICAgICAgICAgICAgICAgaWYgKHRlY2hEYXRhLnRhY3RpY3MubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRlY2huaXF1ZU9iai50YWN0aWMgPSBmb3VuZERhdGE/LnVzZXJQcm92aWRlZFRhY3RpYyB8fCB0ZWNoRGF0YS50YWN0aWNzWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIHRlY2huaXF1ZU9iai50YWN0aWNJZCA9IHRlY2hEYXRhLnRhY3RpY3NbMF07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN1YnRlY2huaXF1ZXNNYXAuZ2V0KHRlY2hEYXRhLnBhcmVudCkhLnB1c2godGVjaG5pcXVlT2JqKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjsgLy8gU2tpcCBhZGRpbmcgdG8gbWFpbiB0YWN0aWMgbGlzdFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBBZGQgcGFyZW50IHRlY2huaXF1ZXMgdG8gQUxMIHRoZWlyIHZhbGlkIHRhY3RpY3NcclxuICAgICAgICAgICAgdGVjaERhdGEudGFjdGljcy5mb3JFYWNoKHRhY3RpY0lkID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICghdGFjdGljTWFwLmhhcyh0YWN0aWNJZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ1tNaXRyZU1vZGFsXSBVbmtub3duIHRhY3RpYyBJRCBpbiBkYXRhc2V0OicsIHRhY3RpY0lkKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgdGFjdGljID0gdGFjdGljTWFwLmdldCh0YWN0aWNJZCkhO1xyXG5cclxuICAgICAgICAgICAgICAgIHRhY3RpYy50ZWNobmlxdWVzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIC4uLnRlY2huaXF1ZU9iaixcclxuICAgICAgICAgICAgICAgICAgICB0YWN0aWM6IGZvdW5kRGF0YT8udXNlclByb3ZpZGVkVGFjdGljIHx8IHRhY3RpY0lkLFxyXG4gICAgICAgICAgICAgICAgICAgIHRhY3RpY0lkOiB0YWN0aWNJZFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgICAvLyBTVEVQIDQ6IENvbnZlcnQgdG8gYXJyYXkgYW5kIHNvcnRcclxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgICAvLyBDb252ZXJ0IHRoZSB0YWN0aWNNYXAgaW50byBhbiBhcnJheSBhbmQgc29ydCB0YWN0aWNzIGJ5IHRoZSBvZmZpY2lhbFxyXG4gICAgICAgIC8vIE1JVFJFIGtpbGwgY2hhaW4gb3JkZXIgKFJlY29ubmFpc3NhbmNlIFx1MjE5MiBJbXBhY3QpLiBUaGlzIGVuc3VyZXMgdGhlXHJcbiAgICAgICAgLy8gbWF0cml4IGNvbHVtbnMgYXBwZWFyIGluIHRoZSBjb3JyZWN0IHNlcXVlbmNlIG1hdGNoaW5nIHRoZSBzdGFuZGFyZFxyXG4gICAgICAgIC8vIEFUVCZDSyBmcmFtZXdvcmsgdmlzdWFsaXphdGlvbi5cclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vIFdpdGhpbiBlYWNoIHRhY3RpYywgdGVjaG5pcXVlcyBhcmUgc29ydGVkIHNvOlxyXG4gICAgICAgIC8vICAgMS4gRm91bmQgdGVjaG5pcXVlcyBhcHBlYXIgZmlyc3QgKGlzRm91bmQ9dHJ1ZSlcclxuICAgICAgICAvLyAgIDIuIFRoZW4gc29ydGVkIGFscGhhYmV0aWNhbGx5IGJ5IHRlY2huaXF1ZSBJRFxyXG4gICAgICAgIGNvbnN0IHRhY3RpY3MgPSBBcnJheS5mcm9tKHRhY3RpY01hcC52YWx1ZXMoKSk7XHJcblxyXG4gICAgICAgIC8vIFNvcnQgdGFjdGljcyBieSBNSVRSRSBraWxsIGNoYWluIG9yZGVyICgxNCB0YWN0aWNzIGZyb20gbGVmdCB0byByaWdodClcclxuICAgICAgICBjb25zdCB0YWN0aWNPcmRlciA9IFtcclxuICAgICAgICAgICAgJ1RBMDA0MycsIC8vIFJlY29ubmFpc3NhbmNlXHJcbiAgICAgICAgICAgICdUQTAwNDInLCAvLyBSZXNvdXJjZSBEZXZlbG9wbWVudFxyXG4gICAgICAgICAgICAnVEEwMDAxJywgLy8gSW5pdGlhbCBBY2Nlc3NcclxuICAgICAgICAgICAgJ1RBMDAwMicsIC8vIEV4ZWN1dGlvblxyXG4gICAgICAgICAgICAnVEEwMDAzJywgLy8gUGVyc2lzdGVuY2VcclxuICAgICAgICAgICAgJ1RBMDAwNCcsIC8vIFByaXZpbGVnZSBFc2NhbGF0aW9uXHJcbiAgICAgICAgICAgICdUQTAwMDUnLCAvLyBEZWZlbnNlIEV2YXNpb25cclxuICAgICAgICAgICAgJ1RBMDAwNicsIC8vIENyZWRlbnRpYWwgQWNjZXNzXHJcbiAgICAgICAgICAgICdUQTAwMDcnLCAvLyBEaXNjb3ZlcnlcclxuICAgICAgICAgICAgJ1RBMDAwOCcsIC8vIExhdGVyYWwgTW92ZW1lbnRcclxuICAgICAgICAgICAgJ1RBMDAwOScsIC8vIENvbGxlY3Rpb25cclxuICAgICAgICAgICAgJ1RBMDAxMScsIC8vIENvbW1hbmQgYW5kIENvbnRyb2xcclxuICAgICAgICAgICAgJ1RBMDAxMCcsIC8vIEV4ZmlsdHJhdGlvblxyXG4gICAgICAgICAgICAnVEEwMDQwJyAgLy8gSW1wYWN0XHJcbiAgICAgICAgXTtcclxuXHJcbiAgICAgICAgdGFjdGljcy5zb3J0KChhLCBiKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGluZGV4QSA9IHRhY3RpY09yZGVyLmluZGV4T2YoYS5uYW1lKTtcclxuICAgICAgICAgICAgY29uc3QgaW5kZXhCID0gdGFjdGljT3JkZXIuaW5kZXhPZihiLm5hbWUpO1xyXG4gICAgICAgICAgICBpZiAoaW5kZXhBID09PSAtMSkgcmV0dXJuIDE7XHJcbiAgICAgICAgICAgIGlmIChpbmRleEIgPT09IC0xKSByZXR1cm4gLTE7XHJcbiAgICAgICAgICAgIHJldHVybiBpbmRleEEgLSBpbmRleEI7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFNvcnQgdGVjaG5pcXVlcyB3aXRoaW4gZWFjaCB0YWN0aWMgYnkgSURcclxuICAgICAgICB0YWN0aWNzLmZvckVhY2godGFjdGljID0+IHtcclxuICAgICAgICAgICAgdGFjdGljLnRlY2huaXF1ZXMuc29ydCgoYSwgYikgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gRm91bmQgdGVjaG5pcXVlcyBjb21lIGZpcnN0XHJcbiAgICAgICAgICAgICAgICBpZiAoYS5pc0ZvdW5kICYmICFiLmlzRm91bmQpIHJldHVybiAtMTtcclxuICAgICAgICAgICAgICAgIGlmICghYS5pc0ZvdW5kICYmIGIuaXNGb3VuZCkgcmV0dXJuIDE7XHJcbiAgICAgICAgICAgICAgICAvLyBUaGVuIHNvcnQgYnkgdGVjaG5pcXVlIElEXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYS5pZC5sb2NhbGVDb21wYXJlKGIuaWQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coJ1tNaXRyZU1vZGFsXSBGdWxsIG1hdHJpeCBidWlsdDonLCB7XHJcbiAgICAgICAgICAgIHRvdGFsVGFjdGljczogdGFjdGljcy5sZW5ndGgsXHJcbiAgICAgICAgICAgIHRvdGFsVGVjaG5pcXVlczogdGFjdGljcy5yZWR1Y2UoKHN1bSwgdCkgPT4gc3VtICsgdC50ZWNobmlxdWVzLmxlbmd0aCwgMCksXHJcbiAgICAgICAgICAgIGZvdW5kVGVjaG5pcXVlczogZm91bmRUZWNobmlxdWVzLnNpemVcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgLy8gU1RFUCA1OiBDb2xsZWN0IHZhbGlkYXRpb24gZXJyb3JzIGZvciBkaXNwbGF5XHJcbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgLy8gQnVpbGQgdGhlIHZhbGlkYXRpb24gZXJyb3JzIGFycmF5IGZvciByZW5kZXJpbmcgYXQgdGhlIHRvcCBvZiB0aGUgbW9kYWwuXHJcbiAgICAgICAgLy8gVXNlcyB0aGUgcGVyLWNhcmQgdmFsaWRhdGlvbiBkYXRhIGNvbGxlY3RlZCBpbiBTVEVQIDEgdG8gc2hvdyB3aGljaFxyXG4gICAgICAgIC8vIHNwZWNpZmljIElPQyBjYXJkcyBoYXZlIGVycm9ycy5cclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vIEdyb3VwcyBlcnJvcnMgYnkgdGVjaG5pcXVlK3NldmVyaXR5IHRvIGF2b2lkIGR1cGxpY2F0ZXM6XHJcbiAgICAgICAgLy8gICAtIEVhY2ggdW5pcXVlIHRlY2huaXF1ZStzZXZlcml0eSBjb21ibyBnZXRzIG9uZSBlcnJvciBlbnRyeVxyXG4gICAgICAgIC8vICAgLSBMaXN0cyBhbGwgYWZmZWN0ZWQgSU9DIGNhcmRzIHVuZGVyIHRoYXQgZXJyb3JcclxuICAgICAgICAvLyAgIC0gQ2F0ZWdvcml6ZWQgYnkgc2V2ZXJpdHkgZm9yIGRpc3BsYXkgKE1pc3NpbmcgVGFjdGljLCBVbmtub3duIFRhY3RpYyxcclxuICAgICAgICAvLyAgICAgVGVjaG5pcXVlIEVycm9ycywgVmFsaWRhdGlvbiBNaXNtYXRjaGVzKVxyXG4gICAgICAgIGNvbnNvbGUubG9nKCdbTWl0cmVNb2RhbF0gQ29sbGVjdGluZyB2YWxpZGF0aW9uIGVycm9ycyBmcm9tIGNhcmQtbGV2ZWwgdmFsaWRhdGlvbi4uLicpO1xyXG4gICAgICAgIHRoaXMudmFsaWRhdGlvbkVycm9ycyA9IFtdO1xyXG5cclxuICAgICAgICAvLyBHcm91cCBjYXJkcyBieSB0ZWNobmlxdWUrc2V2ZXJpdHkgZm9yIGRpc3BsYXlcclxuICAgICAgICBjb25zdCBlcnJvcnNCeVRlY2huaXF1ZSA9IG5ldyBNYXA8c3RyaW5nLCB7XHJcbiAgICAgICAgICAgIHRlY2huaXF1ZUlkOiBzdHJpbmc7XHJcbiAgICAgICAgICAgIHRlY2huaXF1ZU5hbWU6IHN0cmluZztcclxuICAgICAgICAgICAgc2V2ZXJpdHk6ICd1bmtub3duX3RlY2huaXF1ZScgfCAndW5rbm93bl90YWN0aWMnIHwgJ21pc21hdGNoJyB8ICdlbXB0eV90YWN0aWMnO1xyXG4gICAgICAgICAgICBtZXNzYWdlOiBzdHJpbmc7XHJcbiAgICAgICAgICAgIGNhcmRzOiBBcnJheTx7XHJcbiAgICAgICAgICAgICAgICBjYXJkSWQ6IHN0cmluZztcclxuICAgICAgICAgICAgICAgIGlvY1R5cGU6IHN0cmluZztcclxuICAgICAgICAgICAgICAgIG5vZGVJZDogc3RyaW5nO1xyXG4gICAgICAgICAgICB9PjtcclxuICAgICAgICB9PigpO1xyXG5cclxuICAgICAgICAvLyBORVc6IEZpbHRlciBlcnJvcnMgYnkgY2FyZC1sZXZlbCB2YWxpZGF0aW9uIChub3QgdGVjaG5pcXVlLWxldmVsKVxyXG4gICAgICAgIGNhcmRWYWxpZGF0aW9ucy5mb3JFYWNoKChjYXJkVmFsaWRhdGlvbiwgY2FyZElkKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIE9ubHkgaW5jbHVkZSBjYXJkcyB3aXRoIGFjdHVhbCBlcnJvcnNcclxuICAgICAgICAgICAgaWYgKGNhcmRWYWxpZGF0aW9uLnNldmVyaXR5ICE9PSAndmFsaWQnKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSBgJHtjYXJkVmFsaWRhdGlvbi50ZWNobmlxdWVJZH0tJHtjYXJkVmFsaWRhdGlvbi5zZXZlcml0eX1gO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICghZXJyb3JzQnlUZWNobmlxdWUuaGFzKGtleSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBlcnJvcnNCeVRlY2huaXF1ZS5zZXQoa2V5LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlY2huaXF1ZUlkOiBjYXJkVmFsaWRhdGlvbi50ZWNobmlxdWVJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGVjaG5pcXVlTmFtZTogY2FyZFZhbGlkYXRpb24udGVjaG5pcXVlTmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6IGNhcmRWYWxpZGF0aW9uLnNldmVyaXR5IGFzIGFueSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogY2FyZFZhbGlkYXRpb24udmFsaWRhdGlvbk1lc3NhZ2UgfHwgJ1ZhbGlkYXRpb24gZXJyb3InLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXJkczogW11cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBlcnJvcnNCeVRlY2huaXF1ZS5nZXQoa2V5KSEuY2FyZHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FyZElkOiBjYXJkVmFsaWRhdGlvbi5jYXJkSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgaW9jVHlwZTogY2FyZFZhbGlkYXRpb24uaW9jVHlwZSxcclxuICAgICAgICAgICAgICAgICAgICBub2RlSWQ6IGNhcmRWYWxpZGF0aW9uLm5vZGVJZFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gQ29udmVydCB0byB2YWxpZGF0aW9uIGVycm9ycyBhcnJheVxyXG4gICAgICAgIGVycm9yc0J5VGVjaG5pcXVlLmZvckVhY2goKGVycm9yRGF0YSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnZhbGlkYXRpb25FcnJvcnMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICB0ZWNobmlxdWVJZDogZXJyb3JEYXRhLnRlY2huaXF1ZUlkLFxyXG4gICAgICAgICAgICAgICAgdGVjaG5pcXVlTmFtZTogZXJyb3JEYXRhLnRlY2huaXF1ZU5hbWUsXHJcbiAgICAgICAgICAgICAgICBzZXZlcml0eTogZXJyb3JEYXRhLnNldmVyaXR5LFxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogZXJyb3JEYXRhLm1lc3NhZ2UsXHJcbiAgICAgICAgICAgICAgICBpb2NDYXJkczogZXJyb3JEYXRhLmNhcmRzXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZygnW01pdHJlTW9kYWxdIEZvdW5kJywgdGhpcy52YWxpZGF0aW9uRXJyb3JzLmxlbmd0aCwgJ3ZhbGlkYXRpb24gZXJyb3IgZ3JvdXBzIGZyb20nLCBjYXJkVmFsaWRhdGlvbnMuc2l6ZSwgJ2NhcmRzJyk7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ1tNaXRyZU1vZGFsXSBDYXJkcyB3aXRoIGVycm9yczonLCBBcnJheS5mcm9tKGNhcmRWYWxpZGF0aW9ucy52YWx1ZXMoKSkuZmlsdGVyKHYgPT4gdi5zZXZlcml0eSAhPT0gJ3ZhbGlkJykubGVuZ3RoKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRhY3RpY3M7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBFeHRyYWN0IHRlY2huaXF1ZSBJRCBmcm9tIHZhcmlvdXMgZm9ybWF0cy5cclxuICAgICAqXHJcbiAgICAgKiBTdXBwb3J0ZWQgZm9ybWF0czpcclxuICAgICAqIC0gXCJUMTU2NlwiIC0+IFwiVDE1NjZcIlxyXG4gICAgICogLSBcIlQxNTY2LjAwMVwiIC0+IFwiVDE1NjYuMDAxXCJcclxuICAgICAqIC0gXCJUMTU2NiAtIFBoaXNoaW5nXCIgLT4gXCJUMTU2NlwiXHJcbiAgICAgKiAtIFwiUGhpc2hpbmcgKFQxNTY2KVwiIC0+IFwiVDE1NjZcIlxyXG4gICAgICogLSBcIlQxNTY2LjAwMSAtIFNwZWFycGhpc2hpbmcgQXR0YWNobWVudFwiIC0+IFwiVDE1NjYuMDAxXCJcclxuICAgICAqIC0gXCJQaGlzaGluZ1wiIChuYW1lIG9ubHkpIC0+IFwiUGhpc2hpbmdcIiAoZmFsbGJhY2ssIHdpbGwgZmFpbCB2YWxpZGF0aW9uKVxyXG4gICAgICpcclxuICAgICAqIE5PVEU6IFRlY2huaXF1ZSBmaWVsZCBpcyBhbHJlYWR5IHVwcGVyY2FzZWQgYnkgSU9DUGFyc2VyIGZvciBjb25zaXN0ZW5jeVxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGV4dHJhY3RUZWNobmlxdWVJZCh0ZWNobmlxdWU6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgICAgLy8gVHJ5IHRvIG1hdGNoIGZ1bGwgdGVjaG5pcXVlIElEIHdpdGggb3B0aW9uYWwgc3ViLXRlY2huaXF1ZVxyXG4gICAgICAgIC8vIENhc2UtaW5zZW5zaXRpdmUgbWF0Y2ggc2luY2UgaW5wdXQgaXMgdXBwZXJjYXNlZFxyXG4gICAgICAgIGNvbnN0IGlkTWF0Y2ggPSB0ZWNobmlxdWUubWF0Y2goL1RcXGR7NH0oPzpcXC5cXGR7M30pPy9pKTtcclxuICAgICAgICBpZiAoaWRNYXRjaCkge1xyXG4gICAgICAgICAgICAvLyBFbnN1cmUgcmV0dXJuZWQgSUQgaXMgdXBwZXJjYXNlXHJcbiAgICAgICAgICAgIGNvbnN0IHRlY2huaXF1ZUlkID0gaWRNYXRjaFswXS50b1VwcGVyQ2FzZSgpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdbTWl0cmVNb2RhbF0gRXh0cmFjdGVkIHRlY2huaXF1ZSBJRDonLCB0ZWNobmlxdWVJZCwgJ2Zyb206JywgdGVjaG5pcXVlKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRlY2huaXF1ZUlkO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gSWYgbm8gSUQgZm91bmQsIHJldHVybiB0aGUgcmF3IHN0cmluZyAod2lsbCBiZSBmbGFnZ2VkIGFzIGludmFsaWQpXHJcbiAgICAgICAgY29uc29sZS5kZWJ1ZygnW01pdHJlTW9kYWxdIE5vIHRlY2huaXF1ZSBJRCBmb3VuZCBpbjonLCB0ZWNobmlxdWUsICctIHVzaW5nIHJhdyBzdHJpbmcnKTtcclxuICAgICAgICByZXR1cm4gdGVjaG5pcXVlLnRyaW0oKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEV4dHJhY3QgdGVjaG5pcXVlIG5hbWUgZnJvbSB2YXJpb3VzIGZvcm1hdHMuXHJcbiAgICAgKlxyXG4gICAgICogU3VwcG9ydGVkIGZvcm1hdHM6XHJcbiAgICAgKiAtIFwiVDE1NjYgLSBQaGlzaGluZ1wiIC0+IFwiUGhpc2hpbmdcIlxyXG4gICAgICogLSBcIlBoaXNoaW5nIChUMTU2NilcIiAtPiBcIlBoaXNoaW5nXCJcclxuICAgICAqIC0gXCJUMTU2Ni4wMDEgLSBTcGVhcnBoaXNoaW5nIEF0dGFjaG1lbnRcIiAtPiBcIlNwZWFycGhpc2hpbmcgQXR0YWNobWVudFwiXHJcbiAgICAgKiAtIFwiVDE1NjZcIiAoSUQgb25seSkgLT4gbG9va3VwIG5hbWUgZnJvbSBNaXRyZURhdGFcclxuICAgICAqIC0gXCJQaGlzaGluZ1wiIChuYW1lIG9ubHkpIC0+IFwiUGhpc2hpbmdcIlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGV4dHJhY3RUZWNobmlxdWVOYW1lKHRlY2huaXF1ZTogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgICAgICAvLyBGb3JtYXQ6IFwiVDE1NjYgLSBQaGlzaGluZ1wiIG9yIFwiVDE1NjYuMDAxIC0gU3BlYXJwaGlzaGluZyBBdHRhY2htZW50XCJcclxuICAgICAgICBjb25zdCBkYXNoTWF0Y2ggPSB0ZWNobmlxdWUubWF0Y2goL1RcXGR7NH0oPzpcXC5cXGR7M30pP1xccyotXFxzKiguKykvKTtcclxuICAgICAgICBpZiAoZGFzaE1hdGNoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBkYXNoTWF0Y2hbMV0udHJpbSgpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdbTWl0cmVNb2RhbF0gRXh0cmFjdGVkIG5hbWUgZnJvbSBkYXNoIGZvcm1hdDonLCBuYW1lKTtcclxuICAgICAgICAgICAgcmV0dXJuIG5hbWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBGb3JtYXQ6IFwiUGhpc2hpbmcgKFQxNTY2KVwiIG9yIFwiU3BlYXJwaGlzaGluZyBBdHRhY2htZW50IChUMTU2Ni4wMDEpXCJcclxuICAgICAgICBjb25zdCBwYXJlbk1hdGNoID0gdGVjaG5pcXVlLm1hdGNoKC8oLis/KVxccypcXChUXFxkezR9KD86XFwuXFxkezN9KT9cXCkvKTtcclxuICAgICAgICBpZiAocGFyZW5NYXRjaCkge1xyXG4gICAgICAgICAgICBjb25zdCBuYW1lID0gcGFyZW5NYXRjaFsxXS50cmltKCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ1tNaXRyZU1vZGFsXSBFeHRyYWN0ZWQgbmFtZSBmcm9tIHBhcmVuIGZvcm1hdDonLCBuYW1lKTtcclxuICAgICAgICAgICAgcmV0dXJuIG5hbWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBJZiBmb3JtYXQgaXMganVzdCBJRCwgdHJ5IHRvIGxvb2sgdXAgdGhlIG5hbWUgZnJvbSBsb2FkZWQgZGF0YXNldFxyXG4gICAgICAgIGNvbnN0IGlkT25seU1hdGNoID0gdGVjaG5pcXVlLm1hdGNoKC9eVFxcZHs0fSg/OlxcLlxcZHszfSk/JC8pO1xyXG4gICAgICAgIGlmIChpZE9ubHlNYXRjaCAmJiB0aGlzLm1pdHJlRGF0YXNldCkge1xyXG4gICAgICAgICAgICBjb25zdCB0ZWNoRGF0YSA9IHRoaXMubWl0cmVEYXRhc2V0LnRlY2huaXF1ZXNbaWRPbmx5TWF0Y2hbMF1dO1xyXG4gICAgICAgICAgICBpZiAodGVjaERhdGEpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ1tNaXRyZU1vZGFsXSBMb29rZWQgdXAgbmFtZSBmb3IgSUQ6JywgaWRPbmx5TWF0Y2hbMF0sICctPicsIHRlY2hEYXRhLm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRlY2hEYXRhLm5hbWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIE90aGVyd2lzZSByZXR1cm4gYXMtaXMgKG1pZ2h0IGJlIG5hbWUtb25seSBmb3JtYXQpXHJcbiAgICAgICAgY29uc29sZS5kZWJ1ZygnW01pdHJlTW9kYWxdIFVzaW5nIHJhdyB0ZWNobmlxdWUgc3RyaW5nIGFzIG5hbWU6JywgdGVjaG5pcXVlKTtcclxuICAgICAgICByZXR1cm4gdGVjaG5pcXVlLnRyaW0oKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlbmRlclRhY3RpY1NlY3Rpb24oXHJcbiAgICAgICAgY29udGFpbmVyOiBIVE1MRWxlbWVudCxcclxuICAgICAgICB0YWN0aWM6IE1pdHJlVGFjdGljLFxyXG4gICAgICAgIHNlYXJjaFN0YXRlPzogU2VhcmNoU3RhdGUgfCBudWxsXHJcbiAgICApOiB2b2lkIHtcclxuICAgICAgICBjb25zdCB0YWN0aWNDb2x1bW4gPSBjb250YWluZXIuY3JlYXRlRGl2KCdtaXRyZS10YWN0aWMtY29sdW1uJyk7XHJcblxyXG4gICAgICAgIC8vIFNob3cgZm91bmQgdnMgdG90YWwgY291bnRcclxuICAgICAgICBjb25zdCBmb3VuZENvdW50ID0gdGFjdGljLnRlY2huaXF1ZXMuZmlsdGVyKHQgPT4gdC5pc0ZvdW5kKS5sZW5ndGg7XHJcbiAgICAgICAgY29uc3QgdG90YWxDb3VudCA9IHRhY3RpYy50ZWNobmlxdWVzLmxlbmd0aDtcclxuXHJcbiAgICAgICAgY29uc3QgdGFjdGljSGVhZGVyID0gdGFjdGljQ29sdW1uLmNyZWF0ZURpdignbWl0cmUtdGFjdGljLWhlYWRlcicpO1xyXG4gICAgICAgIHRhY3RpY0hlYWRlci5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6IGBcdTI2OTRcdUZFMEYgJHt0YWN0aWMuZGlzcGxheU5hbWUgfHwgdGFjdGljLm5hbWV9YCB9KTtcclxuICAgICAgICB0YWN0aWNIZWFkZXIuY3JlYXRlRWwoJ3NwYW4nLCB7XHJcbiAgICAgICAgICAgIHRleHQ6IGAke2ZvdW5kQ291bnR9LyR7dG90YWxDb3VudH0gdGVjaG5pcXVlcyBjb3ZlcmVkYCxcclxuICAgICAgICAgICAgY2xzOiAnbWl0cmUtdGVjaG5pcXVlLWNvdW50J1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCB0ZWNobmlxdWVMaXN0ID0gdGFjdGljQ29sdW1uLmNyZWF0ZURpdignbWl0cmUtdGVjaG5pcXVlLWxpc3QnKTtcclxuXHJcbiAgICAgICAgdGFjdGljLnRlY2huaXF1ZXMuZm9yRWFjaCh0ZWNobmlxdWUgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB0ZWNoSXRlbSA9IHRlY2huaXF1ZUxpc3QuY3JlYXRlRGl2KCdtaXRyZS10ZWNobmlxdWUtaXRlbScpO1xyXG5cclxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyB0ZWNobmlxdWUgaGFzIHN1YnRlY2huaXF1ZXNcclxuICAgICAgICAgICAgY29uc3Qgc3VidGVjaG5pcXVlcyA9IHRoaXMuc3VidGVjaG5pcXVlc01hcC5nZXQodGVjaG5pcXVlLmlkKSB8fCBbXTtcclxuICAgICAgICAgICAgY29uc3QgaGFzU3VidGVjaG5pcXVlcyA9IHN1YnRlY2huaXF1ZXMubGVuZ3RoID4gMDtcclxuXHJcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIGRlc2NyaXB0aW9uIGlzIGxvbmdcclxuICAgICAgICAgICAgY29uc3QgY2xlYW5lZERlc2MgPSB0aGlzLmNsZWFuRGVzY3JpcHRpb24odGVjaG5pcXVlLmRlc2NyaXB0aW9uIHx8ICcnKTtcclxuICAgICAgICAgICAgY29uc3QgaXNMb25nRGVzY3JpcHRpb24gPSBjbGVhbmVkRGVzYy5sZW5ndGggPiAxODA7XHJcblxyXG4gICAgICAgICAgICAvLyBFeHBhbmRhYmxlIGlmIGxvbmcgZGVzY3JpcHRpb24gT1IgaGFzIHN1YnRlY2huaXF1ZXNcclxuICAgICAgICAgICAgY29uc3QgaXNFeHBhbmRhYmxlID0gaXNMb25nRGVzY3JpcHRpb24gfHwgaGFzU3VidGVjaG5pcXVlcztcclxuXHJcbiAgICAgICAgICAgIC8vIEFkZCBkYXRhIGF0dHJpYnV0ZXMgZm9yIHN0YXRlIG1hbmFnZW1lbnRcclxuICAgICAgICAgICAgdGVjaEl0ZW0uc2V0QXR0cmlidXRlKCdkYXRhLXRlY2huaXF1ZS1pZCcsIHRlY2huaXF1ZS5pZCk7XHJcbiAgICAgICAgICAgIHRlY2hJdGVtLnNldEF0dHJpYnV0ZSgnZGF0YS1zdWJ0ZWNobmlxdWUtY291bnQnLCBzdWJ0ZWNobmlxdWVzLmxlbmd0aC50b1N0cmluZygpKTtcclxuICAgICAgICAgICAgdGVjaEl0ZW0uc2V0QXR0cmlidXRlKCdkYXRhLWlzLWV4cGFuZGFibGUnLCBpc0V4cGFuZGFibGUudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgICAgIHRlY2hJdGVtLnNldEF0dHJpYnV0ZSgnZGF0YS1mdWxsLWRlc2NyaXB0aW9uJywgY2xlYW5lZERlc2MpO1xyXG4gICAgICAgICAgICBpZiAoaXNMb25nRGVzY3JpcHRpb24pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRydW5jYXRlZCA9IHRoaXMudHJ1bmNhdGVEZXNjcmlwdGlvbihjbGVhbmVkRGVzYyk7XHJcbiAgICAgICAgICAgICAgICB0ZWNoSXRlbS5zZXRBdHRyaWJ1dGUoJ2RhdGEtdHJ1bmNhdGVkLWRlc2NyaXB0aW9uJywgdHJ1bmNhdGVkKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gQXBwbHkgc3R5bGluZyBiYXNlZCBvbiBpc0ZvdW5kIGFuZCBzZXZlcml0eVxyXG4gICAgICAgICAgICBpZiAoIXRlY2huaXF1ZS5pc0ZvdW5kKSB7XHJcbiAgICAgICAgICAgICAgICB0ZWNoSXRlbS5hZGRDbGFzcygnbWl0cmUtdGVjaG5pcXVlLXVuZm91bmQnKTsgLy8gR3JheSwgbm8gdmFsaWRhdGlvblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gQXBwbHkgdmFsaWRhdGlvbiBzdHlsaW5nIGZvciBmb3VuZCB0ZWNobmlxdWVzXHJcbiAgICAgICAgICAgICAgICB0aGlzLmFwcGx5U2V2ZXJpdHlDbGFzcyh0ZWNoSXRlbSwgdGVjaG5pcXVlLnNldmVyaXR5KTtcclxuICAgICAgICAgICAgICAgIC8vIGVsc2U6IHZhbGlkIHRlY2huaXF1ZXMgZ2V0IGRlZmF1bHQgZ3JlZW4gc3R5bGluZ1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCB0ZWNoSW5mbyA9IHRlY2hJdGVtLmNyZWF0ZURpdignbWl0cmUtdGVjaG5pcXVlLWluZm8nKTtcclxuXHJcbiAgICAgICAgICAgIC8vIEFkZCBleHBhbmQgaWNvbiBpZiBleHBhbmRhYmxlIChsb25nIGRlc2NyaXB0aW9uIE9SIHN1YnRlY2huaXF1ZXMpXHJcbiAgICAgICAgICAgIGlmIChpc0V4cGFuZGFibGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGFuZEljb24gPSB0ZWNoSW5mby5jcmVhdGVFbCgnc3BhbicsIHtcclxuICAgICAgICAgICAgICAgICAgICBjbHM6ICdtaXRyZS1leHBhbmQtaWNvbicsXHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ1x1MjVCNidcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGVjaEl0ZW0uYWRkQ2xhc3MoJ2hhcy1leHBhbmRhYmxlJyk7ICAvLyBVcGRhdGVkIGNsYXNzIG5hbWVcclxuICAgICAgICAgICAgICAgIHRlY2hJdGVtLmFkZENsYXNzKCdjb2xsYXBzZWQnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBDbGljayBoYW5kbGVyIGZvciBleHBhbmQvY29sbGFwc2VcclxuICAgICAgICAgICAgICAgIHRlY2hJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlRXhwYW5zaW9uKHRlY2hJdGVtLCBzdWJ0ZWNobmlxdWVzKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBTaG93IHZhbGlkYXRpb24gaWNvbiBPTkxZIGZvciBmb3VuZCB0ZWNobmlxdWVzIHdpdGggaXNzdWVzXHJcbiAgICAgICAgICAgIGlmICh0ZWNobmlxdWUuaXNGb3VuZCAmJiB0ZWNobmlxdWUuc2V2ZXJpdHkgIT09ICd2YWxpZCcgJiYgdGVjaG5pcXVlLnNldmVyaXR5ICE9PSAnbm90X2ZvdW5kJykge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgd2FybmluZ0VsID0gdGVjaEluZm8uY3JlYXRlRWwoJ3NwYW4nLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xzOiAnbWl0cmUtdmFsaWRhdGlvbi1pY29uJyxcclxuICAgICAgICAgICAgICAgICAgICBhdHRyOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICd0aXRsZSc6IHRlY2huaXF1ZS52YWxpZGF0aW9uTWVzc2FnZSB8fCAnV2FybmluZydcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHdhcm5pbmdFbC5pbm5lckhUTUwgPSB0aGlzLmdldFNldmVyaXR5SWNvbih0ZWNobmlxdWUuc2V2ZXJpdHkpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0ZWNoSW5mby5jcmVhdGVFbCgnc3BhbicsIHtcclxuICAgICAgICAgICAgICAgIHRleHQ6IHRlY2huaXF1ZS5pZCxcclxuICAgICAgICAgICAgICAgIGNsczogJ21pdHJlLXRlY2huaXF1ZS1pZCdcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBBZGQgc3VidGVjaG5pcXVlIGNvdW50IHRvIG5hbWUgaWYgcHJlc2VudFxyXG4gICAgICAgICAgICBjb25zdCBuYW1lVGV4dCA9IGhhc1N1YnRlY2huaXF1ZXNcclxuICAgICAgICAgICAgICAgID8gYCR7dGVjaG5pcXVlLm5hbWV9ICgke3N1YnRlY2huaXF1ZXMubGVuZ3RofSlgXHJcbiAgICAgICAgICAgICAgICA6IHRlY2huaXF1ZS5uYW1lO1xyXG4gICAgICAgICAgICBjb25zdCBuYW1lRWwgPSB0ZWNoSW5mby5jcmVhdGVFbCgnc3BhbicsIHtcclxuICAgICAgICAgICAgICAgIHRleHQ6IG5hbWVUZXh0LFxyXG4gICAgICAgICAgICAgICAgY2xzOiAnbWl0cmUtdGVjaG5pcXVlLW5hbWUnXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gQXBwbHkgc2VhcmNoIGhpZ2hsaWdodGluZyB0byBuYW1lIGlmIGFjdGl2ZVxyXG4gICAgICAgICAgICBpZiAoc2VhcmNoU3RhdGU/LmlzQWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmhpZ2hsaWdodE1hdGNoZXMobmFtZUVsLCB0ZWNobmlxdWUubmFtZSwgc2VhcmNoU3RhdGUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBTaG93IGRlc2NyaXB0aW9uIGZvciBBTEwgdGVjaG5pcXVlc1xyXG4gICAgICAgICAgICBpZiAodGVjaG5pcXVlLmRlc2NyaXB0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZXNjRWwgPSB0ZWNoSXRlbS5jcmVhdGVEaXYoJ21pdHJlLXRlY2huaXF1ZS1kZXNjcmlwdGlvbicpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIFNob3cgdHJ1bmNhdGVkIG9yIGZ1bGwgZGVzY3JpcHRpb24gYmFzZWQgb24gc3RhdGVcclxuICAgICAgICAgICAgICAgIGNvbnN0IGlzRXhwYW5kZWQgPSB0ZWNoSXRlbS5oYXNDbGFzcygnZXhwYW5kZWQnKTtcclxuICAgICAgICAgICAgICAgIGxldCBkaXNwbGF5VGV4dDogc3RyaW5nO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChpc0V4cGFuZGVkIHx8ICFpc0V4cGFuZGFibGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBTaG93IGZ1bGwgZGVzY3JpcHRpb24gaWYgZXhwYW5kZWQgb3Igbm90IGV4cGFuZGFibGVcclxuICAgICAgICAgICAgICAgICAgICBkaXNwbGF5VGV4dCA9IGNsZWFuZWREZXNjO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBTaG93IHRydW5jYXRlZCBkZXNjcmlwdGlvbiBpZiBjb2xsYXBzZWQgYW5kIGV4cGFuZGFibGVcclxuICAgICAgICAgICAgICAgICAgICBkaXNwbGF5VGV4dCA9IHRoaXMudHJ1bmNhdGVEZXNjcmlwdGlvbihjbGVhbmVkRGVzYyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZGVzY0VsLnRleHRDb250ZW50ID0gZGlzcGxheVRleHQ7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gQXBwbHkgc2VhcmNoIGhpZ2hsaWdodGluZyB0byBkZXNjcmlwdGlvbiBpZiBhY3RpdmVcclxuICAgICAgICAgICAgICAgIGlmIChzZWFyY2hTdGF0ZT8uaXNBY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmhpZ2hsaWdodE1hdGNoZXMoZGVzY0VsLCBkaXNwbGF5VGV4dCwgc2VhcmNoU3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBTaG93IGNvdW50IGJhZGdlIE9OTFkgZm9yIGZvdW5kIHRlY2huaXF1ZXNcclxuICAgICAgICAgICAgaWYgKHRlY2huaXF1ZS5pc0ZvdW5kKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ZWNoQ291bnQgPSB0ZWNoSXRlbS5jcmVhdGVEaXYoJ21pdHJlLXRlY2huaXF1ZS1jb3VudC1iYWRnZScpO1xyXG4gICAgICAgICAgICAgICAgdGVjaENvdW50LnRleHRDb250ZW50ID0gYCR7dGVjaG5pcXVlLmNvdW50fSBjYXJkJHt0ZWNobmlxdWUuY291bnQgPiAxID8gJ3MnIDogJyd9YDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcmVuZGVyU3VidGVjaG5pcXVlcyhcclxuICAgICAgICBwYXJlbnRFbDogSFRNTEVsZW1lbnQsXHJcbiAgICAgICAgc3VidGVjaG5pcXVlczogTWl0cmVUZWNobmlxdWVbXSxcclxuICAgICAgICBzZWFyY2hTdGF0ZT86IFNlYXJjaFN0YXRlIHwgbnVsbFxyXG4gICAgKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gcGFyZW50RWwuY3JlYXRlRGl2KHsgY2xzOiAnbWl0cmUtc3VidGVjaG5pcXVlcy1jb250YWluZXInIH0pO1xyXG5cclxuICAgICAgICBzdWJ0ZWNobmlxdWVzLmZvckVhY2goc3VidGVjaCA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHN1Ykl0ZW0gPSBjb250YWluZXIuY3JlYXRlRGl2KCdtaXRyZS10ZWNobmlxdWUtaXRlbSBtaXRyZS1zdWJ0ZWNobmlxdWUnKTtcclxuXHJcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHN1YnRlY2huaXF1ZSBkZXNjcmlwdGlvbiBpcyBsb25nXHJcbiAgICAgICAgICAgIGNvbnN0IGNsZWFuZWREZXNjID0gdGhpcy5jbGVhbkRlc2NyaXB0aW9uKHN1YnRlY2guZGVzY3JpcHRpb24gfHwgJycpO1xyXG4gICAgICAgICAgICBjb25zdCBpc0xvbmdEZXNjcmlwdGlvbiA9IGNsZWFuZWREZXNjLmxlbmd0aCA+IHRoaXMuU1VCVEVDSE5JUVVFX1RSVU5DQVRFX0xJTUlUO1xyXG5cclxuICAgICAgICAgICAgLy8gQWRkIGRhdGEgYXR0cmlidXRlcyBmb3Igc3RhdGUgbWFuYWdlbWVudFxyXG4gICAgICAgICAgICBzdWJJdGVtLnNldEF0dHJpYnV0ZSgnZGF0YS10ZWNobmlxdWUtaWQnLCBzdWJ0ZWNoLmlkKTtcclxuICAgICAgICAgICAgc3ViSXRlbS5zZXRBdHRyaWJ1dGUoJ2RhdGEtZnVsbC1kZXNjcmlwdGlvbicsIGNsZWFuZWREZXNjKTtcclxuICAgICAgICAgICAgaWYgKGlzTG9uZ0Rlc2NyaXB0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0cnVuY2F0ZWQgPSB0aGlzLnRydW5jYXRlRGVzY3JpcHRpb24oY2xlYW5lZERlc2MsIHRoaXMuU1VCVEVDSE5JUVVFX1RSVU5DQVRFX0xJTUlUKTtcclxuICAgICAgICAgICAgICAgIHN1Ykl0ZW0uc2V0QXR0cmlidXRlKCdkYXRhLXRydW5jYXRlZC1kZXNjcmlwdGlvbicsIHRydW5jYXRlZCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIEFwcGx5IHN0eWxpbmcgYmFzZWQgb24gaXNGb3VuZCBhbmQgc2V2ZXJpdHlcclxuICAgICAgICAgICAgaWYgKCFzdWJ0ZWNoLmlzRm91bmQpIHtcclxuICAgICAgICAgICAgICAgIHN1Ykl0ZW0uYWRkQ2xhc3MoJ21pdHJlLXRlY2huaXF1ZS11bmZvdW5kJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFwcGx5U2V2ZXJpdHlDbGFzcyhzdWJJdGVtLCBzdWJ0ZWNoLnNldmVyaXR5KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3Qgc3ViSW5mbyA9IHN1Ykl0ZW0uY3JlYXRlRGl2KCdtaXRyZS10ZWNobmlxdWUtaW5mbycpO1xyXG5cclxuICAgICAgICAgICAgLy8gQWRkIGV4cGFuZCBpY29uIGlmIGRlc2NyaXB0aW9uIGlzIGxvbmdcclxuICAgICAgICAgICAgaWYgKGlzTG9uZ0Rlc2NyaXB0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBleHBhbmRJY29uID0gc3ViSW5mby5jcmVhdGVFbCgnc3BhbicsIHtcclxuICAgICAgICAgICAgICAgICAgICBjbHM6ICdtaXRyZS1leHBhbmQtaWNvbicsXHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ1x1MjVCNidcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgc3ViSXRlbS5hZGRDbGFzcygnaGFzLWV4cGFuZGFibGUnKTtcclxuICAgICAgICAgICAgICAgIHN1Ykl0ZW0uYWRkQ2xhc3MoJ2NvbGxhcHNlZCcpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIENsaWNrIGhhbmRsZXIgZm9yIGV4cGFuZC9jb2xsYXBzZVxyXG4gICAgICAgICAgICAgICAgc3ViSXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZUV4cGFuc2lvbihzdWJJdGVtKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBTaG93IHZhbGlkYXRpb24gaWNvbiBmb3IgZm91bmQgc3VidGVjaG5pcXVlcyB3aXRoIGlzc3Vlc1xyXG4gICAgICAgICAgICBpZiAoc3VidGVjaC5pc0ZvdW5kICYmIHN1YnRlY2guc2V2ZXJpdHkgIT09ICd2YWxpZCcgJiYgc3VidGVjaC5zZXZlcml0eSAhPT0gJ25vdF9mb3VuZCcpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHdhcm5pbmdFbCA9IHN1YkluZm8uY3JlYXRlRWwoJ3NwYW4nLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xzOiAnbWl0cmUtdmFsaWRhdGlvbi1pY29uJyxcclxuICAgICAgICAgICAgICAgICAgICBhdHRyOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICd0aXRsZSc6IHN1YnRlY2gudmFsaWRhdGlvbk1lc3NhZ2UgfHwgJ1dhcm5pbmcnXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB3YXJuaW5nRWwuaW5uZXJIVE1MID0gdGhpcy5nZXRTZXZlcml0eUljb24oc3VidGVjaC5zZXZlcml0eSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN1YkluZm8uY3JlYXRlRWwoJ3NwYW4nLCB7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OiBzdWJ0ZWNoLmlkLFxyXG4gICAgICAgICAgICAgICAgY2xzOiAnbWl0cmUtdGVjaG5pcXVlLWlkJ1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG5hbWVFbCA9IHN1YkluZm8uY3JlYXRlRWwoJ3NwYW4nLCB7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OiBzdWJ0ZWNoLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBjbHM6ICdtaXRyZS10ZWNobmlxdWUtbmFtZSdcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBBcHBseSBzZWFyY2ggaGlnaGxpZ2h0aW5nIHRvIG5hbWUgaWYgYWN0aXZlXHJcbiAgICAgICAgICAgIGlmIChzZWFyY2hTdGF0ZT8uaXNBY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaGlnaGxpZ2h0TWF0Y2hlcyhuYW1lRWwsIHN1YnRlY2gubmFtZSwgc2VhcmNoU3RhdGUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBTaG93IGRlc2NyaXB0aW9uIHdpdGggdHJ1bmNhdGlvblxyXG4gICAgICAgICAgICBpZiAoc3VidGVjaC5kZXNjcmlwdGlvbikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGVzY0VsID0gc3ViSXRlbS5jcmVhdGVEaXYoJ21pdHJlLXRlY2huaXF1ZS1kZXNjcmlwdGlvbicpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIFNob3cgdHJ1bmNhdGVkIG9yIGZ1bGwgYmFzZWQgb24gZXhwYW5kYWJsZSBzdGF0ZVxyXG4gICAgICAgICAgICAgICAgbGV0IGRpc3BsYXlUZXh0OiBzdHJpbmc7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNMb25nRGVzY3JpcHRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBTdGFydCBjb2xsYXBzZWQgd2l0aCB0cnVuY2F0ZWQgdGV4dFxyXG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXlUZXh0ID0gdGhpcy50cnVuY2F0ZURlc2NyaXB0aW9uKGNsZWFuZWREZXNjLCB0aGlzLlNVQlRFQ0hOSVFVRV9UUlVOQ0FURV9MSU1JVCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFNob3J0IGRlc2NyaXB0aW9ucyBzaG93IGluIGZ1bGxcclxuICAgICAgICAgICAgICAgICAgICBkaXNwbGF5VGV4dCA9IGNsZWFuZWREZXNjO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGRlc2NFbC50ZXh0Q29udGVudCA9IGRpc3BsYXlUZXh0O1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIEFwcGx5IHNlYXJjaCBoaWdobGlnaHRpbmcgaWYgYWN0aXZlXHJcbiAgICAgICAgICAgICAgICBpZiAoc2VhcmNoU3RhdGU/LmlzQWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oaWdobGlnaHRNYXRjaGVzKGRlc2NFbCwgZGlzcGxheVRleHQsIHNlYXJjaFN0YXRlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gU2hvdyBjb3VudCBiYWRnZSBmb3IgZm91bmQgc3VidGVjaG5pcXVlc1xyXG4gICAgICAgICAgICBpZiAoc3VidGVjaC5pc0ZvdW5kKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzdWJDb3VudCA9IHN1Ykl0ZW0uY3JlYXRlRGl2KCdtaXRyZS10ZWNobmlxdWUtY291bnQtYmFkZ2UnKTtcclxuICAgICAgICAgICAgICAgIHN1YkNvdW50LnRleHRDb250ZW50ID0gYCR7c3VidGVjaC5jb3VudH0gY2FyZCR7c3VidGVjaC5jb3VudCA+IDEgPyAncycgOiAnJ31gO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQYXJzZSBzZWFyY2ggcXVlcnkgaW50byBrZXl3b3JkcyBhbmQgcGhyYXNlcy5cclxuICAgICAqXHJcbiAgICAgKiBTdXBwb3J0cyB0d28gdHlwZXMgb2Ygc2VhcmNoIHRlcm1zOlxyXG4gICAgICogMS4gKipLZXl3b3JkcyoqOiBTcGFjZS1zZXBhcmF0ZWQgd29yZHMgKGUuZy4sIFwic3BlYXIgcGhpc2hpbmdcIiBcdTIxOTIgW1wic3BlYXJcIiwgXCJwaGlzaGluZ1wiXSlcclxuICAgICAqIDIuICoqUGhyYXNlcyoqOiBRdW90ZWQgc3RyaW5ncyAoZS5nLiwgXCJzcGVhciBwaGlzaGluZ1wiIFx1MjE5MiBbXCJzcGVhciBwaGlzaGluZ1wiXSlcclxuICAgICAqXHJcbiAgICAgKiAqKlBocmFzZSBTeW50YXg6KipcclxuICAgICAqIC0gUXVvdGVkIHBocmFzZXMgbWF0Y2ggZXhhY3Qgc2VxdWVuY2VzOiBcImxhdGVyYWwgbW92ZW1lbnRcIiBvbmx5IG1hdGNoZXMgdGhhdCBwaHJhc2VcclxuICAgICAqIC0gS2V5d29yZHMgbWF0Y2ggYW55d2hlcmU6IGxhdGVyYWwgbW92ZW1lbnQgbWF0Y2hlcyBib3RoIHNlcGFyYXRlbHlcclxuICAgICAqIC0gVW5tYXRjaGVkIHF1b3RlcyBhcmUgYXV0b21hdGljYWxseSByZW1vdmVkIChlLmcuLCBcInNwZWFyIHBoaXNoaW5nIGJlY29tZXMgc3BlYXIgcGhpc2hpbmcpXHJcbiAgICAgKlxyXG4gICAgICogKipBbGdvcml0aG06KipcclxuICAgICAqIDEuIENoZWNrIGZvciB1bm1hdGNoZWQgcXVvdGVzIGFuZCByZW1vdmUgdGhlIGxhc3Qgb25lXHJcbiAgICAgKiAyLiBFeHRyYWN0IGFsbCBxdW90ZWQgcGhyYXNlcyB1c2luZyByZWdleDogL1wiKFteXCJdKylcIi9nXHJcbiAgICAgKiAzLiBSZW1vdmUgcGhyYXNlcyBmcm9tIHF1ZXJ5IGFuZCBzcGxpdCByZW1haW5pbmcgdGV4dCBpbnRvIGtleXdvcmRzXHJcbiAgICAgKiA0LiBOb3JtYWxpemUgYWxsIHRlcm1zIHRvIGxvd2VyY2FzZSBmb3IgY2FzZS1pbnNlbnNpdGl2ZSBtYXRjaGluZ1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBxdWVyeSAtIFJhdyBzZWFyY2ggcXVlcnkgc3RyaW5nXHJcbiAgICAgKiBAcmV0dXJucyBTZWFyY2hTdGF0ZSBvYmplY3Qgd2l0aCBwYXJzZWQga2V5d29yZHMgYW5kIHBocmFzZXNcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBwYXJzZVNlYXJjaFF1ZXJ5KHF1ZXJ5OiBzdHJpbmcpOiBTZWFyY2hTdGF0ZSB7XHJcbiAgICAgICAgaWYgKCFxdWVyeSB8fCAhcXVlcnkudHJpbSgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBxdWVyeTogJycsXHJcbiAgICAgICAgICAgICAgICBrZXl3b3JkczogW10sXHJcbiAgICAgICAgICAgICAgICBwaHJhc2VzOiBbXSxcclxuICAgICAgICAgICAgICAgIGlzQWN0aXZlOiBmYWxzZVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgdHJpbW1lZFF1ZXJ5ID0gcXVlcnkudHJpbSgpO1xyXG5cclxuICAgICAgICAvLyBIYW5kbGUgdW5tYXRjaGVkIHF1b3RlcyAob2RkIG51bWJlciBvZiBxdW90ZXMpXHJcbiAgICAgICAgLy8gRXhhbXBsZTogdXNlciB0eXBlcyBcInNwZWFyIHBoaXNoaW5nIHdpdGhvdXQgY2xvc2luZyBxdW90ZVxyXG4gICAgICAgIGNvbnN0IHF1b3RlQ291bnQgPSAodHJpbW1lZFF1ZXJ5Lm1hdGNoKC9cIi9nKSB8fCBbXSkubGVuZ3RoO1xyXG4gICAgICAgIGxldCBwcm9jZXNzZWRRdWVyeSA9IHRyaW1tZWRRdWVyeTtcclxuICAgICAgICBpZiAocXVvdGVDb3VudCAlIDIgIT09IDApIHtcclxuICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBsYXN0IHVubWF0Y2hlZCBxdW90ZSB0byBwcmV2ZW50IHJlZ2V4IGlzc3Vlc1xyXG4gICAgICAgICAgICBjb25zdCBsYXN0UXVvdGVJbmRleCA9IHByb2Nlc3NlZFF1ZXJ5Lmxhc3RJbmRleE9mKCdcIicpO1xyXG4gICAgICAgICAgICBwcm9jZXNzZWRRdWVyeSA9IHByb2Nlc3NlZFF1ZXJ5LnN1YnN0cmluZygwLCBsYXN0UXVvdGVJbmRleCkgKyBwcm9jZXNzZWRRdWVyeS5zdWJzdHJpbmcobGFzdFF1b3RlSW5kZXggKyAxKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEV4dHJhY3QgcXVvdGVkIHBocmFzZXMgdXNpbmcgcmVnZXhcclxuICAgICAgICAvLyBSZWdleDogL1wiKFteXCJdKylcIi9nIG1hdGNoZXMgXCJ0ZXh0XCIgYW5kIGNhcHR1cmVzIHRleHQgaW4gZ3JvdXAgMVxyXG4gICAgICAgIGNvbnN0IHBocmFzZXM6IHN0cmluZ1tdID0gW107XHJcbiAgICAgICAgY29uc3QgcGhyYXNlUmVnZXggPSAvXCIoW15cIl0rKVwiL2c7XHJcbiAgICAgICAgbGV0IG1hdGNoO1xyXG4gICAgICAgIHdoaWxlICgobWF0Y2ggPSBwaHJhc2VSZWdleC5leGVjKHByb2Nlc3NlZFF1ZXJ5KSkgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgcGhyYXNlcy5wdXNoKG1hdGNoWzFdLnRvTG93ZXJDYXNlKCkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gUmVtb3ZlIHF1b3RlZCBwaHJhc2VzIGZyb20gcXVlcnkgYW5kIHNwbGl0IHJlbWFpbmluZyBpbnRvIGtleXdvcmRzXHJcbiAgICAgICAgY29uc3QgcmVtYWluaW5nUXVlcnkgPSBwcm9jZXNzZWRRdWVyeS5yZXBsYWNlKC9cIlteXCJdK1wiL2csICcgJyk7XHJcbiAgICAgICAgY29uc3Qga2V5d29yZHMgPSByZW1haW5pbmdRdWVyeVxyXG4gICAgICAgICAgICAuc3BsaXQoL1xccysvKVxyXG4gICAgICAgICAgICAubWFwKGsgPT4gay50cmltKCkudG9Mb3dlckNhc2UoKSlcclxuICAgICAgICAgICAgLmZpbHRlcihrID0+IGsubGVuZ3RoID4gMCk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHF1ZXJ5OiB0cmltbWVkUXVlcnksXHJcbiAgICAgICAgICAgIGtleXdvcmRzLFxyXG4gICAgICAgICAgICBwaHJhc2VzLFxyXG4gICAgICAgICAgICBpc0FjdGl2ZToga2V5d29yZHMubGVuZ3RoID4gMCB8fCBwaHJhc2VzLmxlbmd0aCA+IDBcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2hlY2sgaWYgdGV4dCBtYXRjaGVzIGFsbCBrZXl3b3JkcyBhbmQgcGhyYXNlcyBpbiBzZWFyY2ggc3RhdGUuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHRleHQgLSBUZXh0IHRvIGNoZWNrXHJcbiAgICAgKiBAcGFyYW0gc2VhcmNoU3RhdGUgLSBQYXJzZWQgc2VhcmNoIHN0YXRlXHJcbiAgICAgKiBAcmV0dXJucyBUcnVlIGlmIHRleHQgbWF0Y2hlcyBhbGwgc2VhcmNoIHRlcm1zXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgdGV4dE1hdGNoZXNRdWVyeSh0ZXh0OiBzdHJpbmcsIHNlYXJjaFN0YXRlOiBTZWFyY2hTdGF0ZSk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGlmICghc2VhcmNoU3RhdGUuaXNBY3RpdmUpIHJldHVybiB0cnVlO1xyXG5cclxuICAgICAgICBjb25zdCBsb3dlclRleHQgPSB0ZXh0LnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICAgIC8vIENoZWNrIGFsbCBrZXl3b3JkcyBhcmUgcHJlc2VudFxyXG4gICAgICAgIGNvbnN0IGFsbEtleXdvcmRzTWF0Y2ggPSBzZWFyY2hTdGF0ZS5rZXl3b3Jkcy5ldmVyeShrZXl3b3JkID0+XHJcbiAgICAgICAgICAgIGxvd2VyVGV4dC5pbmNsdWRlcyhrZXl3b3JkKVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIC8vIENoZWNrIGFsbCBwaHJhc2VzIGFyZSBwcmVzZW50XHJcbiAgICAgICAgY29uc3QgYWxsUGhyYXNlc01hdGNoID0gc2VhcmNoU3RhdGUucGhyYXNlcy5ldmVyeShwaHJhc2UgPT5cclxuICAgICAgICAgICAgbG93ZXJUZXh0LmluY2x1ZGVzKHBocmFzZSlcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICByZXR1cm4gYWxsS2V5d29yZHNNYXRjaCAmJiBhbGxQaHJhc2VzTWF0Y2g7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVjayBpZiBhIHRlY2huaXF1ZSBtYXRjaGVzIHRoZSBzZWFyY2ggcXVlcnkuXHJcbiAgICAgKlxyXG4gICAgICogKipTZWFyY2ggSGllcmFyY2h5IChjaGVja2VkIGluIG9yZGVyKToqKlxyXG4gICAgICogMS4gKipUZWNobmlxdWUgSUQqKiAoZS5nLiwgXCJUMTU2NlwiKSAtIGhpZ2hlc3QgcHJpb3JpdHksIGV4YWN0IG1hdGNoXHJcbiAgICAgKiAyLiAqKlRlY2huaXF1ZSBOYW1lKiogKGUuZy4sIFwiUGhpc2hpbmdcIikgLSBjb21tb24gdXNlIGNhc2VcclxuICAgICAqIDMuICoqVGVjaG5pcXVlIERlc2NyaXB0aW9uKiogLSBmaW5kcyB0ZWNobmlxdWVzIGJ5IHRoZWlyIGJlaGF2aW9yIGRlc2NyaXB0aW9uXHJcbiAgICAgKiA0LiAqKlN1YnRlY2huaXF1ZXMqKiAtIGlmIGFueSBzdWJ0ZWNobmlxdWUgbWF0Y2hlcywgc2hvdyB0aGUgcGFyZW50IHRvb1xyXG4gICAgICpcclxuICAgICAqICoqUGFyZW50L1N1YnRlY2huaXF1ZSBMb2dpYzoqKlxyXG4gICAgICogV2hlbiBhIHN1YnRlY2huaXF1ZSBtYXRjaGVzIHRoZSBzZWFyY2gsIHRoZSBwYXJlbnQgdGVjaG5pcXVlIGlzIGFsc29cclxuICAgICAqIGluY2x1ZGVkIGluIHJlc3VsdHMgc28gdGhlIHVzZXIgY2FuIGV4cGFuZCBpdCBhbmQgc2VlIHRoZSBtYXRjaGluZ1xyXG4gICAgICogc3VidGVjaG5pcXVlLiBGb3IgZXhhbXBsZSwgc2VhcmNoaW5nIFwic3BlYXJwaGlzaGluZ1wiIHdpbGwgc2hvdyBUMTU2NlxyXG4gICAgICogKFBoaXNoaW5nKSB3aXRoIFQxNTY2LjAwMSAoU3BlYXJwaGlzaGluZyBBdHRhY2htZW50KSBhcyBhbiBleHBhbmRhYmxlIGNoaWxkLlxyXG4gICAgICpcclxuICAgICAqICoqTWF0Y2ggUHJlY2VkZW5jZToqKlxyXG4gICAgICogUmV0dXJucyBhcyBzb29uIGFzIGEgbWF0Y2ggaXMgZm91bmQgKHNob3J0LWNpcmN1aXRzKSwgcHJpb3JpdGl6aW5nXHJcbiAgICAgKiBtb3JlIHNwZWNpZmljIG1hdGNoZXMgKElEID4gbmFtZSA+IGRlc2NyaXB0aW9uID4gc3VidGVjaG5pcXVlKS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gdGVjaG5pcXVlIC0gVGVjaG5pcXVlIHRvIGNoZWNrXHJcbiAgICAgKiBAcGFyYW0gc2VhcmNoU3RhdGUgLSBQYXJzZWQgc2VhcmNoIHN0YXRlIHdpdGgga2V5d29yZHMvcGhyYXNlc1xyXG4gICAgICogQHJldHVybnMgU2VhcmNoTWF0Y2ggcmVzdWx0IHdpdGggbWF0Y2ggZGV0YWlsc1xyXG4gICAgICovXHJcbiAgICBwcml2YXRlIG1hdGNoZXNTZWFyY2godGVjaG5pcXVlOiBNaXRyZVRlY2huaXF1ZSwgc2VhcmNoU3RhdGU6IFNlYXJjaFN0YXRlKTogU2VhcmNoTWF0Y2gge1xyXG4gICAgICAgIGlmICghc2VhcmNoU3RhdGUuaXNBY3RpdmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgbWF0Y2hlZDogdHJ1ZSB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gMS4gQ2hlY2sgdGVjaG5pcXVlIElEIChlLmcuLCBcIlQxNTY2XCIpXHJcbiAgICAgICAgaWYgKHRoaXMudGV4dE1hdGNoZXNRdWVyeSh0ZWNobmlxdWUuaWQsIHNlYXJjaFN0YXRlKSkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgbWF0Y2hlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIG1hdGNoVHlwZTogJ2lkJyxcclxuICAgICAgICAgICAgICAgIG1hdGNoVGV4dDogdGVjaG5pcXVlLmlkXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyAyLiBDaGVjayB0ZWNobmlxdWUgbmFtZSAoZS5nLiwgXCJQaGlzaGluZ1wiKVxyXG4gICAgICAgIGlmICh0aGlzLnRleHRNYXRjaGVzUXVlcnkodGVjaG5pcXVlLm5hbWUsIHNlYXJjaFN0YXRlKSkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgbWF0Y2hlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIG1hdGNoVHlwZTogJ25hbWUnLFxyXG4gICAgICAgICAgICAgICAgbWF0Y2hUZXh0OiB0ZWNobmlxdWUubmFtZVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gMy4gQ2hlY2sgdGVjaG5pcXVlIGRlc2NyaXB0aW9uIChlLmcuLCBcImFkdmVyc2FyeSBzZW5kcyBlbWFpbFwiKVxyXG4gICAgICAgIGlmICh0ZWNobmlxdWUuZGVzY3JpcHRpb24gJiYgdGhpcy50ZXh0TWF0Y2hlc1F1ZXJ5KHRlY2huaXF1ZS5kZXNjcmlwdGlvbiwgc2VhcmNoU3RhdGUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBtYXRjaGVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgbWF0Y2hUeXBlOiAnZGVzY3JpcHRpb24nLFxyXG4gICAgICAgICAgICAgICAgbWF0Y2hUZXh0OiB0ZWNobmlxdWUuZGVzY3JpcHRpb25cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIDQuIENoZWNrIHN1YnRlY2huaXF1ZXMgKGlmIGNoaWxkIG1hdGNoZXMsIHNob3cgcGFyZW50IGZvciBjb250ZXh0KVxyXG4gICAgICAgIGNvbnN0IHN1YnRlY2huaXF1ZXMgPSB0aGlzLnN1YnRlY2huaXF1ZXNNYXAuZ2V0KHRlY2huaXF1ZS5pZCkgfHwgW107XHJcbiAgICAgICAgZm9yIChjb25zdCBzdWJ0ZWNoIG9mIHN1YnRlY2huaXF1ZXMpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMudGV4dE1hdGNoZXNRdWVyeShzdWJ0ZWNoLmlkLCBzZWFyY2hTdGF0ZSkgfHxcclxuICAgICAgICAgICAgICAgIHRoaXMudGV4dE1hdGNoZXNRdWVyeShzdWJ0ZWNoLm5hbWUsIHNlYXJjaFN0YXRlKSB8fFxyXG4gICAgICAgICAgICAgICAgKHN1YnRlY2guZGVzY3JpcHRpb24gJiYgdGhpcy50ZXh0TWF0Y2hlc1F1ZXJ5KHN1YnRlY2guZGVzY3JpcHRpb24sIHNlYXJjaFN0YXRlKSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBtYXRjaFR5cGU6ICdzdWJ0ZWNobmlxdWUnLFxyXG4gICAgICAgICAgICAgICAgICAgIG1hdGNoVGV4dDogc3VidGVjaC5uYW1lXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4geyBtYXRjaGVkOiBmYWxzZSB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXNjYXBlIEhUTUwgdG8gcHJldmVudCBYU1MgaW5qZWN0aW9uLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB0ZXh0IC0gVGV4dCB0byBlc2NhcGVcclxuICAgICAqIEByZXR1cm5zIEhUTUwtZXNjYXBlZCB0ZXh0XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZXNjYXBlSHRtbCh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIGRpdi50ZXh0Q29udGVudCA9IHRleHQ7XHJcbiAgICAgICAgcmV0dXJuIGRpdi5pbm5lckhUTUw7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBFc2NhcGUgc3BlY2lhbCByZWdleCBjaGFyYWN0ZXJzLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB0ZXh0IC0gVGV4dCB0byBlc2NhcGVcclxuICAgICAqIEByZXR1cm5zIFJlZ2V4LWVzY2FwZWQgdGV4dFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGVzY2FwZVJlZ2V4KHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHRleHQucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEhpZ2hsaWdodCBzZWFyY2ggbWF0Y2hlcyBpbiB0ZXh0IGVsZW1lbnQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGVsZW1lbnQgLSBET00gZWxlbWVudCB0byBoaWdobGlnaHRcclxuICAgICAqIEBwYXJhbSBvcmlnaW5hbFRleHQgLSBPcmlnaW5hbCB0ZXh0IGNvbnRlbnRcclxuICAgICAqIEBwYXJhbSBzZWFyY2hTdGF0ZSAtIFBhcnNlZCBzZWFyY2ggc3RhdGVcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBoaWdobGlnaHRNYXRjaGVzKGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBvcmlnaW5hbFRleHQ6IHN0cmluZywgc2VhcmNoU3RhdGU6IFNlYXJjaFN0YXRlKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKCFzZWFyY2hTdGF0ZS5pc0FjdGl2ZSB8fCAhb3JpZ2luYWxUZXh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBlc2NhcGVkVGV4dCA9IHRoaXMuZXNjYXBlSHRtbChvcmlnaW5hbFRleHQpO1xyXG5cclxuICAgICAgICAvLyBIaWdobGlnaHQgcGhyYXNlcyBmaXJzdCAobG9uZ2VyIG1hdGNoZXMpXHJcbiAgICAgICAgc2VhcmNoU3RhdGUucGhyYXNlcy5mb3JFYWNoKHBocmFzZSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVzY2FwZWRQaHJhc2UgPSB0aGlzLmVzY2FwZVJlZ2V4KHBocmFzZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgKCR7ZXNjYXBlZFBocmFzZX0pYCwgJ2dpJyk7XHJcbiAgICAgICAgICAgIGVzY2FwZWRUZXh0ID0gZXNjYXBlZFRleHQucmVwbGFjZShyZWdleCwgJzxtYXJrIGNsYXNzPVwibWl0cmUtc2VhcmNoLWhpZ2hsaWdodFwiPiQxPC9tYXJrPicpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBIaWdobGlnaHQga2V5d29yZHMgKGF2b2lkIGRvdWJsZS13cmFwcGluZyBpbnNpZGUgZXhpc3RpbmcgbWFya3MpXHJcbiAgICAgICAgc2VhcmNoU3RhdGUua2V5d29yZHMuZm9yRWFjaChrZXl3b3JkID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZXNjYXBlZEtleXdvcmQgPSB0aGlzLmVzY2FwZVJlZ2V4KGtleXdvcmQpO1xyXG4gICAgICAgICAgICAvLyBVc2UgbmVnYXRpdmUgbG9va2FoZWFkIHRvIGF2b2lkIG1hdGNoaW5nIGluc2lkZSBleGlzdGluZyA8bWFyaz4gdGFnc1xyXG4gICAgICAgICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYCg/ITxtYXJrW14+XSo+KSgke2VzY2FwZWRLZXl3b3JkfSkoPyFbXjxdKjxcXC9tYXJrPilgLCAnZ2knKTtcclxuICAgICAgICAgICAgZXNjYXBlZFRleHQgPSBlc2NhcGVkVGV4dC5yZXBsYWNlKHJlZ2V4LCAnPG1hcmsgY2xhc3M9XCJtaXRyZS1zZWFyY2gtaGlnaGxpZ2h0XCI+JDE8L21hcms+Jyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gZXNjYXBlZFRleHQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBhc3luYyBleHBvcnRUb05hdmlnYXRvcigpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICBjb25zb2xlLmRlYnVnKCdbTWl0cmVNb2RhbF0gPT09PT0gRVhQT1JUSU5HID09PT09Jyk7XHJcbiAgICAgICAgY29uc3QgaW9jRGF0YSA9IHRoaXMudGltZVByb2Nlc3Nvci5leHRyYWN0Rml4ZWRJT0NEYXRhKCk7XHJcbiAgICAgICAgY29uc3QgdGFjdGljcyA9IGF3YWl0IHRoaXMuYWdncmVnYXRlVGFjdGljc1RlY2huaXF1ZXMoaW9jRGF0YSk7XHJcblxyXG4gICAgICAgIC8vIEJ1aWxkIE1JVFJFIEFUVCZDSyBOYXZpZ2F0b3IgbGF5ZXIgZm9ybWF0XHJcbiAgICAgICAgY29uc3QgbGF5ZXIgPSB7XHJcbiAgICAgICAgICAgIG5hbWU6IFwiQ3liZXIgQ2FudmFzIElPQyBBbmFseXNpc1wiLFxyXG4gICAgICAgICAgICB2ZXJzaW9uczoge1xyXG4gICAgICAgICAgICAgICAgYXR0YWNrOiBcIjE0XCIsXHJcbiAgICAgICAgICAgICAgICBuYXZpZ2F0b3I6IFwiNC45LjRcIixcclxuICAgICAgICAgICAgICAgIGxheWVyOiBcIjQuNVwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGRvbWFpbjogXCJlbnRlcnByaXNlLWF0dGFja1wiLFxyXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogYEdlbmVyYXRlZCBmcm9tICR7aW9jRGF0YS5sZW5ndGh9IElPQyBjYXJkcyBpbiBPYnNpZGlhbiBDYW52YXNgLFxyXG4gICAgICAgICAgICBmaWx0ZXJzOiB7XHJcbiAgICAgICAgICAgICAgICBwbGF0Zm9ybXM6IFtcIndpbmRvd3NcIiwgXCJsaW51eFwiLCBcIm1hY29zXCJdXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNvcnRpbmc6IDAsXHJcbiAgICAgICAgICAgIGxheW91dDoge1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0OiBcInNpZGVcIixcclxuICAgICAgICAgICAgICAgIGFnZ3JlZ2F0ZUZ1bmN0aW9uOiBcImF2ZXJhZ2VcIixcclxuICAgICAgICAgICAgICAgIHNob3dJRDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIHNob3dOYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgc2hvd0FnZ3JlZ2F0ZVNjb3JlczogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBjb3VudFVuc2NvcmVkOiBmYWxzZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBoaWRlRGlzYWJsZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICB0ZWNobmlxdWVzOiBbXSBhcyBhbnlbXSxcclxuICAgICAgICAgICAgZ3JhZGllbnQ6IHtcclxuICAgICAgICAgICAgICAgIGNvbG9yczogW1wiI2ZmNjY2NlwiLCBcIiNmZmU3NjZcIiwgXCIjOGVjODQzXCJdLFxyXG4gICAgICAgICAgICAgICAgbWluVmFsdWU6IDAsXHJcbiAgICAgICAgICAgICAgICBtYXhWYWx1ZTogMTAwXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGxlZ2VuZEl0ZW1zOiBbXSBhcyBhbnlbXSxcclxuICAgICAgICAgICAgbWV0YWRhdGE6IFtdIGFzIGFueVtdLFxyXG4gICAgICAgICAgICBsaW5rczogW10gYXMgYW55W10sXHJcbiAgICAgICAgICAgIHNob3dUYWN0aWNSb3dCYWNrZ3JvdW5kOiB0cnVlLFxyXG4gICAgICAgICAgICB0YWN0aWNSb3dCYWNrZ3JvdW5kOiBcIiNkZGRkZGRcIixcclxuICAgICAgICAgICAgc2VsZWN0VGVjaG5pcXVlc0Fjcm9zc1RhY3RpY3M6IHRydWUsXHJcbiAgICAgICAgICAgIHNlbGVjdFN1YnRlY2huaXF1ZXNXaXRoUGFyZW50OiBmYWxzZVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIEFkZCB0ZWNobmlxdWVzIHRvIGxheWVyIChvbmx5IGZvdW5kIHRlY2huaXF1ZXMpXHJcbiAgICAgICAgdGFjdGljcy5mb3JFYWNoKHRhY3RpYyA9PiB7XHJcbiAgICAgICAgICAgIHRhY3RpYy50ZWNobmlxdWVzLmZvckVhY2godGVjaG5pcXVlID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIFNraXAgdW5mb3VuZCB0ZWNobmlxdWVzIGluIGV4cG9ydFxyXG4gICAgICAgICAgICAgICAgaWYgKCF0ZWNobmlxdWUuaXNGb3VuZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBVc2UgdGFjdGljIHNob3J0IG5hbWUgZnJvbSBkYXRhc2V0XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0YWN0aWNEYXRhID0gdGhpcy5taXRyZURhdGFzZXQ/LnRhY3RpY3NbdGVjaG5pcXVlLnRhY3RpY0lkXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRhY3RpY1Nob3J0TmFtZSA9IHRhY3RpY0RhdGE/LnNob3J0X25hbWVcclxuICAgICAgICAgICAgICAgICAgICB8fCB0YWN0aWMubmFtZS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xccysvZywgJy0nKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBTZXQgY29sb3IgYmFzZWQgb24gc2V2ZXJpdHlcclxuICAgICAgICAgICAgICAgIGxldCBjb2xvcjogc3RyaW5nO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRlY2huaXF1ZS5zZXZlcml0eSA9PT0gJ3ZhbGlkJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yID0gXCIjNjZiYjZhXCI7ICAvLyBHcmVlbiAtIHZhbGlkXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaXNDcml0aWNhbFNldmVyaXR5KHRlY2huaXF1ZS5zZXZlcml0eSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb2xvciA9IFwiI2Y0NDMzNlwiOyAgLy8gUmVkIC0gdW5rbm93blxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0ZWNobmlxdWUuc2V2ZXJpdHkgPT09ICdtaXNtYXRjaCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb2xvciA9IFwiI2ZmYTUwMFwiOyAgLy8gT3JhbmdlIC0gd3JvbmcgdGFjdGljXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yID0gXCIjNjZiYjZhXCI7ICAvLyBEZWZhdWx0IGdyZWVuXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gQnVpbGQgY29tbWVudCB3aXRoIHZhbGlkYXRpb24gc3RhdHVzXHJcbiAgICAgICAgICAgICAgICBsZXQgY29tbWVudCA9IGBVc2VkIGluICR7dGVjaG5pcXVlLmNvdW50fSBJT0MgY2FyZCR7dGVjaG5pcXVlLmNvdW50ID4gMSA/ICdzJyA6ICcnfWA7XHJcbiAgICAgICAgICAgICAgICBpZiAodGVjaG5pcXVlLnNldmVyaXR5ICE9PSAndmFsaWQnICYmIHRlY2huaXF1ZS52YWxpZGF0aW9uTWVzc2FnZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbW1lbnQgKz0gYFxcbiR7dGhpcy5nZXRTZXZlcml0eUljb24odGVjaG5pcXVlLnNldmVyaXR5KX0gJHt0ZWNobmlxdWUudmFsaWRhdGlvbk1lc3NhZ2V9YDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBsYXllci50ZWNobmlxdWVzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIHRlY2huaXF1ZUlEOiB0ZWNobmlxdWUuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgdGFjdGljOiB0YWN0aWNTaG9ydE5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IGNvbG9yLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbW1lbnQ6IGNvbW1lbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YTogW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnc2V2ZXJpdHknLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHRlY2huaXF1ZS5zZXZlcml0eVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnaW9jX2NhcmRzJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0ZWNobmlxdWUuaW9jQ2FyZHMuam9pbignLCAnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgICAgICAgICBsaW5rczogW10sXHJcbiAgICAgICAgICAgICAgICAgICAgc2hvd1N1YnRlY2huaXF1ZXM6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIHNjb3JlOiB0ZWNobmlxdWUuY291bnQgKiAxMCAvLyBTY2FsZSBjb3VudCBmb3IgdmlzdWFsIHdlaWdodFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBDcmVhdGUgZG93bmxvYWRcclxuICAgICAgICBjb25zdCBqc29uU3RyaW5nID0gSlNPTi5zdHJpbmdpZnkobGF5ZXIsIG51bGwsIDIpO1xyXG4gICAgICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbanNvblN0cmluZ10sIHsgdHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nIH0pO1xyXG4gICAgICAgIGNvbnN0IHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XHJcblxyXG4gICAgICAgIGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICAgICAgYS5ocmVmID0gdXJsO1xyXG4gICAgICAgIGEuZG93bmxvYWQgPSBgbWl0cmUtbmF2aWdhdG9yLSR7RGF0ZS5ub3coKX0uanNvbmA7XHJcbiAgICAgICAgYS5jbGljaygpO1xyXG5cclxuICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25DbG9zZSgpOiB2b2lkIHtcclxuICAgICAgICBjb25zb2xlLmRlYnVnKCdbTWl0cmVNb2RhbF0gPT09PT0gTU9EQUwgQ0xPU0VEID09PT09Jyk7XHJcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBZGQgZHJhZyBoYW5kbGVzIGFuZCByZXNpemUgZnVuY3Rpb25hbGl0eSB0byB0aGUgbW9kYWwuXHJcbiAgICAgKlxyXG4gICAgICogQ3JlYXRlcyA4IHJlc2l6ZSBoYW5kbGVzICg0IGNvcm5lcnMgKyA0IGVkZ2VzKSBhbmQgYXR0YWNoZXMgZHJhZyBsaXN0ZW5lcnMuXHJcbiAgICAgKiBFYWNoIGhhbmRsZSBjYWxjdWxhdGVzIG5ldyBkaW1lbnNpb25zIGJhc2VkIG9uIG1vdXNlIG1vdmVtZW50IGRpcmVjdGlvbjpcclxuICAgICAqXHJcbiAgICAgKiAqKkNvb3JkaW5hdGUgTWF0aDoqKlxyXG4gICAgICogLSAqKkVhc3QgKEUpOioqIERyYWcgcmlnaHQgaW5jcmVhc2VzIHdpZHRoIGJ5IGRlbHRhWFxyXG4gICAgICogLSAqKldlc3QgKFcpOioqIERyYWcgbGVmdCBkZWNyZWFzZXMgd2lkdGgsIHNoaWZ0cyBtb2RhbCBsZWZ0XHJcbiAgICAgKiAtICoqU291dGggKFMpOioqIERyYWcgZG93biBpbmNyZWFzZXMgaGVpZ2h0IGJ5IGRlbHRhWVxyXG4gICAgICogLSAqKk5vcnRoIChOKToqKiBEcmFnIHVwIGRlY3JlYXNlcyBoZWlnaHQsIHNoaWZ0cyBtb2RhbCB1cFxyXG4gICAgICogLSAqKkNvcm5lcnM6KiogQ29tYmluZSB0d28gZGlyZWN0aW9ucyAoZS5nLiwgTkUgPSBOb3J0aCArIEVhc3QpXHJcbiAgICAgKlxyXG4gICAgICogKipDb25zdHJhaW50czoqKlxyXG4gICAgICogLSBNSU5fV0lEVEg6IDYwMHB4IChwcmV2ZW50cyBjcnVzaGluZyB0YWN0aWMgY29sdW1ucylcclxuICAgICAqIC0gTUlOX0hFSUdIVDogNDAwcHggKHByZXZlbnRzIGhpZGluZyBoZWFkZXIvY29udHJvbHMpXHJcbiAgICAgKiAtIE1BWF9XSURUSC9NQVhfSEVJR0hUOiA5NSUgb2Ygdmlld3BvcnQgKHByZXZlbnRzIG92ZXJmbG93KVxyXG4gICAgICpcclxuICAgICAqICoqUG9zaXRpb24gVXBkYXRlczoqKlxyXG4gICAgICogV2hlbiByZXNpemluZyBmcm9tIE5vcnRoIG9yIFdlc3QgZWRnZXMsIHRoZSBtb2RhbCBwb3NpdGlvbiBtdXN0IHNoaWZ0XHJcbiAgICAgKiB0byBtYWludGFpbiB0aGUgb3Bwb3NpdGUgZWRnZSdzIHBvc2l0aW9uLiBGb3IgZXhhbXBsZSwgZHJhZ2dpbmcgdGhlIFdlc3RcclxuICAgICAqIGVkZ2UgbGVmdCBieSA1MHB4IG11c3QgYWxzbyBtb3ZlIHRoZSBtb2RhbCBsZWZ0IGJ5IDUwcHguXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgbWFrZVJlc2l6YWJsZSgpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBtb2RhbCA9IHRoaXMubW9kYWxFbDtcclxuXHJcbiAgICAgICAgLy8gTWluaW11bSBhbmQgbWF4aW11bSBjb25zdHJhaW50cyBmb3IgbW9kYWwgZGltZW5zaW9uc1xyXG4gICAgICAgIGNvbnN0IE1JTl9XSURUSCA9IDYwMDsgICAvLyBOYXJyb3dlciB3b3VsZCBjcnVzaCB0YWN0aWMgY29sdW1uc1xyXG4gICAgICAgIGNvbnN0IE1JTl9IRUlHSFQgPSA0MDA7ICAvLyBTaG9ydGVyIHdvdWxkIGhpZGUgaGVhZGVyL2NvbnRyb2xzXHJcbiAgICAgICAgY29uc3QgTUFYX1dJRFRIID0gd2luZG93LmlubmVyV2lkdGggKiAwLjk1OyAgIC8vIExlYXZlIDUlIHZpZXdwb3J0IG1hcmdpblxyXG4gICAgICAgIGNvbnN0IE1BWF9IRUlHSFQgPSB3aW5kb3cuaW5uZXJIZWlnaHQgKiAwLjk1O1xyXG5cclxuICAgICAgICAvLyBSZXNpemUgaGFuZGxlIHBvc2l0aW9uczogW2NsYXNzTmFtZSwgY3Vyc29yLCBpc0Nvcm5lcl1cclxuICAgICAgICAvLyBOPU5vcnRoLCBTPVNvdXRoLCBFPUVhc3QsIFc9V2VzdFxyXG4gICAgICAgIGNvbnN0IGhhbmRsZXM6IEFycmF5PFtzdHJpbmcsIHN0cmluZywgYm9vbGVhbl0+ID0gW1xyXG4gICAgICAgICAgICBbJ3Jlc2l6ZS1oYW5kbGUtbicsICducy1yZXNpemUnLCBmYWxzZV0sICAgIC8vIFRvcCBlZGdlXHJcbiAgICAgICAgICAgIFsncmVzaXplLWhhbmRsZS1zJywgJ25zLXJlc2l6ZScsIGZhbHNlXSwgICAgLy8gQm90dG9tIGVkZ2VcclxuICAgICAgICAgICAgWydyZXNpemUtaGFuZGxlLWUnLCAnZXctcmVzaXplJywgZmFsc2VdLCAgICAvLyBSaWdodCBlZGdlXHJcbiAgICAgICAgICAgIFsncmVzaXplLWhhbmRsZS13JywgJ2V3LXJlc2l6ZScsIGZhbHNlXSwgICAgLy8gTGVmdCBlZGdlXHJcbiAgICAgICAgICAgIFsncmVzaXplLWhhbmRsZS1uZScsICduZXN3LXJlc2l6ZScsIHRydWVdLCAgLy8gVG9wLXJpZ2h0IGNvcm5lclxyXG4gICAgICAgICAgICBbJ3Jlc2l6ZS1oYW5kbGUtbncnLCAnbndzZS1yZXNpemUnLCB0cnVlXSwgIC8vIFRvcC1sZWZ0IGNvcm5lclxyXG4gICAgICAgICAgICBbJ3Jlc2l6ZS1oYW5kbGUtc2UnLCAnbndzZS1yZXNpemUnLCB0cnVlXSwgIC8vIEJvdHRvbS1yaWdodCBjb3JuZXJcclxuICAgICAgICAgICAgWydyZXNpemUtaGFuZGxlLXN3JywgJ25lc3ctcmVzaXplJywgdHJ1ZV0sICAvLyBCb3R0b20tbGVmdCBjb3JuZXJcclxuICAgICAgICBdO1xyXG5cclxuICAgICAgICBoYW5kbGVzLmZvckVhY2goKFtjbGFzc05hbWUsIGN1cnNvciwgaXNDb3JuZXJdKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGhhbmRsZSA9IG1vZGFsLmNyZWF0ZURpdihgbWl0cmUtcmVzaXplLWhhbmRsZSAke2NsYXNzTmFtZX1gKTtcclxuICAgICAgICAgICAgaGFuZGxlLnN0eWxlLmN1cnNvciA9IGN1cnNvcjtcclxuXHJcbiAgICAgICAgICAgIGxldCBzdGFydFggPSAwLCBzdGFydFkgPSAwLCBzdGFydFdpZHRoID0gMCwgc3RhcnRIZWlnaHQgPSAwLCBzdGFydExlZnQgPSAwLCBzdGFydFRvcCA9IDA7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBvbk1vdXNlRG93biA9IChlOiBNb3VzZUV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cclxuICAgICAgICAgICAgICAgIHN0YXJ0WCA9IGUuY2xpZW50WDtcclxuICAgICAgICAgICAgICAgIHN0YXJ0WSA9IGUuY2xpZW50WTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCByZWN0ID0gbW9kYWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgICAgICBzdGFydFdpZHRoID0gcmVjdC53aWR0aDtcclxuICAgICAgICAgICAgICAgIHN0YXJ0SGVpZ2h0ID0gcmVjdC5oZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICBzdGFydExlZnQgPSByZWN0LmxlZnQ7XHJcbiAgICAgICAgICAgICAgICBzdGFydFRvcCA9IHJlY3QudG9wO1xyXG5cclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIG9uTW91c2VNb3ZlKTtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBvbk1vdXNlVXApO1xyXG5cclxuICAgICAgICAgICAgICAgIG1vZGFsLmFkZENsYXNzKCdtaXRyZS1tb2RhbC1yZXNpemluZycpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgY29uc3Qgb25Nb3VzZU1vdmUgPSAoZTogTW91c2VFdmVudCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIG1vdXNlIG1vdmVtZW50IHNpbmNlIGRyYWcgc3RhcnRlZFxyXG4gICAgICAgICAgICAgICAgY29uc3QgZGVsdGFYID0gZS5jbGllbnRYIC0gc3RhcnRYOyAgLy8gUG9zaXRpdmUgPSBtb3ZlZCByaWdodCwgbmVnYXRpdmUgPSBtb3ZlZCBsZWZ0XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZWx0YVkgPSBlLmNsaWVudFkgLSBzdGFydFk7ICAvLyBQb3NpdGl2ZSA9IG1vdmVkIGRvd24sIG5lZ2F0aXZlID0gbW92ZWQgdXBcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBJbml0aWFsaXplIG5ldyBkaW1lbnNpb25zL3Bvc2l0aW9uIGZyb20gc3RhcnRpbmcgdmFsdWVzXHJcbiAgICAgICAgICAgICAgICBsZXQgbmV3V2lkdGggPSBzdGFydFdpZHRoO1xyXG4gICAgICAgICAgICAgICAgbGV0IG5ld0hlaWdodCA9IHN0YXJ0SGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgbGV0IG5ld0xlZnQgPSBzdGFydExlZnQ7XHJcbiAgICAgICAgICAgICAgICBsZXQgbmV3VG9wID0gc3RhcnRUb3A7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgbmV3IGRpbWVuc2lvbnMgYmFzZWQgb24gaGFuZGxlIGRpcmVjdGlvblxyXG4gICAgICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgICAgICAgICAvLyBFYWNoIGhhbmRsZSBkaXJlY3Rpb24gdXBkYXRlcyBkaWZmZXJlbnQgZGltZW5zaW9uczpcclxuICAgICAgICAgICAgICAgIC8vICAgLSBFYXN0L1dlc3QgYWZmZWN0IHdpZHRoXHJcbiAgICAgICAgICAgICAgICAvLyAgIC0gTm9ydGgvU291dGggYWZmZWN0IGhlaWdodFxyXG4gICAgICAgICAgICAgICAgLy8gICAtIENvcm5lcnMgY29tYmluZSBib3RoXHJcbiAgICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgICAgLy8gQ29uc3RyYWludHMgKE1JTi9NQVgpIGFyZSBhcHBsaWVkIHRvIHByZXZlbnQgaW52YWxpZCBzaXplcy5cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoY2xhc3NOYW1lLmluY2x1ZGVzKCctZScpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gRWFzdCAocmlnaHQgZWRnZSk6IGRyYWcgcmlnaHQgaW5jcmVhc2VzIHdpZHRoXHJcbiAgICAgICAgICAgICAgICAgICAgbmV3V2lkdGggPSBNYXRoLm1heChNSU5fV0lEVEgsIE1hdGgubWluKE1BWF9XSURUSCwgc3RhcnRXaWR0aCArIGRlbHRhWCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGNsYXNzTmFtZS5pbmNsdWRlcygnLXcnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFdlc3QgKGxlZnQgZWRnZSk6IGRyYWcgbGVmdCBpbmNyZWFzZXMgd2lkdGgsIHNoaWZ0cyBtb2RhbCBsZWZ0XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gTm90ZTogZGVsdGFYIGlzIG5lZ2F0aXZlIHdoZW4gZHJhZ2dpbmcgbGVmdCwgc28gc3VidHJhY3QgaXRcclxuICAgICAgICAgICAgICAgICAgICBuZXdXaWR0aCA9IE1hdGgubWF4KE1JTl9XSURUSCwgTWF0aC5taW4oTUFYX1dJRFRILCBzdGFydFdpZHRoIC0gZGVsdGFYKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gU2hpZnQgbW9kYWwgbGVmdCBieSB0aGUgZGlmZmVyZW5jZSB0byBrZWVwIHJpZ2h0IGVkZ2Ugc3RhdGlvbmFyeVxyXG4gICAgICAgICAgICAgICAgICAgIG5ld0xlZnQgPSBzdGFydExlZnQgKyAoc3RhcnRXaWR0aCAtIG5ld1dpZHRoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChjbGFzc05hbWUuaW5jbHVkZXMoJy1zJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBTb3V0aCAoYm90dG9tIGVkZ2UpOiBkcmFnIGRvd24gaW5jcmVhc2VzIGhlaWdodFxyXG4gICAgICAgICAgICAgICAgICAgIG5ld0hlaWdodCA9IE1hdGgubWF4KE1JTl9IRUlHSFQsIE1hdGgubWluKE1BWF9IRUlHSFQsIHN0YXJ0SGVpZ2h0ICsgZGVsdGFZKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoY2xhc3NOYW1lLmluY2x1ZGVzKCctbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gTm9ydGggKHRvcCBlZGdlKTogZHJhZyB1cCBpbmNyZWFzZXMgaGVpZ2h0LCBzaGlmdHMgbW9kYWwgdXBcclxuICAgICAgICAgICAgICAgICAgICAvLyBOb3RlOiBkZWx0YVkgaXMgbmVnYXRpdmUgd2hlbiBkcmFnZ2luZyB1cCwgc28gc3VidHJhY3QgaXRcclxuICAgICAgICAgICAgICAgICAgICBuZXdIZWlnaHQgPSBNYXRoLm1heChNSU5fSEVJR0hULCBNYXRoLm1pbihNQVhfSEVJR0hULCBzdGFydEhlaWdodCAtIGRlbHRhWSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFNoaWZ0IG1vZGFsIHVwIGJ5IHRoZSBkaWZmZXJlbmNlIHRvIGtlZXAgYm90dG9tIGVkZ2Ugc3RhdGlvbmFyeVxyXG4gICAgICAgICAgICAgICAgICAgIG5ld1RvcCA9IHN0YXJ0VG9wICsgKHN0YXJ0SGVpZ2h0IC0gbmV3SGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBBcHBseSBuZXcgZGltZW5zaW9ucyB3aXRoICFpbXBvcnRhbnQgdG8gb3ZlcnJpZGUgYW55IENTU1xyXG4gICAgICAgICAgICAgICAgbW9kYWwuc3R5bGUuc2V0UHJvcGVydHkoJ3dpZHRoJywgYCR7bmV3V2lkdGh9cHhgLCAnaW1wb3J0YW50Jyk7XHJcbiAgICAgICAgICAgICAgICBtb2RhbC5zdHlsZS5zZXRQcm9wZXJ0eSgnaGVpZ2h0JywgYCR7bmV3SGVpZ2h0fXB4YCwgJ2ltcG9ydGFudCcpO1xyXG4gICAgICAgICAgICAgICAgbW9kYWwuc3R5bGUuc2V0UHJvcGVydHkoJ21heC13aWR0aCcsIGAke25ld1dpZHRofXB4YCwgJ2ltcG9ydGFudCcpO1xyXG4gICAgICAgICAgICAgICAgbW9kYWwuc3R5bGUuc2V0UHJvcGVydHkoJ21heC1oZWlnaHQnLCBgJHtuZXdIZWlnaHR9cHhgLCAnaW1wb3J0YW50Jyk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIHBvc2l0aW9uIGlmIHJlc2l6aW5nIGZyb20gdG9wIG9yIGxlZnRcclxuICAgICAgICAgICAgICAgIGlmIChjbGFzc05hbWUuaW5jbHVkZXMoJy13JykgfHwgY2xhc3NOYW1lLmluY2x1ZGVzKCctbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kYWwuc3R5bGUubGVmdCA9IGAke25ld0xlZnR9cHhgO1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGFsLnN0eWxlLnRvcCA9IGAke25ld1RvcH1weGA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBjb25zdCBvbk1vdXNlVXAgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBvbk1vdXNlTW92ZSk7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgb25Nb3VzZVVwKTtcclxuICAgICAgICAgICAgICAgIG1vZGFsLnJlbW92ZUNsYXNzKCdtaXRyZS1tb2RhbC1yZXNpemluZycpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgaGFuZGxlLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIG9uTW91c2VEb3duKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG4iLCAiLyoqXHJcbiAqIE1pdHJlTG9hZGVyLnRzIC0gQXN5bmMgbG9hZGVyIGZvciBNSVRSRSBBVFQmQ0sgZGF0YXNldFxyXG4gKlxyXG4gKiBMb2FkcyB0aGUgZnVsbCBNSVRSRSBkYXRhc2V0IGZyb20gTUlUUkUvZW50ZXJwcmlzZS1hdHRhY2suanNvbi5cclxuICogUmVxdWlyZXMgZW50ZXJwcmlzZS1hdHRhY2suanNvbiAtIHRocm93cyBlcnJvciBpZiB1bmF2YWlsYWJsZS5cclxuICovXHJcblxyXG5pbXBvcnQgeyBBcHAgfSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIE1pdHJlRGF0YXNldCB7XHJcbiAgICB2ZXJzaW9uOiBzdHJpbmc7XHJcbiAgICBsYXN0X3VwZGF0ZWQ6IHN0cmluZztcclxuICAgIHRhY3RpY3M6IFJlY29yZDxzdHJpbmcsIFRhY3RpY0RhdGE+O1xyXG4gICAgdGVjaG5pcXVlczogUmVjb3JkPHN0cmluZywgVGVjaG5pcXVlRGF0YT47XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVGFjdGljRGF0YSB7XHJcbiAgICBpZDogc3RyaW5nOyAgICAgICAgICAgICAgLy8gXCJUQTAwMDZcIlxyXG4gICAgbmFtZTogc3RyaW5nOyAgICAgICAgICAgIC8vIFwiQ3JlZGVudGlhbCBBY2Nlc3NcIlxyXG4gICAgc2hvcnRfbmFtZTogc3RyaW5nOyAgICAgIC8vIFwiY3JlZGVudGlhbC1hY2Nlc3NcIlxyXG4gICAgZGVzY3JpcHRpb246IHN0cmluZztcclxuICAgIGFiYnJldmlhdGlvbnM6IHN0cmluZ1tdOyAvLyBbXCJDQVwiLCBcIkNSRURcIl1cclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBUZWNobmlxdWVEYXRhIHtcclxuICAgIGlkOiBzdHJpbmc7ICAgICAgICAgICAgICAvLyBcIlQxNTU3XCJcclxuICAgIG5hbWU6IHN0cmluZzsgICAgICAgICAgICAvLyBcIkFkdmVyc2FyeS1pbi10aGUtTWlkZGxlXCJcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgICB0YWN0aWNzOiBzdHJpbmdbXTsgICAgICAgLy8gW1wiVEEwMDA2XCJdXHJcbiAgICBwYXJlbnQ/OiBzdHJpbmc7ICAgICAgICAgLy8gRm9yIHN1Yi10ZWNobmlxdWVzXHJcbiAgICB1cmw6IHN0cmluZztcclxufVxyXG5cclxubGV0IGNhY2hlZERhdGFzZXQ6IE1pdHJlRGF0YXNldCB8IG51bGwgPSBudWxsO1xyXG5cclxuLyoqIENvbW1vbiBhYmJyZXZpYXRpb25zIGZvciBNSVRSRSB0YWN0aWMgbmFtZXMuICovXHJcbmNvbnN0IFRBQ1RJQ19BQkJSRVZJQVRJT05TOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4gPSB7XHJcbiAgICAnUmVjb25uYWlzc2FuY2UnOiBbJ1JFQ09OJywgJ1JFQ0NFJywgJ1JFJ10sXHJcbiAgICAnUmVzb3VyY2UgRGV2ZWxvcG1lbnQnOiBbJ1JFU09VUkNFJywgJ1JFUycsICdSRCddLFxyXG4gICAgJ0luaXRpYWwgQWNjZXNzJzogWydJQScsICdJTklUJ10sXHJcbiAgICAnRXhlY3V0aW9uJzogWydFWEVDJywgJ0VYRScsICdFWCddLFxyXG4gICAgJ1BlcnNpc3RlbmNlJzogWydQRVJTSVNUJywgJ1BFUlMnLCAnUFMnXSxcclxuICAgICdQcml2aWxlZ2UgRXNjYWxhdGlvbic6IFsnUFJJVicsICdQRScsICdQUklWRVNDJywgJ1BSSVYgRVNDJ10sXHJcbiAgICAnRGVmZW5zZSBFdmFzaW9uJzogWydERUZFTlNFJywgJ0RFRicsICdERSddLFxyXG4gICAgJ0NyZWRlbnRpYWwgQWNjZXNzJzogWydDUkVEJywgJ0NBJywgJ0NSRUQgQUNDRVNTJ10sXHJcbiAgICAnRGlzY292ZXJ5JzogWydESVNDJywgJ0RJUycsICdESSddLFxyXG4gICAgJ0xhdGVyYWwgTW92ZW1lbnQnOiBbJ0xBVEVSQUwnLCAnTE0nLCAnTEFUIE1PVkUnXSxcclxuICAgICdDb2xsZWN0aW9uJzogWydDT0xMRUNUJywgJ0NPTCcsICdDTyddLFxyXG4gICAgJ0NvbW1hbmQgYW5kIENvbnRyb2wnOiBbJ0MyJywgJ0NOQycsICdDQyddLFxyXG4gICAgJ0V4ZmlsdHJhdGlvbic6IFsnRVhGSUwnLCAnRVhGSUxUUkFURScsICdFWCddLFxyXG4gICAgJ0ltcGFjdCc6IFsnSU1QJywgJ0lNJ11cclxufTtcclxuXHJcbi8qKlxyXG4gKiBMb2FkIE1JVFJFIGRhdGFzZXQgZnJvbSBKU09OIGZpbGUgb3IgZmFsbGJhY2sgdG8gZW1iZWRkZWQgZGF0YS5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkTWl0cmVEYXRhc2V0KGFwcDogQXBwKTogUHJvbWlzZTxNaXRyZURhdGFzZXQ+IHtcclxuICAgIGlmIChjYWNoZWREYXRhc2V0KSB7XHJcbiAgICAgICAgY29uc29sZS5kZWJ1ZygnW01pdHJlTG9hZGVyXSBSZXR1cm5pbmcgY2FjaGVkIGRhdGFzZXQnKTtcclxuICAgICAgICByZXR1cm4gY2FjaGVkRGF0YXNldDtcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAgIC8vIFRyeSB0byBsb2FkIGZyb20gdmF1bHRcclxuICAgICAgICBjb25zdCBhZGFwdGVyID0gYXBwLnZhdWx0LmFkYXB0ZXI7XHJcbiAgICAgICAgY29uc3QganNvblBhdGggPSAnLm9ic2lkaWFuL3BsdWdpbnMvY3liZXJfY2FudmFzL01JVFJFL2VudGVycHJpc2UtYXR0YWNrLmpzb24nO1xyXG5cclxuICAgICAgICBjb25zb2xlLmRlYnVnKCdbTWl0cmVMb2FkZXJdIEF0dGVtcHRpbmcgdG8gbG9hZCBmcm9tOicsIGpzb25QYXRoKTtcclxuXHJcbiAgICAgICAgaWYgKGF3YWl0IGFkYXB0ZXIuZXhpc3RzKGpzb25QYXRoKSkge1xyXG4gICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgYWRhcHRlci5yZWFkKGpzb25QYXRoKTtcclxuICAgICAgICAgICAgY29uc3Qgc3RpeEJ1bmRsZSA9IEpTT04ucGFyc2UoY29udGVudCk7XHJcblxyXG4gICAgICAgICAgICAvLyBDaGVjayBpZiBpdCdzIGEgU1RJWCBidW5kbGVcclxuICAgICAgICAgICAgaWYgKHN0aXhCdW5kbGUudHlwZSA9PT0gJ2J1bmRsZScgJiYgQXJyYXkuaXNBcnJheShzdGl4QnVuZGxlLm9iamVjdHMpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdbTWl0cmVMb2FkZXJdIFBhcnNpbmcgU1RJWCAyLjEgYnVuZGxlIGZvcm1hdC4uLicpO1xyXG4gICAgICAgICAgICAgICAgY2FjaGVkRGF0YXNldCA9IHBhcnNlU3RpeEJ1bmRsZShzdGl4QnVuZGxlKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbTWl0cmVMb2FkZXJdIFx1MjcxMyBMb2FkZWQgZnVsbCBkYXRhc2V0IGZyb20gU1RJWCBidW5kbGUuIFRhY3RpY3M6JywgT2JqZWN0LmtleXMoY2FjaGVkRGF0YXNldC50YWN0aWNzKS5sZW5ndGgsICdUZWNobmlxdWVzOicsIE9iamVjdC5rZXlzKGNhY2hlZERhdGFzZXQudGVjaG5pcXVlcykubGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjYWNoZWREYXRhc2V0O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN0aXhCdW5kbGUudmVyc2lvbiAmJiBzdGl4QnVuZGxlLnRhY3RpY3MgJiYgc3RpeEJ1bmRsZS50ZWNobmlxdWVzKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBPbGQgcHJlLXByb2Nlc3NlZCBmb3JtYXQgKGJhY2t3YXJkIGNvbXBhdGliaWxpdHkpXHJcbiAgICAgICAgICAgICAgICBjYWNoZWREYXRhc2V0ID0gc3RpeEJ1bmRsZTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbTWl0cmVMb2FkZXJdIFx1MjcxMyBMb2FkZWQgcHJlLXByb2Nlc3NlZCBkYXRhc2V0LiBWZXJzaW9uOicsIGNhY2hlZERhdGFzZXQudmVyc2lvbiwgJ1RlY2huaXF1ZXM6JywgT2JqZWN0LmtleXMoY2FjaGVkRGF0YXNldC50ZWNobmlxdWVzKS5sZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlZERhdGFzZXQ7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ1tNaXRyZUxvYWRlcl0gVW5rbm93biBKU09OIGZvcm1hdCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignW01pdHJlTG9hZGVyXSBKU09OIGZpbGUgbm90IGZvdW5kIGF0OicsIGpzb25QYXRoKTtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgICAgICAgICAgJ01JVFJFIEFUVCZDSyBkYXRhc2V0IG5vdCBmb3VuZC4gUGxlYXNlIGVuc3VyZSBlbnRlcnByaXNlLWF0dGFjay5qc29uIGV4aXN0cyBpbiB0aGUgTUlUUkUgZm9sZGVyLiAnICtcclxuICAgICAgICAgICAgICAgICdEb3dubG9hZCBmcm9tOiBodHRwczovL2dpdGh1Yi5jb20vbWl0cmUtYXR0YWNrL2F0dGFjay1zdGl4LWRhdGEnXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignW01pdHJlTG9hZGVyXSBGYWlsZWQgdG8gbG9hZCBNSVRSRSBkYXRhc2V0OicsIGVycik7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgICAgICAnTUlUUkUgQVRUJkNLIGRhdGFzZXQgbm90IGZvdW5kLiBQbGVhc2UgZW5zdXJlIGVudGVycHJpc2UtYXR0YWNrLmpzb24gZXhpc3RzIGluIHRoZSBNSVRSRSBmb2xkZXIuICcgK1xyXG4gICAgICAgICAgICAnRG93bmxvYWQgZnJvbTogaHR0cHM6Ly9naXRodWIuY29tL21pdHJlLWF0dGFjay9hdHRhY2stc3RpeC1kYXRhJ1xyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSWYgd2UgcmVhY2ggaGVyZSB3aXRob3V0IHJldHVybmluZywgZGF0YXNldCBsb2FkIGZhaWxlZFxyXG4gICAgdGhyb3cgbmV3IEVycm9yKCdNSVRSRSBBVFQmQ0sgZGF0YXNldCBjb3VsZCBub3QgYmUgbG9hZGVkJyk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBQYXJzZSBTVElYIDIuMSBidW5kbGUgZm9ybWF0IGludG8gTWl0cmVEYXRhc2V0LlxyXG4gKlxyXG4gKiBUaGUgb2ZmaWNpYWwgTUlUUkUgQVRUJkNLIGRhdGFzZXQgdXNlcyBTVElYIDIuMSAoU3RydWN0dXJlZCBUaHJlYXQgSW5mb3JtYXRpb25cclxuICogZVhwcmVzc2lvbikgZm9ybWF0LCB3aGljaCBpcyBhIEpTT04tYmFzZWQgc3RhbmRhcmQgZm9yIHJlcHJlc2VudGluZyBjeWJlciB0aHJlYXRcclxuICogaW50ZWxsaWdlbmNlLiBUaGUgYnVuZGxlIGNvbnRhaW5zIG11bHRpcGxlIG9iamVjdCB0eXBlcyBtaXhlZCB0b2dldGhlci5cclxuICpcclxuICogKipTVElYIE9iamVjdCBUeXBlczoqKlxyXG4gKiAtIGB4LW1pdHJlLWNvbGxlY3Rpb25gOiBNZXRhZGF0YSAodmVyc2lvbiwgbGFzdCB1cGRhdGVkKVxyXG4gKiAtIGB4LW1pdHJlLXRhY3RpY2A6IFRhY3RpYyBkZWZpbml0aW9ucyAoZS5nLiwgSW5pdGlhbCBBY2Nlc3MsIEV4ZWN1dGlvbilcclxuICogLSBgYXR0YWNrLXBhdHRlcm5gOiBUZWNobmlxdWUgYW5kIHN1YnRlY2huaXF1ZSBkZWZpbml0aW9uc1xyXG4gKlxyXG4gKiAqKlR3by1QYXNzIEFsZ29yaXRobToqKlxyXG4gKiBXZSBwYXJzZSBpbiB0d28gcGFzc2VzIGJlY2F1c2UgdGVjaG5pcXVlcyByZWZlcmVuY2UgdGFjdGljcyBieSBzaG9ydF9uYW1lXHJcbiAqIChlLmcuLCBcImluaXRpYWwtYWNjZXNzXCIpIGluIHRoZWlyIGtpbGxfY2hhaW5fcGhhc2VzLCBzbyB0YWN0aWNzIG11c3QgYmVcclxuICogZXh0cmFjdGVkIGZpcnN0IHRvIGJ1aWxkIHRoZSBzaG9ydF9uYW1lIFx1MjE5MiB0YWN0aWMgSUQgbWFwcGluZy5cclxuICpcclxuICogKipQYXNzIDE6KiogRXh0cmFjdCBhbGwgdGFjdGljcyBhbmQgYnVpbGQgc2hvcnRfbmFtZSBtYXBwaW5nXHJcbiAqICoqUGFzcyAyOioqIEV4dHJhY3QgYWxsIHRlY2huaXF1ZXMgYW5kIHJlc29sdmUgdGFjdGljIElEcyBmcm9tIGtpbGxfY2hhaW5fcGhhc2VzXHJcbiAqXHJcbiAqIEBwYXJhbSBzdGl4QnVuZGxlIC0gUmF3IFNUSVggMi4xIGJ1bmRsZSBKU09OIG9iamVjdFxyXG4gKiBAcmV0dXJucyBOb3JtYWxpemVkIE1pdHJlRGF0YXNldCB3aXRoIHRhY3RpY3MgYW5kIHRlY2huaXF1ZXMgaW5kZXhlZCBieSBJRFxyXG4gKi9cclxuZnVuY3Rpb24gcGFyc2VTdGl4QnVuZGxlKHN0aXhCdW5kbGU6IGFueSk6IE1pdHJlRGF0YXNldCB7XHJcbiAgICBjb25zb2xlLmRlYnVnKCdbTWl0cmVMb2FkZXJdIFBhcnNpbmcgU1RJWCBidW5kbGUgd2l0aCcsIHN0aXhCdW5kbGUub2JqZWN0cz8ubGVuZ3RoLCAnb2JqZWN0cycpO1xyXG5cclxuICAgIGNvbnN0IHRhY3RpY3M6IFJlY29yZDxzdHJpbmcsIFRhY3RpY0RhdGE+ID0ge307XHJcbiAgICBjb25zdCB0ZWNobmlxdWVzOiBSZWNvcmQ8c3RyaW5nLCBUZWNobmlxdWVEYXRhPiA9IHt9O1xyXG5cclxuICAgIC8vIEV4dHJhY3QgdmVyc2lvbiBpbmZvIGZyb20gY29sbGVjdGlvbiBtZXRhZGF0YVxyXG4gICAgbGV0IHZlcnNpb24gPSAndW5rbm93bic7XHJcbiAgICBsZXQgbGFzdF91cGRhdGVkID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcblxyXG4gICAgZm9yIChjb25zdCBvYmogb2Ygc3RpeEJ1bmRsZS5vYmplY3RzKSB7XHJcbiAgICAgICAgaWYgKG9iai50eXBlID09PSAneC1taXRyZS1jb2xsZWN0aW9uJykge1xyXG4gICAgICAgICAgICB2ZXJzaW9uID0gb2JqLnhfbWl0cmVfdmVyc2lvbiB8fCAndW5rbm93bic7XHJcbiAgICAgICAgICAgIGxhc3RfdXBkYXRlZCA9IG9iai5tb2RpZmllZD8uc3BsaXQoJ1QnKVswXSB8fCBsYXN0X3VwZGF0ZWQ7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ1tNaXRyZUxvYWRlcl0gRm91bmQgY29sbGVjdGlvbiBtZXRhZGF0YSAtIHZlcnNpb246JywgdmVyc2lvbiwgJ3VwZGF0ZWQ6JywgbGFzdF91cGRhdGVkKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBGSVJTVCBQQVNTOiBFeHRyYWN0IHRhY3RpY3NcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gQnVpbGQgdGhlIGNvbXBsZXRlIHRhY3RpY3MgbWFwIEJFRk9SRSBwcm9jZXNzaW5nIHRlY2huaXF1ZXMsIGJlY2F1c2VcclxuICAgIC8vIHRlY2huaXF1ZXMgcmVmZXJlbmNlIHRhY3RpY3MgYnkgc2hvcnRfbmFtZSBpbiBraWxsX2NoYWluX3BoYXNlcy5cclxuICAgIGZvciAoY29uc3Qgb2JqIG9mIHN0aXhCdW5kbGUub2JqZWN0cykge1xyXG4gICAgICAgIGlmIChvYmoudHlwZSA9PT0gJ3gtbWl0cmUtdGFjdGljJyAmJiAhb2JqLnhfbWl0cmVfZGVwcmVjYXRlZCkge1xyXG4gICAgICAgICAgICBjb25zdCB0YWN0aWNJZCA9IG9iai5leHRlcm5hbF9yZWZlcmVuY2VzPy5maW5kKChyZWY6IGFueSkgPT4gcmVmLnNvdXJjZV9uYW1lID09PSAnbWl0cmUtYXR0YWNrJyk/LmV4dGVybmFsX2lkO1xyXG4gICAgICAgICAgICBpZiAoIXRhY3RpY0lkKSBjb250aW51ZTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHNob3J0TmFtZSA9IG9iai54X21pdHJlX3Nob3J0bmFtZSB8fCB0YWN0aWNJZC50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgICAgICB0YWN0aWNzW3RhY3RpY0lkXSA9IHtcclxuICAgICAgICAgICAgICAgIGlkOiB0YWN0aWNJZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IG9iai5uYW1lLFxyXG4gICAgICAgICAgICAgICAgc2hvcnRfbmFtZTogc2hvcnROYW1lLFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IG9iai5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgICAgICAgICAgIGFiYnJldmlhdGlvbnM6IGdlbmVyYXRlQWJicmV2aWF0aW9ucyhvYmoubmFtZSlcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5kZWJ1ZygnW01pdHJlTG9hZGVyXSBQYXJzZWQnLCBPYmplY3Qua2V5cyh0YWN0aWNzKS5sZW5ndGgsICd0YWN0aWNzJyk7XHJcblxyXG4gICAgLy8gQnVpbGQgdGFjdGljIHNob3J0IG5hbWUgdG8gSUQgbWFwIGZvciB0ZWNobmlxdWUgcHJvY2Vzc2luZ1xyXG4gICAgLy8gRXhhbXBsZSBtYXBwaW5nOiBcImluaXRpYWwtYWNjZXNzXCIgXHUyMTkyIFwiVEEwMDAxXCJcclxuICAgIGNvbnN0IHNob3J0TmFtZVRvVGFjdGljSWQgPSBuZXcgTWFwPHN0cmluZywgc3RyaW5nPigpO1xyXG4gICAgZm9yIChjb25zdCBbdGFjdGljSWQsIHRhY3RpY10gb2YgT2JqZWN0LmVudHJpZXModGFjdGljcykpIHtcclxuICAgICAgICBzaG9ydE5hbWVUb1RhY3RpY0lkLnNldCh0YWN0aWMuc2hvcnRfbmFtZSwgdGFjdGljSWQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gU0VDT05EIFBBU1M6IEV4dHJhY3QgdGVjaG5pcXVlc1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBOb3cgdGhhdCB3ZSBoYXZlIHRoZSBmdWxsIHRhY3RpY3MgbWFwLCBwcm9jZXNzIGFsbCBhdHRhY2stcGF0dGVybiBvYmplY3RzXHJcbiAgICAvLyAodGVjaG5pcXVlcyBhbmQgc3VidGVjaG5pcXVlcykuIFJlc29sdmUgdGFjdGljIElEcyBmcm9tIGtpbGxfY2hhaW5fcGhhc2VzXHJcbiAgICAvLyB1c2luZyB0aGUgc2hvcnROYW1lVG9UYWN0aWNJZCBtYXAgYnVpbHQgYWJvdmUuXHJcbiAgICAvL1xyXG4gICAgLy8gKipUZWNobmlxdWUgU3RydWN0dXJlOioqXHJcbiAgICAvLyAtIFBhcmVudCB0ZWNobmlxdWVzOiBSZWd1bGFyIHRlY2huaXF1ZXMgKGUuZy4sIFQxNTY2IC0gUGhpc2hpbmcpXHJcbiAgICAvLyAtIFN1YnRlY2huaXF1ZXM6IENoaWxkIHRlY2huaXF1ZXMgd2l0aCBwYXJlbnQgcmVmZXJlbmNlIChlLmcuLCBUMTU2Ni4wMDEpXHJcbiAgICAvLyAtIFRlY2huaXF1ZXMgY2FuIGJlbG9uZyB0byBtdWx0aXBsZSB0YWN0aWNzIChzdG9yZWQgYXMgYXJyYXkpXHJcbiAgICBmb3IgKGNvbnN0IG9iaiBvZiBzdGl4QnVuZGxlLm9iamVjdHMpIHtcclxuICAgICAgICBpZiAob2JqLnR5cGUgPT09ICdhdHRhY2stcGF0dGVybicgJiYgIW9iai54X21pdHJlX2RlcHJlY2F0ZWQpIHtcclxuICAgICAgICAgICAgY29uc3QgdGVjaG5pcXVlSWQgPSBvYmouZXh0ZXJuYWxfcmVmZXJlbmNlcz8uZmluZCgocmVmOiBhbnkpID0+IHJlZi5zb3VyY2VfbmFtZSA9PT0gJ21pdHJlLWF0dGFjaycpPy5leHRlcm5hbF9pZDtcclxuICAgICAgICAgICAgaWYgKCF0ZWNobmlxdWVJZCkgY29udGludWU7XHJcblxyXG4gICAgICAgICAgICAvLyBFeHRyYWN0IHRhY3RpYyBJRHMgZnJvbSBraWxsX2NoYWluX3BoYXNlc1xyXG4gICAgICAgICAgICBjb25zdCB0YWN0aWNJZHM6IHN0cmluZ1tdID0gW107XHJcbiAgICAgICAgICAgIGlmIChvYmoua2lsbF9jaGFpbl9waGFzZXMpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgcGhhc2Ugb2Ygb2JqLmtpbGxfY2hhaW5fcGhhc2VzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBoYXNlLmtpbGxfY2hhaW5fbmFtZSA9PT0gJ21pdHJlLWF0dGFjaycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFjdGljSWQgPSBzaG9ydE5hbWVUb1RhY3RpY0lkLmdldChwaGFzZS5waGFzZV9uYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhY3RpY0lkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWN0aWNJZHMucHVzaCh0YWN0aWNJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIERldGVybWluZSBwYXJlbnQgZm9yIHN1Yi10ZWNobmlxdWVzXHJcbiAgICAgICAgICAgIGxldCBwYXJlbnQ6IHN0cmluZyB8IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgaWYgKG9iai54X21pdHJlX2lzX3N1YnRlY2huaXF1ZSAmJiB0ZWNobmlxdWVJZC5pbmNsdWRlcygnLicpKSB7XHJcbiAgICAgICAgICAgICAgICBwYXJlbnQgPSB0ZWNobmlxdWVJZC5zcGxpdCgnLicpWzBdO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0ZWNobmlxdWVzW3RlY2huaXF1ZUlkXSA9IHtcclxuICAgICAgICAgICAgICAgIGlkOiB0ZWNobmlxdWVJZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IG9iai5uYW1lLFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IG9iai5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgICAgICAgICAgIHRhY3RpY3M6IHRhY3RpY0lkcyxcclxuICAgICAgICAgICAgICAgIHBhcmVudCxcclxuICAgICAgICAgICAgICAgIHVybDogb2JqLmV4dGVybmFsX3JlZmVyZW5jZXM/LmZpbmQoKHJlZjogYW55KSA9PiByZWYuc291cmNlX25hbWUgPT09ICdtaXRyZS1hdHRhY2snKT8udXJsIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgIGBodHRwczovL2F0dGFjay5taXRyZS5vcmcvdGVjaG5pcXVlcy8ke3RlY2huaXF1ZUlkLnJlcGxhY2UoJy4nLCAnLycpfWBcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5kZWJ1ZygnW01pdHJlTG9hZGVyXSBQYXJzZWQnLCBPYmplY3Qua2V5cyh0ZWNobmlxdWVzKS5sZW5ndGgsICd0ZWNobmlxdWVzJyk7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICB2ZXJzaW9uLFxyXG4gICAgICAgIGxhc3RfdXBkYXRlZCxcclxuICAgICAgICB0YWN0aWNzLFxyXG4gICAgICAgIHRlY2huaXF1ZXNcclxuICAgIH07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZW5lcmF0ZSBhYmJyZXZpYXRpb25zIGZvciBhIHRhY3RpYyBuYW1lLlxyXG4gKlxyXG4gKiBDcmVhdGVzIG11bHRpcGxlIGFiYnJldmlhdGlvbiBmb3JtYXRzIHRvIHN1cHBvcnQgZmxleGlibGUgdXNlciBpbnB1dDpcclxuICpcclxuICogKioxLiBJbml0aWFscyAoYXV0b21hdGljKToqKlxyXG4gKiAtIFwiQ3JlZGVudGlhbCBBY2Nlc3NcIiBcdTIxOTIgXCJDQVwiXHJcbiAqIC0gXCJDb21tYW5kIGFuZCBDb250cm9sXCIgXHUyMTkyIFwiQ0NcIlxyXG4gKiAtIFwiUHJpdmlsZWdlIEVzY2FsYXRpb25cIiBcdTIxOTIgXCJQRVwiXHJcbiAqXHJcbiAqICoqMi4gS25vd24gYWJicmV2aWF0aW9ucyAoZnJvbSBUQUNUSUNfQUJCUkVWSUFUSU9OUyBjb25zdGFudCk6KipcclxuICogLSBBZGRzIGNvbW1vbiBzaG9ydCBmb3JtcyBsaWtlIFwiQ1JFRFwiLCBcIkMyXCIsIFwiUFJJVlwiLCBldGMuXHJcbiAqXHJcbiAqICoqQWxnb3JpdGhtOioqXHJcbiAqIC0gU3BsaXQgdGFjdGljIG5hbWUgYnkgc3BhY2VzIG9yIGh5cGhlbnM6IC9bXFxzXFwtXSsvXHJcbiAqIC0gTWFwIGVhY2ggd29yZCB0byBpdHMgZmlyc3QgY2hhcmFjdGVyOiBbJ0MnLCAnQSddXHJcbiAqIC0gSm9pbiBhbmQgdXBwZXJjYXNlOiBcIkNBXCJcclxuICogLSBBcHBlbmQga25vd24gYWJicmV2aWF0aW9ucyBmcm9tIGxvb2t1cCB0YWJsZVxyXG4gKlxyXG4gKiBAcGFyYW0gdGFjdGljTmFtZSAtIEZ1bGwgdGFjdGljIG5hbWUgKGUuZy4sIFwiQ3JlZGVudGlhbCBBY2Nlc3NcIilcclxuICogQHJldHVybnMgQXJyYXkgb2YgYWJicmV2aWF0aW9uIHN0cmluZ3MgKGUuZy4sIFtcIkNBXCIsIFwiQ1JFRFwiLCBcIkNSRUQgQUNDRVNTXCJdKVxyXG4gKi9cclxuZnVuY3Rpb24gZ2VuZXJhdGVBYmJyZXZpYXRpb25zKHRhY3RpY05hbWU6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgIGNvbnN0IGFiYnJldnM6IHN0cmluZ1tdID0gW107XHJcblxyXG4gICAgLy8gR2VuZXJhdGUgaW5pdGlhbHMgKGUuZy4sIFwiQ3JlZGVudGlhbCBBY2Nlc3NcIiAtPiBcIkNBXCIpXHJcbiAgICBjb25zdCB3b3JkcyA9IHRhY3RpY05hbWUuc3BsaXQoL1tcXHNcXC1dKy8pO1xyXG4gICAgaWYgKHdvcmRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAvLyBNYXAgZWFjaCB3b3JkIHRvIGZpcnN0IGxldHRlciwgam9pbiwgdXBwZXJjYXNlXHJcbiAgICAgICAgYWJicmV2cy5wdXNoKHdvcmRzLm1hcCh3ID0+IHdbMF0pLmpvaW4oJycpLnRvVXBwZXJDYXNlKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkZCBrbm93biBhYmJyZXZpYXRpb25zIGZyb20gVEFDVElDX0FCQlJFVklBVElPTlMgY29uc3RhbnRcclxuICAgIGlmIChUQUNUSUNfQUJCUkVWSUFUSU9OU1t0YWN0aWNOYW1lXSkge1xyXG4gICAgICAgIGFiYnJldnMucHVzaCguLi5UQUNUSUNfQUJCUkVWSUFUSU9OU1t0YWN0aWNOYW1lXSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGFiYnJldnM7XHJcbn1cclxuXHJcblxyXG4vKipcclxuICogTm9ybWFsaXplIHRhY3RpYyBuYW1lIGZvciBsb29rdXAsIGhhbmRsaW5nIG11bHRpcGxlIGlucHV0IGZvcm1hdHMuXHJcbiAqXHJcbiAqIEFjY2VwdHMgZmxleGlibGUgdGFjdGljIGlucHV0IGZyb20gdXNlcnMgYW5kIG5vcm1hbGl6ZXMgaXQgdG8gYSB0YWN0aWMgSUQgKGUuZy4sIFwiVEEwMDA2XCIpLlxyXG4gKiBVc2VzIGEgKip0aHJlZS1wYXNzIG1hdGNoaW5nIHN0cmF0ZWd5Kiogd2l0aCBwcm9ncmVzc2l2ZWx5IG1vcmUgZmxleGlibGUgcnVsZXM6XHJcbiAqXHJcbiAqICoqUGFzcyAxOiBTaG9ydCBOYW1lIE1hdGNoKiogKGUuZy4sIFwiY3JlZGVudGlhbC1hY2Nlc3NcIiwgXCJjcmVkZW50aWFsYWNjZXNzXCIsIFwiQ1JFREVOVElBTF9BQ0NFU1NcIilcclxuICogLSBOb3JtYWxpemVzIGlucHV0OiBsb3dlcmNhc2UsIHJlbW92ZSBzcGFjZXMvZGFzaGVzL3VuZGVyc2NvcmVzXHJcbiAqIC0gQ29tcGFyZXMgYWdhaW5zdCB0YWN0aWMuc2hvcnRfbmFtZSAoYWxzbyBub3JtYWxpemVkKVxyXG4gKiAtIEV4YW1wbGU6IFwiY3JlZGVudGlhbCBhY2Nlc3NcIiBcdTIxOTIgXCJjcmVkZW50aWFsYWNjZXNzXCIgXHUyMTkyIG1hdGNoZXMgXCJjcmVkZW50aWFsLWFjY2Vzc1wiIFx1MjE5MiBUQTAwMDZcclxuICpcclxuICogKipQYXNzIDI6IEZ1bGwgTmFtZSBNYXRjaCoqIChlLmcuLCBcIkNyZWRlbnRpYWwgQWNjZXNzXCIpXHJcbiAqIC0gU2FtZSBub3JtYWxpemF0aW9uIGFzIFBhc3MgMVxyXG4gKiAtIENvbXBhcmVzIGFnYWluc3QgdGFjdGljLm5hbWUgKG5vcm1hbGl6ZWQpXHJcbiAqIC0gRXhhbXBsZTogXCJDcmVkZW50aWFsLUFjY2Vzc1wiIFx1MjE5MiBcImNyZWRlbnRpYWxhY2Nlc3NcIiBcdTIxOTIgbWF0Y2hlcyBcIkNyZWRlbnRpYWwgQWNjZXNzXCIgXHUyMTkyIFRBMDAwNlxyXG4gKlxyXG4gKiAqKlBhc3MgMzogQWJicmV2aWF0aW9uIE1hdGNoKiogKGUuZy4sIFwiQ0FcIiwgXCJDUkVEXCIsIFwiQ1JFRCBBQ0NFU1NcIilcclxuICogLSBVcHBlcmNhc2UgaW5wdXQsIG5vIG5vcm1hbGl6YXRpb25cclxuICogLSBDb21wYXJlcyBhZ2FpbnN0IHRhY3RpYy5hYmJyZXZpYXRpb25zIGFycmF5XHJcbiAqIC0gRXhhbXBsZTogXCJjYVwiIFx1MjE5MiBcIkNBXCIgXHUyMTkyIG1hdGNoZXMgYWJicmV2aWF0aW9ucyBcdTIxOTIgVEEwMDA2XHJcbiAqXHJcbiAqICoqV2h5IFRocmVlIFBhc3Nlcz8qKlxyXG4gKiBBbGxvd3MgdXNlcnMgdG8gdHlwZSB0YWN0aWNzIGluIGFueSBmb3JtYXQgd2l0aG91dCBuZWVkaW5nIHRvIGtub3cgdGhlIGV4YWN0XHJcbiAqIGRhdGFzZXQgZm9ybWF0LiBBbGwgb2YgdGhlc2UgaW5wdXRzIHJlc29sdmUgdG8gdGhlIHNhbWUgdGFjdGljOlxyXG4gKiAtIFwiQ3JlZGVudGlhbCBBY2Nlc3NcIiwgXCJjcmVkZW50aWFsLWFjY2Vzc1wiLCBcIkNSRURFTlRJQUxfQUNDRVNTXCJcclxuICogLSBcIkNBXCIsIFwiQ1JFRFwiLCBcIkNSRUQgQUNDRVNTXCJcclxuICpcclxuICogQHBhcmFtIG5hbWUgLSBVc2VyIGlucHV0IHRhY3RpYyBzdHJpbmdcclxuICogQHBhcmFtIGRhdGFzZXQgLSBMb2FkZWQgTUlUUkUgZGF0YXNldFxyXG4gKiBAcmV0dXJucyBUYWN0aWMgSUQgKGUuZy4sIFwiVEEwMDA2XCIpIG9yIG51bGwgaWYgbm8gbWF0Y2ggZm91bmRcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVUYWN0aWNOYW1lKG5hbWU6IHN0cmluZywgZGF0YXNldDogTWl0cmVEYXRhc2V0KTogc3RyaW5nIHwgbnVsbCB7XHJcbiAgICAvLyBOb3JtYWxpemU6IGxvd2VyY2FzZSwgcmVtb3ZlIHNwYWNlcy9kYXNoZXMvdW5kZXJzY29yZXNcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWQgPSBuYW1lLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvW1xcc1xcLV9dKy9nLCAnJyk7XHJcblxyXG4gICAgY29uc29sZS5kZWJ1ZygnW01pdHJlTG9hZGVyXSBOb3JtYWxpemluZyB0YWN0aWM6JywgbmFtZSwgJ1x1MjE5MicsIG5vcm1hbGl6ZWQpO1xyXG5cclxuICAgIC8vIFBBU1MgMTogQ2hlY2sgZXhhY3QgbWF0Y2ggYWdhaW5zdCBzaG9ydF9uYW1lIChlLmcuLCBcImNyZWRlbnRpYWwtYWNjZXNzXCIpXHJcbiAgICBmb3IgKGNvbnN0IFt0YWN0aWNJZCwgdGFjdGljXSBvZiBPYmplY3QuZW50cmllcyhkYXRhc2V0LnRhY3RpY3MpKSB7XHJcbiAgICAgICAgaWYgKHRhY3RpYy5zaG9ydF9uYW1lLnJlcGxhY2UoL1xcLS9nLCAnJykgPT09IG5vcm1hbGl6ZWQpIHtcclxuICAgICAgICAgICAgY29uc29sZS5kZWJ1ZygnW01pdHJlTG9hZGVyXSBcdTI3MTMgTWF0Y2hlZCBieSBzaG9ydF9uYW1lOicsIHRhY3RpYy5uYW1lLCAnKCcgKyB0YWN0aWNJZCArICcpJyk7XHJcbiAgICAgICAgICAgIHJldHVybiB0YWN0aWNJZDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUEFTUyAyOiBDaGVjayBmdWxsIG5hbWUgbWF0Y2ggKGUuZy4sIFwiQ3JlZGVudGlhbCBBY2Nlc3NcIilcclxuICAgIGZvciAoY29uc3QgW3RhY3RpY0lkLCB0YWN0aWNdIG9mIE9iamVjdC5lbnRyaWVzKGRhdGFzZXQudGFjdGljcykpIHtcclxuICAgICAgICBpZiAodGFjdGljLm5hbWUudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bXFxzXFwtX10rL2csICcnKSA9PT0gbm9ybWFsaXplZCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdbTWl0cmVMb2FkZXJdIFx1MjcxMyBNYXRjaGVkIGJ5IGZ1bGwgbmFtZTonLCB0YWN0aWMubmFtZSwgJygnICsgdGFjdGljSWQgKyAnKScpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGFjdGljSWQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFBBU1MgMzogQ2hlY2sgYWJicmV2aWF0aW9ucyAoZS5nLiwgXCJDQVwiLCBcIkNSRURcIilcclxuICAgIGNvbnN0IHVwcGVyID0gbmFtZS50b1VwcGVyQ2FzZSgpLnRyaW0oKTtcclxuICAgIGZvciAoY29uc3QgW3RhY3RpY0lkLCB0YWN0aWNdIG9mIE9iamVjdC5lbnRyaWVzKGRhdGFzZXQudGFjdGljcykpIHtcclxuICAgICAgICBpZiAodGFjdGljLmFiYnJldmlhdGlvbnMuaW5jbHVkZXModXBwZXIpKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ1tNaXRyZUxvYWRlcl0gXHUyNzEzIE1hdGNoZWQgYnkgYWJicmV2aWF0aW9uOicsIHVwcGVyLCAnXHUyMTkyJywgdGFjdGljLm5hbWUsICcoJyArIHRhY3RpY0lkICsgJyknKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRhY3RpY0lkO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjb25zb2xlLmRlYnVnKCdbTWl0cmVMb2FkZXJdIFx1MjcxNyBObyBtYXRjaCBmb3VuZCBmb3I6JywgbmFtZSk7XHJcbiAgICByZXR1cm4gbnVsbDtcclxufVxyXG5cclxuLyoqXHJcbiAqIFZhbGlkYXRlIHRlY2huaXF1ZS10YWN0aWMgbWFwcGluZyB3aXRoIHNldmVyaXR5IGxldmVscy5cclxuICpcclxuICogUGVyZm9ybXMgY29tcHJlaGVuc2l2ZSB2YWxpZGF0aW9uIG9mIGEgdGVjaG5pcXVlLXRhY3RpYyBwYWlyaW5nIGZyb20gYW4gSU9DIGNhcmQuXHJcbiAqIFJldHVybnMgYSBzZXZlcml0eSBlbnVtIGFuZCBvcHRpb25hbCBlcnJvciBtZXNzYWdlIGZvciBkaXNwbGF5IGluIHRoZSBNSVRSRSBtb2RhbC5cclxuICpcclxuICogKipWYWxpZGF0aW9uIFN0ZXBzIChpbiBvcmRlcik6KipcclxuICpcclxuICogMS4gKipOb3JtYWxpemUgVGFjdGljKiogLSBVc2Ugbm9ybWFsaXplVGFjdGljTmFtZSB0byByZXNvbHZlIHRhY3RpYyBJRFxyXG4gKiAgICAtIElmIGZhaWxzIFx1MjE5MiBgdW5rbm93bl90YWN0aWNgIChyZWQpXHJcbiAqXHJcbiAqIDIuICoqQ2hlY2sgVGVjaG5pcXVlIEV4aXN0cyoqIC0gTG9vayB1cCB0ZWNobmlxdWUgSUQgaW4gZGF0YXNldFxyXG4gKiAgICAtIElmIG5vdCBmb3VuZCBcdTIxOTIgYHVua25vd25fdGVjaG5pcXVlYCAocmVkKVxyXG4gKlxyXG4gKiAzLiAqKkNoZWNrIFRlY2huaXF1ZS1UYWN0aWMgUGFpcmluZyoqIC0gVmVyaWZ5IHRlY2huaXF1ZS50YWN0aWNzIGluY2x1ZGVzIHRhY3RpY0lkXHJcbiAqICAgIC0gSWYgbWlzbWF0Y2ggXHUyMTkyIGBtaXNtYXRjaGAgKG9yYW5nZSkgd2l0aCBsaXN0IG9mIHZhbGlkIHRhY3RpY3NcclxuICpcclxuICogNC4gKipBbGwgQ2hlY2tzIFBhc3MqKiBcdTIxOTIgYHZhbGlkYCAoZ3JlZW4pXHJcbiAqXHJcbiAqICoqU2V2ZXJpdHkgTWVhbmluZ3M6KipcclxuICogLSBgdmFsaWRgOiBDb3JyZWN0IHBhaXJpbmcgKGdyZWVuIGluZGljYXRvcilcclxuICogLSBgdW5rbm93bl90ZWNobmlxdWVgOiBUZWNobmlxdWUgSUQgbm90IGluIGRhdGFzZXQgKHJlZCwgY3JpdGljYWwpXHJcbiAqIC0gYHVua25vd25fdGFjdGljYDogVGFjdGljIG5hbWUvYWJicmV2aWF0aW9uIG5vdCByZWNvZ25pemVkIChyZWQsIGNyaXRpY2FsKVxyXG4gKiAtIGBtaXNtYXRjaGA6IEJvdGggZXhpc3QgYnV0IGRvbid0IGJlbG9uZyB0b2dldGhlciAob3JhbmdlLCB3YXJuaW5nKVxyXG4gKiAtIGBlbXB0eV90YWN0aWNgOiBOb3QgdXNlZCBoZXJlIChoYW5kbGVkIGluIGFnZ3JlZ2F0aW9uKVxyXG4gKlxyXG4gKiAqKkV4YW1wbGUgVmFsaWRhdGlvbjoqKlxyXG4gKiBgYGBcclxuICogdmFsaWRhdGVUZWNobmlxdWVUYWN0aWMoXCJUMTU2NlwiLCBcIkNBXCIsIGRhdGFzZXQpXHJcbiAqIFx1MjE5MiB7IHNldmVyaXR5OiAndmFsaWQnLCB0YWN0aWNJZDogJ1RBMDAwNicgfVxyXG4gKlxyXG4gKiB2YWxpZGF0ZVRlY2huaXF1ZVRhY3RpYyhcIlQxNTY2XCIsIFwiRXhlY3V0aW9uXCIsIGRhdGFzZXQpXHJcbiAqIFx1MjE5MiB7IHNldmVyaXR5OiAnbWlzbWF0Y2gnLCBtZXNzYWdlOiAnLi4uVmFsaWQgdGFjdGljczogSW5pdGlhbCBBY2Nlc3MnLCB0YWN0aWNJZDogJ1RBMDAwMicgfVxyXG4gKiBgYGBcclxuICpcclxuICogQHBhcmFtIHRlY2huaXF1ZUlkIC0gVGVjaG5pcXVlIElEIGZyb20gSU9DIGNhcmQgKGUuZy4sIFwiVDE1NjZcIilcclxuICogQHBhcmFtIHRhY3RpY0lucHV0IC0gVGFjdGljIHN0cmluZyBmcm9tIElPQyBjYXJkIChlLmcuLCBcIkNBXCIsIFwiQ3JlZGVudGlhbCBBY2Nlc3NcIilcclxuICogQHBhcmFtIGRhdGFzZXQgLSBMb2FkZWQgTUlUUkUgZGF0YXNldFxyXG4gKiBAcmV0dXJucyBWYWxpZGF0aW9uIHJlc3VsdCB3aXRoIHNldmVyaXR5LCBvcHRpb25hbCBtZXNzYWdlLCBhbmQgdGFjdGljSWRcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVRlY2huaXF1ZVRhY3RpYyhcclxuICAgIHRlY2huaXF1ZUlkOiBzdHJpbmcsXHJcbiAgICB0YWN0aWNJbnB1dDogc3RyaW5nLFxyXG4gICAgZGF0YXNldDogTWl0cmVEYXRhc2V0XHJcbik6IHtcclxuICAgIHNldmVyaXR5OiAndmFsaWQnIHwgJ3Vua25vd25fdGVjaG5pcXVlJyB8ICd1bmtub3duX3RhY3RpYycgfCAnbWlzbWF0Y2gnIHwgJ2VtcHR5X3RhY3RpYyc7XHJcbiAgICBtZXNzYWdlPzogc3RyaW5nO1xyXG4gICAgdGFjdGljSWQ/OiBzdHJpbmc7XHJcbn0ge1xyXG4gICAgLy8gU1RFUCAxOiBOb3JtYWxpemUgdGFjdGljIG5hbWUgdG8gdGFjdGljIElEIChlLmcuLCBcIkNBXCIgXHUyMTkyIFwiVEEwMDA2XCIpXHJcbiAgICBjb25zdCB0YWN0aWNJZCA9IG5vcm1hbGl6ZVRhY3RpY05hbWUodGFjdGljSW5wdXQsIGRhdGFzZXQpO1xyXG5cclxuICAgIC8vIFVua25vd24gdGFjdGljXHJcbiAgICBpZiAoIXRhY3RpY0lkKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc2V2ZXJpdHk6ICd1bmtub3duX3RhY3RpYycsXHJcbiAgICAgICAgICAgIG1lc3NhZ2U6IGBVbmtub3duIHRhY3RpYzogXCIke3RhY3RpY0lucHV0fVwiYFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU1RFUCAyOiBDaGVjayBpZiB0ZWNobmlxdWUgZXhpc3RzIGluIGRhdGFzZXRcclxuICAgIGNvbnN0IHRlY2huaXF1ZSA9IGRhdGFzZXQudGVjaG5pcXVlc1t0ZWNobmlxdWVJZF07XHJcbiAgICBpZiAoIXRlY2huaXF1ZSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHNldmVyaXR5OiAndW5rbm93bl90ZWNobmlxdWUnLFxyXG4gICAgICAgICAgICBtZXNzYWdlOiBgVW5rbm93biB0ZWNobmlxdWU6IFwiJHt0ZWNobmlxdWVJZH1cImBcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFNURVAgMzogQ2hlY2sgaWYgdGVjaG5pcXVlIGJlbG9uZ3MgdG8gdGhpcyB0YWN0aWNcclxuICAgIC8vIFRlY2huaXF1ZXMgY2FuIGJlbG9uZyB0byBtdWx0aXBsZSB0YWN0aWNzLCBzbyBjaGVjayBpZiB0YWN0aWNJZCBpcyBpbiB0aGUgYXJyYXlcclxuICAgIGlmICghdGVjaG5pcXVlLnRhY3RpY3MuaW5jbHVkZXModGFjdGljSWQpKSB7XHJcbiAgICAgICAgLy8gQnVpbGQgYSBoZWxwZnVsIGVycm9yIG1lc3NhZ2UgbGlzdGluZyB0aGUgY29ycmVjdCB0YWN0aWNzXHJcbiAgICAgICAgY29uc3QgdmFsaWRUYWN0aWNzID0gdGVjaG5pcXVlLnRhY3RpY3NcclxuICAgICAgICAgICAgLm1hcCh0aWQgPT4gZGF0YXNldC50YWN0aWNzW3RpZF0/Lm5hbWUgfHwgdGlkKVxyXG4gICAgICAgICAgICAuam9pbignLCAnKTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzZXZlcml0eTogJ21pc21hdGNoJyxcclxuICAgICAgICAgICAgbWVzc2FnZTogYCR7dGVjaG5pcXVlSWR9ICgke3RlY2huaXF1ZS5uYW1lfSkgZG9lcyBub3QgYmVsb25nIHRvICR7ZGF0YXNldC50YWN0aWNzW3RhY3RpY0lkXS5uYW1lfS4gVmFsaWQgdGFjdGljczogJHt2YWxpZFRhY3RpY3N9YCxcclxuICAgICAgICAgICAgdGFjdGljSWRcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFNURVAgNDogQWxsIHZhbGlkYXRpb24gY2hlY2tzIHBhc3NlZFxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBzZXZlcml0eTogJ3ZhbGlkJyxcclxuICAgICAgICB0YWN0aWNJZFxyXG4gICAgfTtcclxufVxyXG4iLCAiLyoqXG4gKiBSZW5kZXJJT0NDYXJkc01vZGFsLnRzIC0gSU9DIHR5cGUgcGlja2VyIG1vZGFsLlxuICpcbiAqIFByZXNlbnRzIGEgMy1jb2x1bW4gZ3JpZCBvZiBhbGwgcmVnaXN0ZXJlZCBJT0MgdHlwZXMuIFdoZW4gdGhlIGFuYWx5c3QgY2xpY2tzXG4gKiBhIHR5cGUsIHRoZSBtb2RhbCBmaXJlcyB0aGUgYG9uU2VsZWN0YCBjYWxsYmFjayB3aXRoIHRoZSBjaG9zZW4gdHlwZSBJRCBhbmRcbiAqIChmb3IgSG9zdG5hbWUpIHRoZSBPUyB2YXJpYW50LCB0aGVuIGNsb3Nlcy4gVGhlIHBhcmVudCBjb2RlIChtYWluLnRzKSB1c2VzXG4gKiB0aGUgY2FsbGJhY2sgdG8gY3JlYXRlIHRoZSBhY3R1YWwgY2FudmFzIHRleHQgbm9kZSB2aWEgUmVuZGVySU9DQ2FyZHMuXG4gKlxuICogU3BlY2lhbCBjYXNlOiBjbGlja2luZyBcIkhvc3RuYW1lXCIgZG9lcyBOT1QgaW1tZWRpYXRlbHkgc2VsZWN0IC0tIGl0IHJlcGxhY2VzXG4gKiB0aGUgZ3JpZCB3aXRoIGFuIE9TIHN1Yi1zZWxlY3RvciAoV2luZG93cyBXb3Jrc3RhdGlvbiAvIFdpbmRvd3MgU2VydmVyIC9cbiAqIG1hY09TIC8gTGludXgpIHNvIHRoZSBjYXJkIGdldHMgdGhlIGNvcnJlY3QgcGxhdGZvcm0gaWNvbi5cbiAqXG4gKiBOT1RFOiBUaGlzIGZpbGUgZGVjbGFyZXMgaXRzIG93biBsb2NhbCBJT0NGaWVsZC9JT0NUeXBlcyBpbnRlcmZhY2VzIHJhdGhlclxuICogdGhhbiBpbXBvcnRpbmcgZnJvbSBJT0NDYXJkc1R5cGVzLnRzLiBUaGV5IGFyZSBzdHJ1Y3R1cmFsbHkgaWRlbnRpY2FsLlxuICovXG5pbXBvcnQgeyBBcHAsIE1vZGFsIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5pbnRlcmZhY2UgSU9DRmllbGQge1xuICAgIG5hbWU6IHN0cmluZztcbiAgICBpY29uOiBzdHJpbmc7XG4gICAgY29sb3I6IHN0cmluZztcbiAgICBmaWVsZHM6IHN0cmluZ1tdO1xuICAgIHN2Zzogc3RyaW5nO1xuICAgIG9zX2ljb25zPzoge1xuICAgICAgICBba2V5OiBzdHJpbmddOiBzdHJpbmc7XG4gICAgfTtcbn1cblxuaW50ZXJmYWNlIElPQ1R5cGVzIHtcbiAgICBba2V5OiBzdHJpbmddOiBJT0NGaWVsZDtcbn1cblxuLyoqIENhbGxiYWNrIHNpZ25hdHVyZTogcmVjZWl2ZXMgdGhlIHNlbGVjdGVkIElPQyB0eXBlIGtleSBhbmQgb3B0aW9uYWwgT1MgdmFyaWFudC4gKi9cbnR5cGUgT25TZWxlY3RDYWxsYmFjayA9IChpb2NUeXBlSWQ6IHN0cmluZywgb3NUeXBlPzogc3RyaW5nKSA9PiB2b2lkO1xuXG5leHBvcnQgY2xhc3MgUmVuZGVySU9DQ2FyZHNNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBwcml2YXRlIGlvY1R5cGVzOiBJT0NUeXBlcztcbiAgICBwcml2YXRlIG9uU2VsZWN0OiBPblNlbGVjdENhbGxiYWNrO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIGlvY1R5cGVzOiBJT0NUeXBlcywgb25TZWxlY3Q6IE9uU2VsZWN0Q2FsbGJhY2spIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5pb2NUeXBlcyA9IGlvY1R5cGVzO1xuICAgICAgICB0aGlzLm9uU2VsZWN0ID0gb25TZWxlY3Q7XG4gICAgfVxuXG4gICAgLyoqIEJ1aWxkcyB0aGUgcHJpbWFyeSBJT0MgdHlwZSBncmlkIHZpZXcuICovXG4gICAgb25PcGVuKCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcblxuICAgICAgICB0aGlzLm1vZGFsRWwuY2xhc3NMaXN0LmFkZCgnaW9jLXR5cGUtc2VsZWN0b3ItbW9kYWwnKTtcbiAgICAgICAgdGhpcy5tb2RhbEVsLnN0eWxlLm1heFdpZHRoID0gJzkwMHB4JztcbiAgICAgICAgdGhpcy5tb2RhbEVsLnN0eWxlLndpZHRoID0gJzkwdncnO1xuXG4gICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdTZWxlY3QgSU9DIFR5cGUnIH0pO1xuXG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoJ2lvYy10eXBlLWNvbnRhaW5lcicpO1xuXG4gICAgICAgIGNvbnN0IHR5cGVDb3VudCA9IE9iamVjdC5rZXlzKHRoaXMuaW9jVHlwZXMpLmxlbmd0aDtcbiAgICAgICAgLy8gQ2FsY3VsYXRlIGNvbHVtbnM6IGFpbSBmb3Igcm91Z2hseSBzcXVhcmUgZ3JpZFxuICAgICAgICBjb25zdCBjb2xzID0gTWF0aC5taW4oTWF0aC5jZWlsKE1hdGguc3FydCh0eXBlQ291bnQpKSwgNSk7XG4gICAgICAgIGNvbnRhaW5lci5zdHlsZS5ncmlkVGVtcGxhdGVDb2x1bW5zID0gYHJlcGVhdCgke2NvbHN9LCAxZnIpYDtcblxuICAgICAgICBPYmplY3Qua2V5cyh0aGlzLmlvY1R5cGVzKS5mb3JFYWNoKChpb2NUeXBlSWQ6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgY29uc3QgaW9jVHlwZSA9IHRoaXMuaW9jVHlwZXNbaW9jVHlwZUlkXTtcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IGNvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJywgeyBjbHM6ICdpb2MtdHlwZS1idXR0b24nIH0pO1xuXG4gICAgICAgICAgICAvLyBDb2xvci1jb2RlZCBsZWZ0IGJvcmRlciBsZXRzIGFuYWx5c3RzIHZpc3VhbGx5IGFzc29jaWF0ZSB0eXBlcyB3aXRoXG4gICAgICAgICAgICAvLyB0aGUgc2FtZSBjb2xvcnMgdXNlZCBvbiB0aW1lbGluZSBpdGVtcyBhbmQgY2FyZCBoZWFkZXJzXG4gICAgICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCdkYXRhLWlvYy10eXBlJywgaW9jVHlwZUlkKTtcbiAgICAgICAgICAgIGJ1dHRvbi5zdHlsZS5ib3JkZXJMZWZ0ID0gYDRweCBzb2xpZCAke2lvY1R5cGUuY29sb3J9YDtcblxuICAgICAgICAgICAgY29uc3QgaWNvbkNvbnRhaW5lciA9IGJ1dHRvbi5jcmVhdGVEaXYoJ2lvYy1idXR0b24taWNvbicpO1xuICAgICAgICAgICAgaWNvbkNvbnRhaW5lci5pbm5lckhUTUwgPSBpb2NUeXBlLnN2ZztcblxuICAgICAgICAgICAgY29uc3QgdGV4dENvbnRhaW5lciA9IGJ1dHRvbi5jcmVhdGVEaXYoJ2lvYy1idXR0b24tdGV4dCcpO1xuICAgICAgICAgICAgdGV4dENvbnRhaW5lci50ZXh0Q29udGVudCA9IGlvY1R5cGUubmFtZTtcblxuICAgICAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIEhvc3RuYW1lIG5lZWRzIGEgc2Vjb25kIHN0ZXAgLS0gcGlja2luZyB0aGUgT1MgdmFyaWFudFxuICAgICAgICAgICAgICAgIGlmIChpb2NUeXBlSWQgPT09ICdob3N0bmFtZScpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93T1NTZWxlY3Rvcihpb2NUeXBlSWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25TZWxlY3QoaW9jVHlwZUlkKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXBsYWNlcyB0aGUgdHlwZSBncmlkIHdpdGggYW4gT1Mgc2VsZWN0b3Igc3ViLXZpZXcuXG4gICAgICogT25seSByZWFjaGFibGUgd2hlbiBpb2NUeXBlSWQgPT09ICdob3N0bmFtZScgYW5kIHRoZSB0eXBlIGhhcyBvc19pY29ucy5cbiAgICAgKi9cbiAgICBwcml2YXRlIHNob3dPU1NlbGVjdG9yKGlvY1R5cGVJZDogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcblxuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnU2VsZWN0IE9wZXJhdGluZyBTeXN0ZW0nIH0pO1xuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ3AnLCB7IHRleHQ6ICdDaG9vc2UgdGhlIG9wZXJhdGluZyBzeXN0ZW0gZm9yIHRoaXMgaG9zdG5hbWU6JyB9KTtcblxuICAgICAgICBjb25zdCBjb250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRGl2KCdvcy1zZWxlY3Rvci1jb250YWluZXInKTtcbiAgICAgICAgY29uc3QgaW9jVHlwZSA9IHRoaXMuaW9jVHlwZXNbaW9jVHlwZUlkXTtcblxuICAgICAgICBpZiAoaW9jVHlwZS5vc19pY29ucykge1xuICAgICAgICAgICAgT2JqZWN0LmtleXMoaW9jVHlwZS5vc19pY29ucykuZm9yRWFjaCgob3NUeXBlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBvc0J1dHRvbiA9IGNvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJywgeyBjbHM6ICdvcy10eXBlLWJ1dHRvbicgfSk7XG4gICAgICAgICAgICAgICAgb3NCdXR0b24uc2V0QXR0cmlidXRlKCdkYXRhLW9zLXR5cGUnLCBvc1R5cGUpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgaWNvbkNvbnRhaW5lciA9IG9zQnV0dG9uLmNyZWF0ZURpdignb3MtYnV0dG9uLWljb24nKTtcbiAgICAgICAgICAgICAgICBpY29uQ29udGFpbmVyLmlubmVySFRNTCA9IGlvY1R5cGUub3NfaWNvbnMhW29zVHlwZV07XG5cbiAgICAgICAgICAgICAgICBjb25zdCB0ZXh0Q29udGFpbmVyID0gb3NCdXR0b24uY3JlYXRlRGl2KCdvcy1idXR0b24tdGV4dCcpO1xuICAgICAgICAgICAgICAgIHRleHRDb250YWluZXIudGV4dENvbnRlbnQgPSBvc1R5cGUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBvc1R5cGUuc2xpY2UoMSk7XG5cbiAgICAgICAgICAgICAgICBvc0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vblNlbGVjdChpb2NUeXBlSWQsIG9zVHlwZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQmFjayBidXR0b24gbGV0cyB0aGUgYW5hbHlzdCByZXR1cm4gdG8gdGhlIG1haW4gZ3JpZCB3aXRob3V0IGNsb3NpbmdcbiAgICAgICAgY29uc3QgYmFja0J1dHRvbiA9IGNvbnRlbnRFbC5jcmVhdGVFbCgnYnV0dG9uJywge1xuICAgICAgICAgICAgdGV4dDogJ1xcdTIxOTAgQmFjayB0byBJT0MgVHlwZXMnLFxuICAgICAgICAgICAgY2xzOiAnYmFjay1idXR0b24nXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGJhY2tCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgICAgICAgICAgIHRoaXMub25PcGVuKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9uQ2xvc2UoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgICB9XG59IiwgIi8qKlxyXG4gKiBSZW5kZXJJT0NDYXJkcy50cyAtIEdlbmVyYXRlcyB0aGUgbWFya2Rvd24gY29udGVudCBmb3IgbmV3IElPQyBjYW52YXMgY2FyZHMuXHJcbiAqXHJcbiAqIEVhY2ggY2FyZCBpcyBhIHN0YW5kYXJkIE9ic2lkaWFuIGNhbnZhcyB0ZXh0IG5vZGUgd2hvc2UgY29udGVudCBpcyBhIG1peCBvZlxyXG4gKiBIVE1MIChmb3IgdGhlIHN0eWxlZCBoZWFkZXIgd2l0aCBpbmxpbmUgU1ZHIGljb24pIGFuZCBtYXJrZG93biAoZm9yIHRoZVxyXG4gKiBhbmFseXN0LWVkaXRhYmxlIGZpZWxkcykuIFRoaXMgaHlicmlkIGZvcm1hdCBsZXRzIHRoZSBjYW52YXMgcmVuZGVyZXIgZGlzcGxheVxyXG4gKiBhIHJpY2ggaGVhZGVyIHdoaWxlIGtlZXBpbmcgdGhlIGZpZWxkIHZhbHVlcyBpbiBwbGFpbiBtYXJrZG93biB0aGF0IHRoZVxyXG4gKiB0aW1lbGluZSBwcm9jZXNzb3JzIGNhbiBwYXJzZSB3aXRoIHJlZ2V4LlxyXG4gKlxyXG4gKiBDYXJkIHN0cnVjdHVyZTpcclxuICogICAxLiBIVE1MIGhlYWRlciBkaXYgLS0gZ3JhZGllbnQgYmFja2dyb3VuZCwgY29sb3JlZCBib3JkZXIsIGlubGluZSBTVkcgKyB0eXBlIG5hbWVcclxuICogICAyLiBUeXBlLXNwZWNpZmljIGZpZWxkcyAtLSBlYWNoIHJlbmRlcmVkIGFzIGEgYm9sZCBsYWJlbCB3aXRoIGlubGluZSB2YWx1ZVxyXG4gKiAgIDMuIEZpeGVkIGZvcmVuc2ljIGZpZWxkcyAtLSBUaW1lIG9mIEV2ZW50IChhdXRvLWZpbGxlZCksIFNwbHVuayBRdWVyeSxcclxuICogICAgICBNSVRSRSBUYWN0aWMsIGFuZCBNSVRSRSBUZWNobmlxdWUgKGxlZnQgYmxhbmsgZm9yIHRoZSBhbmFseXN0KVxyXG4gKi9cclxuaW1wb3J0IHsgSU9DRmllbGQgfSBmcm9tICcuL0lPQ0NhcmRzVHlwZXMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFJlbmRlcklPQ0NhcmRzIHtcclxuICAgIC8qKlxyXG4gICAgICogQnVpbGRzIHRoZSBmdWxsIG1hcmtkb3duK0hUTUwgc3RyaW5nIGZvciBhIG5ldyBJT0MgY2FyZC5cclxuICAgICAqIEBwYXJhbSBpb2NUeXBlICAtIFRoZSBJT0NGaWVsZCBkZWZpbml0aW9uIGZyb20gdGhlIHR5cGUgcmVnaXN0cnlcclxuICAgICAqIEBwYXJhbSBpb2NUeXBlSWQgLSBUaGUgc25ha2VfY2FzZSBrZXkgKG5lZWRlZCB0byBkZXRlY3QgXCJob3N0bmFtZVwiIHNwZWNpYWwgY2FzZSlcclxuICAgICAqIEBwYXJhbSBvc1R5cGUgICAtIElmIGlvY1R5cGVJZCBpcyBcImhvc3RuYW1lXCIsIHdoaWNoIE9TIHZhcmlhbnQgd2FzIHNlbGVjdGVkXHJcbiAgICAgKiBAcGFyYW0gY2FyZElkICAgLSBUaW1lc3RhbXAtYmFzZWQgdW5pcXVlIElEIGZvciB0aGUgY2FyZCAoZm9ybWF0OiAjWVlZWU1NREQtSEhNTSlcclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWF0ZUNhcmRDb250ZW50KFxyXG4gICAgICAgIGlvY1R5cGU6IElPQ0ZpZWxkLFxyXG4gICAgICAgIGlvY1R5cGVJZDogc3RyaW5nLFxyXG4gICAgICAgIG9zVHlwZTogc3RyaW5nIHwgbnVsbCA9IG51bGwsXHJcbiAgICAgICAgY2FyZElkOiBzdHJpbmcgPSAnJ1xyXG4gICAgKTogc3RyaW5nIHtcclxuICAgICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5vdy50b0lTT1N0cmluZygpLnJlcGxhY2UoJ1QnLCAnICcpLnN1YnN0cmluZygwLCAxOSk7XHJcblxyXG4gICAgICAgIC8vIEZvciBob3N0bmFtZSBjYXJkcywgc3dhcCBpbiB0aGUgT1Mtc3BlY2lmaWMgaWNvbiBpZiB0aGUgYW5hbHlzdCBwaWNrZWQgb25lXHJcbiAgICAgICAgbGV0IGljb25TdmcgPSBpb2NUeXBlLnN2ZztcclxuICAgICAgICBpZiAoaW9jVHlwZUlkID09PSAnaG9zdG5hbWUnICYmIG9zVHlwZSAmJiBpb2NUeXBlLm9zX2ljb25zKSB7XHJcbiAgICAgICAgICAgIGljb25TdmcgPSBpb2NUeXBlLm9zX2ljb25zW29zVHlwZSBhcyBrZXlvZiB0eXBlb2YgaW9jVHlwZS5vc19pY29uc10gfHwgaW9jVHlwZS5zdmc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBUaGUgSFRNTCBoZWFkZXIgdXNlcyBpbmxpbmUgc3R5bGVzIHNvIHRoZSBjYXJkIGlzIHNlbGYtY29udGFpbmVkIC0tIG5vXHJcbiAgICAgICAgLy8gZXh0ZXJuYWwgQ1NTIG5lZWRlZCBmb3IgdGhlIGhlYWRlciB0byByZW5kZXIgY29ycmVjdGx5IGluc2lkZSBPYnNpZGlhbidzXHJcbiAgICAgICAgLy8gY2FudmFzIG1hcmtkb3duIHByZXZpZXcuXHJcbiAgICAgICAgbGV0IGNvbnRlbnQgPSBgPGRpdiBjbGFzcz1cImlvYy1jYXJkLWNvbnRhaW5lclwiPjxkaXYgY2xhc3M9XCJpb2MtY2FyZC1oZWFkZXJcIlxyXG4gICAgICAgIHN0eWxlPVwiZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiAxNnB4OyBtYXJnaW4tYm90dG9tOiAzMHB4OyBwYWRkaW5nOiAyMHB4O1xyXG4gICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICR7aW9jVHlwZS5jb2xvcn0yMiwgdHJhbnNwYXJlbnQpO1xyXG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsgYm9yZGVyLWJvdHRvbTogM3B4IHNvbGlkICR7aW9jVHlwZS5jb2xvcn07XCI+XHJcbiAgICAgICAgPGRpdiBjbGFzcz1cImlvYy1oZWFkZXItY29udGVudFwiIHN0eWxlPVwiZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiAxNnB4OyB3aWR0aDogMTAwJTtcIj5cclxuICAgICAgICA8ZGl2IGNsYXNzPVwiaW9jLWljb25cIiBzdHlsZT1cImZsZXgtc2hyaW5rOiAwO1wiPiR7aWNvblN2Z308L2Rpdj48aDIgc3R5bGU9XCJtYXJnaW46IDA7XHJcbiAgICAgICAgY29sb3I6ICR7aW9jVHlwZS5jb2xvcn07IGZvbnQtc2l6ZTogMjRweDsgZm9udC13ZWlnaHQ6IDcwMDtcIj4ke2lvY1R5cGUubmFtZX08L2gyPlxyXG4gICAgICAgIDxzcGFuIGNsYXNzPVwiaW9jLWNhcmQtaWRcIiBzdHlsZT1cIm1hcmdpbi1sZWZ0OiBhdXRvOyBwYWRkaW5nOiAycHggOHB4OyBmb250LXNpemU6IDExcHg7IGZvbnQtd2VpZ2h0OiA2MDA7IGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyBib3JkZXItcmFkaXVzOiA0cHg7IGZvbnQtZmFtaWx5OiB2YXIoLS1mb250LW1vbm9zcGFjZSk7XCI+JHtjYXJkSWR9PC9zcGFuPlxyXG4gICAgICAgIDwvZGl2PjwhLS0gSU9DX0NBUkRfSUQ6JHtjYXJkSWR9IC0tPjwvZGl2PjwvZGl2PlxcbmA7XHJcblxyXG4gICAgICAgIC8vIFR5cGUtc3BlY2lmaWMgZmllbGRzOiBmaWVsZCBsYWJlbCB3aXRoIHNwYWNlIGZvciB1c2VyIHRvIGZpbGwgaW4gdmFsdWVzXHJcbiAgICAgICAgLy8gRGVsaW1pdGVycyAoLS0tLS0tLS0tLS0tKSBtYXJrIGNsZWFyIHZhbHVlIGJvdW5kYXJpZXMgZm9yIHJlbGlhYmxlIHBhcnNpbmdcclxuICAgICAgICAvLyBQYXJzZXIgd2lsbCBleHRyYWN0IGNvbnRlbnQgYmV0d2VlbiBmaWVsZCBsYWJlbCBhbmQgdGhlIGRlbGltaXRlclxyXG4gICAgICAgIGlvY1R5cGUuZmllbGRzLmZvckVhY2goKGZpZWxkOiBzdHJpbmcpID0+IHtcclxuICAgICAgICAgICAgY29udGVudCArPSBgJHtmaWVsZH06IFxcblxcblxcbi0tLS0tLS0tLS0tLVxcbmA7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIEZpeGVkIGZvcmVuc2ljIG1ldGFkYXRhIGZpZWxkcyBhcHBlbmRlZCB0byBldmVyeSBjYXJkIHR5cGUuXHJcbiAgICAgICAgLy8gXCJUaW1lIG9mIEV2ZW50XCIgaXMgcHJlLWZpbGxlZCB3aXRoIHRoZSBjcmVhdGlvbiB0aW1lc3RhbXA7IHRoZSByZXN0XHJcbiAgICAgICAgLy8gYXJlIGxlZnQgYmxhbmsgZm9yIHRoZSBhbmFseXN0LlxyXG4gICAgICAgIC8vIERlbGltaXRlcnMgZW5zdXJlIHJlbGlhYmxlIHZhbHVlIGV4dHJhY3Rpb24gZXZlbiB3aXRoIG11bHRpLWxpbmUgY29udGVudC5cclxuICAgICAgICBjb250ZW50ICs9IGBUaW1lIG9mIEV2ZW50OiAke3RpbWVzdGFtcH1cXG5cXG4tLS0tLS0tLS0tLS1cXG5gO1xyXG4gICAgICAgIGNvbnRlbnQgKz0gYFNwbHVuayBRdWVyeTogXFxuXFxuLS0tLS0tLS0tLS0tXFxuYDtcclxuICAgICAgICBjb250ZW50ICs9IGBNaXRyZSBUYWN0aWM6IFxcblxcbi0tLS0tLS0tLS0tLVxcbmA7XHJcbiAgICAgICAgY29udGVudCArPSBgTWl0cmUgVGVjaG5pcXVlOiBcXG5cXG4tLS0tLS0tLS0tLS1cXG5gO1xyXG5cclxuICAgICAgICByZXR1cm4gY29udGVudDtcclxuICAgIH1cclxufVxyXG4iLCAiaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgSU9DQ2FudmFzUGx1Z2luIGZyb20gJy4vbWFpbic7XHJcblxyXG4vKipcclxuICogRGVmYXVsdCBzZXR0aW5ncyB2YWx1ZXMgYXBwbGllZCB3aGVuIHRoZSBwbHVnaW4gbG9hZHMgZm9yIHRoZSBmaXJzdCB0aW1lXHJcbiAqIG9yIHdoZW4gYSBzZXR0aW5nIGhhcyBub3QgeWV0IGJlZW4gY29uZmlndXJlZCBieSB0aGUgdXNlci5cclxuICovXHJcbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBJT0NDYW52YXNQbHVnaW5TZXR0aW5ncyA9IHtcclxuICBjYXJkU2l6ZTogJ21lZGl1bScsXHJcbiAgc2hvd1RpbWVsaW5lQnV0dG9uOiB0cnVlLFxyXG59O1xyXG5cclxuLyoqXHJcbiAqIFR5cGVkIGludGVyZmFjZSBmb3IgYWxsIHBlcnNpc3RlZCBwbHVnaW4gc2V0dGluZ3MuXHJcbiAqIE9ic2lkaWFuIHNlcmlhbGlzZXMgdGhpcyB0byBgZGF0YS5qc29uYCBpbnNpZGUgdGhlIHBsdWdpbiBkaXJlY3RvcnkuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIElPQ0NhbnZhc1BsdWdpblNldHRpbmdzIHtcclxuICAvKiogRGVmYXVsdCB3aWR0aCBwcmVzZXQgZm9yIG5ld2x5LWNyZWF0ZWQgSU9DIGNhcmRzICgnc21hbGwnIHwgJ21lZGl1bScgfCAnbGFyZ2UnKS4gKi9cclxuICBjYXJkU2l6ZTogc3RyaW5nO1xyXG4gIC8qKiBXaGV0aGVyIHRoZSBmbG9hdGluZyB0aW1lbGluZSBidXR0b24gaXMgc2hvd24gb24gY2FudmFzIHZpZXdzLiAqL1xyXG4gIHNob3dUaW1lbGluZUJ1dHRvbjogYm9vbGVhbjtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNldHRpbmdzIHRhYiByZW5kZXJlZCBpbiBPYnNpZGlhbidzIFNldHRpbmdzIC0+IENvbW11bml0eSBQbHVnaW5zIHNlY3Rpb24uXHJcbiAqIFRoaXMgaXMgdGhlIHNpbmdsZSBhdXRob3JpdGF0aXZlIHNldHRpbmdzIFVJIGZvciB0aGUgcGx1Z2luLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFBsdWdpblNldHRpbmdzIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcbiAgcGx1Z2luOiBJT0NDYW52YXNQbHVnaW47XHJcblxyXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IElPQ0NhbnZhc1BsdWdpbikge1xyXG4gICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgfVxyXG5cclxuICBkaXNwbGF5KCk6IHZvaWQge1xyXG4gICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcclxuICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcbiAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdJT0MgQ2FudmFzIFBsdWdpbiBTZXR0aW5ncycgfSk7XHJcblxyXG4gICAgLy8gQ2FyZCBzaXplIGRyb3Bkb3duIC0gY29udHJvbHMgdGhlIGRlZmF1bHQgZGltZW5zaW9ucyBvZiBuZXcgSU9DIGNhcmRzXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoJ0RlZmF1bHQgY2FyZCBzaXplJylcclxuICAgICAgLnNldERlc2MoJ1NldCB0aGUgZGVmYXVsdCBzaXplIGZvciBJT0MgY2FyZHMnKVxyXG4gICAgICAuYWRkRHJvcGRvd24oZHJvcGRvd24gPT4gZHJvcGRvd25cclxuICAgICAgICAuYWRkT3B0aW9uKCdzbWFsbCcsICdTbWFsbCcpXHJcbiAgICAgICAgLmFkZE9wdGlvbignbWVkaXVtJywgJ01lZGl1bScpXHJcbiAgICAgICAgLmFkZE9wdGlvbignbGFyZ2UnLCAnTGFyZ2UnKVxyXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jYXJkU2l6ZSlcclxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcclxuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNhcmRTaXplID0gdmFsdWU7XHJcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICB9KVxyXG4gICAgICApO1xyXG5cclxuICAgIC8vIFRpbWVsaW5lIGJ1dHRvbiB0b2dnbGUgLSBoaWRlcyBvciBzaG93cyB0aGUgZmxvYXRpbmcgY2xvY2sgYnV0dG9uIG9uIGNhbnZhcyB2aWV3c1xyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKCdTaG93IHRpbWVsaW5lIGJ1dHRvbicpXHJcbiAgICAgIC5zZXREZXNjKCdEaXNwbGF5IHRpbWVsaW5lIGJ1dHRvbiBpbiBjYW52YXMgdG9vbGJhcicpXHJcbiAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxyXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93VGltZWxpbmVCdXR0b24pXHJcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogYm9vbGVhbikgPT4ge1xyXG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd1RpbWVsaW5lQnV0dG9uID0gdmFsdWU7XHJcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICB9KVxyXG4gICAgICApO1xyXG4gIH1cclxufVxyXG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWtCQSxJQUFBQSxtQkFBZ0Q7OztBQ1JoRCxzQkFBMkI7OztBQ3VDbEIsSUFBTSxZQUEyQjtBQUFBO0FB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QUE0QjtBQUN2QztBQUFBLElBQ0o7QUFFQSxVQUFNLFVBQVUsVUFBVSxTQUFTO0FBQ25DLFFBQUksQ0FBQyxTQUFTO0FBQ1YsVUFBSSx3QkFBTyx1QkFBdUIsU0FBUztBQUMzQztBQUFBLElBQ0o7QUFJQSxVQUFNLE1BQU0sSUFBSSxLQUFLO0FBQ3JCLFVBQU0sT0FBTyxJQUFJLFlBQVk7QUFDN0IsVUFBTSxRQUFRLE9BQU8sSUFBSSxTQUFTLElBQUksQ0FBQyxFQUFFLFNBQVMsR0FBRyxHQUFHO0FBQ3hELFVBQU0sTUFBTSxPQUFPLElBQUksUUFBUSxDQUFDLEVBQUUsU0FBUyxHQUFHLEdBQUc7QUFDakQsVUFBTSxRQUFRLE9BQU8sSUFBSSxTQUFTLENBQUMsRUFBRSxTQUFTLEdBQUcsR0FBRztBQUNwRCxVQUFNLFVBQVUsT0FBTyxJQUFJLFdBQVcsQ0FBQyxFQUFFLFNBQVMsR0FBRyxHQUFHO0FBQ3hELFVBQU0sU0FBUyxJQUFJLE9BQU8sUUFBUSxPQUFPLFFBQVE7QUFHakQsVUFBTSxVQUFVLGVBQWUsa0JBQWtCLFNBQVMsV0FBVyxVQUFVLE1BQU0sTUFBTTtBQUczRixXQUFPLGVBQWU7QUFBQSxNQUNsQixLQUFLLEVBQUUsR0FBRyxLQUFLLE9BQU8sSUFBSSxLQUFLLEdBQUcsS0FBSyxPQUFPLElBQUksSUFBSTtBQUFBO0FBQUEsTUFDdEQsTUFBTSxFQUFFLE9BQU8sS0FBSyxRQUFRLElBQUk7QUFBQTtBQUFBLE1BQ2hDLE1BQU07QUFBQTtBQUFBLElBQ1YsQ0FBQztBQUNELFdBQU8sWUFBWTtBQUVuQixRQUFJLHdCQUFPLFdBQVcsUUFBUSxXQUFXO0FBQUEsRUFDN0M7QUFFSjsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgInZhbHVlIiwgImltcG9ydF9vYnNpZGlhbiIsICJ2YWxpZGF0aW9uIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iXQp9Cg==

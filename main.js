/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => IOCCanvasPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian13 = require("obsidian");

// src/timeline/RenderTimelinesModal.ts
var import_obsidian4 = require("obsidian");

// src/debug.ts
var DEBUG = false;

// src/parsing/IOCTypeDetection.ts
var IOC_TYPE_PATTERNS = [
  { pattern: /IP Address/i, type: "IP Address" },
  { pattern: /Domain Name/i, type: "Domain Name" },
  { pattern: /File Hash/i, type: "File Hash" },
  { pattern: /URL/i, type: "URL" },
  { pattern: /Email Address/i, type: "Email Address" },
  { pattern: /Hostname/i, type: "Hostname" },
  { pattern: /YARA Rule/i, type: "YARA Rule" },
  { pattern: /Sigma Rule/i, type: "Sigma Rule" },
  { pattern: /Registry Key/i, type: "Registry Key" },
  { pattern: /Process Name/i, type: "Process Name" },
  // FIX: The IOC_TYPES constant uses "Network" (not "Network Traffic").
  // The old code used "Network Traffic" which would never match the
  // IOC_TYPES lookup, so color and icon were never resolved for this type.
  { pattern: /Network/i, type: "Network" },
  { pattern: /Command Line/i, type: "Command Line" },
  { pattern: /File/i, type: "File" },
  { pattern: /Note/i, type: "Note" },
  { pattern: /DLL/i, type: "DLL" },
  { pattern: /C2/i, type: "C2" }
];
function detectIOCType(text) {
  for (const { pattern, type } of IOC_TYPE_PATTERNS) {
    if (pattern.test(text)) {
      return type;
    }
  }
  return "";
}

// src/parsing/IOCFieldExtractors.ts
function extractValue(text) {
  if (DEBUG)
    console.debug("[IOCFieldExtractors] extractValue - input length:", text.length);
  const codeBlockMatch = text.match(/```([\s\S]*?)```/);
  if (codeBlockMatch && codeBlockMatch[1] && codeBlockMatch[1].trim()) {
    const value2 = codeBlockMatch[1].trim();
    if (DEBUG)
      console.debug("[IOCFieldExtractors] extractValue - found code block:", value2);
    return value2;
  }
  const parts = text.split("</div></div>");
  if (parts.length < 2) {
    if (DEBUG)
      console.debug("[IOCFieldExtractors] extractValue - no HTML header found");
    return "";
  }
  let afterHeader = parts[1].trim();
  if (DEBUG)
    console.debug("[IOCFieldExtractors] extractValue - content after header length:", afterHeader.length);
  const fieldMatch = afterHeader.match(/[^:\n]+:\s*/);
  if (!fieldMatch) {
    if (DEBUG)
      console.debug("[IOCFieldExtractors] extractValue - no field label found");
    return "";
  }
  if (DEBUG)
    console.debug("[IOCFieldExtractors] extractValue - first field:", fieldMatch[0].trim());
  const afterFieldLabel = afterHeader.substring(fieldMatch.index + fieldMatch[0].length);
  const separatorMatch = afterFieldLabel.match(/\n?-----/);
  const nextFieldMatch = afterFieldLabel.match(/\n([^:\n]+:\s*)/);
  let value;
  let delimiterIndex;
  if (separatorMatch && separatorMatch.index !== void 0) {
    delimiterIndex = separatorMatch.index;
  }
  if (nextFieldMatch && nextFieldMatch.index !== void 0) {
    if (delimiterIndex === void 0 || nextFieldMatch.index < delimiterIndex) {
      delimiterIndex = nextFieldMatch.index;
    }
  }
  if (delimiterIndex === void 0) {
    const timeIndex = afterFieldLabel.indexOf("Time of Event:");
    value = timeIndex === -1 ? afterFieldLabel : afterFieldLabel.substring(0, timeIndex);
  } else {
    value = afterFieldLabel.substring(0, delimiterIndex);
  }
  const trimmedValue = value.trim();
  if (DEBUG)
    console.debug("[IOCFieldExtractors] extractValue - result:", trimmedValue || "(empty)");
  return trimmedValue;
}
function extractTime(text) {
  const timePatterns = [
    /\*\*Time of Event:\*\*\s*(\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2})/i,
    /\*\*Time of Event:\*\*\s*(\d{4}-\d{2}-\d{2})/i,
    /Time of Event[:\s]*(\d{4}-\d{2}-\d{2}[T\s]\d{2}:\d{2}:\d{2})/i,
    /Time of Event[:\s]*(\d{4}-\d{2}-\d{2})/i,
    /Time[:\s]*(\d{4}-\d{2}-\d{2}[T\s]\d{2}:\d{2}:\d{2})/i,
    /(\d{4}-\d{2}-\d{2}[T\s]\d{2}:\d{2}:\d{2})/i
  ];
  for (const pattern of timePatterns) {
    const match = text.match(pattern);
    if (match && match[1]) {
      return match[1].trim();
    }
  }
  return "";
}
function extractSplunkQuery(text) {
  const match = text.match(/\*\*Splunk Query:\*\*[:\s]*([\s\S]*?)(?=\*\*|$)/i);
  if (match && match[1] && match[1].trim()) {
    return match[1].trim();
  }
  return "";
}
function extractMitreField(text, fieldName) {
  var _a;
  if (DEBUG)
    console.debug(`[IOCFieldExtractors] Extracting ${fieldName}...`);
  const pattern = new RegExp(
    `Mitre ${fieldName}:[ \\t]*([\\s\\S]*?)(?=\\n-{4,}|Mitre |$)`,
    "i"
  );
  const match = text.match(pattern);
  if (match && ((_a = match[1]) == null ? void 0 : _a.trim())) {
    const value = match[1].trim().toUpperCase();
    if (DEBUG)
      console.debug(`[IOCFieldExtractors] Found ${fieldName}:`, value);
    return value;
  }
  if (DEBUG)
    console.debug(`[IOCFieldExtractors] No ${fieldName} found`);
  return "";
}
var extractTactic = (text) => extractMitreField(text, "Tactic");
var extractTechnique = (text) => extractMitreField(text, "Technique");
function extractCardRole(text) {
  if (/\[P\]/.test(text))
    return "parent";
  if (/\[C\]/.test(text))
    return "child";
  return "";
}
function extractCardId(text) {
  if (DEBUG)
    console.debug("[IOCFieldExtractors] Extracting Card ID...");
  const commentMatch = text.match(/<!-- IOC_CARD_ID:([^>]+) -->/);
  if (commentMatch && commentMatch[1]) {
    const cardId = commentMatch[1].trim();
    if (DEBUG)
      console.debug("[IOCFieldExtractors] Found Card ID in HTML comment:", cardId);
    return cardId;
  }
  const cardIdMatch = text.match(/Card ID:\s*([^\n]+)/i);
  if (cardIdMatch && cardIdMatch[1]) {
    const cardId = cardIdMatch[1].trim();
    if (DEBUG)
      console.debug("[IOCFieldExtractors] Found Card ID in legacy field format:", cardId);
    return cardId;
  }
  if (DEBUG)
    console.debug("[IOCFieldExtractors] No Card ID found");
  return "";
}

// src/types/IOCCardsTypes.ts
var IOC_TYPES = {
  // --- Network-related IOC types ---
  ip_address: {
    name: "IP Address",
    icon: "network",
    color: "#FF6B6B",
    fields: ["IP", "country", "asn"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <circle cx="12" cy="15" r="7"/>
  <path d="M12 8c-3.9 0-7 3.1-7 7"/>
  <path d="M12 8c3.9 0 7 3.1 7 7"/>
  <line x1="5" y1="15" x2="19" y2="15"/>
  <line x1="12" y1="8" x2="12" y2="22"/>
  <path d="M12 8c-1.7-3-1.7-6 0-6s1.7 3 0 6z"/>
  <circle cx="12" cy="4" r="2" fill="currentColor"/>
</svg>`
  },
  domain: {
    name: "Domain Name",
    icon: "globe",
    color: "#4ECDC4",
    fields: ["name", "IP"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="10"/>
    <line x1="2" y1="12" x2="22" y2="12"/>
    <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
  </svg>`
  },
  file_hash: {
    name: "File Hash",
    icon: "hash",
    color: "#45B7D1",
    fields: ["hash", "hash_type", "filename", "file_size"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <line x1="4" y1="9" x2="20" y2="9"/>
    <line x1="4" y1="15" x2="20" y2="15"/>
    <line x1="10" y1="3" x2="8" y2="21"/>
    <line x1="16" y1="3" x2="14" y2="21"/>
  </svg>`
  },
  url: {
    name: "URL",
    icon: "link",
    color: "#96CEB4",
    fields: ["url", "domain", "category"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
    <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
  </svg>`
  },
  email: {
    name: "Email Address",
    icon: "mail",
    color: "#FECA57",
    fields: ["email", "domain"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
    <polyline points="22,6 12,13 2,6"/>
  </svg>`
  },
  // Hostname is the only IOC type with os_icons, triggering a secondary
  // OS selector sub-view in RenderIOCCardsModal before card creation.
  hostname: {
    name: "Hostname",
    icon: "monitor",
    color: "#9C27B0",
    fields: ["hostname", "os_type", "domain"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
    <line x1="8" y1="21" x2="16" y2="21"/>
    <line x1="12" y1="17" x2="12" y2="21"/>
  </svg>`,
    os_icons: {
      windows_workstation: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="currentColor">
    <path d="M0 3.5L10 2v9.5H0V3.5zM11 1.9l13-1.9v11H11V1.9zM0 12.5h10V22l-10-1.5v-8zM11 12h13v10l-13 2v-12z"/>
  </svg>`,
      windows_server: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="currentColor">
    <path d="M0 3.5L10 2v9.5H0V3.5zM11 1.9l13-1.9v11H11V1.9zM0 12.5h10V22l-10-1.5v-8zM11 12h13v10l-13 2v-12z"/>
  </svg>`,
      macos: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="currentColor">
    <path d="M17.05 20.28c-.98.95-2.05.8-3.08.35-1.09-.46-2.09-.48-3.24 0-1.44.62-2.2.44-3.06-.35C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"/>
  </svg>`,
      linux: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="currentColor">
    <path d="M12.504 0c-.155 0-.315.008-.48.021-4.226.333-3.105 4.807-3.17 6.298-.076 1.092-.3 1.953-1.05 3.02-.885 1.051-2.127 2.75-2.716 4.521-.278.84-.41 1.684-.287 2.489.845 5.548 5.676 6.016 6.855 6.016.178 0 .287-.016.287-.016s8.029-.192 8.03-8.047c0-4.662-3.916-9.69-7.47-14.302z"/>
  </svg>`
    }
  },
  // --- Detection rule types ---
  yara_rule: {
    name: "YARA Rule",
    icon: "shield",
    color: "#FF9FF3",
    fields: ["rule_name", "rule_content"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
    <text x="12" y="15" font-size="10" text-anchor="middle" fill="currentColor" font-weight="bold">Y</text>
  </svg>`
  },
  sigma_rule: {
    name: "Sigma Rule",
    icon: "search",
    color: "#A8E6CF",
    fields: ["rule_name", "rule_content"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="10"/>
    <text x="12" y="17" font-size="14" text-anchor="middle" fill="currentColor" font-weight="bold">\u03A3</text>
  </svg>`
  },
  // --- Host-based IOC types ---
  registry_key: {
    name: "Registry Key",
    icon: "settings",
    color: "#FFB74D",
    fields: ["key_path", "key_name", "key_data"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
    <path d="M7 11V7a5 5 0 0 1 9.9-1"/>
  </svg>`
  },
  process_name: {
    name: "Process Name",
    icon: "cpu",
    color: "#81C784",
    fields: ["process_name", "command_line", "pid", "parent_process"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <rect x="3" y="5" width="18" height="14" rx="2" ry="2"/>
  <line x1="3" y1="9" x2="21" y2="9"/>
  <circle cx="6" cy="7" r="0.8" fill="currentColor"/>
  <circle cx="9" cy="7" r="0.8" fill="currentColor"/>
  <line x1="7" y1="13" x2="17" y2="13"/>
  <line x1="7" y1="16" x2="14" y2="16"/>
</svg>`
  },
  network: {
    name: "Network",
    icon: "activity",
    color: "#9575CD",
    fields: ["protocol", "port", "direction"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
  </svg>`
  },
  command_line: {
    name: "Command Line",
    icon: "terminal",
    color: "#2E8B57",
    fields: ["command", "pid", "parent_process"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <polyline points="4 17 10 11 4 5"/>
    <line x1="12" y1="19" x2="20" y2="19"/>
  </svg>`
  },
  // --- File and artifact types ---
  file: {
    name: "File",
    icon: "file",
    color: "#E91E63",
    fields: ["name", "type", "path", "size", "hash", "pid"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <path d="M4 4h12l4 4v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2z"/>
  <line x1="8" y1="11" x2="16" y2="11"/>
  <line x1="8" y1="15" x2="16" y2="15"/>
</svg>`
  },
  // --- Utility types ---
  note: {
    name: "Note",
    icon: "note",
    color: "#F39C12",
    fields: ["NB"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <rect x="4" y="4" width="16" height="16" rx="2" ry="2"/>
  <line x1="8" y1="8" x2="16" y2="8"/>
  <line x1="8" y1="12" x2="16" y2="12"/>
  <line x1="8" y1="16" x2="14" y2="16"/>
</svg>`
  },
  dll: {
    name: "DLL",
    icon: "dll",
    color: "#3498DB",
    fields: ["name", "type", "path", "size", "hash"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"/>
  <polyline points="14 2 14 8 20 8"/>
  <circle cx="12" cy="13" r="2"/>
  <path d="M12 10.5v-1"/>
  <path d="M12 15.5v1"/>
  <path d="M14.5 11.5l0.7-0.7"/>
  <path d="M9.8 16.2l-0.7 0.7"/>
  <path d="M15.5 13h1"/>
  <path d="M8.5 13h-1"/>
  <path d="M14.5 14.5l0.7 0.7"/>
  <path d="M9.8 9.8l-0.7-0.7"/>
</svg>`
  },
  // --- Threat infrastructure ---
  c2: {
    name: "C2",
    icon: "c2",
    color: "#E74C3C",
    fields: ["domain", "IP"],
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <circle cx="12" cy="12" r="9"/>
  <path d="M12 3v1.5"/>
  <path d="M12 19.5V21"/>
  <path d="M3 12h1.5"/>
  <path d="M19.5 12H21"/>
  <path d="M5.6 5.6l1.1 1.1"/>
  <path d="M17.3 17.3l1.1 1.1"/>
  <path d="M5.6 18.4l1.1-1.1"/>
  <path d="M17.3 6.7l1.1-1.1"/>
  <polyline points="8 10 11 13 8 16"/>
  <line x1="13" y1="16" x2="16" y2="16"/>
</svg>`
  }
};

// src/parsing/IOCVisualLookup.ts
function lookupTypeVisuals(iocType, fallbackColor) {
  let icon = "";
  let color = fallbackColor;
  if (IOC_TYPES && typeof IOC_TYPES === "object") {
    for (const key of Object.keys(IOC_TYPES)) {
      if (IOC_TYPES[key].name === iocType) {
        icon = IOC_TYPES[key].svg;
        color = IOC_TYPES[key].color;
        break;
      }
    }
  }
  return { icon, color };
}

// src/parsing/IOCParser.ts
function parseIOCNode(node) {
  var _a;
  if (DEBUG)
    console.debug("[IOCParser] ==================== PARSING NODE ====================");
  if (DEBUG)
    console.debug("[IOCParser] Node ID:", node.id);
  if (DEBUG)
    console.debug("[IOCParser] Text length:", ((_a = node.text) == null ? void 0 : _a.length) || 0);
  if (!node.text) {
    if (DEBUG)
      console.debug("[IOCParser] No text content");
    return null;
  }
  const iocType = detectIOCType(node.text);
  if (!iocType) {
    if (DEBUG)
      console.debug("[IOCParser] No IOC type detected");
    return null;
  }
  if (DEBUG)
    console.debug("[IOCParser] IOC Type:", iocType);
  const value = extractValue(node.text);
  const time = extractTime(node.text);
  const splunkQuery = extractSplunkQuery(node.text);
  const tactic = extractTactic(node.text);
  const technique = extractTechnique(node.text);
  const cardId = extractCardId(node.text);
  const role = extractCardRole(node.text);
  const fallbackColor = node.color || "#333";
  const { icon, color } = lookupTypeVisuals(iocType, fallbackColor);
  const result = {
    id: node.id,
    cardId,
    type: iocType,
    value,
    time,
    splunkQuery,
    tactic,
    technique,
    icon,
    color,
    ...role === "child" ? { isChild: true } : {}
  };
  if (DEBUG)
    console.debug("[IOCParser] EXTRACTION COMPLETE:", {
      type: iocType,
      cardId: cardId || "(no ID)",
      value: value || "(empty)",
      time: time || "(empty)",
      tactic: tactic || "(empty)",
      technique: technique || "(empty)"
    });
  return result;
}

// src/timeline/TimeTimelineProcessing.ts
function extractFixedIOCData(app) {
  if (DEBUG)
    console.debug("[TimeProcessor] Starting extraction");
  const activeLeaf = app.workspace.activeLeaf;
  if (!activeLeaf || !activeLeaf.view || activeLeaf.view.getViewType() !== "canvas") {
    if (DEBUG)
      console.debug("[TimeProcessor] No active canvas view");
    return [];
  }
  const canvasView = activeLeaf.view;
  const canvas = canvasView.canvas;
  if (!canvas || !canvas.nodes) {
    if (DEBUG)
      console.debug("[TimeProcessor] No canvas or nodes");
    return [];
  }
  const totalNodes = canvas.nodes.size || canvas.nodes.length || 0;
  if (DEBUG)
    console.debug("[TimeProcessor] Processing", totalNodes, "nodes");
  const iocData = [];
  let emptyValueCount = 0;
  canvas.nodes.forEach((node) => {
    if (node.text) {
      const parsedData = parseIOCNode(node);
      if (parsedData) {
        if (!parsedData.value || !parsedData.value.trim()) {
          emptyValueCount++;
        }
        iocData.push(parsedData);
      }
    }
  });
  if (DEBUG)
    console.debug("[TimeProcessor] Extraction complete - found:", iocData.length, "IOCs,", emptyValueCount, "empty values");
  return iocData;
}

// src/timeline/TimeTimelineTab.ts
var import_obsidian = require("obsidian");

// src/timeline/TimelineCopyExport.ts
function generateCopyText(iocData, startTime, endTime) {
  let filteredData = iocData;
  if (startTime !== void 0 && endTime !== void 0) {
    filteredData = iocData.filter((ioc) => {
      const ts = new Date(ioc.time).getTime();
      return !isNaN(ts) && ts >= startTime && ts <= endTime;
    });
  }
  const header = "Time	Tactic	Technique	Value";
  const lines = filteredData.map(
    (ioc) => `${ioc.time || ""}	${ioc.tactic || ""}	${ioc.technique || ""}	${ioc.value || ""}`
  );
  return [header, ...lines].join("\n");
}

// src/timeline/TimeTimelineTab.ts
function renderTimeTimeline(container, iocData) {
  if (DEBUG)
    console.debug("[TimeTimeline] Starting render");
  if (iocData.length === 0) {
    container.createEl("p", {
      text: "No IOC cards found in the current canvas. Create some IOC cards first to see the timeline.",
      cls: "timeline-empty-message"
    });
    return;
  }
  const timeCopyBtn = container.createEl("button", {
    text: "Copy Timeline",
    cls: "timeline-copy-button"
  });
  timeCopyBtn.style.position = "absolute";
  timeCopyBtn.style.top = "10px";
  timeCopyBtn.style.right = "10px";
  timeCopyBtn.addEventListener("click", () => {
    const text = generateCopyText(iocData);
    navigator.clipboard.writeText(text).then(() => {
      new import_obsidian.Notice(`Copied ${iocData.length} entries to clipboard`);
    });
  });
  const timelineContainer = container.createDiv("timeline-container");
  iocData.forEach((ioc, index) => {
    const timelineItem = timelineContainer.createDiv("timeline-item");
    timelineItem.style.setProperty("--ioc-color", ioc.color);
    timelineItem.style.setProperty("--ioc-color-30", `${ioc.color}30`);
    timelineItem.style.background = `linear-gradient(135deg, ${ioc.color}15 0%, ${ioc.color}05 100%)`;
    timelineItem.style.boxShadow = `0 4px 12px ${ioc.color}25`;
    timelineItem.style.borderColor = ioc.color;
    if (index < iocData.length - 1) {
      const connector = timelineItem.createDiv("timeline-connector");
      connector.style.background = `linear-gradient(180deg, ${ioc.color} 0%, ${iocData[index + 1].color} 100%)`;
    }
    const iconContainer = timelineItem.createDiv("timeline-icon");
    iconContainer.innerHTML = ioc.icon;
    iconContainer.style.background = `${ioc.color}20`;
    iconContainer.style.borderColor = ioc.color;
    const detailsContainer = timelineItem.createDiv("timeline-details");
    const titleEl = detailsContainer.createEl("h3", { text: ioc.type });
    titleEl.style.textShadow = `0 1px 3px ${ioc.color}40`;
    const timeEl = detailsContainer.createDiv("timeline-time");
    timeEl.textContent = `Time: ${ioc.time}`;
    if (ioc.value && ioc.value.trim()) {
      const valueEl = detailsContainer.createDiv("timeline-value");
      valueEl.textContent = `Value: ${ioc.value}`;
    }
    if (ioc.splunkQuery && ioc.splunkQuery.trim()) {
      const splunkEl = detailsContainer.createDiv("timeline-splunk");
      splunkEl.textContent = `Splunk Query: ${ioc.splunkQuery}`;
    }
    if (ioc.tactic) {
      const tacticEl = detailsContainer.createDiv("timeline-tactic");
      tacticEl.textContent = `Tactic: ${ioc.tactic}`;
    }
    if (ioc.technique) {
      const techniqueEl = detailsContainer.createDiv("timeline-technique");
      techniqueEl.textContent = `Technique: ${ioc.technique}`;
    }
    timelineItem.addEventListener("mouseover", () => {
      timelineItem.style.boxShadow = `0 8px 20px ${ioc.color}35`;
    });
    timelineItem.addEventListener("mouseout", () => {
      timelineItem.style.boxShadow = `0 4px 12px ${ioc.color}25`;
    });
  });
}

// src/timeline/GraphTimelineTab.ts
var import_obsidian2 = require("obsidian");

// src/timeline/GraphTimelineHelpers.ts
var EDGE_PADDING_PERCENT = 0.08;
function computePaddedViewport(viewMin, viewMax) {
  const viewSpan = viewMax - viewMin || 1;
  const paddingMs = EDGE_PADDING_PERCENT * viewSpan;
  return {
    paddedMin: viewMin - paddingMs,
    paddedMax: viewMax + paddingMs,
    paddedSpan: viewMax + paddingMs - (viewMin - paddingMs)
  };
}
function formatTimestamp(ts) {
  const d = new Date(ts);
  return d.toISOString().replace("T", " ").substring(0, 19);
}
function formatShortTime(ts) {
  const d = new Date(ts);
  const year = d.getFullYear();
  const month = String(d.getMonth() + 1).padStart(2, "0");
  const day = String(d.getDate()).padStart(2, "0");
  const hours = String(d.getHours()).padStart(2, "0");
  const minutes = String(d.getMinutes()).padStart(2, "0");
  const seconds = String(d.getSeconds()).padStart(2, "0");
  return `${year}-${month}-${day}
${hours}:${minutes}:${seconds}`;
}

// src/timeline/GraphTimelineRendering.ts
function createGraphTimelineDOM(container, timedData, dataMinTime, dataMaxTime) {
  const controlsEl = container.createDiv("graph-range-controls");
  controlsEl.createEl("span", { text: "From: ", cls: "graph-range-label" });
  const startInput = controlsEl.createEl("input", {
    cls: "graph-range-input",
    type: "text"
  });
  startInput.value = formatTimestamp(dataMinTime);
  controlsEl.createEl("span", { text: " To: ", cls: "graph-range-label" });
  const endInput = controlsEl.createEl("input", {
    cls: "graph-range-input",
    type: "text"
  });
  endInput.value = formatTimestamp(dataMaxTime);
  const resetBtn = controlsEl.createEl("button", {
    text: "Reset",
    cls: "graph-range-reset"
  });
  const graphArea = container.createDiv("graph-timeline-area");
  const axisEl = graphArea.createDiv("graph-time-axis");
  const tooltip = graphArea.createDiv("graph-tooltip");
  tooltip.style.display = "none";
  const selectionOverlay = graphArea.createDiv("graph-selection-overlay");
  selectionOverlay.style.display = "none";
  const dots = [];
  timedData.forEach((d, idx) => {
    const yOffset = (idx % 2 === 0 ? -1 : 1) * (idx % 4 * 6 + 4);
    const dot = graphArea.createDiv("graph-dot");
    dot.style.top = `calc(50% + ${yOffset}px)`;
    dot.style.backgroundColor = d.ioc.color;
    dot.style.borderColor = d.ioc.color;
    dot.setAttribute("data-ts", String(d.ts));
    dot.addEventListener("mouseenter", () => {
      tooltip.style.display = "block";
      tooltip.innerHTML = `<strong>${d.ioc.type}</strong><br/>${d.ioc.value || "(no value)"}<br/><span class="graph-tooltip-time">${d.ioc.time}</span>`;
      const rect = graphArea.getBoundingClientRect();
      const dotRect = dot.getBoundingClientRect();
      tooltip.style.left = `${dotRect.left - rect.left + 6}px`;
      tooltip.style.top = `${dotRect.top - rect.top - 60}px`;
    });
    dot.addEventListener("mouseleave", () => {
      tooltip.style.display = "none";
    });
    dots.push(dot);
  });
  const listContainer = container.createDiv("graph-filtered-list");
  const copyBtn = container.createEl("button", {
    text: "Copy Filtered Range",
    cls: "timeline-copy-button graph-timeline-copy"
  });
  copyBtn.style.position = "absolute";
  copyBtn.style.top = "10px";
  copyBtn.style.right = "10px";
  return {
    controlsEl,
    startInput,
    endInput,
    resetBtn,
    graphArea,
    axisEl,
    tooltip,
    selectionOverlay,
    dots,
    listContainer,
    copyBtn
  };
}

// src/timeline/GraphTimelineTab.ts
function renderGraphTimeline(container, iocData) {
  if (iocData.length === 0) {
    container.createEl("p", {
      text: "No IOC cards found. Create some IOC cards with timestamps to see the graph.",
      cls: "timeline-empty-message"
    });
    return;
  }
  const timedData = iocData.map((ioc) => ({ ioc, ts: new Date(ioc.time).getTime() })).filter((d) => !isNaN(d.ts)).sort((a, b) => a.ts - b.ts);
  if (timedData.length === 0) {
    container.createEl("p", {
      text: "No IOC cards with valid timestamps found.",
      cls: "timeline-empty-message"
    });
    return;
  }
  const dataMinTime = timedData[0].ts;
  const dataMaxTime = timedData[timedData.length - 1].ts;
  let viewMinTime = dataMinTime;
  let viewMaxTime = dataMaxTime;
  let rangeStart = dataMinTime;
  let rangeEnd = dataMaxTime;
  let isDragging = false;
  let dragStartTime = 0;
  const dom = createGraphTimelineDOM(container, timedData, dataMinTime, dataMaxTime);
  const {
    startInput,
    endInput,
    resetBtn,
    graphArea,
    axisEl,
    selectionOverlay,
    dots,
    listContainer
  } = dom;
  function updateAxisTicks() {
    axisEl.querySelectorAll(".graph-axis-tick").forEach((el) => el.remove());
    const { paddedMin, paddedSpan } = computePaddedViewport(viewMinTime, viewMaxTime);
    const tickCount = Math.min(6, timedData.length);
    for (let i = 0; i < tickCount; i++) {
      const pct = tickCount === 1 ? 50 : i / (tickCount - 1) * 100;
      const tickTime = paddedMin + pct / 100 * paddedSpan;
      const tick = axisEl.createDiv("graph-axis-tick");
      tick.style.left = `${pct}%`;
      tick.setAttribute("data-label", formatShortTime(tickTime));
    }
  }
  function updateDotPositions() {
    const { paddedMin, paddedSpan } = computePaddedViewport(viewMinTime, viewMaxTime);
    dots.forEach((dot) => {
      const ts = Number(dot.getAttribute("data-ts"));
      if (ts < viewMinTime || ts > viewMaxTime) {
        dot.style.display = "none";
      } else {
        dot.style.display = "block";
        const pct = (ts - paddedMin) / paddedSpan * 100;
        dot.style.left = `${pct}%`;
      }
    });
  }
  function updateFilter() {
    dots.forEach((dot) => {
      const ts = Number(dot.getAttribute("data-ts"));
      if (ts >= rangeStart && ts <= rangeEnd) {
        dot.classList.add("selected");
      } else {
        dot.classList.remove("selected");
      }
    });
    listContainer.empty();
    const filtered = timedData.filter((d) => d.ts >= rangeStart && d.ts <= rangeEnd);
    if (filtered.length === 0) {
      listContainer.createEl("p", { text: "No cards in selected range.", cls: "timeline-empty-message" });
      return;
    }
    listContainer.createEl("p", { text: `Showing ${filtered.length} of ${timedData.length} cards`, cls: "graph-filter-count" });
    filtered.forEach((d) => {
      const item = listContainer.createDiv("timeline-item");
      item.style.setProperty("--ioc-color", d.ioc.color);
      item.style.background = `linear-gradient(135deg, ${d.ioc.color}15 0%, ${d.ioc.color}05 100%)`;
      item.style.boxShadow = `0 4px 12px ${d.ioc.color}25`;
      item.style.borderColor = d.ioc.color;
      const iconContainer = item.createDiv("timeline-icon");
      iconContainer.innerHTML = d.ioc.icon;
      iconContainer.style.background = `${d.ioc.color}20`;
      iconContainer.style.borderColor = d.ioc.color;
      const details = item.createDiv("timeline-details");
      const titleEl = details.createEl("h3", { text: d.ioc.type });
      titleEl.style.textShadow = `0 1px 3px ${d.ioc.color}40`;
      details.createDiv({ cls: "timeline-time", text: `Time: ${d.ioc.time}` });
      if (d.ioc.value && d.ioc.value.trim()) {
        details.createDiv({ cls: "timeline-value", text: `Value: ${d.ioc.value}` });
      }
      if (d.ioc.tactic) {
        details.createDiv({ cls: "timeline-tactic", text: `Tactic: ${d.ioc.tactic}` });
      }
      if (d.ioc.technique) {
        details.createDiv({ cls: "timeline-technique", text: `Technique: ${d.ioc.technique}` });
      }
    });
  }
  function zoomToRange(newStart, newEnd) {
    if (newStart > newEnd) {
      [newStart, newEnd] = [newEnd, newStart];
    }
    viewMinTime = newStart;
    viewMaxTime = newEnd;
    rangeStart = newStart;
    rangeEnd = newEnd;
    startInput.value = formatTimestamp(newStart);
    endInput.value = formatTimestamp(newEnd);
    updateAxisTicks();
    updateDotPositions();
    updateFilter();
  }
  dom.copyBtn.addEventListener("click", () => {
    const text = generateCopyText(timedData.map((d) => d.ioc), viewMinTime, viewMaxTime);
    const filtered = timedData.filter((d) => d.ts >= viewMinTime && d.ts <= viewMaxTime);
    navigator.clipboard.writeText(text).then(() => {
      new import_obsidian2.Notice(`Copied ${filtered.length} of ${timedData.length} entries to clipboard`);
    });
  });
  graphArea.addEventListener("mousedown", (e) => {
    if (e.target.classList.contains("graph-dot"))
      return;
    const rect = graphArea.getBoundingClientRect();
    const clickX = e.clientX - rect.left;
    const pct = (clickX - 30) / (rect.width - 60);
    const { paddedMin, paddedSpan } = computePaddedViewport(viewMinTime, viewMaxTime);
    dragStartTime = paddedMin + pct * paddedSpan;
    dragStartTime = Math.max(dataMinTime, Math.min(dataMaxTime, dragStartTime));
    isDragging = true;
    graphArea.classList.add("dragging");
    startInput.value = formatTimestamp(dragStartTime);
    selectionOverlay.style.display = "block";
    selectionOverlay.style.left = `${clickX}px`;
    selectionOverlay.style.width = "0px";
  });
  graphArea.addEventListener("mousemove", (e) => {
    if (!isDragging)
      return;
    const rect = graphArea.getBoundingClientRect();
    const currentX = e.clientX - rect.left;
    const pct = (currentX - 30) / (rect.width - 60);
    const { paddedMin, paddedSpan } = computePaddedViewport(viewMinTime, viewMaxTime);
    const currentTime = paddedMin + pct * paddedSpan;
    const clampedTime = Math.max(dataMinTime, Math.min(dataMaxTime, currentTime));
    endInput.value = formatTimestamp(clampedTime);
    const startX = (dragStartTime - paddedMin) / paddedSpan * (rect.width - 60) + 30;
    const endX = currentX;
    const left = Math.min(startX, endX);
    const width = Math.abs(endX - startX);
    selectionOverlay.style.left = `${left}px`;
    selectionOverlay.style.width = `${width}px`;
  });
  graphArea.addEventListener("mouseup", (e) => {
    if (!isDragging)
      return;
    const rect = graphArea.getBoundingClientRect();
    const endX = e.clientX - rect.left;
    const pct = (endX - 30) / (rect.width - 60);
    const { paddedMin, paddedSpan } = computePaddedViewport(viewMinTime, viewMaxTime);
    let dragEndTime = paddedMin + pct * paddedSpan;
    dragEndTime = Math.max(dataMinTime, Math.min(dataMaxTime, dragEndTime));
    isDragging = false;
    graphArea.classList.remove("dragging");
    selectionOverlay.style.display = "none";
    if (Math.abs(dragEndTime - dragStartTime) > 1e3) {
      zoomToRange(dragStartTime, dragEndTime);
    }
  });
  graphArea.addEventListener("mouseleave", () => {
    if (isDragging) {
      isDragging = false;
      graphArea.classList.remove("dragging");
      selectionOverlay.style.display = "none";
    }
  });
  startInput.addEventListener("change", () => {
    const parsed = new Date(startInput.value).getTime();
    if (!isNaN(parsed)) {
      zoomToRange(parsed, rangeEnd);
    }
  });
  endInput.addEventListener("change", () => {
    const parsed = new Date(endInput.value).getTime();
    if (!isNaN(parsed)) {
      zoomToRange(rangeStart, parsed);
    }
  });
  resetBtn.addEventListener("click", () => {
    zoomToRange(dataMinTime, dataMaxTime);
  });
  updateAxisTicks();
  updateDotPositions();
  updateFilter();
}

// src/canvas/CanvasEdges.ts
var import_obsidian3 = require("obsidian");
function getCanvasEdges(app) {
  const activeView = app.workspace.getActiveViewOfType(import_obsidian3.ItemView);
  if (!activeView || activeView.getViewType() !== "canvas") {
    if (DEBUG)
      console.debug("[CanvasEdges] No active canvas view");
    return [];
  }
  const canvas = activeView.canvas;
  if (!canvas || !canvas.edges) {
    if (DEBUG)
      console.debug("[CanvasEdges] No canvas or edges");
    return [];
  }
  const edges = [];
  canvas.edges.forEach((edge) => {
    var _a, _b, _c, _d;
    const fromId = (_b = (_a = edge == null ? void 0 : edge.from) == null ? void 0 : _a.node) == null ? void 0 : _b.id;
    const toId = (_d = (_c = edge == null ? void 0 : edge.to) == null ? void 0 : _c.node) == null ? void 0 : _d.id;
    if (fromId && toId) {
      edges.push({ fromNodeId: fromId, toNodeId: toId });
    } else if (DEBUG) {
      console.debug("[CanvasEdges] Skipping edge with missing node IDs:", edge);
    }
  });
  if (DEBUG)
    console.debug("[CanvasEdges] Found", edges.length, "edges");
  return edges;
}

// src/timeline/LinkTimelineProcessing.ts
function buildParentChildGroups(iocData, edges) {
  const nodeMap = /* @__PURE__ */ new Map();
  for (const ioc of iocData) {
    nodeMap.set(ioc.id, ioc);
  }
  const outgoingEdges = /* @__PURE__ */ new Map();
  const hasIncomingEdge = /* @__PURE__ */ new Set();
  const incomingFrom = /* @__PURE__ */ new Map();
  for (const edge of edges) {
    if (!nodeMap.has(edge.fromNodeId) || !nodeMap.has(edge.toNodeId))
      continue;
    if (!outgoingEdges.has(edge.fromNodeId)) {
      outgoingEdges.set(edge.fromNodeId, /* @__PURE__ */ new Set());
    }
    outgoingEdges.get(edge.fromNodeId).add(edge.toNodeId);
    hasIncomingEdge.add(edge.toNodeId);
    if (!incomingFrom.has(edge.toNodeId)) {
      incomingFrom.set(edge.toNodeId, /* @__PURE__ */ new Set());
    }
    incomingFrom.get(edge.toNodeId).add(edge.fromNodeId);
  }
  function isRootParent(nodeId) {
    const node = nodeMap.get(nodeId);
    if (!node || !outgoingEdges.has(nodeId))
      return false;
    return !node.isChild;
  }
  function buildChildHierarchy(parentId, visited) {
    const childIds = outgoingEdges.get(parentId);
    if (!childIds || childIds.size === 0)
      return [];
    const children = [];
    for (const childId of childIds) {
      if (visited.has(childId))
        continue;
      const childNode = nodeMap.get(childId);
      if (!childNode)
        continue;
      if (!childNode.isChild)
        continue;
      visited.add(childId);
      children.push(childNode);
      const descendants = buildChildHierarchy(childId, visited);
      children.push(...descendants);
    }
    children.sort((a, b) => {
      const aTime = "time" in a ? new Date(a.time).getTime() : new Date(a.parent.time).getTime();
      const bTime = "time" in b ? new Date(b.time).getTime() : new Date(b.parent.time).getTime();
      return aTime - bTime;
    });
    return children;
  }
  const groups = [];
  for (const [parentId, _] of outgoingEdges) {
    if (!isRootParent(parentId))
      continue;
    const parent = nodeMap.get(parentId);
    const visited = /* @__PURE__ */ new Set([parentId]);
    const children = buildChildHierarchy(parentId, visited);
    groups.push({ parent, children });
  }
  groups.sort((a, b) => new Date(a.parent.time).getTime() - new Date(b.parent.time).getTime());
  function hasParentInUpstream(nodeId, visited = /* @__PURE__ */ new Set()) {
    if (visited.has(nodeId))
      return false;
    visited.add(nodeId);
    const node = nodeMap.get(nodeId);
    if (!node)
      return false;
    if (!node.isChild)
      return true;
    const sources = incomingFrom.get(nodeId);
    if (!sources || sources.size === 0)
      return false;
    for (const sourceId of sources) {
      if (hasParentInUpstream(sourceId, visited)) {
        return true;
      }
    }
    return false;
  }
  const badDirectionalCardSet = /* @__PURE__ */ new Set();
  for (const ioc of iocData) {
    if (ioc.isChild)
      continue;
    const incomingSources = incomingFrom.get(ioc.id);
    if (!incomingSources || incomingSources.size === 0)
      continue;
    let hasChildSource = false;
    for (const sourceId of incomingSources) {
      const sourceNode = nodeMap.get(sourceId);
      if (sourceNode && sourceNode.isChild) {
        hasChildSource = true;
        break;
      }
    }
    if (hasChildSource) {
      badDirectionalCardSet.add(ioc.id);
    }
  }
  for (const [childId, sources] of incomingFrom.entries()) {
    const childNode = nodeMap.get(childId);
    if (!childNode || !childNode.isChild)
      continue;
    for (const sourceId of sources) {
      const sourceNode = nodeMap.get(sourceId);
      if (sourceNode && sourceNode.isChild) {
        const hasParent = hasParentInUpstream(childId);
        if (!hasParent) {
          badDirectionalCardSet.add(sourceId);
          badDirectionalCardSet.add(childId);
        }
      }
    }
  }
  const badDirectionalCards = Array.from(badDirectionalCardSet).map((id) => nodeMap.get(id)).filter(Boolean).sort((a, b) => new Date(a.time).getTime() - new Date(b.time).getTime());
  return { groups, badDirectionalCards };
}

// src/timeline/LinkTimelineCardRow.ts
function renderIOCCardRow(opts) {
  const { container, ioc, showConnector = false, depth = 0, extraClasses = [] } = opts;
  const rowEl = container.createDiv("link-timeline-child");
  extraClasses.forEach((cls) => rowEl.classList.add(cls));
  if (depth > 0) {
    rowEl.classList.add(`depth-${depth}`);
    rowEl.style.marginLeft = `${depth * 30}px`;
  }
  rowEl.style.borderLeftColor = ioc.color;
  if (showConnector) {
    rowEl.createDiv("link-timeline-connector");
  }
  rowEl.createEl("span", {
    text: ioc.isChild ? "[C]" : "[P]",
    cls: `link-timeline-role-badge ${ioc.isChild ? "role-child" : "role-parent"}`
  });
  const iconEl = rowEl.createDiv("link-timeline-icon");
  iconEl.innerHTML = ioc.icon;
  iconEl.style.color = ioc.color;
  const detailsEl = rowEl.createDiv("link-timeline-details");
  detailsEl.createEl("strong", { text: ioc.type });
  if (ioc.time) {
    detailsEl.createEl("span", { text: ` | ${ioc.time}`, cls: "link-timeline-time" });
  }
  if (ioc.cardId) {
    detailsEl.createEl("span", { text: ` | ${ioc.cardId}`, cls: "link-timeline-card-id" });
  }
  if (ioc.value && ioc.value.trim()) {
    detailsEl.createDiv({ text: ioc.value, cls: "link-timeline-value" });
  }
  if (ioc.tactic) {
    detailsEl.createDiv({ text: `Tactic: ${ioc.tactic}`, cls: "link-timeline-tactic" });
  }
  if (ioc.technique) {
    detailsEl.createDiv({ text: `Technique: ${ioc.technique}`, cls: "link-timeline-technique" });
  }
  return rowEl;
}

// src/timeline/LinkTimelineTab.ts
function isParentChildGroup(item) {
  return "children" in item && Array.isArray(item.children);
}
function renderLinkTimeline(container, result) {
  const { groups, badDirectionalCards } = result;
  if (groups.length === 0) {
    container.createEl("p", {
      text: "No IOC cards found. Create parent and child cards, then draw arrows between them.",
      cls: "timeline-empty-message"
    });
    return;
  }
  const linkedGroups = groups.filter((g) => g.children.length > 0);
  if (linkedGroups.length === 0) {
    container.createEl("p", {
      text: "No parent-child relationships found. Draw arrows between IOC cards to create links (arrow from parent to child).",
      cls: "timeline-empty-message"
    });
  }
  function renderChild(childrenContainer, child, depth) {
    if (isParentChildGroup(child)) {
      renderNestedGroup(childrenContainer, child, depth);
    } else {
      renderLeafNode(childrenContainer, child, depth);
    }
  }
  function renderLeafNode(childrenContainer, child, depth) {
    renderIOCCardRow({
      container: childrenContainer,
      ioc: child,
      showConnector: true,
      depth
    });
  }
  function renderNestedGroup(childrenContainer, group, depth) {
    const nestedGroupEl = childrenContainer.createDiv("link-timeline-child link-timeline-nested-parent");
    nestedGroupEl.classList.add(`depth-${depth}`);
    nestedGroupEl.style.borderLeftColor = group.parent.color;
    nestedGroupEl.style.marginLeft = `${depth * 30}px`;
    nestedGroupEl.createDiv("link-timeline-connector");
    const toggleEl = nestedGroupEl.createDiv("link-timeline-expand-toggle");
    toggleEl.textContent = "\u25B6";
    toggleEl.classList.add("has-children");
    nestedGroupEl.createEl("span", {
      text: group.parent.isChild ? "[C]" : "[P]",
      cls: `link-timeline-role-badge ${group.parent.isChild ? "role-child" : "role-parent"}`
    });
    const iconEl = nestedGroupEl.createDiv("link-timeline-icon");
    iconEl.innerHTML = group.parent.icon;
    iconEl.style.color = group.parent.color;
    const detailsEl = nestedGroupEl.createDiv("link-timeline-details");
    detailsEl.createEl("strong", { text: group.parent.type });
    if (group.parent.time) {
      detailsEl.createEl("span", { text: ` | ${group.parent.time}`, cls: "link-timeline-time" });
    }
    if (group.parent.cardId) {
      detailsEl.createEl("span", { text: ` | ${group.parent.cardId}`, cls: "link-timeline-card-id" });
    }
    if (group.parent.value && group.parent.value.trim()) {
      detailsEl.createDiv({ text: group.parent.value, cls: "link-timeline-value" });
    }
    nestedGroupEl.createEl("span", {
      text: String(group.children.length),
      cls: "link-timeline-count"
    });
    const nestedChildrenEl = childrenContainer.createDiv("link-timeline-nested-children");
    nestedChildrenEl.style.display = "none";
    group.children.forEach((nestedChild) => {
      renderChild(nestedChildrenEl, nestedChild, depth + 1);
    });
    nestedGroupEl.style.cursor = "pointer";
    nestedGroupEl.addEventListener("click", (e) => {
      e.stopPropagation();
      const isExpanded = nestedChildrenEl.style.display !== "none";
      nestedChildrenEl.style.display = isExpanded ? "none" : "block";
      toggleEl.textContent = isExpanded ? "\u25B6" : "\u25BC";
      toggleEl.classList.toggle("expanded", !isExpanded);
    });
  }
  groups.forEach((group) => {
    const groupEl = container.createDiv("link-timeline-group");
    const parentEl = groupEl.createDiv("link-timeline-parent");
    parentEl.style.borderLeftColor = group.parent.color;
    const hasChildren = group.children.length > 0;
    const toggleEl = parentEl.createDiv("link-timeline-expand-toggle");
    if (hasChildren) {
      toggleEl.textContent = "\u25B6";
      toggleEl.classList.add("has-children");
    }
    const roleBadge = parentEl.createEl("span", {
      text: group.parent.isChild ? "[C]" : "[P]",
      cls: `link-timeline-role-badge ${group.parent.isChild ? "role-child" : "role-parent"}`
    });
    const iconEl = parentEl.createDiv("link-timeline-icon");
    iconEl.innerHTML = group.parent.icon;
    iconEl.style.color = group.parent.color;
    const detailsEl = parentEl.createDiv("link-timeline-details");
    detailsEl.createEl("strong", { text: group.parent.type });
    if (group.parent.time) {
      detailsEl.createEl("span", { text: ` | ${group.parent.time}`, cls: "link-timeline-time" });
    }
    if (group.parent.cardId) {
      detailsEl.createEl("span", { text: ` | ${group.parent.cardId}`, cls: "link-timeline-card-id" });
    }
    if (group.parent.value && group.parent.value.trim()) {
      detailsEl.createDiv({ text: group.parent.value, cls: "link-timeline-value" });
    }
    if (hasChildren) {
      parentEl.createEl("span", {
        text: String(group.children.length),
        cls: "link-timeline-count"
      });
    }
    const childrenEl = groupEl.createDiv("link-timeline-children");
    childrenEl.style.display = "none";
    group.children.forEach((child) => {
      renderChild(childrenEl, child, 0);
    });
    if (hasChildren) {
      parentEl.style.cursor = "pointer";
      parentEl.addEventListener("click", () => {
        const isExpanded = childrenEl.style.display !== "none";
        childrenEl.style.display = isExpanded ? "none" : "block";
        toggleEl.textContent = isExpanded ? "\u25B6" : "\u25BC";
        toggleEl.classList.toggle("expanded", !isExpanded);
      });
    }
  });
  if (badDirectionalCards.length > 0) {
    const errorSection = container.createDiv("link-timeline-error-section");
    const errorHeader = errorSection.createDiv("link-timeline-error-header");
    errorHeader.textContent = "\u26A0\uFE0F Directional Errors: Child\u2192Parent & Child\u2192Child";
    const errorDesc = errorSection.createDiv("link-timeline-error-description");
    errorDesc.textContent = "These cards have incorrect arrow connections: [P] cards with incoming arrows FROM [C] cards (Child\u2192Parent), or orphaned [C] cards with no [P] parent in their upstream chain. C\u2192C arrows are allowed when a parent exists above.";
    badDirectionalCards.forEach((card) => {
      const errorItem = errorSection.createDiv("link-timeline-error-item");
      errorItem.style.borderLeftColor = card.color;
      errorItem.createEl("span", {
        text: "[P]",
        cls: "link-timeline-role-badge role-parent"
      });
      const iconEl = errorItem.createDiv("link-timeline-icon");
      iconEl.innerHTML = card.icon;
      iconEl.style.color = card.color;
      const detailsEl = errorItem.createDiv("link-timeline-details");
      detailsEl.createEl("strong", { text: card.type });
      if (card.time) {
        detailsEl.createEl("span", { text: ` | ${card.time}`, cls: "link-timeline-time" });
      }
      if (card.cardId) {
        detailsEl.createEl("span", { text: ` | ${card.cardId}`, cls: "link-timeline-card-id" });
      }
      if (card.value && card.value.trim()) {
        detailsEl.createDiv({ text: card.value, cls: "link-timeline-value" });
      }
    });
  }
}

// src/timeline/RenderTimelinesModal.ts
var RenderTimelinesModal = class extends import_obsidian4.Modal {
  constructor(app, plugin) {
    super(app);
    this.plugin = plugin;
  }
  onOpen() {
    const { contentEl } = this;
    this.modalEl.classList.add("timeline-modal-fullscreen");
    const iocData = extractFixedIOCData(this.app);
    if (DEBUG)
      console.debug("[TimelineModal] Extracted", iocData.length, "IOC cards");
    const sortedData = [...iocData].sort(
      (a, b) => new Date(a.time).getTime() - new Date(b.time).getTime()
    );
    const headerContainer = contentEl.createDiv("timeline-modal-header");
    headerContainer.createEl("h2", { text: "IOC Timeline" });
    const tabBar = contentEl.createDiv("timeline-tab-bar");
    const tabs = [
      { id: "time", label: "Time Timeline" },
      { id: "graph", label: "Graph" },
      { id: "link", label: "Link Timeline" }
    ];
    const tabContents = {};
    const tabButtons = [];
    tabs.forEach((tab, idx) => {
      const btn = tabBar.createEl("button", {
        text: tab.label,
        cls: "timeline-tab-button"
      });
      if (idx === 0)
        btn.classList.add("active");
      tabButtons.push(btn);
      btn.addEventListener("click", () => {
        tabButtons.forEach((b) => b.classList.remove("active"));
        btn.classList.add("active");
        Object.values(tabContents).forEach((c) => c.style.display = "none");
        tabContents[tab.id].style.display = "block";
      });
    });
    const contentArea = contentEl.createDiv("timeline-tab-content-area");
    const timeTab = contentArea.createDiv("timeline-tab-pane");
    tabContents["time"] = timeTab;
    renderTimeTimeline(timeTab, sortedData);
    const graphTab = contentArea.createDiv("timeline-tab-pane");
    graphTab.style.display = "none";
    tabContents["graph"] = graphTab;
    renderGraphTimeline(graphTab, sortedData);
    const linkTab = contentArea.createDiv("timeline-tab-pane");
    linkTab.style.display = "none";
    tabContents["link"] = linkTab;
    const edges = getCanvasEdges(this.app);
    const result = buildParentChildGroups(iocData, edges);
    renderLinkTimeline(linkTab, result);
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/mitre/RenderMitreModal.ts
var import_obsidian5 = require("obsidian");

// src/mitre/MitreStixParser.ts
var TACTIC_ABBREVIATIONS = {
  "Reconnaissance": ["RECON", "RECCE", "RE"],
  "Resource Development": ["RESOURCE", "RES", "RD"],
  "Initial Access": ["IA", "INIT"],
  "Execution": ["EXEC", "EXE", "EX"],
  "Persistence": ["PERSIST", "PERS", "PS"],
  "Privilege Escalation": ["PRIV", "PE", "PRIVESC", "PRIV ESC"],
  "Defense Evasion": ["DEFENSE", "DEF", "DE"],
  "Credential Access": ["CRED", "CA", "CRED ACCESS"],
  "Discovery": ["DISC", "DIS", "DI"],
  "Lateral Movement": ["LATERAL", "LM", "LAT MOVE"],
  "Collection": ["COLLECT", "COL", "CO"],
  "Command and Control": ["C2", "CNC", "CC"],
  "Exfiltration": ["EXFIL", "EXFILTRATE"],
  "Impact": ["IMP", "IM"]
};
function generateAbbreviations(tacticName) {
  const abbrevs = [];
  const words = tacticName.split(/[\s\-]+/);
  if (words.length > 0) {
    abbrevs.push(words.map((w) => w[0]).join("").toUpperCase());
  }
  if (TACTIC_ABBREVIATIONS[tacticName]) {
    abbrevs.push(...TACTIC_ABBREVIATIONS[tacticName]);
  }
  return abbrevs;
}
function parseStixBundle(stixBundle) {
  var _a, _b, _c, _d, _e, _f, _g, _h;
  if (DEBUG)
    console.debug("[MitreLoader] Parsing STIX bundle with", (_a = stixBundle.objects) == null ? void 0 : _a.length, "objects");
  const tactics = {};
  const techniques = {};
  let version = "unknown";
  let last_updated = new Date().toISOString().split("T")[0];
  for (const obj of stixBundle.objects) {
    if (obj.type === "x-mitre-collection") {
      version = obj.x_mitre_version || "unknown";
      last_updated = ((_b = obj.modified) == null ? void 0 : _b.split("T")[0]) || last_updated;
      if (DEBUG)
        console.debug("[MitreLoader] Found collection metadata - version:", version, "updated:", last_updated);
    }
  }
  for (const obj of stixBundle.objects) {
    if (obj.type === "x-mitre-tactic" && !obj.x_mitre_deprecated) {
      const tacticId = (_d = (_c = obj.external_references) == null ? void 0 : _c.find((ref) => ref.source_name === "mitre-attack")) == null ? void 0 : _d.external_id;
      if (!tacticId)
        continue;
      const shortName = obj.x_mitre_shortname || tacticId.toLowerCase();
      tactics[tacticId] = {
        id: tacticId,
        name: obj.name,
        short_name: shortName,
        description: obj.description || "",
        abbreviations: generateAbbreviations(obj.name)
      };
    }
  }
  if (DEBUG)
    console.debug("[MitreLoader] Parsed", Object.keys(tactics).length, "tactics");
  const shortNameToTacticId = /* @__PURE__ */ new Map();
  for (const [tacticId, tactic] of Object.entries(tactics)) {
    shortNameToTacticId.set(tactic.short_name, tacticId);
  }
  for (const obj of stixBundle.objects) {
    if (obj.type === "attack-pattern" && !obj.x_mitre_deprecated) {
      const techniqueId = (_f = (_e = obj.external_references) == null ? void 0 : _e.find((ref) => ref.source_name === "mitre-attack")) == null ? void 0 : _f.external_id;
      if (!techniqueId)
        continue;
      const tacticIds = [];
      if (obj.kill_chain_phases) {
        for (const phase of obj.kill_chain_phases) {
          if (phase.kill_chain_name === "mitre-attack") {
            const tacticId = shortNameToTacticId.get(phase.phase_name);
            if (tacticId) {
              tacticIds.push(tacticId);
            }
          }
        }
      }
      let parent;
      if (obj.x_mitre_is_subtechnique && techniqueId.includes(".")) {
        parent = techniqueId.split(".")[0];
      }
      techniques[techniqueId] = {
        id: techniqueId,
        name: obj.name,
        description: obj.description || "",
        tactics: tacticIds,
        parent,
        url: ((_h = (_g = obj.external_references) == null ? void 0 : _g.find((ref) => ref.source_name === "mitre-attack")) == null ? void 0 : _h.url) || `https://attack.mitre.org/techniques/${techniqueId.replace(".", "/")}`
      };
    }
  }
  if (DEBUG)
    console.debug("[MitreLoader] Parsed", Object.keys(techniques).length, "techniques");
  return {
    version,
    last_updated,
    tactics,
    techniques
  };
}

// src/mitre/MitreValidation.ts
function normalizeTacticName(name, dataset) {
  const normalized = name.toLowerCase().replace(/[\s\-_]+/g, "");
  if (DEBUG)
    console.debug("[MitreLoader] Normalizing tactic:", name, "\u2192", normalized);
  for (const [tacticId, tactic] of Object.entries(dataset.tactics)) {
    if (tactic.short_name.replace(/\-/g, "") === normalized) {
      if (DEBUG)
        console.debug("[MitreLoader] Matched by short_name:", tactic.name, "(" + tacticId + ")");
      return tacticId;
    }
  }
  for (const [tacticId, tactic] of Object.entries(dataset.tactics)) {
    if (tactic.name.toLowerCase().replace(/[\s\-_]+/g, "") === normalized) {
      if (DEBUG)
        console.debug("[MitreLoader] Matched by full name:", tactic.name, "(" + tacticId + ")");
      return tacticId;
    }
  }
  const upper = name.toUpperCase().trim();
  for (const [tacticId, tactic] of Object.entries(dataset.tactics)) {
    if (tactic.abbreviations.includes(upper)) {
      if (DEBUG)
        console.debug("[MitreLoader] Matched by abbreviation:", upper, "\u2192", tactic.name, "(" + tacticId + ")");
      return tacticId;
    }
  }
  if (DEBUG)
    console.debug("[MitreLoader] No match found for:", name);
  return null;
}
function validateTechniqueTactic(techniqueId, tacticInput, dataset) {
  const tacticId = normalizeTacticName(tacticInput, dataset);
  if (!tacticId) {
    return {
      severity: "unknown_tactic",
      message: `Unknown tactic: "${tacticInput}"`
    };
  }
  const technique = dataset.techniques[techniqueId];
  if (!technique) {
    return {
      severity: "unknown_technique",
      message: `Unknown technique: "${techniqueId}"`
    };
  }
  if (!technique.tactics.includes(tacticId)) {
    const validTactics = technique.tactics.map((tid) => {
      var _a;
      return ((_a = dataset.tactics[tid]) == null ? void 0 : _a.name) || tid;
    }).join(", ");
    return {
      severity: "mismatch",
      message: `${techniqueId} (${technique.name}) does not belong to ${dataset.tactics[tacticId].name}. Valid tactics: ${validTactics}`,
      tacticId
    };
  }
  return {
    severity: "valid",
    tacticId
  };
}

// src/mitre/MitreLoader.ts
var cachedDataset = null;
async function loadMitreDataset(app) {
  if (cachedDataset) {
    if (DEBUG)
      console.debug("[MitreLoader] Returning cached dataset");
    return cachedDataset;
  }
  try {
    const adapter = app.vault.adapter;
    const jsonPath = ".obsidian/plugins/cyber_canvas/MITRE/enterprise-attack.json";
    if (DEBUG)
      console.debug("[MitreLoader] Attempting to load from:", jsonPath);
    if (await adapter.exists(jsonPath)) {
      const content = await adapter.read(jsonPath);
      const stixBundle = JSON.parse(content);
      if (stixBundle.type === "bundle" && Array.isArray(stixBundle.objects)) {
        if (DEBUG)
          console.debug("[MitreLoader] Parsing STIX 2.1 bundle format...");
        cachedDataset = parseStixBundle(stixBundle);
        if (DEBUG)
          console.debug("[MitreLoader] Loaded full dataset from STIX bundle. Tactics:", Object.keys(cachedDataset.tactics).length, "Techniques:", Object.keys(cachedDataset.techniques).length);
        return cachedDataset;
      } else if (stixBundle.version && stixBundle.tactics && stixBundle.techniques) {
        cachedDataset = stixBundle;
        if (DEBUG)
          console.debug("[MitreLoader] Loaded pre-processed dataset. Version:", cachedDataset.version, "Techniques:", Object.keys(cachedDataset.techniques).length);
        return cachedDataset;
      } else {
        console.warn("[MitreLoader] Unknown JSON format");
      }
    } else {
      console.error("[MitreLoader] JSON file not found at:", jsonPath);
      throw new Error(
        "MITRE ATT&CK dataset not found. Please ensure enterprise-attack.json exists in the MITRE folder. Download from: https://github.com/mitre-attack/attack-stix-data"
      );
    }
  } catch (err) {
    console.error("[MitreLoader] Failed to load MITRE dataset:", err);
    throw new Error(
      "MITRE ATT&CK dataset not found. Please ensure enterprise-attack.json exists in the MITRE folder. Download from: https://github.com/mitre-attack/attack-stix-data"
    );
  }
  throw new Error("MITRE ATT&CK dataset could not be loaded");
}

// src/mitre/MitreAggregatorTypes.ts
var TACTIC_ORDER = [
  "TA0043",
  // Reconnaissance
  "TA0042",
  // Resource Development
  "TA0001",
  // Initial Access
  "TA0002",
  // Execution
  "TA0003",
  // Persistence
  "TA0004",
  // Privilege Escalation
  "TA0005",
  // Defense Evasion
  "TA0006",
  // Credential Access
  "TA0007",
  // Discovery
  "TA0008",
  // Lateral Movement
  "TA0009",
  // Collection
  "TA0011",
  // Command and Control
  "TA0010",
  // Exfiltration
  "TA0040"
  // Impact
];
function extractTechniqueId(technique) {
  const idMatch = technique.match(/T\d{4}(?:\.\d{3})?/i);
  if (idMatch) {
    const techniqueId = idMatch[0].toUpperCase();
    if (DEBUG)
      console.debug("[MitreAggregator] Extracted technique ID:", techniqueId, "from:", technique);
    return techniqueId;
  }
  if (DEBUG)
    console.debug("[MitreAggregator] No technique ID found in:", technique, "- using raw string");
  return technique.trim();
}
function extractTechniqueName(technique, dataset) {
  const dashMatch = technique.match(/T\d{4}(?:\.\d{3})?\s*-\s*(.+)/);
  if (dashMatch) {
    const name = dashMatch[1].trim();
    if (DEBUG)
      console.debug("[MitreAggregator] Extracted name from dash format:", name);
    return name;
  }
  const parenMatch = technique.match(/(.+?)\s*\(T\d{4}(?:\.\d{3})?\)/);
  if (parenMatch) {
    const name = parenMatch[1].trim();
    if (DEBUG)
      console.debug("[MitreAggregator] Extracted name from paren format:", name);
    return name;
  }
  const idOnlyMatch = technique.match(/^T\d{4}(?:\.\d{3})?$/);
  if (idOnlyMatch && dataset) {
    const techData = dataset.techniques[idOnlyMatch[0]];
    if (techData) {
      if (DEBUG)
        console.debug("[MitreAggregator] Looked up name for ID:", idOnlyMatch[0], "->", techData.name);
      return techData.name;
    }
  }
  if (DEBUG)
    console.debug("[MitreAggregator] Using raw technique string as name:", technique);
  return technique.trim();
}

// src/mitre/MitreSeverity.ts
function isCriticalSeverity(severity) {
  return severity === "unknown_technique" || severity === "unknown_tactic";
}
function getSeverityIcon(severity) {
  return isCriticalSeverity(severity) ? "\u{1F534}" : "\u26A0\uFE0F";
}
function applySeverityClass(element, severity) {
  if (severity === "valid") {
    element.addClass("mitre-technique-valid");
  } else if (isCriticalSeverity(severity)) {
    element.addClass("mitre-technique-error");
  } else if (severity === "mismatch") {
    element.addClass("mitre-technique-warning");
  }
}
function shouldOverrideSeverity(newSeverity, existingSeverity) {
  const severityRank = {
    "unknown_technique": 4,
    "unknown_tactic": 3,
    "mismatch": 2,
    "valid": 1
  };
  return severityRank[newSeverity] > severityRank[existingSeverity];
}

// src/mitre/MitreAggregatorCardProcessing.ts
function markParentAsFound(techniqueId, foundTechniques, tactic) {
  if (!techniqueId.includes("."))
    return;
  const parentId = techniqueId.split(".")[0];
  if (foundTechniques.has(parentId)) {
    const existing = foundTechniques.get(parentId);
    existing.count++;
  } else {
    foundTechniques.set(parentId, {
      count: 1,
      iocCards: [],
      // Empty - cards reference subtechniques, not parent
      severity: "valid",
      validationMessage: void 0,
      userProvidedTactic: tactic
    });
  }
  if (DEBUG)
    console.debug("[MitreAggregator] Marked parent technique as found:", {
      subtechnique: techniqueId,
      parent: parentId,
      tactic
    });
}
function buildFoundTechniquesFromIOC(iocData, dataset) {
  const foundTechniques = /* @__PURE__ */ new Map();
  const cardValidations = /* @__PURE__ */ new Map();
  const missingTacticCards = [];
  const missingTechniqueCards = [];
  let iocCount = 0;
  iocData.forEach((ioc) => {
    const rawTactic = (ioc.tactic || "").trim();
    const rawTechnique = (ioc.technique || "").trim();
    if (DEBUG)
      console.debug("[MitreAggregator] Processing IOC card:", {
        cardId: ioc.cardId || "(no ID)",
        type: ioc.type,
        nodeId: ioc.id,
        rawTactic: rawTactic || "(empty)",
        rawTechnique: rawTechnique || "(empty)"
      });
    if (!rawTechnique) {
      if (DEBUG)
        console.debug("[MitreAggregator] IOC card has empty technique:", ioc.id);
      const missingInfo = {
        cardId: ioc.cardId || ioc.id,
        iocType: ioc.type,
        nodeId: ioc.id,
        missing: !rawTactic ? "both" : "technique"
      };
      missingTechniqueCards.push(missingInfo);
      if (!rawTactic) {
        missingTacticCards.push({ ...missingInfo, missing: "both" });
      }
      iocCount++;
      return;
    }
    const technique = rawTechnique;
    const techniqueId = extractTechniqueId(technique);
    const techniqueName = extractTechniqueName(technique, dataset);
    if (!rawTactic) {
      if (DEBUG)
        console.debug("[MitreAggregator] IOC card has empty tactic:", ioc.id);
      missingTacticCards.push({
        cardId: ioc.cardId || ioc.id,
        iocType: ioc.type,
        nodeId: ioc.id,
        missing: "tactic"
      });
      iocCount++;
      if (!foundTechniques.has(techniqueId)) {
        foundTechniques.set(techniqueId, {
          count: 1,
          iocCards: [ioc.id],
          severity: "valid",
          // No severity penalty for missing tactic
          validationMessage: void 0,
          userProvidedTactic: "(empty)"
        });
      } else {
        const existing = foundTechniques.get(techniqueId);
        existing.count++;
        existing.iocCards.push(ioc.id);
      }
      markParentAsFound(techniqueId, foundTechniques, "(empty)");
      return;
    }
    const tactic = rawTactic;
    const validation = validateTechniqueTactic(techniqueId, tactic, dataset);
    if (DEBUG)
      console.debug("[MitreAggregator] Validated technique:", {
        cardId: ioc.cardId || ioc.id,
        techniqueId,
        tactic,
        severity: validation.severity,
        message: validation.message || "valid"
      });
    iocCount++;
    cardValidations.set(ioc.id, {
      cardId: ioc.cardId || ioc.id,
      techniqueId,
      techniqueName,
      tactic,
      severity: validation.severity,
      validationMessage: validation.message,
      iocType: ioc.type,
      nodeId: ioc.id
    });
    if (foundTechniques.has(techniqueId)) {
      const existing = foundTechniques.get(techniqueId);
      existing.count++;
      existing.iocCards.push(ioc.id);
      if (shouldOverrideSeverity(validation.severity, existing.severity)) {
        existing.severity = validation.severity;
        existing.validationMessage = validation.message;
      }
    } else {
      foundTechniques.set(techniqueId, {
        count: 1,
        iocCards: [ioc.id],
        severity: validation.severity,
        validationMessage: validation.message,
        userProvidedTactic: tactic
      });
    }
    markParentAsFound(techniqueId, foundTechniques, tactic);
  });
  if (DEBUG)
    console.debug("[MitreAggregator] Found", foundTechniques.size, "unique techniques in IOC cards");
  return {
    foundTechniques,
    cardValidations,
    missingTacticCards,
    missingTechniqueCards,
    iocCount
  };
}

// src/mitre/MitreAggregator.ts
function aggregateTacticsTechniques(iocData, dataset) {
  if (DEBUG)
    console.debug("[MitreAggregator] Starting full matrix aggregation with", iocData.length, "IOC cards");
  if (DEBUG)
    console.debug("[MitreAggregator] Dataset has", Object.keys(dataset.techniques).length, "techniques");
  const iocDataMap = /* @__PURE__ */ new Map();
  iocData.forEach((ioc) => {
    iocDataMap.set(ioc.id, ioc);
  });
  const {
    foundTechniques,
    cardValidations,
    missingTacticCards,
    missingTechniqueCards,
    iocCount
  } = buildFoundTechniquesFromIOC(iocData, dataset);
  const tacticMap = /* @__PURE__ */ new Map();
  Object.values(dataset.tactics).forEach((tacticData) => {
    tacticMap.set(tacticData.id, {
      name: tacticData.id,
      displayName: `${tacticData.name} (${tacticData.id})`,
      techniques: []
    });
  });
  const subtechniquesMap = /* @__PURE__ */ new Map();
  Object.values(dataset.techniques).forEach((techData) => {
    const foundData = foundTechniques.get(techData.id);
    const isFound = !!foundData;
    const techniqueObj = {
      id: techData.id,
      name: techData.name,
      tactic: "",
      tacticId: "",
      count: (foundData == null ? void 0 : foundData.count) || 0,
      iocCards: (foundData == null ? void 0 : foundData.iocCards) || [],
      severity: (foundData == null ? void 0 : foundData.severity) || "not_found",
      validationMessage: foundData == null ? void 0 : foundData.validationMessage,
      description: techData.description,
      isFound
    };
    if (techData.parent) {
      if (!subtechniquesMap.has(techData.parent)) {
        subtechniquesMap.set(techData.parent, []);
      }
      if (techData.tactics.length > 0) {
        techniqueObj.tactic = (foundData == null ? void 0 : foundData.userProvidedTactic) || techData.tactics[0];
        techniqueObj.tacticId = techData.tactics[0];
      }
      subtechniquesMap.get(techData.parent).push(techniqueObj);
      if (DEBUG)
        console.debug("[MitreAggregator] Added subtechnique:", {
          id: techData.id,
          parent: techData.parent,
          isFound,
          totalSubtechniques: subtechniquesMap.get(techData.parent).length
        });
      return;
    }
    techData.tactics.forEach((tacticId) => {
      if (!tacticMap.has(tacticId)) {
        console.warn("[MitreAggregator] Unknown tactic ID in dataset:", tacticId);
        return;
      }
      const tactic = tacticMap.get(tacticId);
      tactic.techniques.push({
        ...techniqueObj,
        tactic: (foundData == null ? void 0 : foundData.userProvidedTactic) || tacticId,
        tacticId
      });
    });
  });
  const tactics = Array.from(tacticMap.values());
  tactics.sort((a, b) => {
    const indexA = TACTIC_ORDER.indexOf(a.name);
    const indexB = TACTIC_ORDER.indexOf(b.name);
    if (indexA === -1)
      return 1;
    if (indexB === -1)
      return -1;
    return indexA - indexB;
  });
  tactics.forEach((tactic) => {
    tactic.techniques.sort((a, b) => {
      if (a.isFound && !b.isFound)
        return -1;
      if (!a.isFound && b.isFound)
        return 1;
      return a.id.localeCompare(b.id);
    });
  });
  if (DEBUG)
    console.debug("[MitreAggregator] Full matrix built:", {
      totalTactics: tactics.length,
      totalTechniques: tactics.reduce((sum, t) => sum + t.techniques.length, 0),
      foundTechniques: foundTechniques.size
    });
  if (DEBUG)
    console.debug("[MitreAggregator] Collecting validation errors from card-level validation...");
  const validationErrors = [];
  const errorsByTechnique = /* @__PURE__ */ new Map();
  cardValidations.forEach((cardValidation, cardId) => {
    if (cardValidation.severity !== "valid") {
      const key = `${cardValidation.techniqueId}-${cardValidation.severity}`;
      if (!errorsByTechnique.has(key)) {
        errorsByTechnique.set(key, {
          techniqueId: cardValidation.techniqueId,
          techniqueName: cardValidation.techniqueName,
          severity: cardValidation.severity,
          message: cardValidation.validationMessage || "Validation error",
          cards: []
        });
      }
      errorsByTechnique.get(key).cards.push({
        cardId: cardValidation.cardId,
        iocType: cardValidation.iocType,
        nodeId: cardValidation.nodeId
      });
    }
  });
  errorsByTechnique.forEach((errorData) => {
    validationErrors.push({
      techniqueId: errorData.techniqueId,
      techniqueName: errorData.techniqueName,
      severity: errorData.severity,
      message: errorData.message,
      iocCards: errorData.cards
    });
  });
  if (DEBUG)
    console.debug("[MitreAggregator] Aggregation complete:", {
      errorGroups: validationErrors.length,
      cardsWithErrors: Array.from(cardValidations.values()).filter((v) => v.severity !== "valid").length,
      missingTactic: missingTacticCards.length,
      missingTechnique: missingTechniqueCards.length
    });
  return {
    tactics,
    validationErrors,
    subtechniquesMap,
    iocDataMap,
    iocCount,
    missingFields: {
      missingTactic: missingTacticCards,
      missingTechnique: missingTechniqueCards
    }
  };
}

// src/mitre/MitreExport.ts
function exportToNavigator(tactics, iocCount, dataset) {
  if (DEBUG)
    console.debug("[MitreExport] Starting export -", tactics.length, "tactics,", iocCount, "IOC cards");
  const layer = {
    name: "Cyber Canvas IOC Analysis",
    versions: {
      attack: "14",
      navigator: "4.9.4",
      layer: "4.5"
    },
    domain: "enterprise-attack",
    description: `Generated from ${iocCount} IOC cards in Obsidian Canvas`,
    filters: {
      platforms: ["windows", "linux", "macos"]
    },
    sorting: 0,
    layout: {
      layout: "side",
      aggregateFunction: "average",
      showID: true,
      showName: true,
      showAggregateScores: false,
      countUnscored: false
    },
    hideDisabled: false,
    techniques: [],
    gradient: {
      colors: ["#ff6666", "#ffe766", "#8ec843"],
      minValue: 0,
      maxValue: 100
    },
    legendItems: [],
    metadata: [],
    links: [],
    showTacticRowBackground: true,
    tacticRowBackground: "#dddddd",
    selectTechniquesAcrossTactics: true,
    selectSubtechniquesWithParent: false
  };
  tactics.forEach((tactic) => {
    tactic.techniques.forEach((technique) => {
      if (!technique.isFound)
        return;
      const tacticData = dataset.tactics[technique.tacticId];
      const tacticShortName = (tacticData == null ? void 0 : tacticData.short_name) || tactic.name.toLowerCase().replace(/\s+/g, "-");
      let color;
      if (technique.severity === "valid") {
        color = "#66bb6a";
      } else if (isCriticalSeverity(technique.severity)) {
        color = "#f44336";
      } else if (technique.severity === "mismatch") {
        color = "#ffa500";
      } else {
        color = "#66bb6a";
      }
      let comment = `Used in ${technique.count} IOC card${technique.count > 1 ? "s" : ""}`;
      if (technique.severity !== "valid" && technique.validationMessage) {
        comment += `
${getSeverityIcon(technique.severity)} ${technique.validationMessage}`;
      }
      layer.techniques.push({
        techniqueID: technique.id,
        tactic: tacticShortName,
        color,
        comment,
        enabled: true,
        metadata: [
          { name: "severity", value: technique.severity },
          { name: "ioc_cards", value: technique.iocCards.join(", ") }
        ],
        links: [],
        showSubtechniques: false,
        score: technique.count * 10
        // Scale count for visual weight
      });
    });
  });
  if (DEBUG)
    console.debug("[MitreExport] Exported", layer.techniques.length, "techniques to Navigator format");
  const jsonString = JSON.stringify(layer, null, 2);
  const blob = new Blob([jsonString], { type: "application/json" });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = `mitre-navigator-${Date.now()}.json`;
  a.click();
  URL.revokeObjectURL(url);
}

// src/mitre/MitreResizable.ts
function makeResizable(modal) {
  if (DEBUG)
    console.debug("[MitreResizable] Attaching resize handles");
  const MIN_WIDTH = 600;
  const MIN_HEIGHT = 400;
  const MAX_WIDTH = window.innerWidth * 0.95;
  const MAX_HEIGHT = window.innerHeight * 0.95;
  const handles = [
    ["resize-handle-n", "ns-resize", false],
    // Top edge
    ["resize-handle-s", "ns-resize", false],
    // Bottom edge
    ["resize-handle-e", "ew-resize", false],
    // Right edge
    ["resize-handle-w", "ew-resize", false],
    // Left edge
    ["resize-handle-ne", "nesw-resize", true],
    // Top-right corner
    ["resize-handle-nw", "nwse-resize", true],
    // Top-left corner
    ["resize-handle-se", "nwse-resize", true],
    // Bottom-right corner
    ["resize-handle-sw", "nesw-resize", true]
    // Bottom-left corner
  ];
  handles.forEach(([className, cursor, isCorner]) => {
    const handle = modal.createDiv(`mitre-resize-handle ${className}`);
    handle.style.cursor = cursor;
    let startX = 0, startY = 0, startWidth = 0, startHeight = 0, startLeft = 0, startTop = 0;
    const onMouseDown = (e) => {
      e.preventDefault();
      e.stopPropagation();
      startX = e.clientX;
      startY = e.clientY;
      const rect = modal.getBoundingClientRect();
      startWidth = rect.width;
      startHeight = rect.height;
      startLeft = rect.left;
      startTop = rect.top;
      document.addEventListener("mousemove", onMouseMove);
      document.addEventListener("mouseup", onMouseUp);
      modal.addClass("mitre-modal-resizing");
    };
    const onMouseMove = (e) => {
      const deltaX = e.clientX - startX;
      const deltaY = e.clientY - startY;
      let newWidth = startWidth;
      let newHeight = startHeight;
      let newLeft = startLeft;
      let newTop = startTop;
      if (className.includes("-e")) {
        newWidth = Math.max(MIN_WIDTH, Math.min(MAX_WIDTH, startWidth + deltaX));
      }
      if (className.includes("-w")) {
        newWidth = Math.max(MIN_WIDTH, Math.min(MAX_WIDTH, startWidth - deltaX));
        newLeft = startLeft + (startWidth - newWidth);
      }
      if (className.includes("-s")) {
        newHeight = Math.max(MIN_HEIGHT, Math.min(MAX_HEIGHT, startHeight + deltaY));
      }
      if (className.includes("-n")) {
        newHeight = Math.max(MIN_HEIGHT, Math.min(MAX_HEIGHT, startHeight - deltaY));
        newTop = startTop + (startHeight - newHeight);
      }
      modal.style.setProperty("width", `${newWidth}px`, "important");
      modal.style.setProperty("height", `${newHeight}px`, "important");
      modal.style.setProperty("max-width", `${newWidth}px`, "important");
      modal.style.setProperty("max-height", `${newHeight}px`, "important");
      if (className.includes("-w") || className.includes("-n")) {
        modal.style.left = `${newLeft}px`;
        modal.style.top = `${newTop}px`;
      }
    };
    const onMouseUp = () => {
      document.removeEventListener("mousemove", onMouseMove);
      document.removeEventListener("mouseup", onMouseUp);
      modal.removeClass("mitre-modal-resizing");
      if (DEBUG)
        console.debug("[MitreResizable] Resize complete");
    };
    handle.addEventListener("mousedown", onMouseDown);
  });
}

// src/mitre/MitreStatsBar.ts
function renderStatsBar(statsContainer, tactics, iocCount, missingFields) {
  const totalTechniques = tactics.reduce((sum, t) => sum + t.techniques.length, 0);
  const foundTechniques = tactics.reduce(
    (sum, t) => sum + t.techniques.filter((tech) => tech.isFound).length,
    0
  );
  const coveragePercent = totalTechniques > 0 ? Math.round(foundTechniques / totalTechniques * 100) : 0;
  statsContainer.createEl("div", {
    text: `\u{1F4CA} Coverage: ${foundTechniques}/${totalTechniques} techniques (${coveragePercent}%)`,
    cls: "mitre-stat-item"
  });
  const activeTactics = tactics.filter((t) => t.techniques.some((tech) => tech.isFound)).length;
  statsContainer.createEl("div", {
    text: `\u2694\uFE0F Tactics: ${activeTactics}/${tactics.length} active`,
    cls: "mitre-stat-item"
  });
  statsContainer.createEl("div", {
    text: `\u{1F4C7} IOC Cards: ${iocCount} total`,
    cls: "mitre-stat-item"
  });
  const missingTacticCount = missingFields.missingTactic.length;
  if (missingTacticCount > 0) {
    const missingTacticEl = statsContainer.createEl("div", {
      text: `\u26A0\uFE0F Missing Tactic: ${missingTacticCount} card${missingTacticCount === 1 ? "" : "s"}`,
      cls: "mitre-stat-item mitre-stat-warning"
    });
    const tooltipText = missingFields.missingTactic.map((info) => {
      const missing = info.missing === "both" ? "tactic, technique" : "tactic";
      return `${info.iocType} ${info.cardId} (missing: ${missing})`;
    }).join("\n");
    missingTacticEl.setAttribute("title", tooltipText);
    missingTacticEl.setAttribute("aria-label", `${missingTacticCount} cards missing tactic field`);
  }
  const missingTechniqueCount = missingFields.missingTechnique.length;
  if (missingTechniqueCount > 0) {
    const missingTechniqueEl = statsContainer.createEl("div", {
      text: `\u26A0\uFE0F Missing Technique: ${missingTechniqueCount} card${missingTechniqueCount === 1 ? "" : "s"}`,
      cls: "mitre-stat-item mitre-stat-warning"
    });
    const tooltipText = missingFields.missingTechnique.map((info) => {
      const missing = info.missing === "both" ? "tactic, technique" : "technique";
      return `${info.iocType} ${info.cardId} (missing: ${missing})`;
    }).join("\n");
    missingTechniqueEl.setAttribute("title", tooltipText);
    missingTechniqueEl.setAttribute("aria-label", `${missingTechniqueCount} cards missing technique field`);
  }
}

// src/mitre/MitreTextUtils.ts
function cleanDescription(description) {
  if (!description)
    return "";
  let cleaned = description;
  cleaned = cleaned.replace(/\[([^\]]+)\]\([^)]+\)/g, "");
  cleaned = cleaned.replace(/\[[^\]]*\]/g, "");
  cleaned = cleaned.replace(/\s+/g, " ").trim();
  return cleaned;
}
function truncateDescription(description, maxChars = 180) {
  if (!description || description.length <= maxChars) {
    return description;
  }
  const truncated = description.substring(0, maxChars);
  const lastSpace = truncated.lastIndexOf(" ");
  if (lastSpace > 0) {
    return truncated.substring(0, lastSpace) + "...";
  }
  return truncated + "...";
}

// src/mitre/MitreSearch.ts
function parseSearchQuery(query) {
  if (!query || !query.trim()) {
    return {
      query: "",
      keywords: [],
      phrases: [],
      isActive: false
    };
  }
  const trimmedQuery = query.trim();
  const quoteCount = (trimmedQuery.match(/"/g) || []).length;
  let processedQuery = trimmedQuery;
  if (quoteCount % 2 !== 0) {
    const lastQuoteIndex = processedQuery.lastIndexOf('"');
    processedQuery = processedQuery.substring(0, lastQuoteIndex) + processedQuery.substring(lastQuoteIndex + 1);
  }
  const phrases = [];
  const phraseRegex = /"([^"]+)"/g;
  let match;
  while ((match = phraseRegex.exec(processedQuery)) !== null) {
    phrases.push(match[1].toLowerCase());
  }
  const remainingQuery = processedQuery.replace(/"[^"]+"/g, " ");
  const keywords = remainingQuery.split(/\s+/).map((k) => k.trim().toLowerCase()).filter((k) => k.length > 0);
  if (DEBUG)
    console.debug("[MitreSearch] Parsed query:", { query: trimmedQuery, keywords, phrases });
  return {
    query: trimmedQuery,
    keywords,
    phrases,
    isActive: keywords.length > 0 || phrases.length > 0
  };
}
function textMatchesQuery(text, searchState) {
  if (!searchState.isActive)
    return true;
  const lowerText = text.toLowerCase();
  const allKeywordsMatch = searchState.keywords.every(
    (keyword) => lowerText.includes(keyword)
  );
  const allPhrasesMatch = searchState.phrases.every(
    (phrase) => lowerText.includes(phrase)
  );
  return allKeywordsMatch && allPhrasesMatch;
}
function matchesSearch(technique, searchState, subtechniquesMap) {
  if (!searchState.isActive) {
    return { matched: true };
  }
  if (textMatchesQuery(technique.id, searchState)) {
    return { matched: true, matchType: "id", matchText: technique.id };
  }
  if (textMatchesQuery(technique.name, searchState)) {
    return { matched: true, matchType: "name", matchText: technique.name };
  }
  if (technique.description && textMatchesQuery(technique.description, searchState)) {
    return { matched: true, matchType: "description", matchText: technique.description };
  }
  const subtechniques = subtechniquesMap.get(technique.id) || [];
  for (const subtech of subtechniques) {
    if (textMatchesQuery(subtech.id, searchState) || textMatchesQuery(subtech.name, searchState) || subtech.description && textMatchesQuery(subtech.description, searchState)) {
      return { matched: true, matchType: "subtechnique", matchText: subtech.name };
    }
  }
  return { matched: false };
}
function escapeHtml(text) {
  const div = document.createElement("div");
  div.textContent = text;
  return div.innerHTML;
}
function escapeRegex(text) {
  return text.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
}
function highlightMatches(element, originalText, searchState) {
  if (!searchState.isActive || !originalText) {
    return;
  }
  let escapedText = escapeHtml(originalText);
  searchState.phrases.forEach((phrase) => {
    const escapedPhrase = escapeRegex(phrase);
    const regex = new RegExp(`(${escapedPhrase})`, "gi");
    escapedText = escapedText.replace(regex, '<mark class="mitre-search-highlight">$1</mark>');
  });
  searchState.keywords.forEach((keyword) => {
    const escapedKeyword = escapeRegex(keyword);
    const regex = new RegExp(`(?!<mark[^>]*>)(${escapedKeyword})(?![^<]*</mark>)`, "gi");
    escapedText = escapedText.replace(regex, '<mark class="mitre-search-highlight">$1</mark>');
  });
  element.innerHTML = escapedText;
}

// src/mitre/MitreModalHelpers.ts
function isActiveTechnique(techniqueId, activeTechniqueId) {
  if (!activeTechniqueId)
    return false;
  if (techniqueId === activeTechniqueId)
    return true;
  if (activeTechniqueId.includes(".")) {
    const parentId = activeTechniqueId.split(".")[0];
    if (techniqueId === parentId)
      return true;
  }
  return false;
}
function toggleExpansion(element, ctx, subtechniques) {
  var _a, _b, _c;
  const isCollapsed = element.hasClass("collapsed");
  const expandIcon = element.querySelector(".mitre-expand-icon");
  const descEl = element.querySelector(".mitre-technique-description");
  if (isCollapsed) {
    element.removeClass("collapsed");
    element.addClass("expanded");
    element.setAttribute("data-is-expanded", "true");
    if (expandIcon)
      expandIcon.setText("\u25BC");
    if (subtechniques && subtechniques.length > 0) {
      ctx.renderSubtechniques(element, subtechniques, ctx.currentSearchState);
    }
    if (descEl) {
      const fullDesc = element.getAttribute("data-full-description");
      if (fullDesc) {
        descEl.textContent = fullDesc;
        if ((_a = ctx.currentSearchState) == null ? void 0 : _a.isActive) {
          highlightMatches(descEl, fullDesc, ctx.currentSearchState);
        }
      }
    }
  } else {
    element.removeClass("expanded");
    element.addClass("collapsed");
    element.setAttribute("data-is-expanded", "false");
    if (expandIcon)
      expandIcon.setText("\u25B6");
    (_b = element.querySelector(".mitre-subtechniques-container")) == null ? void 0 : _b.remove();
    if (descEl) {
      const fullDesc = element.getAttribute("data-full-description");
      const truncatedDesc = element.getAttribute("data-truncated-description");
      const displayText = truncatedDesc || (fullDesc ? truncateDescription(fullDesc) : null);
      if (displayText) {
        descEl.textContent = displayText;
        if ((_c = ctx.currentSearchState) == null ? void 0 : _c.isActive) {
          highlightMatches(descEl, displayText, ctx.currentSearchState);
        }
      }
    }
  }
}

// src/mitre/MitreCountBadge.ts
function createCountBadgeWithTooltip(parentEl, technique, ctx, extraIocCards) {
  const badge = parentEl.createDiv("mitre-technique-count-badge");
  badge.textContent = `${technique.count} card${technique.count > 1 ? "s" : ""}`;
  const allCardIds = [...technique.iocCards, ...extraIocCards || []];
  const tooltip = badge.createDiv("mitre-count-tooltip");
  tooltip.style.display = "none";
  allCardIds.forEach((cardId, index) => {
    const iocData = ctx.iocDataMap.get(cardId);
    if (!iocData)
      return;
    const cardItem = tooltip.createDiv("mitre-tooltip-card");
    const iocType = Object.values(IOC_TYPES).find((t) => t.name === iocData.type);
    const typeColor = (iocType == null ? void 0 : iocType.color) || "#888";
    const typeEl = cardItem.createDiv("mitre-tooltip-type");
    typeEl.style.color = typeColor;
    typeEl.style.fontWeight = "bold";
    typeEl.textContent = iocData.type;
    if (iocData.value) {
      const valueEl = cardItem.createDiv("mitre-tooltip-value");
      valueEl.textContent = iocData.value;
    }
    if (index < allCardIds.length - 1) {
      cardItem.style.borderBottom = "1px solid var(--background-modifier-border)";
      cardItem.style.paddingBottom = "8px";
      cardItem.style.marginBottom = "8px";
    }
  });
  badge.addEventListener("mouseenter", () => {
    tooltip.style.display = "block";
  });
  badge.addEventListener("mouseleave", () => {
    tooltip.style.display = "none";
  });
  if (DEBUG)
    console.debug("[MitreModalRenderer]   \u2192 Count badge with tooltip:", technique.count, "card(s), allCards:", allCardIds.length);
}

// src/mitre/MitreModalTacticRenderer.ts
function renderTacticSection(container, tactic, ctx, searchState) {
  if (DEBUG)
    console.debug("[MitreModalRenderer] ========== RENDERING TACTIC SECTION ==========");
  if (DEBUG)
    console.debug("[MitreModalRenderer] Tactic:", tactic.displayName || tactic.name);
  const tacticColumn = container.createDiv("mitre-tactic-column");
  const foundCount = tactic.techniques.filter((t) => t.isFound).length;
  const totalCount = tactic.techniques.length;
  if (DEBUG)
    console.debug("[MitreModalRenderer] Found techniques:", foundCount, "/", totalCount);
  const tacticHeader = tacticColumn.createDiv("mitre-tactic-header");
  tacticHeader.createEl("h3", { text: `\u2694\uFE0F ${tactic.displayName || tactic.name}` });
  tacticHeader.createEl("span", {
    text: `${foundCount} active / ${totalCount} total techniques`,
    cls: "mitre-technique-count"
  });
  const techniqueList = tacticColumn.createDiv("mitre-technique-list");
  tactic.techniques.forEach((technique) => {
    renderTechniqueItem(techniqueList, technique, ctx, searchState);
  });
  if (DEBUG)
    console.debug("[MitreModalRenderer] ========== TACTIC RENDERING COMPLETE ==========");
}
function renderTechniqueItem(techniqueList, technique, ctx, searchState) {
  const techItem = techniqueList.createDiv("mitre-technique-item");
  const subtechniques = ctx.subtechniquesMap.get(technique.id) || [];
  const hasSubtechniques = subtechniques.length > 0;
  const cleanedDesc = cleanDescription(technique.description || "");
  const isLongDescription = cleanedDesc.length > ctx.TECHNIQUE_TRUNCATE_LIMIT;
  const isExpandable = isLongDescription || hasSubtechniques;
  techItem.setAttribute("data-technique-id", technique.id);
  techItem.setAttribute("data-subtechnique-count", subtechniques.length.toString());
  techItem.setAttribute("data-is-expandable", isExpandable.toString());
  techItem.setAttribute("data-full-description", cleanedDesc);
  if (isLongDescription) {
    const truncated = truncateDescription(cleanedDesc);
    techItem.setAttribute("data-truncated-description", truncated);
  }
  const isActive = isActiveTechnique(technique.id, ctx.activeTechniqueId);
  if (isActive) {
    techItem.addClass("mitre-technique-active");
  }
  if (!technique.isFound) {
    techItem.addClass("mitre-technique-unfound");
  } else {
    applySeverityClass(techItem, technique.severity);
  }
  const techInfo = techItem.createDiv("mitre-technique-info");
  if (isExpandable) {
    techInfo.createEl("span", {
      cls: "mitre-expand-icon",
      text: "\u25B6"
    });
    techItem.addClass("has-expandable");
    techItem.addClass("collapsed");
    techItem.addEventListener("click", (e) => {
      e.stopPropagation();
      toggleExpansion(techItem, ctx, subtechniques);
    });
  }
  techInfo.createEl("span", {
    text: technique.id,
    cls: "mitre-technique-id"
  });
  const nameText = hasSubtechniques ? `${technique.name} (${subtechniques.length})` : technique.name;
  const nameEl = techInfo.createEl("span", {
    text: nameText,
    cls: "mitre-technique-name"
  });
  if (searchState == null ? void 0 : searchState.isActive) {
    highlightMatches(nameEl, technique.name, searchState);
  }
  if (technique.description) {
    const descEl = techItem.createDiv("mitre-technique-description");
    const isExpanded = techItem.hasClass("expanded");
    let displayText;
    if (isExpanded || !isExpandable) {
      displayText = cleanedDesc;
    } else {
      displayText = truncateDescription(cleanedDesc);
    }
    descEl.textContent = displayText;
    if (searchState == null ? void 0 : searchState.isActive) {
      highlightMatches(descEl, displayText, searchState);
    }
  }
  if (technique.isFound) {
    const subtechCards = [];
    subtechniques.forEach((sub) => {
      if (sub.isFound && sub.iocCards.length > 0) {
        subtechCards.push(...sub.iocCards);
      }
    });
    createCountBadgeWithTooltip(techItem, technique, ctx, subtechCards);
  }
}

// src/mitre/MitreSubtechniqueRenderer.ts
function renderSubtechniques(parentEl, subtechniques, ctx, searchState) {
  const container = parentEl.createDiv({ cls: "mitre-subtechniques-container" });
  subtechniques.forEach((subtech) => {
    const subItem = container.createDiv("mitre-technique-item mitre-subtechnique");
    const cleanedDesc = cleanDescription(subtech.description || "");
    const isLongDescription = cleanedDesc.length > ctx.SUBTECHNIQUE_TRUNCATE_LIMIT;
    subItem.setAttribute("data-technique-id", subtech.id);
    subItem.setAttribute("data-full-description", cleanedDesc);
    if (isLongDescription) {
      const truncated = truncateDescription(cleanedDesc, ctx.SUBTECHNIQUE_TRUNCATE_LIMIT);
      subItem.setAttribute("data-truncated-description", truncated);
    }
    const isActive = isActiveTechnique(subtech.id, ctx.activeTechniqueId);
    if (isActive) {
      subItem.addClass("mitre-technique-active");
    }
    if (!subtech.isFound) {
      subItem.addClass("mitre-technique-unfound");
    } else {
      applySeverityClass(subItem, subtech.severity);
    }
    const subInfo = subItem.createDiv("mitre-technique-info");
    if (isLongDescription) {
      subInfo.createEl("span", {
        cls: "mitre-expand-icon",
        text: "\u25B6"
      });
      subItem.addClass("has-expandable");
      subItem.addClass("collapsed");
      subItem.addEventListener("click", (e) => {
        e.stopPropagation();
        toggleExpansion(subItem, ctx);
      });
    }
    subInfo.createEl("span", {
      text: subtech.id,
      cls: "mitre-technique-id"
    });
    const nameEl = subInfo.createEl("span", {
      text: subtech.name,
      cls: "mitre-technique-name"
    });
    if (searchState == null ? void 0 : searchState.isActive) {
      highlightMatches(nameEl, subtech.name, searchState);
    }
    if (subtech.description) {
      const descEl = subItem.createDiv("mitre-technique-description");
      let displayText;
      if (isLongDescription) {
        displayText = truncateDescription(cleanedDesc, ctx.SUBTECHNIQUE_TRUNCATE_LIMIT);
      } else {
        displayText = cleanedDesc;
      }
      descEl.textContent = displayText;
      if (searchState == null ? void 0 : searchState.isActive) {
        highlightMatches(descEl, displayText, searchState);
      }
    }
    if (subtech.isFound) {
      createCountBadgeWithTooltip(subItem, subtech, ctx);
    }
  });
}

// src/mitre/MitreModalValidation.ts
function renderValidationErrors(container, validationErrors) {
  if (validationErrors.length === 0)
    return;
  if (DEBUG)
    console.debug("[MitreModalValidation] Rendering", validationErrors.length, "validation errors");
  const tacticErrors = validationErrors.filter((e) => e.severity === "unknown_tactic");
  const techniqueErrors = validationErrors.filter((e) => e.severity === "unknown_technique");
  const mismatchErrors = validationErrors.filter((e) => e.severity === "mismatch");
  const errorSection = container.createDiv("mitre-validation-errors");
  const header = errorSection.createDiv("mitre-errors-header");
  header.createEl("h3", {
    text: `\u26A0\uFE0F Validation Issues (${validationErrors.length})`
  });
  const toggleBtn = header.createEl("button", {
    text: "Hide",
    cls: "mitre-errors-toggle"
  });
  const errorsList = errorSection.createDiv("mitre-errors-list");
  errorSection.addClass("expanded");
  toggleBtn.addEventListener("click", () => {
    if (errorSection.hasClass("expanded")) {
      errorSection.removeClass("expanded");
      errorSection.addClass("collapsed");
      toggleBtn.setText("Show");
      errorsList.style.display = "none";
    } else {
      errorSection.removeClass("collapsed");
      errorSection.addClass("expanded");
      toggleBtn.setText("Hide");
      errorsList.style.display = "block";
    }
  });
  if (tacticErrors.length > 0) {
    renderErrorCategory(errorsList, "Unknown Tactic", tacticErrors, "\u{1F534}");
  }
  if (techniqueErrors.length > 0) {
    renderErrorCategory(errorsList, "Technique Errors", techniqueErrors, "\u{1F534}");
  }
  if (mismatchErrors.length > 0) {
    renderErrorCategory(errorsList, "Validation Mismatches", mismatchErrors, "\u26A0\uFE0F");
  }
}
function renderErrorCategory(container, categoryTitle, errors, icon) {
  const categorySection = container.createDiv("mitre-error-category");
  const categoryHeader = categorySection.createDiv("mitre-error-category-header");
  categoryHeader.createEl("h4", {
    text: `${icon} ${categoryTitle} (${errors.length})`
  });
  errors.forEach((error) => {
    const errorItem = categorySection.createDiv("mitre-error-item");
    if (isCriticalSeverity(error.severity)) {
      errorItem.addClass("mitre-error-critical");
    } else if (error.severity === "mismatch") {
      errorItem.addClass("mitre-error-warning");
    }
    const errorHeader = errorItem.createDiv("mitre-error-header");
    errorHeader.createEl("span", {
      text: error.techniqueId,
      cls: "mitre-error-technique-id"
    });
    errorHeader.createEl("span", {
      text: error.techniqueName,
      cls: "mitre-error-technique-name"
    });
    errorItem.createDiv({
      text: error.message,
      cls: "mitre-error-message"
    });
    const cardsSection = errorItem.createDiv("mitre-error-cards");
    cardsSection.createEl("span", {
      text: "Affected cards: ",
      cls: "mitre-error-cards-label"
    });
    error.iocCards.forEach((card, index) => {
      const cardBadge = cardsSection.createEl("span", {
        cls: "mitre-error-card-badge",
        attr: { "title": `Node ID: ${card.nodeId}` }
      });
      cardBadge.createEl("span", {
        text: card.iocType,
        cls: "mitre-error-card-type"
      });
      cardBadge.createEl("span", {
        text: ` ${card.cardId}`,
        cls: "mitre-error-card-id"
      });
      if (index < error.iocCards.length - 1) {
        cardsSection.createEl("span", { text: ", " });
      }
    });
  });
}

// src/mitre/MitreModalSearch.ts
function renderSearchBar(headerContainer, onSearchChange) {
  const searchContainer = headerContainer.createDiv("mitre-search-container");
  const searchInput = searchContainer.createEl("input", {
    type: "text",
    placeholder: 'Search techniques (use "quotes" for exact phrases)...',
    cls: "mitre-search-input"
  });
  const clearButton = searchContainer.createEl("button", {
    text: "\u2715",
    cls: "mitre-search-clear",
    attr: { "aria-label": "Clear search" }
  });
  clearButton.style.display = "none";
  const matchCount = searchContainer.createDiv("mitre-search-match-count");
  matchCount.style.display = "none";
  let debounceTimer = null;
  searchInput.addEventListener("input", () => {
    if (debounceTimer !== null) {
      clearTimeout(debounceTimer);
    }
    debounceTimer = window.setTimeout(() => {
      onSearchChange(searchInput.value);
    }, 300);
  });
  clearButton.addEventListener("click", () => {
    searchInput.value = "";
    onSearchChange("");
  });
  searchInput.addEventListener("keydown", (e) => {
    if (e.key === "Escape") {
      searchInput.value = "";
      onSearchChange("");
    }
  });
  return {
    searchBar: searchInput,
    searchClearButton: clearButton,
    searchMatchCount: matchCount
  };
}
function handleSearchInput(query, modalEl, currentTactics, ctx, searchUI) {
  const searchState = parseSearchQuery(query);
  if (DEBUG)
    console.debug("[MitreModalSearch] Search query:", query, "- Parsed:", searchState);
  if (searchUI.searchClearButton) {
    searchUI.searchClearButton.style.display = searchState.isActive ? "block" : "none";
  }
  const container = modalEl.querySelector(".mitre-content-area");
  if (container && currentTactics) {
    container.empty();
    const updatedCtx = { ...ctx, currentSearchState: searchState };
    let matchCount = 0;
    currentTactics.forEach((tactic) => {
      const matchingTechniques = tactic.techniques.filter((tech) => {
        if (!searchState.isActive)
          return true;
        const match = matchesSearch(tech, searchState, ctx.subtechniquesMap);
        if (match.matched)
          matchCount++;
        return match.matched;
      });
      if (matchingTechniques.length > 0) {
        const filteredTactic = { ...tactic, techniques: matchingTechniques };
        renderTacticSection(container, filteredTactic, updatedCtx, searchState);
      }
    });
    if (searchUI.searchMatchCount) {
      if (searchState.isActive) {
        searchUI.searchMatchCount.textContent = `${matchCount} technique${matchCount !== 1 ? "s" : ""} found`;
        searchUI.searchMatchCount.style.display = "block";
      } else {
        searchUI.searchMatchCount.style.display = "none";
      }
    }
    if (matchCount === 0 && searchState.isActive) {
      container.createDiv({
        cls: "mitre-no-results",
        text: "No techniques match your search"
      });
    }
  }
  return searchState;
}

// src/mitre/RenderMitreModal.ts
var RenderMitreModal = class extends import_obsidian5.Modal {
  constructor(app, plugin, activeTechniqueId) {
    super(app);
    this.mitreDataset = null;
    this.subtechniquesMap = /* @__PURE__ */ new Map();
    this.currentSearchState = null;
    this.currentTactics = null;
    this.validationErrors = [];
    this.activeTechniqueId = null;
    this.iocDataMap = /* @__PURE__ */ new Map();
    this.iocCount = 0;
    this.searchUI = { searchBar: null, searchClearButton: null, searchMatchCount: null };
    // Truncation limits
    this.TECHNIQUE_TRUNCATE_LIMIT = 180;
    this.SUBTECHNIQUE_TRUNCATE_LIMIT = 100;
    this.plugin = plugin;
    this.activeTechniqueId = activeTechniqueId || null;
    this.loadDataset();
  }
  // ---------------------------------------------------------------
  // Lifecycle
  // ---------------------------------------------------------------
  async loadDataset() {
    try {
      this.mitreDataset = await loadMitreDataset(this.app);
      if (DEBUG)
        console.debug("[MitreModal] Dataset loaded:", this.mitreDataset.version, "- Techniques:", Object.keys(this.mitreDataset.techniques).length);
    } catch (err) {
      console.error("[MitreModal] Failed to load dataset:", err);
      this.mitreDataset = null;
    }
  }
  onOpen() {
    if (DEBUG)
      console.debug("[MitreModal] ===== MODAL OPENED =====");
    const { contentEl } = this;
    this.modalEl.classList.add("mitre-modal-fullscreen");
    makeResizable(this.modalEl);
    const headerContainer = contentEl.createDiv("mitre-modal-header");
    const titleRow = headerContainer.createDiv("mitre-title-row");
    titleRow.createEl("h2", { text: "\u{1F3AF} MITRE ATT&CK Technique Mapper" });
    const exportBtn = titleRow.createEl("button", {
      text: "Export to Navigator",
      cls: "mitre-export-button"
    });
    exportBtn.addEventListener("click", () => {
      if (this.currentTactics && this.mitreDataset) {
        exportToNavigator(this.currentTactics, this.iocCount, this.mitreDataset);
      }
    });
    this.searchUI = renderSearchBar(headerContainer, (query) => {
      this.currentSearchState = handleSearchInput(
        query,
        this.modalEl,
        this.currentTactics,
        this.getContext(),
        this.searchUI
      );
    });
    const statsContainer = contentEl.createDiv("mitre-stats");
    const contentArea = contentEl.createDiv("mitre-content-area");
    this.renderMitreMapping(contentArea, statsContainer);
  }
  onClose() {
    if (DEBUG)
      console.debug("[MitreModal] ===== MODAL CLOSED =====");
    const { contentEl } = this;
    contentEl.empty();
  }
  // ---------------------------------------------------------------
  // Context builder
  // ---------------------------------------------------------------
  /**
   * Build a MitreModalContext from current class state.
   * Passed to extracted rendering functions instead of `this`.
   */
  getContext() {
    return {
      activeTechniqueId: this.activeTechniqueId,
      currentSearchState: this.currentSearchState,
      subtechniquesMap: this.subtechniquesMap,
      iocDataMap: this.iocDataMap,
      TECHNIQUE_TRUNCATE_LIMIT: this.TECHNIQUE_TRUNCATE_LIMIT,
      SUBTECHNIQUE_TRUNCATE_LIMIT: this.SUBTECHNIQUE_TRUNCATE_LIMIT,
      renderSubtechniques: (parentEl, subtechniques, searchState) => {
        renderSubtechniques(parentEl, subtechniques, this.getContext(), searchState);
      }
    };
  }
  // ---------------------------------------------------------------
  // Core rendering (stays as class method - mutates 5+ properties)
  // ---------------------------------------------------------------
  /**
   * Main rendering entry point. Extracts IOC data, runs aggregation,
   * and renders the full MITRE matrix.
   */
  async renderMitreMapping(container, statsContainer) {
    if (DEBUG)
      console.debug("[MitreModal] ===== STARTING DATA EXTRACTION =====");
    const iocData = extractFixedIOCData(this.app);
    if (DEBUG)
      console.debug("[MitreModal] Extracted IOC count:", iocData.length);
    this.iocCount = iocData.length;
    if (iocData.length === 0) {
      container.createEl("p", {
        text: "No IOC cards found in the current canvas.",
        cls: "mitre-empty-message"
      });
      return;
    }
    if (!this.mitreDataset) {
      await this.loadDataset();
    }
    if (!this.mitreDataset) {
      container.createEl("div", {
        cls: "mitre-error-message",
        text: "\u274C MITRE ATT&CK dataset could not be loaded."
      });
      container.createEl("p", {
        text: "Please ensure enterprise-attack.json exists in the MITRE folder."
      });
      container.createEl("a", {
        text: "Download dataset from MITRE",
        attr: { href: "https://github.com/mitre-attack/attack-stix-data", target: "_blank" }
      });
      return;
    }
    const result = aggregateTacticsTechniques(iocData, this.mitreDataset);
    const tactics = result.tactics;
    this.subtechniquesMap = result.subtechniquesMap;
    this.validationErrors = result.validationErrors;
    this.iocDataMap = result.iocDataMap;
    this.iocCount = result.iocCount;
    const missingFields = result.missingFields;
    if (DEBUG)
      console.debug("[MitreModal] ===== AGGREGATION COMPLETE =====");
    if (tactics.length === 0) {
      container.createEl("p", {
        text: 'No MITRE tactics or techniques found in IOC cards. Add "Mitre Tactic" and "Mitre Technique" fields to your cards.',
        cls: "mitre-empty-message"
      });
      return;
    }
    renderStatsBar(statsContainer, tactics, result.iocCount, missingFields);
    this.currentTactics = tactics;
    const ctx = this.getContext();
    renderValidationErrors(container, this.validationErrors);
    if (DEBUG)
      console.debug("[MitreModal] Rendering MITRE matrix -", tactics.length, "tactics");
    tactics.forEach((tactic) => {
      renderTacticSection(container, tactic, ctx, this.currentSearchState);
    });
    if (DEBUG)
      console.debug("[MitreModal] Matrix rendering complete:", {
        tactics: tactics.length,
        iocCards: result.iocCount
      });
  }
};

// src/settings/PluginSettings.ts
var import_obsidian6 = require("obsidian");
var DEFAULT_SETTINGS = {
  cardSize: "medium",
  showTimelineButton: true
};
var PluginSettings = class extends import_obsidian6.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "IOC Canvas Plugin Settings" });
    new import_obsidian6.Setting(containerEl).setName("Default card size").setDesc("Set the default size for IOC cards").addDropdown(
      (dropdown) => dropdown.addOption("small", "Small").addOption("medium", "Medium").addOption("large", "Large").setValue(this.plugin.settings.cardSize).onChange(async (value) => {
        this.plugin.settings.cardSize = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian6.Setting(containerEl).setName("Show timeline button").setDesc("Display timeline button in canvas toolbar").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.showTimelineButton).onChange(async (value) => {
        this.plugin.settings.showTimelineButton = value;
        await this.plugin.saveSettings();
      })
    );
  }
};

// src/canvas/CanvasToolbar.ts
var import_obsidian7 = require("obsidian");
var TIMELINE_SVG = '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>';
var CARDS_SVG = '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>';
var REDUCE_SVG = '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="4 14 10 14 10 20"/><polyline points="20 10 14 10 14 4"/><line x1="14" y1="10" x2="21" y2="3"/><line x1="3" y1="21" x2="10" y2="14"/></svg>';
var CHILD_CARD_SVG = '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="5" y="6" width="16" height="12" rx="2" ry="2"/><line x1="9" y1="22" x2="15" y2="22"/><line x1="12" y1="18" x2="12" y2="22"/><polyline points="1 12 4 9 7 12"/></svg>';
var MITRE_SVG = '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>';
function createToolbarButton(label, svgIcon, onClick) {
  const item = document.createElement("div");
  item.className = "canvas-control-item";
  item.setAttribute("aria-label", label);
  item.setAttribute("title", label);
  item.addEventListener("click", onClick);
  const icon = document.createElement("div");
  icon.className = "clickable-icon";
  icon.innerHTML = svgIcon;
  item.appendChild(icon);
  return item;
}
function addCanvasButtons(ctx) {
  try {
    const activeView = ctx.app.workspace.getActiveViewOfType(import_obsidian7.ItemView);
    if (!activeView || activeView.getViewType() !== "canvas") {
      return;
    }
    const canvasView = activeView.containerEl;
    if (!canvasView) {
      return;
    }
    const canvasControls = canvasView.querySelector(".canvas-controls");
    if (!canvasControls) {
      return;
    }
    if (canvasControls.querySelector(".ioc-toolbar")) {
      return;
    }
    if (DEBUG)
      console.debug("[CanvasToolbar] Injecting toolbar buttons");
    const iocToolbar = document.createElement("div");
    iocToolbar.className = "ioc-toolbar";
    const timelineBtn = createToolbarButton("Show Attack Timelines", TIMELINE_SVG, ctx.onTimeline);
    const parentBtn = createToolbarButton("Parent Card", CARDS_SVG, ctx.onAddCard);
    const childBtn = createToolbarButton("Child Card", CHILD_CARD_SVG, ctx.onChildCard);
    const reduceBtn = createToolbarButton("Toggle Reduce View", REDUCE_SVG, () => {
      const newState = ctx.onReduce();
      const icon = reduceBtn.querySelector(".clickable-icon");
      if (icon)
        icon.classList.toggle("is-active", newState);
    });
    const mitreBtn = createToolbarButton("MITRE ATT&CK Mapper", MITRE_SVG, ctx.onMitre);
    iocToolbar.appendChild(timelineBtn);
    iocToolbar.appendChild(parentBtn);
    iocToolbar.appendChild(childBtn);
    iocToolbar.appendChild(reduceBtn);
    iocToolbar.appendChild(mitreBtn);
    canvasControls.appendChild(iocToolbar);
  } catch (err) {
    console.error("IOC Canvas: failed to inject canvas buttons", err);
  }
}

// src/canvas/CanvasSelection.ts
var import_obsidian8 = require("obsidian");
function getSelectedTechniqueId(app) {
  try {
    const activeView = app.workspace.getActiveViewOfType(import_obsidian8.ItemView);
    if (!activeView || activeView.getViewType() !== "canvas") {
      return null;
    }
    const canvas = activeView.canvas;
    if (!canvas) {
      return null;
    }
    let selectedNode = null;
    if (canvas.selection && canvas.selection.size > 0) {
      const firstSelectedId = Array.from(canvas.selection)[0];
      selectedNode = canvas.nodes.get(firstSelectedId);
    }
    if (!selectedNode && canvas.selectedNodes) {
      if (Array.isArray(canvas.selectedNodes) && canvas.selectedNodes.length > 0) {
        selectedNode = canvas.selectedNodes[0];
      } else if (canvas.selectedNodes.size > 0) {
        selectedNode = Array.from(canvas.selectedNodes)[0];
      }
    }
    if (!selectedNode && canvas.nodes) {
      canvas.nodes.forEach((node) => {
        if (node.selected || node.isSelected) {
          selectedNode = node;
          return;
        }
      });
    }
    if (!selectedNode || !selectedNode.text) {
      return null;
    }
    const parsedData = parseIOCNode(selectedNode);
    if (!parsedData || !parsedData.technique || !parsedData.technique.trim()) {
      return null;
    }
    const technique = parsedData.technique.toUpperCase();
    const idMatch = technique.match(/T\d{4}(?:\.\d{3})?/i);
    if (idMatch) {
      if (DEBUG)
        console.debug("[CanvasSelection] Selected technique:", idMatch[0].toUpperCase());
      return idMatch[0].toUpperCase();
    }
    return null;
  } catch (err) {
    console.error("[CanvasSelection] Error getting selected technique:", err);
    return null;
  }
}

// src/canvas/ReduceView.ts
var import_obsidian9 = require("obsidian");
function toggleReduceView(app, isReducedView) {
  const activeView = app.workspace.getActiveViewOfType(import_obsidian9.ItemView);
  if (!activeView || activeView.getViewType() !== "canvas")
    return isReducedView;
  const canvas = activeView.canvas;
  if (!canvas)
    return isReducedView;
  const newState = !isReducedView;
  if (DEBUG)
    console.debug("[ReduceView] Toggling reduce view:", isReducedView, "->", newState);
  const wrapperEl = canvas.wrapperEl;
  if (wrapperEl) {
    if (newState) {
      wrapperEl.classList.add("ioc-reduced");
    } else {
      wrapperEl.classList.remove("ioc-reduced");
    }
  }
  if (canvas.nodes) {
    canvas.nodes.forEach((node) => {
      if (!node.text)
        return;
      if (newState) {
        if (!node._iocOriginalHeight) {
          node._iocOriginalHeight = node.height;
        }
        if (node.resize) {
          node.resize({ width: node.width, height: 60 });
        } else {
          node.height = 60;
        }
      } else {
        const originalH = node._iocOriginalHeight || 400;
        if (node.resize) {
          node.resize({ width: node.width, height: originalH });
        } else {
          node.height = originalH;
        }
      }
    });
  }
  canvas.requestFrame();
  canvas.requestSave();
  return newState;
}

// src/canvas/IOCCardCreation.ts
var import_obsidian11 = require("obsidian");

// src/canvas/RenderIOCCardsModal.ts
var import_obsidian10 = require("obsidian");
var RenderIOCCardsModal = class extends import_obsidian10.Modal {
  constructor(app, iocTypes, onSelect, title) {
    super(app);
    this.iocTypes = iocTypes;
    this.onSelect = onSelect;
    this.title = title || "Select IOC Type";
  }
  /** Builds the primary IOC type grid view. */
  onOpen() {
    const { contentEl } = this;
    this.modalEl.classList.add("ioc-type-selector-modal");
    this.modalEl.style.maxWidth = "900px";
    this.modalEl.style.width = "90vw";
    contentEl.createEl("h2", { text: this.title });
    const container = contentEl.createDiv("ioc-type-container");
    const typeCount = Object.keys(this.iocTypes).length;
    const cols = Math.min(Math.ceil(Math.sqrt(typeCount)), 5);
    container.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
    Object.keys(this.iocTypes).forEach((iocTypeId) => {
      const iocType = this.iocTypes[iocTypeId];
      const button = container.createEl("button", { cls: "ioc-type-button" });
      button.setAttribute("data-ioc-type", iocTypeId);
      button.style.borderLeft = `4px solid ${iocType.color}`;
      const iconContainer = button.createDiv("ioc-button-icon");
      iconContainer.innerHTML = iocType.svg;
      const textContainer = button.createDiv("ioc-button-text");
      textContainer.textContent = iocType.name;
      button.addEventListener("click", () => {
        if (iocTypeId === "hostname") {
          this.showOSSelector(iocTypeId);
        } else {
          this.onSelect(iocTypeId);
          this.close();
        }
      });
    });
  }
  /**
   * Replaces the type grid with an OS selector sub-view.
   * Only reachable when iocTypeId === 'hostname' and the type has os_icons.
   */
  showOSSelector(iocTypeId) {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h2", { text: "Select Operating System" });
    contentEl.createEl("p", { text: "Choose the operating system for this hostname:" });
    const container = contentEl.createDiv("os-selector-container");
    const iocType = this.iocTypes[iocTypeId];
    if (iocType.os_icons) {
      Object.keys(iocType.os_icons).forEach((osType) => {
        const osButton = container.createEl("button", { cls: "os-type-button" });
        osButton.setAttribute("data-os-type", osType);
        const iconContainer = osButton.createDiv("os-button-icon");
        iconContainer.innerHTML = iocType.os_icons[osType];
        const textContainer = osButton.createDiv("os-button-text");
        textContainer.textContent = osType.charAt(0).toUpperCase() + osType.slice(1);
        osButton.addEventListener("click", () => {
          this.onSelect(iocTypeId, osType);
          this.close();
        });
      });
    }
    const backButton = contentEl.createEl("button", {
      text: "\u2190 Back to IOC Types",
      cls: "back-button"
    });
    backButton.addEventListener("click", () => {
      contentEl.empty();
      this.onOpen();
    });
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/canvas/RenderIOCCards.ts
function createCardContent(iocType, iocTypeId, osType = null, cardId = "", isChild = false) {
  const now = new Date();
  const timestamp = now.toISOString().replace("T", " ").substring(0, 19);
  let iconSvg = iocType.svg;
  if (iocTypeId === "hostname" && osType && iocType.os_icons) {
    iconSvg = iocType.os_icons[osType] || iocType.svg;
  }
  const roleLabel = isChild ? "[C]" : "[P]";
  const roleClass = isChild ? "ioc-role-child" : "ioc-role-parent";
  const roleBadge = `<span class="ioc-card-role ${roleClass}" style="font-size: 12px; font-weight: 700; padding: 2px 6px; border-radius: 4px; margin-right: 4px;">${roleLabel}</span>`;
  let content = `<div class="ioc-card-container"><div class="ioc-card-header"
        style="display: flex; align-items: center; gap: 16px; margin-bottom: 30px; padding: 20px;
        background: linear-gradient(135deg, ${iocType.color}22, transparent);
        border-radius: 8px; border-bottom: 3px solid ${iocType.color};">
        <div class="ioc-header-content" style="display: flex; align-items: center; gap: 16px; width: 100%;">
        <div class="ioc-icon" style="flex-shrink: 0;">${iconSvg}</div><h2 style="margin: 0;
        color: ${iocType.color}; font-size: 24px; font-weight: 700;">${roleBadge}${iocType.name}</h2>
        <span class="ioc-card-id" style="margin-left: auto; padding: 2px 8px; font-size: 11px; font-weight: 600; background: var(--background-modifier-border); color: var(--text-muted); border-radius: 4px; font-family: var(--font-monospace);">${cardId}</span>
        </div><!-- IOC_CARD_ID:${cardId} --></div></div>
`;
  iocType.fields.forEach((field) => {
    content += `${field}: 


------------
`;
  });
  content += `Time of Event: ${timestamp}


------------
`;
  content += `Splunk Query: 


------------
`;
  content += `Mitre Tactic: 


------------
`;
  content += `Mitre Technique: 


------------
`;
  return content;
}

// src/canvas/IOCCardCreation.ts
function openIOCCardSelector(app, createCard, title) {
  new RenderIOCCardsModal(
    app,
    IOC_TYPES,
    (iocTypeId, osType) => {
      createCard(iocTypeId, osType);
    },
    title
  ).open();
}
function createIOCCard(app, iocTypeId, osType, isChild = false) {
  const activeView = app.workspace.getActiveViewOfType(import_obsidian11.ItemView);
  if (!activeView || activeView.getViewType() !== "canvas") {
    new import_obsidian11.Notice("Please open a canvas first");
    return;
  }
  const canvas = activeView.canvas;
  if (!canvas) {
    new import_obsidian11.Notice("Please open a canvas first");
    return;
  }
  const iocType = IOC_TYPES[iocTypeId];
  if (!iocType) {
    new import_obsidian11.Notice("Unknown IOC type: " + iocTypeId);
    return;
  }
  const now = new Date();
  const year = now.getFullYear();
  const month = String(now.getMonth() + 1).padStart(2, "0");
  const day = String(now.getDate()).padStart(2, "0");
  const hours = String(now.getHours()).padStart(2, "0");
  const minutes = String(now.getMinutes()).padStart(2, "0");
  const cardId = `#${year}${month}${day}-${hours}${minutes}`;
  if (DEBUG)
    console.debug("[CardCreation] Creating card:", iocTypeId, cardId);
  const content = createCardContent(iocType, iocTypeId, osType || null, cardId, isChild);
  canvas.createTextNode({
    pos: { x: Math.random() * 400, y: Math.random() * 400 },
    // Random placement
    size: { width: 400, height: 400 },
    // Standard card size
    text: content
    // Markdown with HTML header
  });
  canvas.requestSave();
  new import_obsidian11.Notice(`Created ${iocType.name} card`);
}

// src/canvas/CanvasContextMenu.ts
var import_obsidian12 = require("obsidian");
var listenerMap = /* @__PURE__ */ new WeakMap();
function convertCardRole(node, targetRole) {
  var _a;
  const text = node.text || ((_a = node.getText) == null ? void 0 : _a.call(node)) || "";
  if (!text)
    return;
  let newText;
  if (targetRole === "child") {
    newText = text.replace("ioc-role-parent", "ioc-role-child").replace(">[P]<", ">[C]<");
  } else {
    newText = text.replace("ioc-role-child", "ioc-role-parent").replace(">[C]<", ">[P]<");
  }
  if (node.setText) {
    node.setText(newText);
  } else {
    node.text = newText;
  }
  if (DEBUG)
    console.debug(`[CanvasContextMenu] Converted node to ${targetRole}`);
}
function getNodeRole(node) {
  var _a;
  const text = node.text || ((_a = node.getText) == null ? void 0 : _a.call(node)) || "";
  if (/>\[P\]</.test(text))
    return "parent";
  if (/>\[C\]</.test(text))
    return "child";
  return null;
}
function setupCanvasContextMenu(app, canvas) {
  const wrapperEl = canvas.wrapperEl;
  if (!wrapperEl)
    return;
  if (listenerMap.has(wrapperEl))
    return;
  const handler = (e) => {
    const nodeEl = e.target.closest(".canvas-node");
    if (!nodeEl)
      return;
    let targetNode = null;
    canvas.nodes.forEach((node) => {
      if (node.nodeEl === nodeEl || node.contentEl === nodeEl) {
        targetNode = node;
      }
    });
    if (!targetNode)
      return;
    const clickedRole = getNodeRole(targetNode);
    if (!clickedRole)
      return;
    e.preventDefault();
    e.stopImmediatePropagation();
    const selectedNodes = [];
    const selection = canvas.selection;
    if (selection && selection.size > 1 && selection.has(targetNode)) {
      selection.forEach((node) => {
        if (getNodeRole(node)) {
          selectedNodes.push(node);
        }
      });
    } else {
      selectedNodes.push(targetNode);
    }
    const menu = new import_obsidian12.Menu();
    const isMulti = selectedNodes.length > 1;
    if (isMulti) {
      menu.addItem((item) => {
        item.setTitle("Convert to Parent [P]").setIcon("arrow-up-circle").onClick(() => {
          selectedNodes.forEach((n) => convertCardRole(n, "parent"));
          canvas.requestSave();
        });
      });
      menu.addItem((item) => {
        item.setTitle("Convert to Child [C]").setIcon("arrow-down-circle").onClick(() => {
          selectedNodes.forEach((n) => convertCardRole(n, "child"));
          canvas.requestSave();
        });
      });
    } else {
      const oppositeRole = clickedRole === "parent" ? "child" : "parent";
      const label = oppositeRole === "parent" ? "Convert to Parent [P]" : "Convert to Child [C]";
      const icon = oppositeRole === "parent" ? "arrow-up-circle" : "arrow-down-circle";
      menu.addItem((item) => {
        item.setTitle(label).setIcon(icon).onClick(() => {
          convertCardRole(targetNode, oppositeRole);
          canvas.requestSave();
        });
      });
    }
    menu.addSeparator();
    menu.addItem((item) => {
      item.setTitle("Delete").setIcon("trash").onClick(() => {
        selectedNodes.forEach((n) => canvas.removeNode(n));
        canvas.requestSave();
      });
    });
    menu.showAtMouseEvent(e);
  };
  wrapperEl.addEventListener("contextmenu", handler, true);
  listenerMap.set(wrapperEl, handler);
  if (DEBUG)
    console.debug("[CanvasContextMenu] Context menu handler attached");
}
function removeCanvasContextMenu(wrapperEl) {
  const handler = listenerMap.get(wrapperEl);
  if (handler) {
    wrapperEl.removeEventListener("contextmenu", handler, true);
    listenerMap.delete(wrapperEl);
    if (DEBUG)
      console.debug("[CanvasContextMenu] Context menu handler removed");
  }
}

// src/main.ts
var IOCCanvasPlugin = class extends import_obsidian13.Plugin {
  constructor() {
    super(...arguments);
    /** Typed settings object persisted to data.json. */
    this.settings = DEFAULT_SETTINGS;
    /** Whether the canvas IOC cards are currently in compact/reduced view. */
    this.isReducedView = false;
    /** Tracked canvas wrapper element for context menu cleanup on unload. */
    this.canvasWrapperEl = null;
  }
  // ---------------------------------------------------------------
  // Plugin lifecycle
  // ---------------------------------------------------------------
  async onload() {
    console.log("Loading IOC Canvas Plugin");
    await this.loadSettings();
    this.addRibbonIcon("clock", "Show Attack Timelines", () => {
      new RenderTimelinesModal(this.app, this).open();
    });
    this.addCommand({
      id: "show-timelines",
      name: "Show Attack Timelines",
      callback: () => {
        new RenderTimelinesModal(this.app, this).open();
      }
    });
    this.addCommand({
      id: "show-ioc-cards",
      name: "Add Parent IOC Card",
      callback: () => {
        openIOCCardSelector(this.app, (id, os) => createIOCCard(this.app, id, os, false), "Select Parent IOC Type");
      }
    });
    this.addCommand({
      id: "add-child-card",
      name: "Add Child IOC Card",
      callback: () => {
        openIOCCardSelector(this.app, (id, os) => createIOCCard(this.app, id, os, true), "Select Child IOC Type");
      }
    });
    this.addSettingTab(new PluginSettings(this.app, this));
    this.registerEvent(
      this.app.workspace.on("file-menu", (menu, file) => {
        if (file instanceof import_obsidian13.TFile && file.extension === "canvas") {
          menu.addItem((item) => {
            item.setTitle("Show Attack Timelines").setIcon("clock").onClick(() => {
              new RenderTimelinesModal(this.app, this).open();
            });
          });
        }
      })
    );
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", () => {
        this.injectCanvasButtons();
      })
    );
    this.injectCanvasButtons();
  }
  onunload() {
    console.log("Unloading IOC Canvas Plugin");
    document.querySelectorAll(".ioc-toolbar").forEach((el) => el.remove());
    document.querySelectorAll(".ioc-reduced").forEach((el) => el.classList.remove("ioc-reduced"));
    if (this.canvasWrapperEl) {
      removeCanvasContextMenu(this.canvasWrapperEl);
      this.canvasWrapperEl = null;
    }
  }
  // ---------------------------------------------------------------
  // Settings persistence
  // ---------------------------------------------------------------
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  // ---------------------------------------------------------------
  // Thin delegation to canvas modules
  // ---------------------------------------------------------------
  /** Inject toolbar buttons and context menu into the active canvas view. */
  injectCanvasButtons() {
    addCanvasButtons({
      app: this.app,
      isReducedView: this.isReducedView,
      onTimeline: () => new RenderTimelinesModal(this.app, this).open(),
      onAddCard: () => openIOCCardSelector(this.app, (id, os) => createIOCCard(this.app, id, os, false), "Select Parent IOC Type"),
      onChildCard: () => openIOCCardSelector(this.app, (id, os) => createIOCCard(this.app, id, os, true), "Select Child IOC Type"),
      onReduce: () => {
        this.isReducedView = toggleReduceView(this.app, this.isReducedView);
        return this.isReducedView;
      },
      onMitre: () => {
        const activeTechniqueId = getSelectedTechniqueId(this.app);
        new RenderMitreModal(this.app, this, activeTechniqueId).open();
      }
    });
    try {
      const activeView = this.app.workspace.getActiveViewOfType(import_obsidian13.ItemView);
      if (activeView && activeView.getViewType() === "canvas") {
        const canvas = activeView.canvas;
        if (canvas == null ? void 0 : canvas.wrapperEl) {
          this.canvasWrapperEl = canvas.wrapperEl;
          setupCanvasContextMenu(this.app, canvas);
        }
      }
    } catch (err) {
      console.error("IOC Canvas: failed to set up context menu", err);
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3RpbWVsaW5lL1JlbmRlclRpbWVsaW5lc01vZGFsLnRzIiwgInNyYy9kZWJ1Zy50cyIsICJzcmMvcGFyc2luZy9JT0NUeXBlRGV0ZWN0aW9uLnRzIiwgInNyYy9wYXJzaW5nL0lPQ0ZpZWxkRXh0cmFjdG9ycy50cyIsICJzcmMvdHlwZXMvSU9DQ2FyZHNUeXBlcy50cyIsICJzcmMvcGFyc2luZy9JT0NWaXN1YWxMb29rdXAudHMiLCAic3JjL3BhcnNpbmcvSU9DUGFyc2VyLnRzIiwgInNyYy90aW1lbGluZS9UaW1lVGltZWxpbmVQcm9jZXNzaW5nLnRzIiwgInNyYy90aW1lbGluZS9UaW1lVGltZWxpbmVUYWIudHMiLCAic3JjL3RpbWVsaW5lL1RpbWVsaW5lQ29weUV4cG9ydC50cyIsICJzcmMvdGltZWxpbmUvR3JhcGhUaW1lbGluZVRhYi50cyIsICJzcmMvdGltZWxpbmUvR3JhcGhUaW1lbGluZUhlbHBlcnMudHMiLCAic3JjL3RpbWVsaW5lL0dyYXBoVGltZWxpbmVSZW5kZXJpbmcudHMiLCAic3JjL2NhbnZhcy9DYW52YXNFZGdlcy50cyIsICJzcmMvdGltZWxpbmUvTGlua1RpbWVsaW5lUHJvY2Vzc2luZy50cyIsICJzcmMvdGltZWxpbmUvTGlua1RpbWVsaW5lQ2FyZFJvdy50cyIsICJzcmMvdGltZWxpbmUvTGlua1RpbWVsaW5lVGFiLnRzIiwgInNyYy9taXRyZS9SZW5kZXJNaXRyZU1vZGFsLnRzIiwgInNyYy9taXRyZS9NaXRyZVN0aXhQYXJzZXIudHMiLCAic3JjL21pdHJlL01pdHJlVmFsaWRhdGlvbi50cyIsICJzcmMvbWl0cmUvTWl0cmVMb2FkZXIudHMiLCAic3JjL21pdHJlL01pdHJlQWdncmVnYXRvclR5cGVzLnRzIiwgInNyYy9taXRyZS9NaXRyZVNldmVyaXR5LnRzIiwgInNyYy9taXRyZS9NaXRyZUFnZ3JlZ2F0b3JDYXJkUHJvY2Vzc2luZy50cyIsICJzcmMvbWl0cmUvTWl0cmVBZ2dyZWdhdG9yLnRzIiwgInNyYy9taXRyZS9NaXRyZUV4cG9ydC50cyIsICJzcmMvbWl0cmUvTWl0cmVSZXNpemFibGUudHMiLCAic3JjL21pdHJlL01pdHJlU3RhdHNCYXIudHMiLCAic3JjL21pdHJlL01pdHJlVGV4dFV0aWxzLnRzIiwgInNyYy9taXRyZS9NaXRyZVNlYXJjaC50cyIsICJzcmMvbWl0cmUvTWl0cmVNb2RhbEhlbHBlcnMudHMiLCAic3JjL21pdHJlL01pdHJlQ291bnRCYWRnZS50cyIsICJzcmMvbWl0cmUvTWl0cmVNb2RhbFRhY3RpY1JlbmRlcmVyLnRzIiwgInNyYy9taXRyZS9NaXRyZVN1YnRlY2huaXF1ZVJlbmRlcmVyLnRzIiwgInNyYy9taXRyZS9NaXRyZU1vZGFsVmFsaWRhdGlvbi50cyIsICJzcmMvbWl0cmUvTWl0cmVNb2RhbFNlYXJjaC50cyIsICJzcmMvc2V0dGluZ3MvUGx1Z2luU2V0dGluZ3MudHMiLCAic3JjL2NhbnZhcy9DYW52YXNUb29sYmFyLnRzIiwgInNyYy9jYW52YXMvQ2FudmFzU2VsZWN0aW9uLnRzIiwgInNyYy9jYW52YXMvUmVkdWNlVmlldy50cyIsICJzcmMvY2FudmFzL0lPQ0NhcmRDcmVhdGlvbi50cyIsICJzcmMvY2FudmFzL1JlbmRlcklPQ0NhcmRzTW9kYWwudHMiLCAic3JjL2NhbnZhcy9SZW5kZXJJT0NDYXJkcy50cyIsICJzcmMvY2FudmFzL0NhbnZhc0NvbnRleHRNZW51LnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyIvKipcbiAqIElPQyBDYW52YXMgUGx1Z2luIC0gTWFpbiBlbnRyeSBwb2ludFxuICpcbiAqIFRoaW4gcGx1Z2luIHNoZWxsIHRoYXQgT2JzaWRpYW4gaW5zdGFudGlhdGVzIHdoZW4gdGhlIHBsdWdpbiBpcyBlbmFibGVkLlxuICogRGVsZWdhdGVzIGFsbCBjYW52YXMgb3BlcmF0aW9ucyB0byBleHRyYWN0ZWQgbW9kdWxlcyBpbiBjYW52YXMvOlxuICogICAtIENhbnZhc1Rvb2xiYXI6IGJ1dHRvbiBpbmplY3Rpb24gaW50byBjYW52YXMgY29udHJvbHNcbiAqICAgLSBDYW52YXNTZWxlY3Rpb246IHRlY2huaXF1ZSBleHRyYWN0aW9uIGZyb20gc2VsZWN0ZWQgbm9kZVxuICogICAtIFJlZHVjZVZpZXc6IGNvbXBhY3QgdmlldyB0b2dnbGVcbiAqICAgLSBJT0NDYXJkQ3JlYXRpb246IGNhcmQgc2VsZWN0b3IgbW9kYWwgYW5kIGNhcmQgY3JlYXRpb25cbiAqXG4gKiBLZWVwcyBvbmx5IGxpZmVjeWNsZSBtZXRob2RzIChvbmxvYWQvb251bmxvYWQpLCBzZXR0aW5ncyBwZXJzaXN0ZW5jZSxcbiAqIGFuZCB0aGluIGRlbGVnYXRpb24gd3JhcHBlcnMgdGhhdCBwYXNzIGB0aGlzLmFwcGAgYW5kIGB0aGlzLmlzUmVkdWNlZFZpZXdgXG4gKiB0byB0aGUgc3RhbmRhbG9uZSBmdW5jdGlvbnMuXG4gKi9cblxuaW1wb3J0IHsgUGx1Z2luLCBURmlsZSwgSXRlbVZpZXcgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBSZW5kZXJUaW1lbGluZXNNb2RhbCB9IGZyb20gJy4vdGltZWxpbmUvUmVuZGVyVGltZWxpbmVzTW9kYWwnO1xuaW1wb3J0IHsgUmVuZGVyTWl0cmVNb2RhbCB9IGZyb20gJy4vbWl0cmUvUmVuZGVyTWl0cmVNb2RhbCc7XG5pbXBvcnQgeyBQbHVnaW5TZXR0aW5ncywgSU9DQ2FudmFzUGx1Z2luU2V0dGluZ3MsIERFRkFVTFRfU0VUVElOR1MgfSBmcm9tICcuL3NldHRpbmdzL1BsdWdpblNldHRpbmdzJztcblxuLy8gQ2FudmFzIG1vZHVsZXNcbmltcG9ydCB7IGFkZENhbnZhc0J1dHRvbnMgfSBmcm9tICcuL2NhbnZhcy9DYW52YXNUb29sYmFyJztcbmltcG9ydCB7IGdldFNlbGVjdGVkVGVjaG5pcXVlSWQgfSBmcm9tICcuL2NhbnZhcy9DYW52YXNTZWxlY3Rpb24nO1xuaW1wb3J0IHsgdG9nZ2xlUmVkdWNlVmlldyB9IGZyb20gJy4vY2FudmFzL1JlZHVjZVZpZXcnO1xuaW1wb3J0IHsgb3BlbklPQ0NhcmRTZWxlY3RvciwgY3JlYXRlSU9DQ2FyZCB9IGZyb20gJy4vY2FudmFzL0lPQ0NhcmRDcmVhdGlvbic7XG5pbXBvcnQgeyBzZXR1cENhbnZhc0NvbnRleHRNZW51LCByZW1vdmVDYW52YXNDb250ZXh0TWVudSB9IGZyb20gJy4vY2FudmFzL0NhbnZhc0NvbnRleHRNZW51JztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSU9DQ2FudmFzUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcbiAgICAvKiogVHlwZWQgc2V0dGluZ3Mgb2JqZWN0IHBlcnNpc3RlZCB0byBkYXRhLmpzb24uICovXG4gICAgc2V0dGluZ3M6IElPQ0NhbnZhc1BsdWdpblNldHRpbmdzID0gREVGQVVMVF9TRVRUSU5HUztcblxuICAgIC8qKiBXaGV0aGVyIHRoZSBjYW52YXMgSU9DIGNhcmRzIGFyZSBjdXJyZW50bHkgaW4gY29tcGFjdC9yZWR1Y2VkIHZpZXcuICovXG4gICAgaXNSZWR1Y2VkVmlldzogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICAgLyoqIFRyYWNrZWQgY2FudmFzIHdyYXBwZXIgZWxlbWVudCBmb3IgY29udGV4dCBtZW51IGNsZWFudXAgb24gdW5sb2FkLiAqL1xuICAgIHByaXZhdGUgY2FudmFzV3JhcHBlckVsOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUGx1Z2luIGxpZmVjeWNsZVxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICBjb25zb2xlLmxvZygnTG9hZGluZyBJT0MgQ2FudmFzIFBsdWdpbicpO1xuXG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cbiAgICAgICAgLy8gUmliYm9uIGljb246IHF1aWNrIGFjY2VzcyBmcm9tIHRoZSBsZWZ0IHNpZGViYXJcbiAgICAgICAgdGhpcy5hZGRSaWJib25JY29uKCdjbG9jaycsICdTaG93IEF0dGFjayBUaW1lbGluZXMnLCAoKSA9PiB7XG4gICAgICAgICAgICBuZXcgUmVuZGVyVGltZWxpbmVzTW9kYWwodGhpcy5hcHAsIHRoaXMpLm9wZW4oKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ29tbWFuZHM6IGFjY2Vzc2libGUgdmlhIHRoZSBjb21tYW5kIHBhbGV0dGUgKEN0cmwvQ21kK1ApXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ3Nob3ctdGltZWxpbmVzJyxcbiAgICAgICAgICAgIG5hbWU6ICdTaG93IEF0dGFjayBUaW1lbGluZXMnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICBuZXcgUmVuZGVyVGltZWxpbmVzTW9kYWwodGhpcy5hcHAsIHRoaXMpLm9wZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnc2hvdy1pb2MtY2FyZHMnLFxuICAgICAgICAgICAgbmFtZTogJ0FkZCBQYXJlbnQgSU9DIENhcmQnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICBvcGVuSU9DQ2FyZFNlbGVjdG9yKHRoaXMuYXBwLCAoaWQsIG9zKSA9PiBjcmVhdGVJT0NDYXJkKHRoaXMuYXBwLCBpZCwgb3MsIGZhbHNlKSwgJ1NlbGVjdCBQYXJlbnQgSU9DIFR5cGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnYWRkLWNoaWxkLWNhcmQnLFxuICAgICAgICAgICAgbmFtZTogJ0FkZCBDaGlsZCBJT0MgQ2FyZCcsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4ge1xuICAgICAgICAgICAgICAgIG9wZW5JT0NDYXJkU2VsZWN0b3IodGhpcy5hcHAsIChpZCwgb3MpID0+IGNyZWF0ZUlPQ0NhcmQodGhpcy5hcHAsIGlkLCBvcywgdHJ1ZSksICdTZWxlY3QgQ2hpbGQgSU9DIFR5cGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gU2V0dGluZ3MgdGFiXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgUGx1Z2luU2V0dGluZ3ModGhpcy5hcHAsIHRoaXMpKTtcblxuICAgICAgICAvLyBDYW52YXMgY29udGV4dCBtZW51OiByaWdodC1jbGljayBhIC5jYW52YXMgZmlsZSBpbiB0aGUgZmlsZSBleHBsb3JlclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2ZpbGUtbWVudScsIChtZW51LCBmaWxlKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gJ2NhbnZhcycpIHtcbiAgICAgICAgICAgICAgICAgICAgbWVudS5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNldFRpdGxlKCdTaG93IEF0dGFjayBUaW1lbGluZXMnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKCdjbG9jaycpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgUmVuZGVyVGltZWxpbmVzTW9kYWwodGhpcy5hcHAsIHRoaXMpLm9wZW4oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBDYW52YXMgYnV0dG9uIGluamVjdGlvbiBvbiBsZWFmIGNoYW5nZSArIGluaXRpYWwgaW5qZWN0aW9uXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vbignYWN0aXZlLWxlYWYtY2hhbmdlJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuaW5qZWN0Q2FudmFzQnV0dG9ucygpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5pbmplY3RDYW52YXNCdXR0b25zKCk7XG4gICAgfVxuXG4gICAgb251bmxvYWQoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdVbmxvYWRpbmcgSU9DIENhbnZhcyBQbHVnaW4nKTtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmlvYy10b29sYmFyJykuZm9yRWFjaChlbCA9PiBlbC5yZW1vdmUoKSk7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pb2MtcmVkdWNlZCcpLmZvckVhY2goZWwgPT4gZWwuY2xhc3NMaXN0LnJlbW92ZSgnaW9jLXJlZHVjZWQnKSk7XG4gICAgICAgIGlmICh0aGlzLmNhbnZhc1dyYXBwZXJFbCkge1xuICAgICAgICAgICAgcmVtb3ZlQ2FudmFzQ29udGV4dE1lbnUodGhpcy5jYW52YXNXcmFwcGVyRWwpO1xuICAgICAgICAgICAgdGhpcy5jYW52YXNXcmFwcGVyRWwgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gU2V0dGluZ3MgcGVyc2lzdGVuY2VcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuICAgIH1cblxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFRoaW4gZGVsZWdhdGlvbiB0byBjYW52YXMgbW9kdWxlc1xuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqIEluamVjdCB0b29sYmFyIGJ1dHRvbnMgYW5kIGNvbnRleHQgbWVudSBpbnRvIHRoZSBhY3RpdmUgY2FudmFzIHZpZXcuICovXG4gICAgcHJpdmF0ZSBpbmplY3RDYW52YXNCdXR0b25zKCk6IHZvaWQge1xuICAgICAgICBhZGRDYW52YXNCdXR0b25zKHtcbiAgICAgICAgICAgIGFwcDogdGhpcy5hcHAsXG4gICAgICAgICAgICBpc1JlZHVjZWRWaWV3OiB0aGlzLmlzUmVkdWNlZFZpZXcsXG4gICAgICAgICAgICBvblRpbWVsaW5lOiAoKSA9PiBuZXcgUmVuZGVyVGltZWxpbmVzTW9kYWwodGhpcy5hcHAsIHRoaXMpLm9wZW4oKSxcbiAgICAgICAgICAgIG9uQWRkQ2FyZDogKCkgPT4gb3BlbklPQ0NhcmRTZWxlY3Rvcih0aGlzLmFwcCwgKGlkLCBvcykgPT4gY3JlYXRlSU9DQ2FyZCh0aGlzLmFwcCwgaWQsIG9zLCBmYWxzZSksICdTZWxlY3QgUGFyZW50IElPQyBUeXBlJyksXG4gICAgICAgICAgICBvbkNoaWxkQ2FyZDogKCkgPT4gb3BlbklPQ0NhcmRTZWxlY3Rvcih0aGlzLmFwcCwgKGlkLCBvcykgPT4gY3JlYXRlSU9DQ2FyZCh0aGlzLmFwcCwgaWQsIG9zLCB0cnVlKSwgJ1NlbGVjdCBDaGlsZCBJT0MgVHlwZScpLFxuICAgICAgICAgICAgb25SZWR1Y2U6ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmlzUmVkdWNlZFZpZXcgPSB0b2dnbGVSZWR1Y2VWaWV3KHRoaXMuYXBwLCB0aGlzLmlzUmVkdWNlZFZpZXcpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmlzUmVkdWNlZFZpZXc7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb25NaXRyZTogKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGFjdGl2ZVRlY2huaXF1ZUlkID0gZ2V0U2VsZWN0ZWRUZWNobmlxdWVJZCh0aGlzLmFwcCk7XG4gICAgICAgICAgICAgICAgbmV3IFJlbmRlck1pdHJlTW9kYWwodGhpcy5hcHAsIHRoaXMsIGFjdGl2ZVRlY2huaXF1ZUlkKS5vcGVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFNldCB1cCByaWdodC1jbGljayBjb250ZXh0IG1lbnUgZm9yIElPQyBjYXJkIHJvbGUgY29udmVyc2lvblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKEl0ZW1WaWV3KTtcbiAgICAgICAgICAgIGlmIChhY3RpdmVWaWV3ICYmIGFjdGl2ZVZpZXcuZ2V0Vmlld1R5cGUoKSA9PT0gJ2NhbnZhcycpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjYW52YXMgPSAoYWN0aXZlVmlldyBhcyBhbnkpLmNhbnZhcztcbiAgICAgICAgICAgICAgICBpZiAoY2FudmFzPy53cmFwcGVyRWwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYW52YXNXcmFwcGVyRWwgPSBjYW52YXMud3JhcHBlckVsO1xuICAgICAgICAgICAgICAgICAgICBzZXR1cENhbnZhc0NvbnRleHRNZW51KHRoaXMuYXBwLCBjYW52YXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdJT0MgQ2FudmFzOiBmYWlsZWQgdG8gc2V0IHVwIGNvbnRleHQgbWVudScsIGVycik7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCAiLyoqXHJcbiAqIFJlbmRlclRpbWVsaW5lc01vZGFsLnRzIC0gVGltZWxpbmUgdmlzdWFsaXphdGlvbiBtb2RhbCB3aXRoIDMgdGFicy5cclxuICpcclxuICogVGFiIDE6IFRpbWUgVGltZWxpbmUgLSBDaHJvbm9sb2dpY2FsIElPQyBjYXJkIGRpc3BsYXkgKGV4aXN0aW5nIGJlaGF2aW9yKVxyXG4gKiBUYWIgMjogR3JhcGggLSBIb3Jpem9udGFsIGRvdCB0aW1lbGluZSB3aXRoIHRpbWUgcmFuZ2UgZmlsdGVyaW5nXHJcbiAqIFRhYiAzOiBMaW5rIFRpbWVsaW5lIC0gUGFyZW50LWNoaWxkIGdyb3VwaW5nIGJ5IGNhbnZhcyBhcnJvd3NcclxuICpcclxuICogQWxsIERPTSBpcyBidWlsdCB3aXRoIE9ic2lkaWFuJ3MgY3JlYXRlRWwvY3JlYXRlRGl2IEFQSTsgY29sb3JzIGFyZSBhcHBsaWVkXHJcbiAqIHZpYSBpbmxpbmUgc3R5bGVzIHVzaW5nIGVhY2ggSU9DIHR5cGUncyBjb2xvciBmcm9tIHRoZSBjYXJkIGRhdGEuXHJcbiAqL1xyXG5pbXBvcnQgeyBBcHAsIE1vZGFsIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBleHRyYWN0Rml4ZWRJT0NEYXRhIH0gZnJvbSAnLi9UaW1lVGltZWxpbmVQcm9jZXNzaW5nJztcclxuaW1wb3J0IHsgcmVuZGVyVGltZVRpbWVsaW5lIH0gZnJvbSAnLi9UaW1lVGltZWxpbmVUYWInO1xyXG5pbXBvcnQgeyByZW5kZXJHcmFwaFRpbWVsaW5lIH0gZnJvbSAnLi9HcmFwaFRpbWVsaW5lVGFiJztcclxuaW1wb3J0IHsgZ2V0Q2FudmFzRWRnZXMgfSBmcm9tICcuLi9jYW52YXMvQ2FudmFzRWRnZXMnO1xyXG5pbXBvcnQgeyBidWlsZFBhcmVudENoaWxkR3JvdXBzIH0gZnJvbSAnLi9MaW5rVGltZWxpbmVQcm9jZXNzaW5nJztcclxuaW1wb3J0IHsgcmVuZGVyTGlua1RpbWVsaW5lIH0gZnJvbSAnLi9MaW5rVGltZWxpbmVUYWInO1xyXG5pbXBvcnQgeyBERUJVRyB9IGZyb20gJy4uL2RlYnVnJztcclxuXHJcbmV4cG9ydCBjbGFzcyBSZW5kZXJUaW1lbGluZXNNb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICAgIHByaXZhdGUgcGx1Z2luOiBhbnk7XHJcblxyXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogYW55KSB7XHJcbiAgICAgICAgc3VwZXIoYXBwKTtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgIH1cclxuXHJcbiAgICBvbk9wZW4oKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5tb2RhbEVsLmNsYXNzTGlzdC5hZGQoJ3RpbWVsaW5lLW1vZGFsLWZ1bGxzY3JlZW4nKTtcclxuXHJcbiAgICAgICAgLy8gRXh0cmFjdCBJT0MgZGF0YSBvbmNlIGZvciBhbGwgdGFic1xyXG4gICAgICAgIGNvbnN0IGlvY0RhdGEgPSBleHRyYWN0Rml4ZWRJT0NEYXRhKHRoaXMuYXBwKTtcclxuICAgICAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tUaW1lbGluZU1vZGFsXSBFeHRyYWN0ZWQnLCBpb2NEYXRhLmxlbmd0aCwgJ0lPQyBjYXJkcycpO1xyXG5cclxuICAgICAgICAvLyBTb3J0IGNocm9ub2xvZ2ljYWxseSBmb3IgdGltZS1iYXNlZCB2aWV3c1xyXG4gICAgICAgIGNvbnN0IHNvcnRlZERhdGEgPSBbLi4uaW9jRGF0YV0uc29ydChcclxuICAgICAgICAgICAgKGEsIGIpID0+IG5ldyBEYXRlKGEudGltZSkuZ2V0VGltZSgpIC0gbmV3IERhdGUoYi50aW1lKS5nZXRUaW1lKClcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgICAvLyBIZWFkZXIgd2l0aCB0aXRsZVxyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgIGNvbnN0IGhlYWRlckNvbnRhaW5lciA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoJ3RpbWVsaW5lLW1vZGFsLWhlYWRlcicpO1xyXG4gICAgICAgIGhlYWRlckNvbnRhaW5lci5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdJT0MgVGltZWxpbmUnIH0pO1xyXG5cclxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgICAvLyBUYWIgYmFyXHJcbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgY29uc3QgdGFiQmFyID0gY29udGVudEVsLmNyZWF0ZURpdigndGltZWxpbmUtdGFiLWJhcicpO1xyXG4gICAgICAgIGNvbnN0IHRhYnMgPSBbXHJcbiAgICAgICAgICAgIHsgaWQ6ICd0aW1lJywgbGFiZWw6ICdUaW1lIFRpbWVsaW5lJyB9LFxyXG4gICAgICAgICAgICB7IGlkOiAnZ3JhcGgnLCBsYWJlbDogJ0dyYXBoJyB9LFxyXG4gICAgICAgICAgICB7IGlkOiAnbGluaycsIGxhYmVsOiAnTGluayBUaW1lbGluZScgfVxyXG4gICAgICAgIF07XHJcblxyXG4gICAgICAgIGNvbnN0IHRhYkNvbnRlbnRzOiBSZWNvcmQ8c3RyaW5nLCBIVE1MRWxlbWVudD4gPSB7fTtcclxuICAgICAgICBjb25zdCB0YWJCdXR0b25zOiBIVE1MRWxlbWVudFtdID0gW107XHJcblxyXG4gICAgICAgIHRhYnMuZm9yRWFjaCgodGFiLCBpZHgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgYnRuID0gdGFiQmFyLmNyZWF0ZUVsKCdidXR0b24nLCB7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OiB0YWIubGFiZWwsXHJcbiAgICAgICAgICAgICAgICBjbHM6ICd0aW1lbGluZS10YWItYnV0dG9uJ1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKGlkeCA9PT0gMCkgYnRuLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICB0YWJCdXR0b25zLnB1c2goYnRuKTtcclxuXHJcbiAgICAgICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIFN3aXRjaCBhY3RpdmUgdGFiXHJcbiAgICAgICAgICAgICAgICB0YWJCdXR0b25zLmZvckVhY2goYiA9PiBiLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpKTtcclxuICAgICAgICAgICAgICAgIGJ0bi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuXHJcbiAgICAgICAgICAgICAgICBPYmplY3QudmFsdWVzKHRhYkNvbnRlbnRzKS5mb3JFYWNoKGMgPT4gYy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnKTtcclxuICAgICAgICAgICAgICAgIHRhYkNvbnRlbnRzW3RhYi5pZF0uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgICAvLyBUYWIgY29udGVudCBhcmVhc1xyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgIGNvbnN0IGNvbnRlbnRBcmVhID0gY29udGVudEVsLmNyZWF0ZURpdigndGltZWxpbmUtdGFiLWNvbnRlbnQtYXJlYScpO1xyXG5cclxuICAgICAgICAvLyBUYWIgMTogVGltZSBUaW1lbGluZVxyXG4gICAgICAgIGNvbnN0IHRpbWVUYWIgPSBjb250ZW50QXJlYS5jcmVhdGVEaXYoJ3RpbWVsaW5lLXRhYi1wYW5lJyk7XHJcbiAgICAgICAgdGFiQ29udGVudHNbJ3RpbWUnXSA9IHRpbWVUYWI7XHJcbiAgICAgICAgcmVuZGVyVGltZVRpbWVsaW5lKHRpbWVUYWIsIHNvcnRlZERhdGEpO1xyXG5cclxuICAgICAgICAvLyBUYWIgMjogR3JhcGhcclxuICAgICAgICBjb25zdCBncmFwaFRhYiA9IGNvbnRlbnRBcmVhLmNyZWF0ZURpdigndGltZWxpbmUtdGFiLXBhbmUnKTtcclxuICAgICAgICBncmFwaFRhYi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgIHRhYkNvbnRlbnRzWydncmFwaCddID0gZ3JhcGhUYWI7XHJcbiAgICAgICAgcmVuZGVyR3JhcGhUaW1lbGluZShncmFwaFRhYiwgc29ydGVkRGF0YSk7XHJcblxyXG4gICAgICAgIC8vIFRhYiAzOiBMaW5rIFRpbWVsaW5lXHJcbiAgICAgICAgY29uc3QgbGlua1RhYiA9IGNvbnRlbnRBcmVhLmNyZWF0ZURpdigndGltZWxpbmUtdGFiLXBhbmUnKTtcclxuICAgICAgICBsaW5rVGFiLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgdGFiQ29udGVudHNbJ2xpbmsnXSA9IGxpbmtUYWI7XHJcbiAgICAgICAgY29uc3QgZWRnZXMgPSBnZXRDYW52YXNFZGdlcyh0aGlzLmFwcCk7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYnVpbGRQYXJlbnRDaGlsZEdyb3Vwcyhpb2NEYXRhLCBlZGdlcyk7XHJcbiAgICAgICAgcmVuZGVyTGlua1RpbWVsaW5lKGxpbmtUYWIsIHJlc3VsdCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25DbG9zZSgpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcclxuICAgIH1cclxufVxyXG4iLCAiLyoqIFNldCB0byB0cnVlIHRvIGVuYWJsZSB2ZXJib3NlIGRlYnVnIGxvZ2dpbmcgYWNyb3NzIGFsbCBtb2R1bGVzLiAqL1xyXG5leHBvcnQgY29uc3QgREVCVUcgPSBmYWxzZTtcclxuIiwgIi8qKlxyXG4gKiBJT0NUeXBlRGV0ZWN0aW9uLnRzIC0gSU9DIHR5cGUgZGV0ZWN0aW9uIGZyb20gY2FudmFzIG5vZGUgdGV4dFxyXG4gKlxyXG4gKiBNYXRjaGVzIHJhdyBub2RlIHRleHQgYWdhaW5zdCBvcmRlcmVkIHJlZ2V4IHBhdHRlcm5zIHRvIGRldGVybWluZSB0aGUgSU9DXHJcbiAqIGNhcmQgdHlwZS4gUGF0dGVybiBvcmRlciBpcyBjcml0aWNhbDogbW9yZS1zcGVjaWZpYyB0eXBlcyBtdXN0IGFwcGVhciBiZWZvcmVcclxuICogbGVzcy1zcGVjaWZpYyBvbmVzIHRvIGF2b2lkIGZhbHNlIHBvc2l0aXZlcyAoZS5nLiwgXCJGaWxlIEhhc2hcIiBiZWZvcmUgXCJGaWxlXCIpLlxyXG4gKi9cclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBQYXR0ZXJuIHRhYmxlXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLyoqXHJcbiAqIElPQyB0eXBlIGRldGVjdGlvbiBwYXR0ZXJucy5cclxuICpcclxuICogT1JERVIgTUFUVEVSUzogTW9yZSBzcGVjaWZpYyBwYXR0ZXJucyBtdXN0IGNvbWUgYmVmb3JlIGxlc3Mgc3BlY2lmaWMgb25lcy5cclxuICogRm9yIGV4YW1wbGU6XHJcbiAqICAgLSBcIkZpbGUgSGFzaFwiIG11c3QgYXBwZWFyIGJlZm9yZSBcIkZpbGVcIiB0byBhdm9pZCBcIkZpbGVcIiBtYXRjaGluZyBmaXJzdFxyXG4gKiAgIC0gXCJEb21haW4gTmFtZVwiIG11c3QgYXBwZWFyIGJlZm9yZSBnZW5lcmljIHBhdHRlcm5zXHJcbiAqICAgLSBcIklQIEFkZHJlc3NcIiBhbmQgXCJFbWFpbCBBZGRyZXNzXCIgbXVzdCBhcHBlYXIgYmVmb3JlIGdlbmVyaWMgd29yZHNcclxuICogICAtIFwiTmV0d29ya1wiIG1hdGNoZXMgdGhlIElPQ19UWVBFUyBjb25zdGFudCBrZXkgbmFtZSAobm90IFwiTmV0d29yayBUcmFmZmljXCIpXHJcbiAqICAgLSBcIkNvbW1hbmQgTGluZVwiIG11c3QgYXBwZWFyIGJlZm9yZSBzaG9ydCBnZW5lcmljIHBhdHRlcm5zXHJcbiAqXHJcbiAqIEVhY2ggcGF0dGVybiB1c2VzIGNhc2UtaW5zZW5zaXRpdmUgbWF0Y2hpbmcgYWdhaW5zdCB0aGUgZnVsbCBub2RlIHRleHQuXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgSU9DX1RZUEVfUEFUVEVSTlM6IHsgcGF0dGVybjogUmVnRXhwOyB0eXBlOiBzdHJpbmcgfVtdID0gW1xyXG4gICAgeyBwYXR0ZXJuOiAvSVAgQWRkcmVzcy9pLCB0eXBlOiBcIklQIEFkZHJlc3NcIiB9LFxyXG4gICAgeyBwYXR0ZXJuOiAvRG9tYWluIE5hbWUvaSwgdHlwZTogXCJEb21haW4gTmFtZVwiIH0sXHJcbiAgICB7IHBhdHRlcm46IC9GaWxlIEhhc2gvaSwgdHlwZTogXCJGaWxlIEhhc2hcIiB9LFxyXG4gICAgeyBwYXR0ZXJuOiAvVVJML2ksIHR5cGU6IFwiVVJMXCIgfSxcclxuICAgIHsgcGF0dGVybjogL0VtYWlsIEFkZHJlc3MvaSwgdHlwZTogXCJFbWFpbCBBZGRyZXNzXCIgfSxcclxuICAgIHsgcGF0dGVybjogL0hvc3RuYW1lL2ksIHR5cGU6IFwiSG9zdG5hbWVcIiB9LFxyXG4gICAgeyBwYXR0ZXJuOiAvWUFSQSBSdWxlL2ksIHR5cGU6IFwiWUFSQSBSdWxlXCIgfSxcclxuICAgIHsgcGF0dGVybjogL1NpZ21hIFJ1bGUvaSwgdHlwZTogXCJTaWdtYSBSdWxlXCIgfSxcclxuICAgIHsgcGF0dGVybjogL1JlZ2lzdHJ5IEtleS9pLCB0eXBlOiBcIlJlZ2lzdHJ5IEtleVwiIH0sXHJcbiAgICB7IHBhdHRlcm46IC9Qcm9jZXNzIE5hbWUvaSwgdHlwZTogXCJQcm9jZXNzIE5hbWVcIiB9LFxyXG4gICAgLy8gRklYOiBUaGUgSU9DX1RZUEVTIGNvbnN0YW50IHVzZXMgXCJOZXR3b3JrXCIgKG5vdCBcIk5ldHdvcmsgVHJhZmZpY1wiKS5cclxuICAgIC8vIFRoZSBvbGQgY29kZSB1c2VkIFwiTmV0d29yayBUcmFmZmljXCIgd2hpY2ggd291bGQgbmV2ZXIgbWF0Y2ggdGhlXHJcbiAgICAvLyBJT0NfVFlQRVMgbG9va3VwLCBzbyBjb2xvciBhbmQgaWNvbiB3ZXJlIG5ldmVyIHJlc29sdmVkIGZvciB0aGlzIHR5cGUuXHJcbiAgICB7IHBhdHRlcm46IC9OZXR3b3JrL2ksIHR5cGU6IFwiTmV0d29ya1wiIH0sXHJcbiAgICB7IHBhdHRlcm46IC9Db21tYW5kIExpbmUvaSwgdHlwZTogXCJDb21tYW5kIExpbmVcIiB9LFxyXG4gICAgeyBwYXR0ZXJuOiAvRmlsZS9pLCB0eXBlOiBcIkZpbGVcIiB9LFxyXG4gICAgeyBwYXR0ZXJuOiAvTm90ZS9pLCB0eXBlOiBcIk5vdGVcIiB9LFxyXG4gICAgeyBwYXR0ZXJuOiAvRExML2ksIHR5cGU6IFwiRExMXCIgfSxcclxuICAgIHsgcGF0dGVybjogL0MyL2ksIHR5cGU6IFwiQzJcIiB9XHJcbl07XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gRGV0ZWN0aW9uIGZ1bmN0aW9uXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLyoqXHJcbiAqIERldGVjdCB0aGUgSU9DIHR5cGUgZnJvbSBub2RlIHRleHQgY29udGVudC5cclxuICpcclxuICogSXRlcmF0ZXMgdGhyb3VnaCBJT0NfVFlQRV9QQVRURVJOUyBpbiBvcmRlciwgcmV0dXJuaW5nIHRoZSBmaXJzdCBtYXRjaC5cclxuICogQmVjYXVzZSBwYXR0ZXJucyBhcmUgdGVzdGVkIGluIHNlcXVlbmNlLCBzcGVjaWZpY2l0eSBvcmRlcmluZyBwcmV2ZW50c1xyXG4gKiBmYWxzZSBwb3NpdGl2ZXMgKGUuZy4gXCJGaWxlIEhhc2hcIiBub2RlIHdvbid0IG1hdGNoIGdlbmVyaWMgXCJGaWxlXCIpLlxyXG4gKlxyXG4gKiBAcGFyYW0gdGV4dCAtIFJhdyBjYW52YXMgbm9kZSB0ZXh0IGNvbnRlbnRcclxuICogQHJldHVybnMgTWF0Y2hlZCBJT0MgdHlwZSBuYW1lLCBvciBlbXB0eSBzdHJpbmcgaWYgbm8gbWF0Y2hcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBkZXRlY3RJT0NUeXBlKHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICBmb3IgKGNvbnN0IHsgcGF0dGVybiwgdHlwZSB9IG9mIElPQ19UWVBFX1BBVFRFUk5TKSB7XHJcbiAgICAgICAgaWYgKHBhdHRlcm4udGVzdCh0ZXh0KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHlwZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gJyc7XHJcbn1cclxuIiwgIi8qKlxyXG4gKiBJT0NGaWVsZEV4dHJhY3RvcnMudHMgLSBGaWVsZCB2YWx1ZSBleHRyYWN0aW9uIGZyb20gSU9DIGNhcmQgdGV4dFxyXG4gKlxyXG4gKiBQcm92aWRlcyBmdW5jdGlvbnMgdG8gZXh0cmFjdCBzdHJ1Y3R1cmVkIGRhdGEgZnJvbSB0aGUgcmF3IG1hcmtkb3duIHRleHRcclxuICogb2YgSU9DIGNhbnZhcyBub2Rlcy4gRWFjaCBleHRyYWN0b3IgdGFyZ2V0cyBhIHNwZWNpZmljIGZpZWxkOlxyXG4gKiAtIGV4dHJhY3RWYWx1ZTogcHJpbWFyeSBJT0MgdmFsdWUgKGZpcnN0IGZpZWxkIGFmdGVyIGhlYWRlcilcclxuICogLSBleHRyYWN0VGltZTogXCJUaW1lIG9mIEV2ZW50XCIgdGltZXN0YW1wXHJcbiAqIC0gZXh0cmFjdFNwbHVua1F1ZXJ5OiBTcGx1bmsgcXVlcnkgc3RyaW5nXHJcbiAqIC0gZXh0cmFjdE1pdHJlRmllbGQ6IE1JVFJFIHRhY3RpYyBvciB0ZWNobmlxdWUgKGdlbmVyaWMpXHJcbiAqIC0gZXh0cmFjdENhcmRJZDogdGltZXN0YW1wLWJhc2VkIGNhcmQgSURcclxuICpcclxuICogQWxsIGZ1bmN0aW9ucyBhcmUgcHVyZSAobm8gc2lkZSBlZmZlY3RzIGJleW9uZCBkZWJ1ZyBsb2dnaW5nKS5cclxuICovXHJcblxyXG5pbXBvcnQgeyBERUJVRyB9IGZyb20gJy4uL2RlYnVnJztcclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBQcmltYXJ5IHZhbHVlIGV4dHJhY3Rpb25cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vKipcclxuICogRXh0cmFjdCB0aGUgcHJpbWFyeSB2YWx1ZSBmcm9tIElPQyBjYXJkIHRleHQuXHJcbiAqXHJcbiAqIFRoZSBGSVJTVCBGSUVMRCBvZiBlYWNoIGNhcmQgaXMgYWx3YXlzIGNvbnNpZGVyZWQgdGhlIFwidmFsdWVcIiBmb3IgdGltZWxpbmVcclxuICogZGlzcGxheSwgcmVnYXJkbGVzcyBvZiB3aGF0IHRoZSBmaWVsZCBpcyBuYW1lZCAoSVAsIERvbWFpbiwgSGFzaCwgZXRjLikuXHJcbiAqXHJcbiAqIERlbGltaXRlciBwcmVjZWRlbmNlOlxyXG4gKiAgIDEuIExlZ2FjeSBjb2RlIGJsb2NrcyAoYGBgLi4uYGBgKVxyXG4gKiAgIDIuIFwiLS0tLS1cIiBzZXBhcmF0b3IgYmV0d2VlbiBmaWVsZHNcclxuICogICAzLiBOZXh0IGZpZWxkIGxhYmVsICh0ZXh0IGVuZGluZyB3aXRoIGNvbG9uKVxyXG4gKiAgIDQuIFwiVGltZSBvZiBFdmVudDpcIiBhcyBmaW5hbCBib3VuZGFyeVxyXG4gKlxyXG4gKiBAcGFyYW0gdGV4dCAtIFJhdyBjYW52YXMgbm9kZSB0ZXh0IGNvbnRlbnRcclxuICogQHJldHVybnMgRXh0cmFjdGVkIHByaW1hcnkgdmFsdWUsIG9yIGVtcHR5IHN0cmluZ1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RWYWx1ZSh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbSU9DRmllbGRFeHRyYWN0b3JzXSBleHRyYWN0VmFsdWUgLSBpbnB1dCBsZW5ndGg6JywgdGV4dC5sZW5ndGgpO1xyXG5cclxuICAgIC8vIEZpcnN0IHRyeSBjb2RlIGJsb2NrcyAobGVnYWN5IGZvcm1hdCBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSlcclxuICAgIGNvbnN0IGNvZGVCbG9ja01hdGNoID0gdGV4dC5tYXRjaCgvYGBgKFtcXHNcXFNdKj8pYGBgLyk7XHJcbiAgICBpZiAoY29kZUJsb2NrTWF0Y2ggJiYgY29kZUJsb2NrTWF0Y2hbMV0gJiYgY29kZUJsb2NrTWF0Y2hbMV0udHJpbSgpKSB7XHJcbiAgICAgICAgY29uc3QgdmFsdWUgPSBjb2RlQmxvY2tNYXRjaFsxXS50cmltKCk7XHJcbiAgICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbSU9DRmllbGRFeHRyYWN0b3JzXSBleHRyYWN0VmFsdWUgLSBmb3VuZCBjb2RlIGJsb2NrOicsIHZhbHVlKTtcclxuICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU3BsaXQgYnkgSFRNTCBoZWFkZXIgY2xvc2luZyB0YWcgdG8gZ2V0IGNvbnRlbnQgYWZ0ZXIgaGVhZGVyXHJcbiAgICBjb25zdCBwYXJ0cyA9IHRleHQuc3BsaXQoJzwvZGl2PjwvZGl2PicpO1xyXG4gICAgaWYgKHBhcnRzLmxlbmd0aCA8IDIpIHtcclxuICAgICAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tJT0NGaWVsZEV4dHJhY3RvcnNdIGV4dHJhY3RWYWx1ZSAtIG5vIEhUTUwgaGVhZGVyIGZvdW5kJyk7XHJcbiAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBhZnRlckhlYWRlciA9IHBhcnRzWzFdLnRyaW0oKTtcclxuICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW0lPQ0ZpZWxkRXh0cmFjdG9yc10gZXh0cmFjdFZhbHVlIC0gY29udGVudCBhZnRlciBoZWFkZXIgbGVuZ3RoOicsIGFmdGVySGVhZGVyLmxlbmd0aCk7XHJcblxyXG4gICAgLy8gRmluZCBmaXJzdCBmaWVsZCBsYWJlbCAodGV4dCBlbmRpbmcgd2l0aCBjb2xvbilcclxuICAgIGNvbnN0IGZpZWxkTWF0Y2ggPSBhZnRlckhlYWRlci5tYXRjaCgvW146XFxuXSs6XFxzKi8pO1xyXG4gICAgaWYgKCFmaWVsZE1hdGNoKSB7XHJcbiAgICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbSU9DRmllbGRFeHRyYWN0b3JzXSBleHRyYWN0VmFsdWUgLSBubyBmaWVsZCBsYWJlbCBmb3VuZCcpO1xyXG4gICAgICAgIHJldHVybiAnJztcclxuICAgIH1cclxuXHJcbiAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tJT0NGaWVsZEV4dHJhY3RvcnNdIGV4dHJhY3RWYWx1ZSAtIGZpcnN0IGZpZWxkOicsIGZpZWxkTWF0Y2hbMF0udHJpbSgpKTtcclxuXHJcbiAgICAvLyBHZXQgY29udGVudCBhZnRlciB0aGUgZmllbGQgbGFiZWxcclxuICAgIGNvbnN0IGFmdGVyRmllbGRMYWJlbCA9IGFmdGVySGVhZGVyLnN1YnN0cmluZyhmaWVsZE1hdGNoLmluZGV4ISArIGZpZWxkTWF0Y2hbMF0ubGVuZ3RoKTtcclxuXHJcbiAgICAvLyBGaW5kIHRoZSBmaXJzdCBcIi0tLS0tXCIgc2VwYXJhdG9yIE9SIHRoZSBmaXJzdCBuZXdsaW5lIGZvbGxvd2VkIGJ5IGFub3RoZXIgZmllbGRcclxuICAgIGNvbnN0IHNlcGFyYXRvck1hdGNoID0gYWZ0ZXJGaWVsZExhYmVsLm1hdGNoKC9cXG4/LS0tLS0vKTtcclxuICAgIGNvbnN0IG5leHRGaWVsZE1hdGNoID0gYWZ0ZXJGaWVsZExhYmVsLm1hdGNoKC9cXG4oW146XFxuXSs6XFxzKikvKTtcclxuXHJcbiAgICBsZXQgdmFsdWU6IHN0cmluZztcclxuICAgIGxldCBkZWxpbWl0ZXJJbmRleDogbnVtYmVyIHwgdW5kZWZpbmVkO1xyXG5cclxuICAgIC8vIERldGVybWluZSB3aGljaCBkZWxpbWl0ZXIgY29tZXMgZmlyc3RcclxuICAgIGlmIChzZXBhcmF0b3JNYXRjaCAmJiBzZXBhcmF0b3JNYXRjaC5pbmRleCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgZGVsaW1pdGVySW5kZXggPSBzZXBhcmF0b3JNYXRjaC5pbmRleDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAobmV4dEZpZWxkTWF0Y2ggJiYgbmV4dEZpZWxkTWF0Y2guaW5kZXggIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGlmIChkZWxpbWl0ZXJJbmRleCA9PT0gdW5kZWZpbmVkIHx8IG5leHRGaWVsZE1hdGNoLmluZGV4IDwgZGVsaW1pdGVySW5kZXgpIHtcclxuICAgICAgICAgICAgZGVsaW1pdGVySW5kZXggPSBuZXh0RmllbGRNYXRjaC5pbmRleDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGRlbGltaXRlckluZGV4ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAvLyBObyBzZXBhcmF0b3Igb3IgbmV4dCBmaWVsZCBmb3VuZCAtIGV4dHJhY3QgZXZlcnl0aGluZyB1bnRpbCBUaW1lIG9mIEV2ZW50XHJcbiAgICAgICAgY29uc3QgdGltZUluZGV4ID0gYWZ0ZXJGaWVsZExhYmVsLmluZGV4T2YoJ1RpbWUgb2YgRXZlbnQ6Jyk7XHJcbiAgICAgICAgdmFsdWUgPSB0aW1lSW5kZXggPT09IC0xID8gYWZ0ZXJGaWVsZExhYmVsIDogYWZ0ZXJGaWVsZExhYmVsLnN1YnN0cmluZygwLCB0aW1lSW5kZXgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBFeHRyYWN0IGNvbnRlbnQgYmVmb3JlIGZpcnN0IGRlbGltaXRlclxyXG4gICAgICAgIHZhbHVlID0gYWZ0ZXJGaWVsZExhYmVsLnN1YnN0cmluZygwLCBkZWxpbWl0ZXJJbmRleCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdHJpbW1lZFZhbHVlID0gdmFsdWUudHJpbSgpO1xyXG4gICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbSU9DRmllbGRFeHRyYWN0b3JzXSBleHRyYWN0VmFsdWUgLSByZXN1bHQ6JywgdHJpbW1lZFZhbHVlIHx8ICcoZW1wdHkpJyk7XHJcbiAgICByZXR1cm4gdHJpbW1lZFZhbHVlO1xyXG59XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gVGltZXN0YW1wIGV4dHJhY3Rpb25cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vKipcclxuICogRXh0cmFjdCB0aGUgXCJUaW1lIG9mIEV2ZW50XCIgdGltZXN0YW1wIGZyb20gbm9kZSB0ZXh0LlxyXG4gKlxyXG4gKiBUcmllcyBwcm9ncmVzc2l2ZWx5IGxlc3Mgc3BlY2lmaWMgcGF0dGVybnM6XHJcbiAqICAgMS4gKipUaW1lIG9mIEV2ZW50OioqIGZvbGxvd2VkIGJ5IGRhdGV0aW1lIChZWVlZLU1NLUREIEhIOk1NOlNTKVxyXG4gKiAgIDIuICoqVGltZSBvZiBFdmVudDoqKiBmb2xsb3dlZCBieSBkYXRlIG9ubHkgKFlZWVktTU0tREQpXHJcbiAqICAgMy4gQmFyZSBcIlRpbWVcIiBsYWJlbCBmb2xsb3dlZCBieSBkYXRldGltZVxyXG4gKiAgIDQuIEFueSBzdGFuZGFsb25lIGRhdGV0aW1lIHBhdHRlcm4gaW4gdGhlIHRleHRcclxuICpcclxuICogQHBhcmFtIHRleHQgLSBSYXcgY2FudmFzIG5vZGUgdGV4dCBjb250ZW50XHJcbiAqIEByZXR1cm5zIEV4dHJhY3RlZCB0aW1lc3RhbXAgc3RyaW5nLCBvciBlbXB0eSBzdHJpbmdcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBleHRyYWN0VGltZSh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgY29uc3QgdGltZVBhdHRlcm5zID0gW1xyXG4gICAgICAgIC9cXCpcXCpUaW1lIG9mIEV2ZW50OlxcKlxcKlxccyooXFxkezR9LVxcZHsyfS1cXGR7Mn1cXHNcXGR7Mn06XFxkezJ9OlxcZHsyfSkvaSxcclxuICAgICAgICAvXFwqXFwqVGltZSBvZiBFdmVudDpcXCpcXCpcXHMqKFxcZHs0fS1cXGR7Mn0tXFxkezJ9KS9pLFxyXG4gICAgICAgIC9UaW1lIG9mIEV2ZW50WzpcXHNdKihcXGR7NH0tXFxkezJ9LVxcZHsyfVtUXFxzXVxcZHsyfTpcXGR7Mn06XFxkezJ9KS9pLFxyXG4gICAgICAgIC9UaW1lIG9mIEV2ZW50WzpcXHNdKihcXGR7NH0tXFxkezJ9LVxcZHsyfSkvaSxcclxuICAgICAgICAvVGltZVs6XFxzXSooXFxkezR9LVxcZHsyfS1cXGR7Mn1bVFxcc11cXGR7Mn06XFxkezJ9OlxcZHsyfSkvaSxcclxuICAgICAgICAvKFxcZHs0fS1cXGR7Mn0tXFxkezJ9W1RcXHNdXFxkezJ9OlxcZHsyfTpcXGR7Mn0pL2lcclxuICAgIF07XHJcblxyXG4gICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIHRpbWVQYXR0ZXJucykge1xyXG4gICAgICAgIGNvbnN0IG1hdGNoID0gdGV4dC5tYXRjaChwYXR0ZXJuKTtcclxuICAgICAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMV0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIG1hdGNoWzFdLnRyaW0oKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gJyc7XHJcbn1cclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBTcGx1bmsgcXVlcnkgZXh0cmFjdGlvblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8qKlxyXG4gKiBFeHRyYWN0IHRoZSBTcGx1bmsgcXVlcnkgZnJvbSBub2RlIHRleHQuXHJcbiAqXHJcbiAqIE1hdGNoZXM6ICoqU3BsdW5rIFF1ZXJ5OioqIDxxdWVyeSB0ZXh0PlxyXG4gKiBDYXB0dXJlcyBldmVyeXRoaW5nIGFmdGVyIHRoZSBsYWJlbCB1cCB0byB0aGUgbmV4dCBib2xkIG1hcmtlciBvciBlbmQgb2Ygc3RyaW5nLlxyXG4gKlxyXG4gKiBAcGFyYW0gdGV4dCAtIFJhdyBjYW52YXMgbm9kZSB0ZXh0IGNvbnRlbnRcclxuICogQHJldHVybnMgRXh0cmFjdGVkIFNwbHVuayBxdWVyeSBzdHJpbmcsIG9yIGVtcHR5IHN0cmluZ1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RTcGx1bmtRdWVyeSh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgY29uc3QgbWF0Y2ggPSB0ZXh0Lm1hdGNoKC9cXCpcXCpTcGx1bmsgUXVlcnk6XFwqXFwqWzpcXHNdKihbXFxzXFxTXSo/KSg/PVxcKlxcKnwkKS9pKTtcclxuICAgIGlmIChtYXRjaCAmJiBtYXRjaFsxXSAmJiBtYXRjaFsxXS50cmltKCkpIHtcclxuICAgICAgICByZXR1cm4gbWF0Y2hbMV0udHJpbSgpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuICcnO1xyXG59XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gTUlUUkUgZmllbGQgZXh0cmFjdGlvblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8qKlxyXG4gKiBFeHRyYWN0IGEgTUlUUkUgQVRUJkNLIGZpZWxkICh0YWN0aWMgb3IgdGVjaG5pcXVlKSBmcm9tIG5vZGUgdGV4dC5cclxuICpcclxuICogVXNlcyB0aGUgc2FtZSBwYXR0ZXJuIGFwcHJvYWNoIGFzIGV4dHJhY3RTcGx1bmtRdWVyeSAtIGNhcHR1cmVzIGV2ZXJ5dGhpbmdcclxuICogYWZ0ZXIgdGhlIGZpZWxkIGxhYmVsIHVudGlsIGhpdHRpbmcgYSBzZXBhcmF0b3IgbGluZSwgbmV4dCBNSVRSRSBmaWVsZCwgb3IgZW5kLlxyXG4gKlxyXG4gKiBTdXBwb3J0cyB2YWx1ZXMgb246XHJcbiAqICAgLSBTYW1lIGxpbmU6IFwiTWl0cmUgVGFjdGljOiBJbml0aWFsIEFjY2Vzc1wiXHJcbiAqICAgLSBOZXh0IGxpbmU6IFwiTWl0cmUgVGFjdGljOlxcbkluaXRpYWwgQWNjZXNzXCJcclxuICogICAtIEFmdGVyIGJsYW5rIGxpbmVzOiBcIk1pdHJlIFRhY3RpYzpcXG5cXG5cXG5Jbml0aWFsIEFjY2Vzc1wiXHJcbiAqXHJcbiAqIEBwYXJhbSB0ZXh0IC0gUmF3IG5vZGUgdGV4dCBjb250ZW50XHJcbiAqIEBwYXJhbSBmaWVsZE5hbWUgLSBcIlRhY3RpY1wiIG9yIFwiVGVjaG5pcXVlXCJcclxuICogQHJldHVybnMgTm9ybWFsaXplZCB2YWx1ZSBpbiBVUFBFUkNBU0UgZm9yIGNvbnNpc3RlbnQgbWF0Y2hpbmdcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBleHRyYWN0TWl0cmVGaWVsZCh0ZXh0OiBzdHJpbmcsIGZpZWxkTmFtZTogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZyhgW0lPQ0ZpZWxkRXh0cmFjdG9yc10gRXh0cmFjdGluZyAke2ZpZWxkTmFtZX0uLi5gKTtcclxuXHJcbiAgICAvLyBQYXR0ZXJuIG1hdGNoZXMgbGlrZSBTcGx1bmsgUXVlcnk6IGNhcHR1cmUgdW50aWwgc2VwYXJhdG9yIGxpbmUsIG5leHQgTWl0cmUgZmllbGQsIG9yIGVuZFxyXG4gICAgLy8gU3RvcHMgYXQ6IFxcbi0tLS0gKHNlcGFyYXRvciksIG9yIFwiTWl0cmUgXCIgKG5leHQgZmllbGQpLCBvciBlbmQgb2Ygc3RyaW5nXHJcbiAgICAvLyBJTVBPUlRBTlQ6IFVzZSBbIFxcdF0qIChzcGFjZXMvdGFicyBvbmx5KSBhZnRlciBjb2xvbiwgTk9UIFxccyogd2hpY2ggd291bGQgY29uc3VtZVxyXG4gICAgLy8gbmV3bGluZXMgYW5kIHByZXZlbnQgdGhlIGxvb2thaGVhZCBmcm9tIHNlZWluZyBcXG4tezQsfSBzZXBhcmF0b3JzIHdoZW4gZmllbGQgaXMgZW1wdHlcclxuICAgIGNvbnN0IHBhdHRlcm4gPSBuZXcgUmVnRXhwKFxyXG4gICAgICAgIGBNaXRyZSAke2ZpZWxkTmFtZX06WyBcXFxcdF0qKFtcXFxcc1xcXFxTXSo/KSg/PVxcXFxuLXs0LH18TWl0cmUgfCQpYCxcclxuICAgICAgICAnaSdcclxuICAgICk7XHJcbiAgICBjb25zdCBtYXRjaCA9IHRleHQubWF0Y2gocGF0dGVybik7XHJcblxyXG4gICAgaWYgKG1hdGNoICYmIG1hdGNoWzFdPy50cmltKCkpIHtcclxuICAgICAgICBjb25zdCB2YWx1ZSA9IG1hdGNoWzFdLnRyaW0oKS50b1VwcGVyQ2FzZSgpO1xyXG4gICAgICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZyhgW0lPQ0ZpZWxkRXh0cmFjdG9yc10gRm91bmQgJHtmaWVsZE5hbWV9OmAsIHZhbHVlKTtcclxuICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKGBbSU9DRmllbGRFeHRyYWN0b3JzXSBObyAke2ZpZWxkTmFtZX0gZm91bmRgKTtcclxuICAgIHJldHVybiAnJztcclxufVxyXG5cclxuLyoqIENvbnZlbmllbmNlIHdyYXBwZXI6IGV4dHJhY3QgTUlUUkUgdGFjdGljIGZyb20gY2FyZCB0ZXh0LiAqL1xyXG5leHBvcnQgY29uc3QgZXh0cmFjdFRhY3RpYyA9ICh0ZXh0OiBzdHJpbmcpID0+IGV4dHJhY3RNaXRyZUZpZWxkKHRleHQsICdUYWN0aWMnKTtcclxuXHJcbi8qKiBDb252ZW5pZW5jZSB3cmFwcGVyOiBleHRyYWN0IE1JVFJFIHRlY2huaXF1ZSBmcm9tIGNhcmQgdGV4dC4gKi9cclxuZXhwb3J0IGNvbnN0IGV4dHJhY3RUZWNobmlxdWUgPSAodGV4dDogc3RyaW5nKSA9PiBleHRyYWN0TWl0cmVGaWVsZCh0ZXh0LCAnVGVjaG5pcXVlJyk7XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gQ2FyZCByb2xlIGV4dHJhY3Rpb24gKFBhcmVudC9DaGlsZClcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vKipcclxuICogRGV0ZWN0IHRoZSBjYXJkIHJvbGUgZnJvbSB0aGUgSFRNTCBoZWFkZXIuXHJcbiAqXHJcbiAqIExvb2tzIGZvciBbUF0gb3IgW0NdIGJhZGdlcyBpbnNpZGUgdGhlIGNhcmQgaGVhZGVyJ3MgYDxzcGFuIGNsYXNzPVwiaW9jLWNhcmQtcm9sZVwiPmAuXHJcbiAqIEZhbGxzIGJhY2sgdG8gcGxhaW4tdGV4dCBwYXR0ZXJuIG1hdGNoaW5nIGZvciBgW1BdYCAvIGBbQ11gIG5lYXIgdGhlIHR5cGUgbmFtZS5cclxuICpcclxuICogQHBhcmFtIHRleHQgLSBSYXcgY2FudmFzIG5vZGUgdGV4dCBjb250ZW50XHJcbiAqIEByZXR1cm5zICdwYXJlbnQnIHwgJ2NoaWxkJyB8ICcnIChlbXB0eSBpZiBubyByb2xlIGJhZGdlIGZvdW5kKVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RDYXJkUm9sZSh0ZXh0OiBzdHJpbmcpOiAncGFyZW50JyB8ICdjaGlsZCcgfCAnJyB7XHJcbiAgICBpZiAoL1xcW1BcXF0vLnRlc3QodGV4dCkpIHJldHVybiAncGFyZW50JztcclxuICAgIGlmICgvXFxbQ1xcXS8udGVzdCh0ZXh0KSkgcmV0dXJuICdjaGlsZCc7XHJcbiAgICByZXR1cm4gJyc7XHJcbn1cclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBDYXJkIElEIGV4dHJhY3Rpb25cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vKipcclxuICogRXh0cmFjdCB0aGUgQ2FyZCBJRCBmaWVsZCBmcm9tIElPQyBjYXJkIG1hcmtkb3duLlxyXG4gKlxyXG4gKiBTdXBwb3J0cyB0d28gZm9ybWF0czpcclxuICogICAtIEhUTUwgY29tbWVudCAobmV3KTogPCEtLSBJT0NfQ0FSRF9JRDojWVlZWU1NREQtSEhNTSAtLT5cclxuICogICAtIExlZ2FjeSBmaWVsZCAoYmFja3dhcmQgY29tcGF0KTogXCJDYXJkIElEOiAjWVlZWU1NREQtSEhNTVwiXHJcbiAqXHJcbiAqIEBwYXJhbSB0ZXh0IC0gUmF3IGNhbnZhcyBub2RlIHRleHQgY29udGVudFxyXG4gKiBAcmV0dXJucyBFeHRyYWN0ZWQgY2FyZCBJRCBzdHJpbmcsIG9yIGVtcHR5IHN0cmluZ1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RDYXJkSWQodGV4dDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW0lPQ0ZpZWxkRXh0cmFjdG9yc10gRXh0cmFjdGluZyBDYXJkIElELi4uJyk7XHJcblxyXG4gICAgLy8gTkVXIEZPUk1BVDogVHJ5IEhUTUwgY29tbWVudCBmaXJzdCAocHJlZmVycmVkKVxyXG4gICAgY29uc3QgY29tbWVudE1hdGNoID0gdGV4dC5tYXRjaCgvPCEtLSBJT0NfQ0FSRF9JRDooW14+XSspIC0tPi8pO1xyXG4gICAgaWYgKGNvbW1lbnRNYXRjaCAmJiBjb21tZW50TWF0Y2hbMV0pIHtcclxuICAgICAgICBjb25zdCBjYXJkSWQgPSBjb21tZW50TWF0Y2hbMV0udHJpbSgpO1xyXG4gICAgICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW0lPQ0ZpZWxkRXh0cmFjdG9yc10gRm91bmQgQ2FyZCBJRCBpbiBIVE1MIGNvbW1lbnQ6JywgY2FyZElkKTtcclxuICAgICAgICByZXR1cm4gY2FyZElkO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIExFR0FDWSBGT1JNQVQ6IEZhbGwgYmFjayB0byBtYXJrZG93biBmaWVsZCBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxyXG4gICAgY29uc3QgY2FyZElkTWF0Y2ggPSB0ZXh0Lm1hdGNoKC9DYXJkIElEOlxccyooW15cXG5dKykvaSk7XHJcbiAgICBpZiAoY2FyZElkTWF0Y2ggJiYgY2FyZElkTWF0Y2hbMV0pIHtcclxuICAgICAgICBjb25zdCBjYXJkSWQgPSBjYXJkSWRNYXRjaFsxXS50cmltKCk7XHJcbiAgICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbSU9DRmllbGRFeHRyYWN0b3JzXSBGb3VuZCBDYXJkIElEIGluIGxlZ2FjeSBmaWVsZCBmb3JtYXQ6JywgY2FyZElkKTtcclxuICAgICAgICByZXR1cm4gY2FyZElkO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW0lPQ0ZpZWxkRXh0cmFjdG9yc10gTm8gQ2FyZCBJRCBmb3VuZCcpO1xyXG4gICAgcmV0dXJuICcnO1xyXG59XHJcbiIsICIvKipcclxuICogSU9DQ2FyZHNUeXBlcy50cyAtIElPQyAoSW5kaWNhdG9yIG9mIENvbXByb21pc2UpIHR5cGUgZGVmaW5pdGlvbnMuXHJcbiAqXHJcbiAqIERlZmluZXMgdGhlIDE2IGJ1aWx0LWluIElPQyB0eXBlcyB1c2VkIGFjcm9zcyB0aGUgcGx1Z2luOiBJUCBBZGRyZXNzLCBEb21haW4sXHJcbiAqIEZpbGUgSGFzaCwgVVJMLCBFbWFpbCwgSG9zdG5hbWUsIFlBUkEgUnVsZSwgU2lnbWEgUnVsZSwgUmVnaXN0cnkgS2V5LFxyXG4gKiBQcm9jZXNzIE5hbWUsIE5ldHdvcmssIENvbW1hbmQgTGluZSwgRmlsZSwgTm90ZSwgRExMLCBhbmQgQzIuXHJcbiAqXHJcbiAqIEVhY2ggSU9DIHR5cGUgY2FycmllcyBpdHMgb3duIGRpc3BsYXkgbWV0YWRhdGEgKGNvbG9yLCBpbmxpbmUgU1ZHIGljb24pIGFuZCBhXHJcbiAqIGxpc3Qgb2YgZm9yZW5zaWMgZmllbGRzIHRoYXQgYW5hbHlzdHMgZmlsbCBpbiBvbiB0aGUgY2FudmFzIGNhcmQuIFRoZSB0aW1lbGluZVxyXG4gKiBwcm9jZXNzb3JzIGlkZW50aWZ5IGNhcmQgdHlwZXMgYnkgcmVnZXgtbWF0Y2hpbmcgYElPQ0ZpZWxkLm5hbWVgIGFnYWluc3Qgbm9kZVxyXG4gKiB0ZXh0LCBzbyB0aGUgYG5hbWVgIHZhbHVlIGRvdWJsZXMgYXMgYSBkaXNwbGF5IGxhYmVsIGFuZCBhIGRldGVjdGlvbiBrZXkuXHJcbiAqXHJcbiAqIFNWRyBpY29ucyBhcmUgc3RvcmVkIGFzIGlubGluZSBzdHJpbmdzIGhlcmUgKG5vdCBsb2FkZWQgZnJvbSB0aGUgaWNvbnMvXHJcbiAqIGRpcmVjdG9yeSkgc28gdGhlIGNhbnZhcyBjYXJkcyByZW1haW4gc2VsZi1jb250YWluZWQgbWFya2Rvd24rSFRNTC5cclxuICovXHJcblxyXG4vKiogRGVzY3JpYmVzIGEgc2luZ2xlIElPQyB0eXBlIGFuZCBpdHMgdmlzdWFsL3N0cnVjdHVyYWwgbWV0YWRhdGEuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgSU9DRmllbGQge1xyXG4gICAgLyoqIEh1bWFuLXJlYWRhYmxlIG5hbWUgc2hvd24gb24gdGhlIGNhcmQgaGVhZGVyOyBhbHNvIHVzZWQgZm9yIHJlZ2V4IG1hdGNoaW5nIGJ5IHRpbWVsaW5lIHByb2Nlc3NvcnMuICovXHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICAvKiogT2JzaWRpYW4gaWNvbiBpZGVudGlmaWVyIHVzZWQgZm9yIHJpYmJvbi9jb21tYW5kIHBhbGV0dGUgZW50cmllcy4gKi9cclxuICAgIGljb246IHN0cmluZztcclxuICAgIC8qKiBIZXggY29sb3IgYXBwbGllZCB0byB0aGUgY2FyZCBoZWFkZXIgZ3JhZGllbnQsIGJvcmRlciwgYW5kIHRpbWVsaW5lIGhpZ2hsaWdodHMuICovXHJcbiAgICBjb2xvcjogc3RyaW5nO1xyXG4gICAgLyoqIEFuYWx5c3QtZWRpdGFibGUgZmllbGRzIHJlbmRlcmVkIGFzIGxhYmVsZWQgY29kZSBibG9ja3Mgb24gdGhlIGNhcmQuICovXHJcbiAgICBmaWVsZHM6IHN0cmluZ1tdO1xyXG4gICAgLyoqIElubGluZSBTVkcgbWFya3VwIGZvciB0aGUgY2FyZCBoZWFkZXIgaWNvbiAoMzJ4MzIsIHN0cm9rZS1iYXNlZCkuICovXHJcbiAgICBzdmc6IHN0cmluZztcclxuICAgIC8qKiBPcHRpb25hbCBPUy1zcGVjaWZpYyBpY29uIHZhcmlhbnRzIC0tIG9ubHkgdXNlZCBieSB0aGUgSG9zdG5hbWUgdHlwZVxyXG4gICAgICogIHRvIGxldCBhbmFseXN0cyBwaWNrIGEgcGxhdGZvcm0gd2hlbiBjcmVhdGluZyB0aGUgY2FyZC4gKi9cclxuICAgIG9zX2ljb25zPzoge1xyXG4gICAgICB3aW5kb3dzX3dvcmtzdGF0aW9uOiBzdHJpbmc7XHJcbiAgICAgIHdpbmRvd3Nfc2VydmVyOiBzdHJpbmc7XHJcbiAgICAgIG1hY29zOiBzdHJpbmc7XHJcbiAgICAgIGxpbnV4OiBzdHJpbmc7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqIERpY3Rpb25hcnkgbWFwcGluZyBJT0MgdHlwZSBrZXlzIChzbmFrZV9jYXNlIElEcykgdG8gdGhlaXIgZmllbGQgZGVmaW5pdGlvbnMuICovXHJcbiAgZXhwb3J0IGludGVyZmFjZSBJT0NDYXJkc1R5cGVzIHtcclxuICAgIFtrZXk6IHN0cmluZ106IElPQ0ZpZWxkO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTWFzdGVyIHJlZ2lzdHJ5IG9mIGFsbCBJT0MgdHlwZXMuIEtleXMgYXJlIHN0YWJsZSBzbmFrZV9jYXNlIGlkZW50aWZpZXJzXHJcbiAgICogKGUuZy4gXCJpcF9hZGRyZXNzXCIsIFwiZmlsZV9oYXNoXCIpIHVzZWQgYXMgaW50ZXJuYWwgcmVmZXJlbmNlcyB0aHJvdWdob3V0IHRoZVxyXG4gICAqIHBsdWdpbi5cclxuICAgKi9cclxuICBleHBvcnQgY29uc3QgSU9DX1RZUEVTOiBJT0NDYXJkc1R5cGVzID0ge1xyXG4gICAgLy8gLS0tIE5ldHdvcmstcmVsYXRlZCBJT0MgdHlwZXMgLS0tXHJcblxyXG4gICAgaXBfYWRkcmVzczoge1xyXG4gICAgICBuYW1lOiAnSVAgQWRkcmVzcycsXHJcbiAgICAgIGljb246ICduZXR3b3JrJyxcclxuICAgICAgY29sb3I6ICcjRkY2QjZCJyxcclxuICAgICAgZmllbGRzOiBbJ0lQJywgJ2NvdW50cnknLCAnYXNuJ10sXHJcbiAgICAgIHN2ZzogYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiB3aWR0aD1cIjMyXCIgaGVpZ2h0PVwiMzJcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj5cclxuICA8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjE1XCIgcj1cIjdcIi8+XHJcbiAgPHBhdGggZD1cIk0xMiA4Yy0zLjkgMC03IDMuMS03IDdcIi8+XHJcbiAgPHBhdGggZD1cIk0xMiA4YzMuOSAwIDcgMy4xIDcgN1wiLz5cclxuICA8bGluZSB4MT1cIjVcIiB5MT1cIjE1XCIgeDI9XCIxOVwiIHkyPVwiMTVcIi8+XHJcbiAgPGxpbmUgeDE9XCIxMlwiIHkxPVwiOFwiIHgyPVwiMTJcIiB5Mj1cIjIyXCIvPlxyXG4gIDxwYXRoIGQ9XCJNMTIgOGMtMS43LTMtMS43LTYgMC02czEuNyAzIDAgNnpcIi8+XHJcbiAgPGNpcmNsZSBjeD1cIjEyXCIgY3k9XCI0XCIgcj1cIjJcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxyXG48L3N2Zz5gXHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICBkb21haW46IHtcclxuICAgICAgbmFtZTogJ0RvbWFpbiBOYW1lJyxcclxuICAgICAgaWNvbjogJ2dsb2JlJyxcclxuICAgICAgY29sb3I6ICcjNEVDREM0JyxcclxuICAgICAgZmllbGRzOiBbJ25hbWUnLCAnSVAnXSxcclxuICAgICAgc3ZnOiBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHdpZHRoPVwiMzJcIiBoZWlnaHQ9XCIzMlwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPlxyXG4gICAgPGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxMFwiLz5cclxuICAgIDxsaW5lIHgxPVwiMlwiIHkxPVwiMTJcIiB4Mj1cIjIyXCIgeTI9XCIxMlwiLz5cclxuICAgIDxwYXRoIGQ9XCJNMTIgMmExNS4zIDE1LjMgMCAwIDEgNCAxMCAxNS4zIDE1LjMgMCAwIDEtNCAxMCAxNS4zIDE1LjMgMCAwIDEtNC0xMCAxNS4zIDE1LjMgMCAwIDEgNC0xMHpcIi8+XHJcbiAgPC9zdmc+YFxyXG4gICAgfSxcclxuICAgIFxyXG4gICAgZmlsZV9oYXNoOiB7XHJcbiAgICAgIG5hbWU6ICdGaWxlIEhhc2gnLFxyXG4gICAgICBpY29uOiAnaGFzaCcsXHJcbiAgICAgIGNvbG9yOiAnIzQ1QjdEMScsXHJcbiAgICAgIGZpZWxkczogWydoYXNoJywgJ2hhc2hfdHlwZScsICdmaWxlbmFtZScsICdmaWxlX3NpemUnXSxcclxuICAgICAgc3ZnOiBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHdpZHRoPVwiMzJcIiBoZWlnaHQ9XCIzMlwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPlxyXG4gICAgPGxpbmUgeDE9XCI0XCIgeTE9XCI5XCIgeDI9XCIyMFwiIHkyPVwiOVwiLz5cclxuICAgIDxsaW5lIHgxPVwiNFwiIHkxPVwiMTVcIiB4Mj1cIjIwXCIgeTI9XCIxNVwiLz5cclxuICAgIDxsaW5lIHgxPVwiMTBcIiB5MT1cIjNcIiB4Mj1cIjhcIiB5Mj1cIjIxXCIvPlxyXG4gICAgPGxpbmUgeDE9XCIxNlwiIHkxPVwiM1wiIHgyPVwiMTRcIiB5Mj1cIjIxXCIvPlxyXG4gIDwvc3ZnPmBcclxuICAgIH0sXHJcbiAgICBcclxuICAgIHVybDoge1xyXG4gICAgICBuYW1lOiAnVVJMJyxcclxuICAgICAgaWNvbjogJ2xpbmsnLFxyXG4gICAgICBjb2xvcjogJyM5NkNFQjQnLFxyXG4gICAgICBmaWVsZHM6IFsndXJsJywgJ2RvbWFpbicsICdjYXRlZ29yeSddLFxyXG4gICAgICBzdmc6IGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgd2lkdGg9XCIzMlwiIGhlaWdodD1cIjMyXCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+XHJcbiAgICA8cGF0aCBkPVwiTTEwIDEzYTUgNSAwIDAgMCA3LjU0LjU0bDMtM2E1IDUgMCAwIDAtNy4wNy03LjA3bC0xLjcyIDEuNzFcIi8+XHJcbiAgICA8cGF0aCBkPVwiTTE0IDExYTUgNSAwIDAgMC03LjU0LS41NGwtMyAzYTUgNSAwIDAgMCA3LjA3IDcuMDdsMS43MS0xLjcxXCIvPlxyXG4gIDwvc3ZnPmBcclxuICAgIH0sXHJcbiAgICBcclxuICAgIGVtYWlsOiB7XHJcbiAgICAgIG5hbWU6ICdFbWFpbCBBZGRyZXNzJyxcclxuICAgICAgaWNvbjogJ21haWwnLFxyXG4gICAgICBjb2xvcjogJyNGRUNBNTcnLFxyXG4gICAgICBmaWVsZHM6IFsnZW1haWwnLCAnZG9tYWluJ10sXHJcbiAgICAgIHN2ZzogYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiB3aWR0aD1cIjMyXCIgaGVpZ2h0PVwiMzJcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj5cclxuICAgIDxwYXRoIGQ9XCJNNCA0aDE2YzEuMSAwIDIgLjkgMiAydjEyYzAgMS4xLS45IDItMiAySDRjLTEuMSAwLTItLjktMi0yVjZjMC0xLjEuOS0yIDItMnpcIi8+XHJcbiAgICA8cG9seWxpbmUgcG9pbnRzPVwiMjIsNiAxMiwxMyAyLDZcIi8+XHJcbiAgPC9zdmc+YFxyXG4gICAgfSxcclxuICAgIFxyXG4gICAgLy8gSG9zdG5hbWUgaXMgdGhlIG9ubHkgSU9DIHR5cGUgd2l0aCBvc19pY29ucywgdHJpZ2dlcmluZyBhIHNlY29uZGFyeVxyXG4gICAgLy8gT1Mgc2VsZWN0b3Igc3ViLXZpZXcgaW4gUmVuZGVySU9DQ2FyZHNNb2RhbCBiZWZvcmUgY2FyZCBjcmVhdGlvbi5cclxuICAgIGhvc3RuYW1lOiB7XHJcbiAgICAgIG5hbWU6ICdIb3N0bmFtZScsXHJcbiAgICAgIGljb246ICdtb25pdG9yJyxcclxuICAgICAgY29sb3I6ICcjOUMyN0IwJyxcclxuICAgICAgZmllbGRzOiBbJ2hvc3RuYW1lJywgJ29zX3R5cGUnLCAnZG9tYWluJ10sXHJcbiAgICAgIHN2ZzogYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiB3aWR0aD1cIjMyXCIgaGVpZ2h0PVwiMzJcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj5cclxuICAgIDxyZWN0IHg9XCIyXCIgeT1cIjNcIiB3aWR0aD1cIjIwXCIgaGVpZ2h0PVwiMTRcIiByeD1cIjJcIiByeT1cIjJcIi8+XHJcbiAgICA8bGluZSB4MT1cIjhcIiB5MT1cIjIxXCIgeDI9XCIxNlwiIHkyPVwiMjFcIi8+XHJcbiAgICA8bGluZSB4MT1cIjEyXCIgeTE9XCIxN1wiIHgyPVwiMTJcIiB5Mj1cIjIxXCIvPlxyXG4gIDwvc3ZnPmAsXHJcbiAgICAgIG9zX2ljb25zOiB7XHJcbiAgICAgICAgd2luZG93c193b3Jrc3RhdGlvbjogYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiB3aWR0aD1cIjMyXCIgaGVpZ2h0PVwiMzJcIiBmaWxsPVwiY3VycmVudENvbG9yXCI+XHJcbiAgICA8cGF0aCBkPVwiTTAgMy41TDEwIDJ2OS41SDBWMy41ek0xMSAxLjlsMTMtMS45djExSDExVjEuOXpNMCAxMi41aDEwVjIybC0xMC0xLjV2LTh6TTExIDEyaDEzdjEwbC0xMyAydi0xMnpcIi8+XHJcbiAgPC9zdmc+YCxcclxuICAgICAgICB3aW5kb3dzX3NlcnZlcjogYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiB3aWR0aD1cIjMyXCIgaGVpZ2h0PVwiMzJcIiBmaWxsPVwiY3VycmVudENvbG9yXCI+XHJcbiAgICA8cGF0aCBkPVwiTTAgMy41TDEwIDJ2OS41SDBWMy41ek0xMSAxLjlsMTMtMS45djExSDExVjEuOXpNMCAxMi41aDEwVjIybC0xMC0xLjV2LTh6TTExIDEyaDEzdjEwbC0xMyAydi0xMnpcIi8+XHJcbiAgPC9zdmc+YCxcclxuICAgICAgICBtYWNvczogYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiB3aWR0aD1cIjMyXCIgaGVpZ2h0PVwiMzJcIiBmaWxsPVwiY3VycmVudENvbG9yXCI+XHJcbiAgICA8cGF0aCBkPVwiTTE3LjA1IDIwLjI4Yy0uOTguOTUtMi4wNS44LTMuMDguMzUtMS4wOS0uNDYtMi4wOS0uNDgtMy4yNCAwLTEuNDQuNjItMi4yLjQ0LTMuMDYtLjM1QzIuNzkgMTUuMjUgMy41MSA3LjU5IDkuMDUgNy4zMWMxLjM1LjA3IDIuMjkuNzQgMy4wOC44IDEuMTgtLjI0IDIuMzEtLjkzIDMuNTctLjg0IDEuNTEuMTIgMi42NS43MiAzLjQgMS44LTMuMTIgMS44Ny0yLjM4IDUuOTguNDggNy4xMy0uNTcgMS41LTEuMzEgMi45OS0yLjU0IDQuMDlsLjAxLS4wMXpNMTIuMDMgNy4yNWMtLjE1LTIuMjMgMS42Ni00LjA3IDMuNzQtNC4yNS4yOSAyLjU4LTIuMzQgNC41LTMuNzQgNC4yNXpcIi8+XHJcbiAgPC9zdmc+YCxcclxuICAgICAgICBsaW51eDogYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiB3aWR0aD1cIjMyXCIgaGVpZ2h0PVwiMzJcIiBmaWxsPVwiY3VycmVudENvbG9yXCI+XHJcbiAgICA8cGF0aCBkPVwiTTEyLjUwNCAwYy0uMTU1IDAtLjMxNS4wMDgtLjQ4LjAyMS00LjIyNi4zMzMtMy4xMDUgNC44MDctMy4xNyA2LjI5OC0uMDc2IDEuMDkyLS4zIDEuOTUzLTEuMDUgMy4wMi0uODg1IDEuMDUxLTIuMTI3IDIuNzUtMi43MTYgNC41MjEtLjI3OC44NC0uNDEgMS42ODQtLjI4NyAyLjQ4OS44NDUgNS41NDggNS42NzYgNi4wMTYgNi44NTUgNi4wMTYuMTc4IDAgLjI4Ny0uMDE2LjI4Ny0uMDE2czguMDI5LS4xOTIgOC4wMy04LjA0N2MwLTQuNjYyLTMuOTE2LTkuNjktNy40Ny0xNC4zMDJ6XCIvPlxyXG4gIDwvc3ZnPmBcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIFxyXG4gICAgLy8gLS0tIERldGVjdGlvbiBydWxlIHR5cGVzIC0tLVxyXG5cclxuICAgIHlhcmFfcnVsZToge1xyXG4gICAgICBuYW1lOiAnWUFSQSBSdWxlJyxcclxuICAgICAgaWNvbjogJ3NoaWVsZCcsXHJcbiAgICAgIGNvbG9yOiAnI0ZGOUZGMycsXHJcbiAgICAgIGZpZWxkczogWydydWxlX25hbWUnLCAncnVsZV9jb250ZW50J10sXHJcbiAgICAgIHN2ZzogYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiB3aWR0aD1cIjMyXCIgaGVpZ2h0PVwiMzJcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj5cclxuICAgIDxwYXRoIGQ9XCJNMTIgMjJzOC00IDgtMTBWNWwtOC0zLTggM3Y3YzAgNiA4IDEwIDggMTB6XCIvPlxyXG4gICAgPHRleHQgeD1cIjEyXCIgeT1cIjE1XCIgZm9udC1zaXplPVwiMTBcIiB0ZXh0LWFuY2hvcj1cIm1pZGRsZVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIiBmb250LXdlaWdodD1cImJvbGRcIj5ZPC90ZXh0PlxyXG4gIDwvc3ZnPmBcclxuICAgIH0sXHJcbiAgICBcclxuICAgIHNpZ21hX3J1bGU6IHtcclxuICAgICAgbmFtZTogJ1NpZ21hIFJ1bGUnLFxyXG4gICAgICBpY29uOiAnc2VhcmNoJyxcclxuICAgICAgY29sb3I6ICcjQThFNkNGJyxcclxuICAgICAgZmllbGRzOiBbJ3J1bGVfbmFtZScsICdydWxlX2NvbnRlbnQnXSxcclxuICAgICAgc3ZnOiBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHdpZHRoPVwiMzJcIiBoZWlnaHQ9XCIzMlwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPlxyXG4gICAgPGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxMFwiLz5cclxuICAgIDx0ZXh0IHg9XCIxMlwiIHk9XCIxN1wiIGZvbnQtc2l6ZT1cIjE0XCIgdGV4dC1hbmNob3I9XCJtaWRkbGVcIiBmaWxsPVwiY3VycmVudENvbG9yXCIgZm9udC13ZWlnaHQ9XCJib2xkXCI+XHUwM0EzPC90ZXh0PlxyXG4gIDwvc3ZnPmBcclxuICAgIH0sXHJcbiAgICBcclxuICAgIC8vIC0tLSBIb3N0LWJhc2VkIElPQyB0eXBlcyAtLS1cclxuXHJcbiAgICByZWdpc3RyeV9rZXk6IHtcclxuICAgICAgbmFtZTogJ1JlZ2lzdHJ5IEtleScsXHJcbiAgICAgIGljb246ICdzZXR0aW5ncycsXHJcbiAgICAgIGNvbG9yOiAnI0ZGQjc0RCcsXHJcbiAgICAgIGZpZWxkczogWydrZXlfcGF0aCcsICdrZXlfbmFtZScsICdrZXlfZGF0YSddLFxyXG4gICAgICBzdmc6IGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgd2lkdGg9XCIzMlwiIGhlaWdodD1cIjMyXCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+XHJcbiAgICA8cmVjdCB4PVwiM1wiIHk9XCIxMVwiIHdpZHRoPVwiMThcIiBoZWlnaHQ9XCIxMVwiIHJ4PVwiMlwiIHJ5PVwiMlwiLz5cclxuICAgIDxwYXRoIGQ9XCJNNyAxMVY3YTUgNSAwIDAgMSA5LjktMVwiLz5cclxuICA8L3N2Zz5gXHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICBwcm9jZXNzX25hbWU6IHtcclxuICAgICAgbmFtZTogJ1Byb2Nlc3MgTmFtZScsXHJcbiAgICAgIGljb246ICdjcHUnLFxyXG4gICAgICBjb2xvcjogJyM4MUM3ODQnLFxyXG4gICAgICBmaWVsZHM6IFsncHJvY2Vzc19uYW1lJywgJ2NvbW1hbmRfbGluZScsICdwaWQnLCAncGFyZW50X3Byb2Nlc3MnXSxcclxuICAgICAgc3ZnOiBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHdpZHRoPVwiMzJcIiBoZWlnaHQ9XCIzMlwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPlxyXG4gIDxyZWN0IHg9XCIzXCIgeT1cIjVcIiB3aWR0aD1cIjE4XCIgaGVpZ2h0PVwiMTRcIiByeD1cIjJcIiByeT1cIjJcIi8+XHJcbiAgPGxpbmUgeDE9XCIzXCIgeTE9XCI5XCIgeDI9XCIyMVwiIHkyPVwiOVwiLz5cclxuICA8Y2lyY2xlIGN4PVwiNlwiIGN5PVwiN1wiIHI9XCIwLjhcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxyXG4gIDxjaXJjbGUgY3g9XCI5XCIgY3k9XCI3XCIgcj1cIjAuOFwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XHJcbiAgPGxpbmUgeDE9XCI3XCIgeTE9XCIxM1wiIHgyPVwiMTdcIiB5Mj1cIjEzXCIvPlxyXG4gIDxsaW5lIHgxPVwiN1wiIHkxPVwiMTZcIiB4Mj1cIjE0XCIgeTI9XCIxNlwiLz5cclxuPC9zdmc+YFxyXG4gICAgfSxcclxuICAgIFxyXG4gICAgbmV0d29yazoge1xyXG4gICAgICBuYW1lOiAnTmV0d29yaycsXHJcbiAgICAgIGljb246ICdhY3Rpdml0eScsXHJcbiAgICAgIGNvbG9yOiAnIzk1NzVDRCcsXHJcbiAgICAgIGZpZWxkczogWydwcm90b2NvbCcsICdwb3J0JywgJ2RpcmVjdGlvbiddLFxyXG4gICAgICBzdmc6IGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgd2lkdGg9XCIzMlwiIGhlaWdodD1cIjMyXCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+XHJcbiAgICA8cG9seWxpbmUgcG9pbnRzPVwiMjIgMTIgMTggMTIgMTUgMjEgOSAzIDYgMTIgMiAxMlwiLz5cclxuICA8L3N2Zz5gXHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICBjb21tYW5kX2xpbmU6IHtcclxuICAgICAgbmFtZTogJ0NvbW1hbmQgTGluZScsXHJcbiAgICAgIGljb246ICd0ZXJtaW5hbCcsXHJcbiAgICAgIGNvbG9yOiAnIzJFOEI1NycsXHJcbiAgICAgIGZpZWxkczogWydjb21tYW5kJywgJ3BpZCcsICdwYXJlbnRfcHJvY2VzcyddLFxyXG4gICAgICBzdmc6IGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgd2lkdGg9XCIzMlwiIGhlaWdodD1cIjMyXCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+XHJcbiAgICA8cG9seWxpbmUgcG9pbnRzPVwiNCAxNyAxMCAxMSA0IDVcIi8+XHJcbiAgICA8bGluZSB4MT1cIjEyXCIgeTE9XCIxOVwiIHgyPVwiMjBcIiB5Mj1cIjE5XCIvPlxyXG4gIDwvc3ZnPmBcclxuICAgIH0sXHJcblxyXG4gICAgLy8gLS0tIEZpbGUgYW5kIGFydGlmYWN0IHR5cGVzIC0tLVxyXG5cclxuICAgIGZpbGU6IHtcclxuICAgICAgbmFtZTogJ0ZpbGUnLFxyXG4gICAgICBpY29uOiAnZmlsZScsXHJcbiAgICAgIGNvbG9yOiAnI0U5MUU2MycsXHJcbiAgICAgIGZpZWxkczogWyduYW1lJywgJ3R5cGUnLCAncGF0aCcsICdzaXplJywgJ2hhc2gnLCAncGlkJ10sXHJcbiAgICAgIHN2ZzogYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiB3aWR0aD1cIjMyXCIgaGVpZ2h0PVwiMzJcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj5cclxuICA8cGF0aCBkPVwiTTQgNGgxMmw0IDR2MTJhMiAyIDAgMCAxLTIgMkg0YTIgMiAwIDAgMS0yLTJWNmEyIDIgMCAwIDEgMi0yelwiLz5cclxuICA8bGluZSB4MT1cIjhcIiB5MT1cIjExXCIgeDI9XCIxNlwiIHkyPVwiMTFcIi8+XHJcbiAgPGxpbmUgeDE9XCI4XCIgeTE9XCIxNVwiIHgyPVwiMTZcIiB5Mj1cIjE1XCIvPlxyXG48L3N2Zz5gXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIC0tLSBVdGlsaXR5IHR5cGVzIC0tLVxyXG5cclxuICAgIG5vdGU6IHtcclxuICAgICAgbmFtZTogJ05vdGUnLFxyXG4gICAgICBpY29uOiAnbm90ZScsXHJcbiAgICAgIGNvbG9yOiAnI0YzOUMxMicsXHJcbiAgICAgIGZpZWxkczogWydOQiddLFxyXG4gICAgICBzdmc6IGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgd2lkdGg9XCIzMlwiIGhlaWdodD1cIjMyXCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+XHJcbiAgPHJlY3QgeD1cIjRcIiB5PVwiNFwiIHdpZHRoPVwiMTZcIiBoZWlnaHQ9XCIxNlwiIHJ4PVwiMlwiIHJ5PVwiMlwiLz5cclxuICA8bGluZSB4MT1cIjhcIiB5MT1cIjhcIiB4Mj1cIjE2XCIgeTI9XCI4XCIvPlxyXG4gIDxsaW5lIHgxPVwiOFwiIHkxPVwiMTJcIiB4Mj1cIjE2XCIgeTI9XCIxMlwiLz5cclxuICA8bGluZSB4MT1cIjhcIiB5MT1cIjE2XCIgeDI9XCIxNFwiIHkyPVwiMTZcIi8+XHJcbjwvc3ZnPmBcclxuICAgIH0sXHJcblxyXG4gICAgZGxsOiB7XHJcbiAgICAgIG5hbWU6ICdETEwnLFxyXG4gICAgICBpY29uOiAnZGxsJyxcclxuICAgICAgY29sb3I6ICcjMzQ5OERCJyxcclxuICAgICAgZmllbGRzOiBbJ25hbWUnLCAndHlwZScsICdwYXRoJywgJ3NpemUnLCAnaGFzaCddLFxyXG4gICAgICBzdmc6IGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgd2lkdGg9XCIzMlwiIGhlaWdodD1cIjMyXCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+XHJcbiAgPHBhdGggZD1cIk0xNCAySDZhMiAyIDAgMCAwLTIgMnYxNmEyIDIgMCAwIDAgMiAyaDEyYTIgMiAwIDAgMCAyLTJWOGwtNi02elwiLz5cclxuICA8cG9seWxpbmUgcG9pbnRzPVwiMTQgMiAxNCA4IDIwIDhcIi8+XHJcbiAgPGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxM1wiIHI9XCIyXCIvPlxyXG4gIDxwYXRoIGQ9XCJNMTIgMTAuNXYtMVwiLz5cclxuICA8cGF0aCBkPVwiTTEyIDE1LjV2MVwiLz5cclxuICA8cGF0aCBkPVwiTTE0LjUgMTEuNWwwLjctMC43XCIvPlxyXG4gIDxwYXRoIGQ9XCJNOS44IDE2LjJsLTAuNyAwLjdcIi8+XHJcbiAgPHBhdGggZD1cIk0xNS41IDEzaDFcIi8+XHJcbiAgPHBhdGggZD1cIk04LjUgMTNoLTFcIi8+XHJcbiAgPHBhdGggZD1cIk0xNC41IDE0LjVsMC43IDAuN1wiLz5cclxuICA8cGF0aCBkPVwiTTkuOCA5LjhsLTAuNy0wLjdcIi8+XHJcbjwvc3ZnPmBcclxuICAgIH0sXHJcblxyXG4gICAgLy8gLS0tIFRocmVhdCBpbmZyYXN0cnVjdHVyZSAtLS1cclxuXHJcbiAgICBjMjoge1xyXG4gICAgICBuYW1lOiAnQzInLFxyXG4gICAgICBpY29uOiAnYzInLFxyXG4gICAgICBjb2xvcjogJyNFNzRDM0MnLFxyXG4gICAgICBmaWVsZHM6IFsnZG9tYWluJywgJ0lQJ10sXHJcbiAgICAgIHN2ZzogYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiB3aWR0aD1cIjMyXCIgaGVpZ2h0PVwiMzJcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj5cclxuICA8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjlcIi8+XHJcbiAgPHBhdGggZD1cIk0xMiAzdjEuNVwiLz5cclxuICA8cGF0aCBkPVwiTTEyIDE5LjVWMjFcIi8+XHJcbiAgPHBhdGggZD1cIk0zIDEyaDEuNVwiLz5cclxuICA8cGF0aCBkPVwiTTE5LjUgMTJIMjFcIi8+XHJcbiAgPHBhdGggZD1cIk01LjYgNS42bDEuMSAxLjFcIi8+XHJcbiAgPHBhdGggZD1cIk0xNy4zIDE3LjNsMS4xIDEuMVwiLz5cclxuICA8cGF0aCBkPVwiTTUuNiAxOC40bDEuMS0xLjFcIi8+XHJcbiAgPHBhdGggZD1cIk0xNy4zIDYuN2wxLjEtMS4xXCIvPlxyXG4gIDxwb2x5bGluZSBwb2ludHM9XCI4IDEwIDExIDEzIDggMTZcIi8+XHJcbiAgPGxpbmUgeDE9XCIxM1wiIHkxPVwiMTZcIiB4Mj1cIjE2XCIgeTI9XCIxNlwiLz5cclxuPC9zdmc+YFxyXG4gICAgfVxyXG4gIH07XHJcbiAgIiwgIi8qKlxyXG4gKiBJT0NWaXN1YWxMb29rdXAudHMgLSBJT0MgdHlwZSB2aXN1YWwgbWV0YWRhdGEgbG9va3VwXHJcbiAqXHJcbiAqIFJlc29sdmVzIHRoZSBTVkcgaWNvbiBhbmQgaGV4IGNvbG9yIGZvciBhIGRldGVjdGVkIElPQyB0eXBlIG5hbWUgYnlcclxuICogc2VhcmNoaW5nIHRoZSBJT0NfVFlQRVMgcmVnaXN0cnkuIFVzZWQgYnkgSU9DUGFyc2VyIGFmdGVyIHR5cGUgZGV0ZWN0aW9uXHJcbiAqIHRvIGF0dGFjaCBkaXNwbGF5IG1ldGFkYXRhIHRvIHBhcnNlZCBub2RlIGRhdGEuXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgSU9DX1RZUEVTIH0gZnJvbSAnLi4vdHlwZXMvSU9DQ2FyZHNUeXBlcyc7XHJcblxyXG4vKipcclxuICogTG9vayB1cCB0aGUgU1ZHIGljb24gYW5kIGhleCBjb2xvciBmb3IgYSBnaXZlbiBJT0MgdHlwZSBuYW1lLlxyXG4gKlxyXG4gKiBTZWFyY2hlcyB0aGUgSU9DX1RZUEVTIGNvbnN0YW50IChmcm9tIElPQ0NhcmRzVHlwZXMudHMpIGJ5IGNvbXBhcmluZ1xyXG4gKiBlYWNoIGVudHJ5J3MgYG5hbWVgIHByb3BlcnR5IGFnYWluc3QgdGhlIGRldGVjdGVkIHR5cGUgc3RyaW5nLlxyXG4gKiBSZXR1cm5zIGRlZmF1bHRzIGlmIG5vIG1hdGNoIGlzIGZvdW5kIChlbXB0eSBpY29uLCBmYWxsYmFjayBjb2xvcikuXHJcbiAqXHJcbiAqIEBwYXJhbSBpb2NUeXBlIC0gRGV0ZWN0ZWQgSU9DIHR5cGUgbmFtZSAoZS5nLiwgXCJJUCBBZGRyZXNzXCIpXHJcbiAqIEBwYXJhbSBmYWxsYmFja0NvbG9yIC0gQ29sb3IgdG8gdXNlIGlmIHRoZSB0eXBlIGlzIG5vdCBmb3VuZCBpbiBJT0NfVFlQRVNcclxuICogQHJldHVybnMgT2JqZWN0IHdpdGggYGljb25gIChTVkcgc3RyaW5nKSBhbmQgYGNvbG9yYCAoaGV4IHN0cmluZylcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBsb29rdXBUeXBlVmlzdWFscyhpb2NUeXBlOiBzdHJpbmcsIGZhbGxiYWNrQ29sb3I6IHN0cmluZyk6IHsgaWNvbjogc3RyaW5nOyBjb2xvcjogc3RyaW5nIH0ge1xyXG4gICAgbGV0IGljb24gPSAnJztcclxuICAgIGxldCBjb2xvciA9IGZhbGxiYWNrQ29sb3I7XHJcblxyXG4gICAgaWYgKElPQ19UWVBFUyAmJiB0eXBlb2YgSU9DX1RZUEVTID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKElPQ19UWVBFUykpIHtcclxuICAgICAgICAgICAgaWYgKElPQ19UWVBFU1trZXldLm5hbWUgPT09IGlvY1R5cGUpIHtcclxuICAgICAgICAgICAgICAgIGljb24gPSBJT0NfVFlQRVNba2V5XS5zdmc7XHJcbiAgICAgICAgICAgICAgICBjb2xvciA9IElPQ19UWVBFU1trZXldLmNvbG9yO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgaWNvbiwgY29sb3IgfTtcclxufVxyXG4iLCAiLyoqXHJcbiAqIElPQ1BhcnNlci50cyAtIFNoYXJlZCBJT0Mgbm9kZSBwYXJzaW5nIG9yY2hlc3RyYXRvclxyXG4gKlxyXG4gKiBTaW5nbGUgZW50cnkgcG9pbnQgZm9yIHBhcnNpbmcgSU9DIGNhbnZhcyBub2Rlcy4gRGVsZWdhdGVzIHRvOlxyXG4gKiAtIElPQ1R5cGVEZXRlY3Rpb246IHJlZ2V4IHBhdHRlcm4gbWF0Y2hpbmcgZm9yIElPQyB0eXBlIGlkZW50aWZpY2F0aW9uXHJcbiAqIC0gSU9DRmllbGRFeHRyYWN0b3JzOiB2YWx1ZSwgdGltZSwgc3BsdW5rLCBNSVRSRSwgYW5kIGNhcmQgSUQgZXh0cmFjdGlvblxyXG4gKiAtIElPQ1Zpc3VhbExvb2t1cDogU1ZHIGljb24gYW5kIGNvbG9yIHJlc29sdXRpb24gZnJvbSBJT0NfVFlQRVMgcmVnaXN0cnlcclxuICpcclxuICogQ29uc3VtZXJzIGltcG9ydCBgcGFyc2VJT0NOb2RlYCBhbmQgYElPQ05vZGVEYXRhYCBmcm9tIHRoaXMgbW9kdWxlLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IERFQlVHIH0gZnJvbSAnLi4vZGVidWcnO1xyXG5cclxuLy8gUmUtZXhwb3J0IElPQ05vZGVEYXRhIGZyb20gaXRzIGNhbm9uaWNhbCBsb2NhdGlvbiBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eS5cclxuLy8gQ29uc3VtZXJzIHRoYXQgaW1wb3J0ZWQgeyBJT0NOb2RlRGF0YSB9IGZyb20gJy4vSU9DUGFyc2VyJyBjb250aW51ZSB0byB3b3JrLlxyXG5leHBvcnQgdHlwZSB7IElPQ05vZGVEYXRhIH0gZnJvbSAnLi4vdHlwZXMvSU9DTm9kZURhdGEnO1xyXG5pbXBvcnQgdHlwZSB7IElPQ05vZGVEYXRhIH0gZnJvbSAnLi4vdHlwZXMvSU9DTm9kZURhdGEnO1xyXG5cclxuLy8gU3ViLW1vZHVsZSBpbXBvcnRzXHJcbmltcG9ydCB7IGRldGVjdElPQ1R5cGUgfSBmcm9tICcuL0lPQ1R5cGVEZXRlY3Rpb24nO1xyXG5pbXBvcnQge1xyXG4gICAgZXh0cmFjdFZhbHVlLFxyXG4gICAgZXh0cmFjdFRpbWUsXHJcbiAgICBleHRyYWN0U3BsdW5rUXVlcnksXHJcbiAgICBleHRyYWN0VGFjdGljLFxyXG4gICAgZXh0cmFjdFRlY2huaXF1ZSxcclxuICAgIGV4dHJhY3RDYXJkSWQsXHJcbiAgICBleHRyYWN0Q2FyZFJvbGVcclxufSBmcm9tICcuL0lPQ0ZpZWxkRXh0cmFjdG9ycyc7XHJcbmltcG9ydCB7IGxvb2t1cFR5cGVWaXN1YWxzIH0gZnJvbSAnLi9JT0NWaXN1YWxMb29rdXAnO1xyXG5cclxuLyoqXHJcbiAqIFBhcnNlIGFuIE9ic2lkaWFuIGNhbnZhcyB0ZXh0IG5vZGUgYW5kIGV4dHJhY3Qgc3RydWN0dXJlZCBJT0MgZGF0YS5cclxuICpcclxuICogVGhpcyBpcyB0aGUgbWFpbiBlbnRyeSBwb2ludCB1c2VkIGJ5IHRpbWVsaW5lIHByb2Nlc3NvcnMgYW5kIHRoZSBNSVRSRVxyXG4gKiBtb2RhbC4gSXQgY29tYmluZXMgYWxsIGV4dHJhY3Rpb24gc3RlcHM6XHJcbiAqICAgMS4gRGV0ZWN0IElPQyB0eXBlIGZyb20gdGhlIG5vZGUncyB0ZXh0IGNvbnRlbnRcclxuICogICAyLiBFeHRyYWN0IHZhbHVlLCB0aW1lLCBzcGx1bmsgcXVlcnksIHRhY3RpYywgYW5kIHRlY2huaXF1ZVxyXG4gKiAgIDMuIExvb2sgdXAgdGhlIFNWRyBpY29uIGFuZCBjb2xvciBmcm9tIElPQ19UWVBFU1xyXG4gKlxyXG4gKiBAcGFyYW0gbm9kZSAtIEFuIE9ic2lkaWFuIGNhbnZhcyBub2RlIG9iamVjdCB3aXRoIGBpZGAsIGB0ZXh0YCwgYW5kXHJcbiAqICAgICAgICAgICAgICAgb3B0aW9uYWwgYGNvbG9yYCBwcm9wZXJ0aWVzXHJcbiAqIEByZXR1cm5zIElPQ05vZGVEYXRhIHdpdGggYWxsIGZpZWxkcyBwb3B1bGF0ZWQsIG9yIG51bGwgaWYgdGhlIG5vZGVcclxuICogICAgICAgICAgdGV4dCBkb2VzIG5vdCBtYXRjaCBhbnkga25vd24gSU9DIHR5cGVcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUlPQ05vZGUobm9kZTogYW55KTogSU9DTm9kZURhdGEgfCBudWxsIHtcclxuICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW0lPQ1BhcnNlcl0gPT09PT09PT09PT09PT09PT09PT0gUEFSU0lORyBOT0RFID09PT09PT09PT09PT09PT09PT09Jyk7XHJcbiAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tJT0NQYXJzZXJdIE5vZGUgSUQ6Jywgbm9kZS5pZCk7XHJcbiAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tJT0NQYXJzZXJdIFRleHQgbGVuZ3RoOicsIG5vZGUudGV4dD8ubGVuZ3RoIHx8IDApO1xyXG5cclxuICAgIGlmICghbm9kZS50ZXh0KSB7XHJcbiAgICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbSU9DUGFyc2VyXSBObyB0ZXh0IGNvbnRlbnQnKTtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTdGVwIDE6IERldGVjdCBJT0MgdHlwZVxyXG4gICAgY29uc3QgaW9jVHlwZSA9IGRldGVjdElPQ1R5cGUobm9kZS50ZXh0KTtcclxuICAgIGlmICghaW9jVHlwZSkge1xyXG4gICAgICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW0lPQ1BhcnNlcl0gTm8gSU9DIHR5cGUgZGV0ZWN0ZWQnKTtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW0lPQ1BhcnNlcl0gSU9DIFR5cGU6JywgaW9jVHlwZSk7XHJcblxyXG4gICAgLy8gU3RlcCAyOiBFeHRyYWN0IGZpZWxkIHZhbHVlc1xyXG4gICAgY29uc3QgdmFsdWUgPSBleHRyYWN0VmFsdWUobm9kZS50ZXh0KTtcclxuICAgIGNvbnN0IHRpbWUgPSBleHRyYWN0VGltZShub2RlLnRleHQpO1xyXG4gICAgY29uc3Qgc3BsdW5rUXVlcnkgPSBleHRyYWN0U3BsdW5rUXVlcnkobm9kZS50ZXh0KTtcclxuICAgIGNvbnN0IHRhY3RpYyA9IGV4dHJhY3RUYWN0aWMobm9kZS50ZXh0KTtcclxuICAgIGNvbnN0IHRlY2huaXF1ZSA9IGV4dHJhY3RUZWNobmlxdWUobm9kZS50ZXh0KTtcclxuICAgIGNvbnN0IGNhcmRJZCA9IGV4dHJhY3RDYXJkSWQobm9kZS50ZXh0KTtcclxuICAgIGNvbnN0IHJvbGUgPSBleHRyYWN0Q2FyZFJvbGUobm9kZS50ZXh0KTtcclxuXHJcbiAgICAvLyBTdGVwIDM6IExvb2sgdXAgaWNvbiBhbmQgY29sb3IgZnJvbSB0aGUgSU9DX1RZUEVTIGNvbnN0YW50XHJcbiAgICBjb25zdCBmYWxsYmFja0NvbG9yID0gbm9kZS5jb2xvciB8fCAnIzMzMyc7XHJcbiAgICBjb25zdCB7IGljb24sIGNvbG9yIH0gPSBsb29rdXBUeXBlVmlzdWFscyhpb2NUeXBlLCBmYWxsYmFja0NvbG9yKTtcclxuXHJcbiAgICBjb25zdCByZXN1bHQ6IElPQ05vZGVEYXRhID0ge1xyXG4gICAgICAgIGlkOiBub2RlLmlkLFxyXG4gICAgICAgIGNhcmRJZDogY2FyZElkLFxyXG4gICAgICAgIHR5cGU6IGlvY1R5cGUsXHJcbiAgICAgICAgdmFsdWUsXHJcbiAgICAgICAgdGltZSxcclxuICAgICAgICBzcGx1bmtRdWVyeSxcclxuICAgICAgICB0YWN0aWMsXHJcbiAgICAgICAgdGVjaG5pcXVlLFxyXG4gICAgICAgIGljb24sXHJcbiAgICAgICAgY29sb3IsXHJcbiAgICAgICAgLi4uKHJvbGUgPT09ICdjaGlsZCcgPyB7IGlzQ2hpbGQ6IHRydWUgfSA6IHt9KVxyXG4gICAgfTtcclxuXHJcbiAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tJT0NQYXJzZXJdIEVYVFJBQ1RJT04gQ09NUExFVEU6Jywge1xyXG4gICAgICAgIHR5cGU6IGlvY1R5cGUsXHJcbiAgICAgICAgY2FyZElkOiBjYXJkSWQgfHwgJyhubyBJRCknLFxyXG4gICAgICAgIHZhbHVlOiB2YWx1ZSB8fCAnKGVtcHR5KScsXHJcbiAgICAgICAgdGltZTogdGltZSB8fCAnKGVtcHR5KScsXHJcbiAgICAgICAgdGFjdGljOiB0YWN0aWMgfHwgJyhlbXB0eSknLFxyXG4gICAgICAgIHRlY2huaXF1ZTogdGVjaG5pcXVlIHx8ICcoZW1wdHkpJ1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcbiIsICIvKipcclxuICogVGltZVRpbWVsaW5lUHJvY2Vzc2luZy50cyAtIENocm9ub2xvZ2ljYWwgSU9DIHRpbWVsaW5lIGV4dHJhY3Rpb25cclxuICpcclxuICogUmVhZHMgYWxsIHRleHQgbm9kZXMgZnJvbSB0aGUgYWN0aXZlIE9ic2lkaWFuIGNhbnZhcywgcGFyc2VzIGVhY2ggb25lXHJcbiAqIGZvciBJT0MgZGF0YSB1c2luZyB0aGUgc2hhcmVkIElPQ1BhcnNlciwgYW5kIHJldHVybnMgdGhlbSBhcyBhIGZsYXRcclxuICogYXJyYXkgc3VpdGFibGUgZm9yIHRpbWUtYmFzZWQgc29ydGluZyBhbmQgZGlzcGxheS5cclxuICpcclxuICogVGhlIFJlbmRlclRpbWVsaW5lc01vZGFsIHNvcnRzIHRoZSByZXR1cm5lZCBhcnJheSBieSB0aGUgYHRpbWVgIGZpZWxkXHJcbiAqIHRvIHByb2R1Y2UgYSBjaHJvbm9sb2dpY2FsIGF0dGFjayB0aW1lbGluZSB2aWV3LlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgcGFyc2VJT0NOb2RlLCBJT0NOb2RlRGF0YSB9IGZyb20gJy4uL3BhcnNpbmcvSU9DUGFyc2VyJztcclxuaW1wb3J0IHsgREVCVUcgfSBmcm9tICcuLi9kZWJ1Zyc7XHJcblxyXG4vKipcclxuICogRXh0cmFjdCBJT0MgZGF0YSBmcm9tIGFsbCBjYW52YXMgdGV4dCBub2RlcyBmb3IgdGltZS1iYXNlZCB0aW1lbGluZS5cclxuICpcclxuICogSXRlcmF0ZXMgb3ZlciBldmVyeSBub2RlIGluIHRoZSBhY3RpdmUgY2FudmFzLiBFYWNoIG5vZGUgd2l0aCBhIGB0ZXh0YFxyXG4gKiBwcm9wZXJ0eSBpcyBwYXJzZWQgdmlhIHRoZSBzaGFyZWQgSU9DUGFyc2VyLiBOb2RlcyB0aGF0IG1hdGNoIGEga25vd25cclxuICogSU9DIHR5cGUgYXJlIGluY2x1ZGVkIGluIHRoZSByZXR1cm5lZCBhcnJheS5cclxuICpcclxuICogVGhlIGNhbGxlciAoUmVuZGVyVGltZWxpbmVzTW9kYWwpIHNvcnRzIHRoZSByZXN1bHQgYnkgdGltZSBmb3IgZGlzcGxheS5cclxuICpcclxuICogQHBhcmFtIGFwcCAtIE9ic2lkaWFuIEFwcCBpbnN0YW5jZVxyXG4gKiBAcmV0dXJucyBBcnJheSBvZiBwYXJzZWQgSU9DIG5vZGUgZGF0YSBvYmplY3RzLCB1bnNvcnRlZFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RGaXhlZElPQ0RhdGEoYXBwOiBBcHApOiBJT0NOb2RlRGF0YVtdIHtcclxuICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW1RpbWVQcm9jZXNzb3JdIFN0YXJ0aW5nIGV4dHJhY3Rpb24nKTtcclxuXHJcbiAgICBjb25zdCBhY3RpdmVMZWFmID0gYXBwLndvcmtzcGFjZS5hY3RpdmVMZWFmO1xyXG4gICAgaWYgKCFhY3RpdmVMZWFmIHx8ICFhY3RpdmVMZWFmLnZpZXcgfHwgYWN0aXZlTGVhZi52aWV3LmdldFZpZXdUeXBlKCkgIT09ICdjYW52YXMnKSB7XHJcbiAgICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbVGltZVByb2Nlc3Nvcl0gTm8gYWN0aXZlIGNhbnZhcyB2aWV3Jyk7XHJcbiAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNhbnZhc1ZpZXcgPSBhY3RpdmVMZWFmLnZpZXcgYXMgYW55O1xyXG4gICAgY29uc3QgY2FudmFzID0gY2FudmFzVmlldy5jYW52YXM7XHJcbiAgICBpZiAoIWNhbnZhcyB8fCAhY2FudmFzLm5vZGVzKSB7XHJcbiAgICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbVGltZVByb2Nlc3Nvcl0gTm8gY2FudmFzIG9yIG5vZGVzJyk7XHJcbiAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHRvdGFsTm9kZXMgPSBjYW52YXMubm9kZXMuc2l6ZSB8fCBjYW52YXMubm9kZXMubGVuZ3RoIHx8IDA7XHJcbiAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tUaW1lUHJvY2Vzc29yXSBQcm9jZXNzaW5nJywgdG90YWxOb2RlcywgJ25vZGVzJyk7XHJcblxyXG4gICAgLy8gUGFyc2UgZWFjaCBjYW52YXMgdGV4dCBub2RlIGFuZCBjb2xsZWN0IHRob3NlIHdpdGggdmFsaWQgSU9DIHR5cGVzXHJcbiAgICBjb25zdCBpb2NEYXRhOiBJT0NOb2RlRGF0YVtdID0gW107XHJcbiAgICBsZXQgZW1wdHlWYWx1ZUNvdW50ID0gMDtcclxuXHJcbiAgICBjYW52YXMubm9kZXMuZm9yRWFjaCgobm9kZTogYW55KSA9PiB7XHJcbiAgICAgICAgaWYgKG5vZGUudGV4dCkge1xyXG4gICAgICAgICAgICBjb25zdCBwYXJzZWREYXRhID0gcGFyc2VJT0NOb2RlKG5vZGUpO1xyXG4gICAgICAgICAgICBpZiAocGFyc2VkRGF0YSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFwYXJzZWREYXRhLnZhbHVlIHx8ICFwYXJzZWREYXRhLnZhbHVlLnRyaW0oKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVtcHR5VmFsdWVDb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaW9jRGF0YS5wdXNoKHBhcnNlZERhdGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbVGltZVByb2Nlc3Nvcl0gRXh0cmFjdGlvbiBjb21wbGV0ZSAtIGZvdW5kOicsIGlvY0RhdGEubGVuZ3RoLCAnSU9DcywnLCBlbXB0eVZhbHVlQ291bnQsICdlbXB0eSB2YWx1ZXMnKTtcclxuICAgIHJldHVybiBpb2NEYXRhO1xyXG59XHJcbiIsICIvKipcclxuICogVGltZVRpbWVsaW5lVGFiLnRzIC0gQ2hyb25vbG9naWNhbCBUaW1lIFRpbWVsaW5lIHJlbmRlcmVyLlxyXG4gKlxyXG4gKiBSZW5kZXJzIElPQyBjYXJkcyBhcyBhIHZlcnRpY2FsIHRpbWVsaW5lIHNvcnRlZCBieSBcIlRpbWUgb2YgRXZlbnRcIi5cclxuICogRWFjaCBjYXJkIGlzIGRpc3BsYXllZCB3aXRoIGl0cyBJT0MgY29sb3IsIGdyYWRpZW50IGNvbm5lY3RvcnMgYmV0d2VlblxyXG4gKiBjb25zZWN1dGl2ZSBpdGVtcywgU1ZHIGljb24sIGFuZCBkZXRhaWwgZmllbGRzICh0aW1lLCB2YWx1ZSwgc3BsdW5rLCBNSVRSRSkuXHJcbiAqIEluY2x1ZGVzIGEgY29weSBidXR0b24gdGhhdCBleHBvcnRzIGFsbCBlbnRyaWVzIHRvIGNsaXBib2FyZC5cclxuICovXHJcblxyXG5pbXBvcnQgeyBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IElPQ05vZGVEYXRhIH0gZnJvbSAnLi4vcGFyc2luZy9JT0NQYXJzZXInO1xyXG5pbXBvcnQgeyBnZW5lcmF0ZUNvcHlUZXh0IH0gZnJvbSAnLi9UaW1lbGluZUNvcHlFeHBvcnQnO1xyXG5pbXBvcnQgeyBERUJVRyB9IGZyb20gJy4uL2RlYnVnJztcclxuXHJcbi8qKlxyXG4gKiBSZW5kZXJzIHRoZSBjaHJvbm9sb2dpY2FsIFRpbWUgVGltZWxpbmUgaW50byB0aGUgZ2l2ZW4gY29udGFpbmVyLlxyXG4gKlxyXG4gKiBUYWtlcyBwcmUtc29ydGVkIElPQyBkYXRhIGFuZCByZW5kZXJzIGVhY2ggSU9DIGFzIGEgY29sb3JlZCBjYXJkIHdpdGg6XHJcbiAqIC0gR3JhZGllbnQgYmFja2dyb3VuZCBhbmQgc2hhZG93IHVzaW5nIHRoZSBJT0MgdHlwZSdzIGNvbG9yXHJcbiAqIC0gR3JhZGllbnQgY29ubmVjdG9yIGxpbmUgYmV0d2VlbiBjb25zZWN1dGl2ZSBjYXJkc1xyXG4gKiAtIFNWRyBpY29uIHdpdGggY29sb3JlZCBib3JkZXJcclxuICogLSBEZXRhaWwgZmllbGRzOiB0aW1lLCB2YWx1ZSwgc3BsdW5rIHF1ZXJ5LCB0YWN0aWMsIHRlY2huaXF1ZVxyXG4gKiAtIEhvdmVyIGVmZmVjdCAoZW5oYW5jZWQgYm94IHNoYWRvdylcclxuICogLSBDb3B5IGJ1dHRvbiB0byBleHBvcnQgYWxsIGVudHJpZXMgYXMgdGFiLXNlcGFyYXRlZCB0ZXh0XHJcbiAqXHJcbiAqIEBwYXJhbSBjb250YWluZXIgLSBET00gZWxlbWVudCB0byByZW5kZXIgdGhlIHRpbWVsaW5lIGludG9cclxuICogQHBhcmFtIGlvY0RhdGEgLSBBcnJheSBvZiBwYXJzZWQgSU9DIGRhdGEsIHByZS1zb3J0ZWQgY2hyb25vbG9naWNhbGx5XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyVGltZVRpbWVsaW5lKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIGlvY0RhdGE6IElPQ05vZGVEYXRhW10pOiB2b2lkIHtcclxuICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW1RpbWVUaW1lbGluZV0gU3RhcnRpbmcgcmVuZGVyJyk7XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBFbXB0eSBzdGF0ZTogbm8gSU9DIGNhcmRzIGZvdW5kXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIGlmIChpb2NEYXRhLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVFbCgncCcsIHtcclxuICAgICAgICAgICAgdGV4dDogJ05vIElPQyBjYXJkcyBmb3VuZCBpbiB0aGUgY3VycmVudCBjYW52YXMuIENyZWF0ZSBzb21lIElPQyBjYXJkcyBmaXJzdCB0byBzZWUgdGhlIHRpbWVsaW5lLicsXHJcbiAgICAgICAgICAgIGNsczogJ3RpbWVsaW5lLWVtcHR5LW1lc3NhZ2UnXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gQ29weSBidXR0b246IGV4cG9ydHMgYWxsIElPQyBlbnRyaWVzIGFzIHRhYi1zZXBhcmF0ZWQgdGV4dFxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICBjb25zdCB0aW1lQ29weUJ0biA9IGNvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJywge1xyXG4gICAgICAgIHRleHQ6ICdDb3B5IFRpbWVsaW5lJyxcclxuICAgICAgICBjbHM6ICd0aW1lbGluZS1jb3B5LWJ1dHRvbidcclxuICAgIH0pO1xyXG4gICAgdGltZUNvcHlCdG4uc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xyXG4gICAgdGltZUNvcHlCdG4uc3R5bGUudG9wID0gJzEwcHgnO1xyXG4gICAgdGltZUNvcHlCdG4uc3R5bGUucmlnaHQgPSAnMTBweCc7XHJcbiAgICB0aW1lQ29weUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICBjb25zdCB0ZXh0ID0gZ2VuZXJhdGVDb3B5VGV4dChpb2NEYXRhKTtcclxuICAgICAgICBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dCh0ZXh0KS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgbmV3IE5vdGljZShgQ29waWVkICR7aW9jRGF0YS5sZW5ndGh9IGVudHJpZXMgdG8gY2xpcGJvYXJkYCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIFRpbWVsaW5lIGl0ZW1zOiBvbmUgY2FyZCBwZXIgSU9DLCBjb25uZWN0ZWQgYnkgZ3JhZGllbnQgbGluZXNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgY29uc3QgdGltZWxpbmVDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KCd0aW1lbGluZS1jb250YWluZXInKTtcclxuXHJcbiAgICBpb2NEYXRhLmZvckVhY2goKGlvYywgaW5kZXgpID0+IHtcclxuICAgICAgICBjb25zdCB0aW1lbGluZUl0ZW0gPSB0aW1lbGluZUNvbnRhaW5lci5jcmVhdGVEaXYoJ3RpbWVsaW5lLWl0ZW0nKTtcclxuXHJcbiAgICAgICAgLy8gQXBwbHkgdGhlIElPQydzIGNvbG9yIHRvIGJhY2tncm91bmQgZ3JhZGllbnQgYW5kIHNoYWRvdyBmb3IgdmlzdWFsIGdyb3VwaW5nXHJcbiAgICAgICAgdGltZWxpbmVJdGVtLnN0eWxlLnNldFByb3BlcnR5KCctLWlvYy1jb2xvcicsIGlvYy5jb2xvcik7XHJcbiAgICAgICAgdGltZWxpbmVJdGVtLnN0eWxlLnNldFByb3BlcnR5KCctLWlvYy1jb2xvci0zMCcsIGAke2lvYy5jb2xvcn0zMGApO1xyXG4gICAgICAgIHRpbWVsaW5lSXRlbS5zdHlsZS5iYWNrZ3JvdW5kID0gYGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICR7aW9jLmNvbG9yfTE1IDAlLCAke2lvYy5jb2xvcn0wNSAxMDAlKWA7XHJcbiAgICAgICAgdGltZWxpbmVJdGVtLnN0eWxlLmJveFNoYWRvdyA9IGAwIDRweCAxMnB4ICR7aW9jLmNvbG9yfTI1YDtcclxuICAgICAgICB0aW1lbGluZUl0ZW0uc3R5bGUuYm9yZGVyQ29sb3IgPSBpb2MuY29sb3I7XHJcblxyXG4gICAgICAgIC8vIEdyYWRpZW50IGNvbm5lY3RvciBiZXR3ZWVuIHRoaXMgY2FyZCBhbmQgdGhlIG5leHQgb25lXHJcbiAgICAgICAgaWYgKGluZGV4IDwgaW9jRGF0YS5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbm5lY3RvciA9IHRpbWVsaW5lSXRlbS5jcmVhdGVEaXYoJ3RpbWVsaW5lLWNvbm5lY3RvcicpO1xyXG4gICAgICAgICAgICBjb25uZWN0b3Iuc3R5bGUuYmFja2dyb3VuZCA9IGBsaW5lYXItZ3JhZGllbnQoMTgwZGVnLCAke2lvYy5jb2xvcn0gMCUsICR7aW9jRGF0YVtpbmRleCArIDFdLmNvbG9yfSAxMDAlKWA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBpY29uQ29udGFpbmVyID0gdGltZWxpbmVJdGVtLmNyZWF0ZURpdigndGltZWxpbmUtaWNvbicpO1xyXG4gICAgICAgIGljb25Db250YWluZXIuaW5uZXJIVE1MID0gaW9jLmljb247XHJcbiAgICAgICAgaWNvbkNvbnRhaW5lci5zdHlsZS5iYWNrZ3JvdW5kID0gYCR7aW9jLmNvbG9yfTIwYDtcclxuICAgICAgICBpY29uQ29udGFpbmVyLnN0eWxlLmJvcmRlckNvbG9yID0gaW9jLmNvbG9yO1xyXG5cclxuICAgICAgICBjb25zdCBkZXRhaWxzQ29udGFpbmVyID0gdGltZWxpbmVJdGVtLmNyZWF0ZURpdigndGltZWxpbmUtZGV0YWlscycpO1xyXG5cclxuICAgICAgICBjb25zdCB0aXRsZUVsID0gZGV0YWlsc0NvbnRhaW5lci5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6IGlvYy50eXBlIH0pO1xyXG4gICAgICAgIHRpdGxlRWwuc3R5bGUudGV4dFNoYWRvdyA9IGAwIDFweCAzcHggJHtpb2MuY29sb3J9NDBgO1xyXG5cclxuICAgICAgICBjb25zdCB0aW1lRWwgPSBkZXRhaWxzQ29udGFpbmVyLmNyZWF0ZURpdigndGltZWxpbmUtdGltZScpO1xyXG4gICAgICAgIHRpbWVFbC50ZXh0Q29udGVudCA9IGBUaW1lOiAke2lvYy50aW1lfWA7XHJcblxyXG4gICAgICAgIGlmIChpb2MudmFsdWUgJiYgaW9jLnZhbHVlLnRyaW0oKSkge1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZUVsID0gZGV0YWlsc0NvbnRhaW5lci5jcmVhdGVEaXYoJ3RpbWVsaW5lLXZhbHVlJyk7XHJcbiAgICAgICAgICAgIHZhbHVlRWwudGV4dENvbnRlbnQgPSBgVmFsdWU6ICR7aW9jLnZhbHVlfWA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaW9jLnNwbHVua1F1ZXJ5ICYmIGlvYy5zcGx1bmtRdWVyeS50cmltKCkpIHtcclxuICAgICAgICAgICAgY29uc3Qgc3BsdW5rRWwgPSBkZXRhaWxzQ29udGFpbmVyLmNyZWF0ZURpdigndGltZWxpbmUtc3BsdW5rJyk7XHJcbiAgICAgICAgICAgIHNwbHVua0VsLnRleHRDb250ZW50ID0gYFNwbHVuayBRdWVyeTogJHtpb2Muc3BsdW5rUXVlcnl9YDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChpb2MudGFjdGljKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRhY3RpY0VsID0gZGV0YWlsc0NvbnRhaW5lci5jcmVhdGVEaXYoJ3RpbWVsaW5lLXRhY3RpYycpO1xyXG4gICAgICAgICAgICB0YWN0aWNFbC50ZXh0Q29udGVudCA9IGBUYWN0aWM6ICR7aW9jLnRhY3RpY31gO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGlvYy50ZWNobmlxdWUpIHtcclxuICAgICAgICAgICAgY29uc3QgdGVjaG5pcXVlRWwgPSBkZXRhaWxzQ29udGFpbmVyLmNyZWF0ZURpdigndGltZWxpbmUtdGVjaG5pcXVlJyk7XHJcbiAgICAgICAgICAgIHRlY2huaXF1ZUVsLnRleHRDb250ZW50ID0gYFRlY2huaXF1ZTogJHtpb2MudGVjaG5pcXVlfWA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBIb3ZlciBlZmZlY3Q6IGVuaGFuY2VkIGJveCBzaGFkb3cgb24gbW91c2VvdmVyXHJcbiAgICAgICAgdGltZWxpbmVJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsICgpID0+IHtcclxuICAgICAgICAgICAgdGltZWxpbmVJdGVtLnN0eWxlLmJveFNoYWRvdyA9IGAwIDhweCAyMHB4ICR7aW9jLmNvbG9yfTM1YDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGltZWxpbmVJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3V0JywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lbGluZUl0ZW0uc3R5bGUuYm94U2hhZG93ID0gYDAgNHB4IDEycHggJHtpb2MuY29sb3J9MjVgO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuIiwgIi8qKlxyXG4gKiBUaW1lbGluZUNvcHlFeHBvcnQudHMgLSBDb3B5LXRvLWNsaXBib2FyZCB0ZXh0IGdlbmVyYXRpb24gZm9yIHRpbWVsaW5lIGRhdGFcclxuICpcclxuICogR2VuZXJhdGVzIHRhYi1zZXBhcmF0ZWQgdGV4dCBmcm9tIElPQyB0aW1lbGluZSBkYXRhIGZvciBjbGlwYm9hcmQgZXhwb3J0LlxyXG4gKiBGb3JtYXQ6IFRpbWVcXHRUYWN0aWNcXHRUZWNobmlxdWVcXHRWYWx1ZSAob25lIGxpbmUgcGVyIGNhcmQpLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IElPQ05vZGVEYXRhIH0gZnJvbSAnLi4vdHlwZXMvSU9DTm9kZURhdGEnO1xyXG5cclxuLyoqXHJcbiAqIEdlbmVyYXRlIHRhYi1zZXBhcmF0ZWQgdGV4dCBmcm9tIElPQyBkYXRhIGZvciBjbGlwYm9hcmQgY29weS5cclxuICpcclxuICogRWFjaCBsaW5lIGNvbnRhaW5zOiB0aW1lLCB0YWN0aWMsIHRlY2huaXF1ZSwgdmFsdWUgc2VwYXJhdGVkIGJ5IHRhYnMuXHJcbiAqIEVtcHR5IGZpZWxkcyBhcmUgcmVwcmVzZW50ZWQgYXMgZW1wdHkgc3RyaW5ncy5cclxuICogRGF0YSBzaG91bGQgYmUgcHJlLXNvcnRlZCBjaHJvbm9sb2dpY2FsbHkgYnkgdGhlIGNhbGxlci5cclxuICpcclxuICogQHBhcmFtIGlvY0RhdGEgLSBBcnJheSBvZiBwYXJzZWQgSU9DIG5vZGUgZGF0YSwgc29ydGVkIGNocm9ub2xvZ2ljYWxseVxyXG4gKiBAcGFyYW0gc3RhcnRUaW1lIC0gT3B0aW9uYWwgc3RhcnQgdGltZXN0YW1wIGZvciBmaWx0ZXJpbmcgKGluY2x1c2l2ZSlcclxuICogQHBhcmFtIGVuZFRpbWUgLSBPcHRpb25hbCBlbmQgdGltZXN0YW1wIGZvciBmaWx0ZXJpbmcgKGluY2x1c2l2ZSlcclxuICogQHJldHVybnMgVGFiLXNlcGFyYXRlZCB0ZXh0IHN0cmluZyByZWFkeSBmb3IgY2xpcGJvYXJkXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVDb3B5VGV4dChpb2NEYXRhOiBJT0NOb2RlRGF0YVtdLCBzdGFydFRpbWU/OiBudW1iZXIsIGVuZFRpbWU/OiBudW1iZXIpOiBzdHJpbmcge1xyXG4gICAgLy8gRmlsdGVyIGJ5IHRpbWUgcmFuZ2UgaWYgcHJvdmlkZWRcclxuICAgIGxldCBmaWx0ZXJlZERhdGEgPSBpb2NEYXRhO1xyXG4gICAgaWYgKHN0YXJ0VGltZSAhPT0gdW5kZWZpbmVkICYmIGVuZFRpbWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGZpbHRlcmVkRGF0YSA9IGlvY0RhdGEuZmlsdGVyKGlvYyA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRzID0gbmV3IERhdGUoaW9jLnRpbWUpLmdldFRpbWUoKTtcclxuICAgICAgICAgICAgcmV0dXJuICFpc05hTih0cykgJiYgdHMgPj0gc3RhcnRUaW1lICYmIHRzIDw9IGVuZFRpbWU7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgaGVhZGVyID0gJ1RpbWVcXHRUYWN0aWNcXHRUZWNobmlxdWVcXHRWYWx1ZSc7XHJcbiAgICBjb25zdCBsaW5lcyA9IGZpbHRlcmVkRGF0YS5tYXAoaW9jID0+XHJcbiAgICAgICAgYCR7aW9jLnRpbWUgfHwgJyd9XFx0JHtpb2MudGFjdGljIHx8ICcnfVxcdCR7aW9jLnRlY2huaXF1ZSB8fCAnJ31cXHQke2lvYy52YWx1ZSB8fCAnJ31gXHJcbiAgICApO1xyXG4gICAgcmV0dXJuIFtoZWFkZXIsIC4uLmxpbmVzXS5qb2luKCdcXG4nKTtcclxufVxyXG4iLCAiLyoqXHJcbiAqIEdyYXBoVGltZWxpbmVUYWIudHMgLSBIb3Jpem9udGFsIGRvdCBncmFwaCB0aW1lbGluZSB3aXRoIGRyYWctdG8tem9vbVxyXG4gKlxyXG4gKiBPcmNoZXN0cmF0ZXMgdGhlIGludGVyYWN0aXZlIGdyYXBoIHRpbWVsaW5lIGJ5OlxyXG4gKiAgIDEuIFBhcnNpbmcgYW5kIGZpbHRlcmluZyBJT0MgZGF0YSBmb3IgdmFsaWQgdGltZXN0YW1wc1xyXG4gKiAgIDIuIERlbGVnYXRpbmcgRE9NIGNyZWF0aW9uIHRvIEdyYXBoVGltZWxpbmVSZW5kZXJpbmdcclxuICogICAzLiBXaXJpbmcgdXAgaW50ZXJhY3Rpb24gaGFuZGxlcnMgKGRyYWctdG8tem9vbSwgaW5wdXQgZmllbGRzLCByZXNldCwgY29weSlcclxuICogICA0LiBNYW5hZ2luZyB2aWV3cG9ydCBzdGF0ZSBhbmQgem9vbSBvcGVyYXRpb25zIHZpYSBHcmFwaFRpbWVsaW5lSGVscGVyc1xyXG4gKlxyXG4gKiBGZWF0dXJlczpcclxuICogICAtIFgtYXhpczogZHluYW1pY2FsbHkgc2NhbGVzIHdpdGggem9vbSBsZXZlbFxyXG4gKiAgIC0gQ29sb3JlZCBkb3RzIHBvc2l0aW9uZWQgcHJvcG9ydGlvbmFsbHkgYWxvbmcgdGhlIGF4aXNcclxuICogICAtIEhvdmVyIHRvb2x0aXBzIHNob3dpbmcgdHlwZSwgdmFsdWUsIHRpbWVcclxuICogICAtIENsaWNrIGFuZCBkcmFnIHRvIHNlbGVjdCB0aW1lIHJhbmdlIGFuZCB6b29tIChTcGx1bmstbGlrZSBpbnRlcmFjdGlvbilcclxuICogICAtIE1hbnVhbCB0aW1lIHJhbmdlIGlucHV0IGZpZWxkcyB3aXRoIGF1dG9tYXRpYyB6b29tXHJcbiAqICAgLSBSZXNldCBidXR0b24gdG8gem9vbSBiYWNrIHRvIGZ1bGwgZGF0YSByYW5nZVxyXG4gKiAgIC0gVGltZWxpbmUgdGFrZXMgZnVsbCBtb2RhbCB3aWR0aCB3aXRoIGVkZ2UgcGFkZGluZyBmb3IgdmlzaWJpbGl0eVxyXG4gKiAgIC0gRmlsdGVyZWQgY2FyZCBsaXN0IGJlbG93IHRoZSBncmFwaFxyXG4gKi9cclxuXHJcbmltcG9ydCB7IElPQ05vZGVEYXRhIH0gZnJvbSAnLi4vdHlwZXMvSU9DTm9kZURhdGEnO1xyXG5pbXBvcnQgeyBnZW5lcmF0ZUNvcHlUZXh0IH0gZnJvbSAnLi9UaW1lbGluZUNvcHlFeHBvcnQnO1xyXG5pbXBvcnQgeyBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IGNvbXB1dGVQYWRkZWRWaWV3cG9ydCwgZm9ybWF0VGltZXN0YW1wLCBmb3JtYXRTaG9ydFRpbWUsIEVER0VfUEFERElOR19QRVJDRU5UIH0gZnJvbSAnLi9HcmFwaFRpbWVsaW5lSGVscGVycyc7XHJcbmltcG9ydCB7IGNyZWF0ZUdyYXBoVGltZWxpbmVET00gfSBmcm9tICcuL0dyYXBoVGltZWxpbmVSZW5kZXJpbmcnO1xyXG5cclxuLyoqXHJcbiAqIFJlbmRlciB0aGUgZ3JhcGggdGltZWxpbmUgdGFiIGNvbnRlbnQuXHJcbiAqXHJcbiAqIEBwYXJhbSBjb250YWluZXIgLSBQYXJlbnQgRE9NIGVsZW1lbnQgdG8gcmVuZGVyIGludG9cclxuICogQHBhcmFtIGlvY0RhdGEgLSBJT0MgY2FyZCBkYXRhIHNvcnRlZCBjaHJvbm9sb2dpY2FsbHlcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJHcmFwaFRpbWVsaW5lKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIGlvY0RhdGE6IElPQ05vZGVEYXRhW10pOiB2b2lkIHtcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gRWFybHkgcmV0dXJuOiBubyBJT0MgZGF0YSBhdCBhbGxcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgaWYgKGlvY0RhdGEubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZUVsKCdwJywge1xyXG4gICAgICAgICAgICB0ZXh0OiAnTm8gSU9DIGNhcmRzIGZvdW5kLiBDcmVhdGUgc29tZSBJT0MgY2FyZHMgd2l0aCB0aW1lc3RhbXBzIHRvIHNlZSB0aGUgZ3JhcGguJyxcclxuICAgICAgICAgICAgY2xzOiAndGltZWxpbmUtZW1wdHktbWVzc2FnZSdcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBQYXJzZSB0aW1lc3RhbXBzIGFuZCBmaWx0ZXIgb3V0IGNhcmRzIHdpdGhvdXQgdmFsaWQgdGltZXNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgY29uc3QgdGltZWREYXRhID0gaW9jRGF0YVxyXG4gICAgICAgIC5tYXAoaW9jID0+ICh7IGlvYywgdHM6IG5ldyBEYXRlKGlvYy50aW1lKS5nZXRUaW1lKCkgfSkpXHJcbiAgICAgICAgLmZpbHRlcihkID0+ICFpc05hTihkLnRzKSlcclxuICAgICAgICAuc29ydCgoYSwgYikgPT4gYS50cyAtIGIudHMpO1xyXG5cclxuICAgIGlmICh0aW1lZERhdGEubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZUVsKCdwJywge1xyXG4gICAgICAgICAgICB0ZXh0OiAnTm8gSU9DIGNhcmRzIHdpdGggdmFsaWQgdGltZXN0YW1wcyBmb3VuZC4nLFxyXG4gICAgICAgICAgICBjbHM6ICd0aW1lbGluZS1lbXB0eS1tZXNzYWdlJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBEYXRhIGJvdW5kcyAobmV2ZXIgY2hhbmdlIC0gcmVwcmVzZW50IGZ1bGwgZGF0YXNldClcclxuICAgIGNvbnN0IGRhdGFNaW5UaW1lID0gdGltZWREYXRhWzBdLnRzO1xyXG4gICAgY29uc3QgZGF0YU1heFRpbWUgPSB0aW1lZERhdGFbdGltZWREYXRhLmxlbmd0aCAtIDFdLnRzO1xyXG5cclxuICAgIC8vIFZpZXdwb3J0IGJvdW5kcyAoY2hhbmdlcyB3aXRoIHpvb20pXHJcbiAgICBsZXQgdmlld01pblRpbWUgPSBkYXRhTWluVGltZTtcclxuICAgIGxldCB2aWV3TWF4VGltZSA9IGRhdGFNYXhUaW1lO1xyXG5cclxuICAgIC8vIFN0YXRlIGZvciByYW5nZSBzZWxlY3Rpb25cclxuICAgIGxldCByYW5nZVN0YXJ0ID0gZGF0YU1pblRpbWU7XHJcbiAgICBsZXQgcmFuZ2VFbmQgPSBkYXRhTWF4VGltZTtcclxuXHJcbiAgICAvLyBTdGF0ZSBmb3IgZHJhZyBpbnRlcmFjdGlvblxyXG4gICAgbGV0IGlzRHJhZ2dpbmcgPSBmYWxzZTtcclxuICAgIGxldCBkcmFnU3RhcnRUaW1lID0gMDtcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIENyZWF0ZSBhbGwgRE9NIGVsZW1lbnRzIHZpYSByZW5kZXJpbmcgbW9kdWxlXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIGNvbnN0IGRvbSA9IGNyZWF0ZUdyYXBoVGltZWxpbmVET00oY29udGFpbmVyLCB0aW1lZERhdGEsIGRhdGFNaW5UaW1lLCBkYXRhTWF4VGltZSk7XHJcbiAgICBjb25zdCB7XHJcbiAgICAgICAgc3RhcnRJbnB1dCwgZW5kSW5wdXQsIHJlc2V0QnRuLFxyXG4gICAgICAgIGdyYXBoQXJlYSwgYXhpc0VsLCBzZWxlY3Rpb25PdmVybGF5LFxyXG4gICAgICAgIGRvdHMsIGxpc3RDb250YWluZXJcclxuICAgIH0gPSBkb207XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBWaWV3cG9ydCB1cGRhdGUgZnVuY3Rpb25zXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFVwZGF0ZSBheGlzIHRpY2sgbGFiZWxzIGJhc2VkIG9uIGN1cnJlbnQgdmlld3BvcnQuXHJcbiAgICAgKiBUaWNrcyBzcGFuIHRoZSBwYWRkZWQgcmFuZ2Ugc28gZWRnZSBkb3RzIGFyZSBmdWxseSB2aXNpYmxlLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiB1cGRhdGVBeGlzVGlja3MoKSB7XHJcbiAgICAgICAgLy8gUmVtb3ZlIG9sZCB0aWNrc1xyXG4gICAgICAgIGF4aXNFbC5xdWVyeVNlbGVjdG9yQWxsKCcuZ3JhcGgtYXhpcy10aWNrJykuZm9yRWFjaChlbCA9PiBlbC5yZW1vdmUoKSk7XHJcblxyXG4gICAgICAgIC8vIENhbGN1bGF0ZSBwYWRkZWQgdmlld3BvcnQgcmFuZ2VcclxuICAgICAgICBjb25zdCB7IHBhZGRlZE1pbiwgcGFkZGVkU3BhbiB9ID0gY29tcHV0ZVBhZGRlZFZpZXdwb3J0KHZpZXdNaW5UaW1lLCB2aWV3TWF4VGltZSk7XHJcblxyXG4gICAgICAgIC8vIEFkZCB0aWNrcyBhY3Jvc3MgdGhlIHBhZGRlZCByYW5nZVxyXG4gICAgICAgIGNvbnN0IHRpY2tDb3VudCA9IE1hdGgubWluKDYsIHRpbWVkRGF0YS5sZW5ndGgpO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGlja0NvdW50OyBpKyspIHtcclxuICAgICAgICAgICAgY29uc3QgcGN0ID0gdGlja0NvdW50ID09PSAxID8gNTAgOiAoaSAvICh0aWNrQ291bnQgLSAxKSkgKiAxMDA7XHJcbiAgICAgICAgICAgIGNvbnN0IHRpY2tUaW1lID0gcGFkZGVkTWluICsgKHBjdCAvIDEwMCkgKiBwYWRkZWRTcGFuO1xyXG4gICAgICAgICAgICBjb25zdCB0aWNrID0gYXhpc0VsLmNyZWF0ZURpdignZ3JhcGgtYXhpcy10aWNrJyk7XHJcbiAgICAgICAgICAgIHRpY2suc3R5bGUubGVmdCA9IGAke3BjdH0lYDtcclxuICAgICAgICAgICAgdGljay5zZXRBdHRyaWJ1dGUoJ2RhdGEtbGFiZWwnLCBmb3JtYXRTaG9ydFRpbWUodGlja1RpbWUpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXBvc2l0aW9uIGFsbCBkb3RzIGJhc2VkIG9uIGN1cnJlbnQgdmlld3BvcnQuXHJcbiAgICAgKiBEb3RzIGFyZSBwb3NpdGlvbmVkIHVzaW5nIHBhZGRlZCByYW5nZSBzbyBlZGdlIGRvdHMgYXJlbid0IGF0IGV4YWN0IDAlLzEwMCUuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHVwZGF0ZURvdFBvc2l0aW9ucygpIHtcclxuICAgICAgICAvLyBDYWxjdWxhdGUgcGFkZGVkIHZpZXdwb3J0IHJhbmdlXHJcbiAgICAgICAgY29uc3QgeyBwYWRkZWRNaW4sIHBhZGRlZFNwYW4gfSA9IGNvbXB1dGVQYWRkZWRWaWV3cG9ydCh2aWV3TWluVGltZSwgdmlld01heFRpbWUpO1xyXG5cclxuICAgICAgICBkb3RzLmZvckVhY2goZG90ID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdHMgPSBOdW1iZXIoZG90LmdldEF0dHJpYnV0ZSgnZGF0YS10cycpKTtcclxuICAgICAgICAgICAgLy8gSGlkZSBkb3RzIG91dHNpZGUgYWN0dWFsIHZpZXdwb3J0ICh1c2Ugbm9uLXBhZGRlZCByYW5nZSBmb3IgdmlzaWJpbGl0eSBjaGVjaylcclxuICAgICAgICAgICAgaWYgKHRzIDwgdmlld01pblRpbWUgfHwgdHMgPiB2aWV3TWF4VGltZSkge1xyXG4gICAgICAgICAgICAgICAgZG90LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBkb3Quc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICAgICAgICAgICAgICAvLyBQb3NpdGlvbiB1c2luZyBwYWRkZWQgcmFuZ2UgKGVkZ2UgZG90cyBhdCB+NSUgYW5kIH45NSUsIG5vdCAwJSBhbmQgMTAwJSlcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBjdCA9ICgodHMgLSBwYWRkZWRNaW4pIC8gcGFkZGVkU3BhbikgKiAxMDA7XHJcbiAgICAgICAgICAgICAgICBkb3Quc3R5bGUubGVmdCA9IGAke3BjdH0lYDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVXBkYXRlIGRvdCBoaWdobGlnaHRpbmcgYW5kIGZpbHRlcmVkIGNhcmQgbGlzdC5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gdXBkYXRlRmlsdGVyKCkge1xyXG4gICAgICAgIC8vIFVwZGF0ZSBkb3QgaGlnaGxpZ2h0aW5nXHJcbiAgICAgICAgZG90cy5mb3JFYWNoKGRvdCA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRzID0gTnVtYmVyKGRvdC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdHMnKSk7XHJcbiAgICAgICAgICAgIGlmICh0cyA+PSByYW5nZVN0YXJ0ICYmIHRzIDw9IHJhbmdlRW5kKSB7XHJcbiAgICAgICAgICAgICAgICBkb3QuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGRvdC5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFJlbmRlciBmaWx0ZXJlZCBjYXJkIGxpc3RcclxuICAgICAgICBsaXN0Q29udGFpbmVyLmVtcHR5KCk7XHJcbiAgICAgICAgY29uc3QgZmlsdGVyZWQgPSB0aW1lZERhdGEuZmlsdGVyKGQgPT4gZC50cyA+PSByYW5nZVN0YXJ0ICYmIGQudHMgPD0gcmFuZ2VFbmQpO1xyXG5cclxuICAgICAgICBpZiAoZmlsdGVyZWQubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIGxpc3RDb250YWluZXIuY3JlYXRlRWwoJ3AnLCB7IHRleHQ6ICdObyBjYXJkcyBpbiBzZWxlY3RlZCByYW5nZS4nLCBjbHM6ICd0aW1lbGluZS1lbXB0eS1tZXNzYWdlJyB9KTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGlzdENvbnRhaW5lci5jcmVhdGVFbCgncCcsIHsgdGV4dDogYFNob3dpbmcgJHtmaWx0ZXJlZC5sZW5ndGh9IG9mICR7dGltZWREYXRhLmxlbmd0aH0gY2FyZHNgLCBjbHM6ICdncmFwaC1maWx0ZXItY291bnQnIH0pO1xyXG5cclxuICAgICAgICBmaWx0ZXJlZC5mb3JFYWNoKGQgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtID0gbGlzdENvbnRhaW5lci5jcmVhdGVEaXYoJ3RpbWVsaW5lLWl0ZW0nKTtcclxuICAgICAgICAgICAgaXRlbS5zdHlsZS5zZXRQcm9wZXJ0eSgnLS1pb2MtY29sb3InLCBkLmlvYy5jb2xvcik7XHJcbiAgICAgICAgICAgIGl0ZW0uc3R5bGUuYmFja2dyb3VuZCA9IGBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAke2QuaW9jLmNvbG9yfTE1IDAlLCAke2QuaW9jLmNvbG9yfTA1IDEwMCUpYDtcclxuICAgICAgICAgICAgaXRlbS5zdHlsZS5ib3hTaGFkb3cgPSBgMCA0cHggMTJweCAke2QuaW9jLmNvbG9yfTI1YDtcclxuICAgICAgICAgICAgaXRlbS5zdHlsZS5ib3JkZXJDb2xvciA9IGQuaW9jLmNvbG9yO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgaWNvbkNvbnRhaW5lciA9IGl0ZW0uY3JlYXRlRGl2KCd0aW1lbGluZS1pY29uJyk7XHJcbiAgICAgICAgICAgIGljb25Db250YWluZXIuaW5uZXJIVE1MID0gZC5pb2MuaWNvbjtcclxuICAgICAgICAgICAgaWNvbkNvbnRhaW5lci5zdHlsZS5iYWNrZ3JvdW5kID0gYCR7ZC5pb2MuY29sb3J9MjBgO1xyXG4gICAgICAgICAgICBpY29uQ29udGFpbmVyLnN0eWxlLmJvcmRlckNvbG9yID0gZC5pb2MuY29sb3I7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBkZXRhaWxzID0gaXRlbS5jcmVhdGVEaXYoJ3RpbWVsaW5lLWRldGFpbHMnKTtcclxuICAgICAgICAgICAgY29uc3QgdGl0bGVFbCA9IGRldGFpbHMuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiBkLmlvYy50eXBlIH0pO1xyXG4gICAgICAgICAgICB0aXRsZUVsLnN0eWxlLnRleHRTaGFkb3cgPSBgMCAxcHggM3B4ICR7ZC5pb2MuY29sb3J9NDBgO1xyXG5cclxuICAgICAgICAgICAgZGV0YWlscy5jcmVhdGVEaXYoeyBjbHM6ICd0aW1lbGluZS10aW1lJywgdGV4dDogYFRpbWU6ICR7ZC5pb2MudGltZX1gIH0pO1xyXG4gICAgICAgICAgICBpZiAoZC5pb2MudmFsdWUgJiYgZC5pb2MudmFsdWUudHJpbSgpKSB7XHJcbiAgICAgICAgICAgICAgICBkZXRhaWxzLmNyZWF0ZURpdih7IGNsczogJ3RpbWVsaW5lLXZhbHVlJywgdGV4dDogYFZhbHVlOiAke2QuaW9jLnZhbHVlfWAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGQuaW9jLnRhY3RpYykge1xyXG4gICAgICAgICAgICAgICAgZGV0YWlscy5jcmVhdGVEaXYoeyBjbHM6ICd0aW1lbGluZS10YWN0aWMnLCB0ZXh0OiBgVGFjdGljOiAke2QuaW9jLnRhY3RpY31gIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChkLmlvYy50ZWNobmlxdWUpIHtcclxuICAgICAgICAgICAgICAgIGRldGFpbHMuY3JlYXRlRGl2KHsgY2xzOiAndGltZWxpbmUtdGVjaG5pcXVlJywgdGV4dDogYFRlY2huaXF1ZTogJHtkLmlvYy50ZWNobmlxdWV9YCB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogWm9vbSB0aGUgdGltZWxpbmUgdG8gYSBzcGVjaWZpYyB0aW1lIHJhbmdlLlxyXG4gICAgICogVXBkYXRlcyB2aWV3cG9ydCwgcmVwb3NpdGlvbnMgZG90cywgcmVnZW5lcmF0ZXMgYXhpcyB0aWNrcywgYW5kIHVwZGF0ZXMgZmlsdGVycy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gbmV3U3RhcnQgLSBTdGFydCB0aW1lc3RhbXAgZm9yIHRoZSB6b29tZWQgcmFuZ2VcclxuICAgICAqIEBwYXJhbSBuZXdFbmQgLSBFbmQgdGltZXN0YW1wIGZvciB0aGUgem9vbWVkIHJhbmdlXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHpvb21Ub1JhbmdlKG5ld1N0YXJ0OiBudW1iZXIsIG5ld0VuZDogbnVtYmVyKSB7XHJcbiAgICAgICAgLy8gRW5zdXJlIHN0YXJ0IDwgZW5kXHJcbiAgICAgICAgaWYgKG5ld1N0YXJ0ID4gbmV3RW5kKSB7XHJcbiAgICAgICAgICAgIFtuZXdTdGFydCwgbmV3RW5kXSA9IFtuZXdFbmQsIG5ld1N0YXJ0XTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFVwZGF0ZSB2aWV3cG9ydFxyXG4gICAgICAgIHZpZXdNaW5UaW1lID0gbmV3U3RhcnQ7XHJcbiAgICAgICAgdmlld01heFRpbWUgPSBuZXdFbmQ7XHJcblxyXG4gICAgICAgIC8vIFVwZGF0ZSByYW5nZSBzZWxlY3Rpb25cclxuICAgICAgICByYW5nZVN0YXJ0ID0gbmV3U3RhcnQ7XHJcbiAgICAgICAgcmFuZ2VFbmQgPSBuZXdFbmQ7XHJcblxyXG4gICAgICAgIC8vIFVwZGF0ZSBpbnB1dCBmaWVsZHNcclxuICAgICAgICBzdGFydElucHV0LnZhbHVlID0gZm9ybWF0VGltZXN0YW1wKG5ld1N0YXJ0KTtcclxuICAgICAgICBlbmRJbnB1dC52YWx1ZSA9IGZvcm1hdFRpbWVzdGFtcChuZXdFbmQpO1xyXG5cclxuICAgICAgICAvLyBVcGRhdGUgdmlzdWFsIGVsZW1lbnRzXHJcbiAgICAgICAgdXBkYXRlQXhpc1RpY2tzKCk7XHJcbiAgICAgICAgdXBkYXRlRG90UG9zaXRpb25zKCk7XHJcbiAgICAgICAgdXBkYXRlRmlsdGVyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBDb3B5IGJ1dHRvbiBoYW5kbGVyIChuZWVkcyB2aWV3cG9ydCBzdGF0ZSlcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgZG9tLmNvcHlCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdGV4dCA9IGdlbmVyYXRlQ29weVRleHQodGltZWREYXRhLm1hcChkID0+IGQuaW9jKSwgdmlld01pblRpbWUsIHZpZXdNYXhUaW1lKTtcclxuICAgICAgICBjb25zdCBmaWx0ZXJlZCA9IHRpbWVkRGF0YS5maWx0ZXIoZCA9PiBkLnRzID49IHZpZXdNaW5UaW1lICYmIGQudHMgPD0gdmlld01heFRpbWUpO1xyXG4gICAgICAgIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KHRleHQpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBuZXcgTm90aWNlKGBDb3BpZWQgJHtmaWx0ZXJlZC5sZW5ndGh9IG9mICR7dGltZWREYXRhLmxlbmd0aH0gZW50cmllcyB0byBjbGlwYm9hcmRgKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gRHJhZy10by16b29tIGludGVyYWN0aW9uXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIGdyYXBoQXJlYS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZSkgPT4ge1xyXG4gICAgICAgIC8vIE9ubHkgc3RhcnQgZHJhZyBvbiBheGlzIGFyZWEgKG5vdCBvbiBkb3RzKVxyXG4gICAgICAgIGlmICgoZS50YXJnZXQgYXMgSFRNTEVsZW1lbnQpLmNsYXNzTGlzdC5jb250YWlucygnZ3JhcGgtZG90JykpIHJldHVybjtcclxuXHJcbiAgICAgICAgY29uc3QgcmVjdCA9IGdyYXBoQXJlYS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICBjb25zdCBjbGlja1ggPSBlLmNsaWVudFggLSByZWN0LmxlZnQ7XHJcbiAgICAgICAgY29uc3QgcGN0ID0gKGNsaWNrWCAtIDMwKSAvIChyZWN0LndpZHRoIC0gNjApOyAvLyBhY2NvdW50IGZvciBjb250YWluZXIgcGFkZGluZ1xyXG5cclxuICAgICAgICAvLyBDYWxjdWxhdGUgcGFkZGVkIHZpZXdwb3J0IHJhbmdlIGZvciBtb3VzZS10by10aW1lIGNvbnZlcnNpb25cclxuICAgICAgICBjb25zdCB7IHBhZGRlZE1pbiwgcGFkZGVkU3BhbiB9ID0gY29tcHV0ZVBhZGRlZFZpZXdwb3J0KHZpZXdNaW5UaW1lLCB2aWV3TWF4VGltZSk7XHJcblxyXG4gICAgICAgIGRyYWdTdGFydFRpbWUgPSBwYWRkZWRNaW4gKyBwY3QgKiBwYWRkZWRTcGFuO1xyXG5cclxuICAgICAgICAvLyBDbGFtcCB0byBkYXRhIGJvdW5kc1xyXG4gICAgICAgIGRyYWdTdGFydFRpbWUgPSBNYXRoLm1heChkYXRhTWluVGltZSwgTWF0aC5taW4oZGF0YU1heFRpbWUsIGRyYWdTdGFydFRpbWUpKTtcclxuXHJcbiAgICAgICAgaXNEcmFnZ2luZyA9IHRydWU7XHJcbiAgICAgICAgZ3JhcGhBcmVhLmNsYXNzTGlzdC5hZGQoJ2RyYWdnaW5nJyk7XHJcbiAgICAgICAgc3RhcnRJbnB1dC52YWx1ZSA9IGZvcm1hdFRpbWVzdGFtcChkcmFnU3RhcnRUaW1lKTtcclxuXHJcbiAgICAgICAgLy8gU2hvdyBzZWxlY3Rpb24gb3ZlcmxheVxyXG4gICAgICAgIHNlbGVjdGlvbk92ZXJsYXkuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICAgICAgc2VsZWN0aW9uT3ZlcmxheS5zdHlsZS5sZWZ0ID0gYCR7Y2xpY2tYfXB4YDtcclxuICAgICAgICBzZWxlY3Rpb25PdmVybGF5LnN0eWxlLndpZHRoID0gJzBweCc7XHJcbiAgICB9KTtcclxuXHJcbiAgICBncmFwaEFyZWEuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgKGUpID0+IHtcclxuICAgICAgICBpZiAoIWlzRHJhZ2dpbmcpIHJldHVybjtcclxuXHJcbiAgICAgICAgY29uc3QgcmVjdCA9IGdyYXBoQXJlYS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICBjb25zdCBjdXJyZW50WCA9IGUuY2xpZW50WCAtIHJlY3QubGVmdDtcclxuICAgICAgICBjb25zdCBwY3QgPSAoY3VycmVudFggLSAzMCkgLyAocmVjdC53aWR0aCAtIDYwKTtcclxuXHJcbiAgICAgICAgLy8gQ2FsY3VsYXRlIHBhZGRlZCB2aWV3cG9ydCByYW5nZSBmb3IgbW91c2UtdG8tdGltZSBjb252ZXJzaW9uXHJcbiAgICAgICAgY29uc3QgeyBwYWRkZWRNaW4sIHBhZGRlZFNwYW4gfSA9IGNvbXB1dGVQYWRkZWRWaWV3cG9ydCh2aWV3TWluVGltZSwgdmlld01heFRpbWUpO1xyXG5cclxuICAgICAgICBjb25zdCBjdXJyZW50VGltZSA9IHBhZGRlZE1pbiArIHBjdCAqIHBhZGRlZFNwYW47XHJcblxyXG4gICAgICAgIC8vIENsYW1wIHRvIGRhdGEgYm91bmRzXHJcbiAgICAgICAgY29uc3QgY2xhbXBlZFRpbWUgPSBNYXRoLm1heChkYXRhTWluVGltZSwgTWF0aC5taW4oZGF0YU1heFRpbWUsIGN1cnJlbnRUaW1lKSk7XHJcbiAgICAgICAgZW5kSW5wdXQudmFsdWUgPSBmb3JtYXRUaW1lc3RhbXAoY2xhbXBlZFRpbWUpO1xyXG5cclxuICAgICAgICAvLyBVcGRhdGUgc2VsZWN0aW9uIG92ZXJsYXkgKGNvbnZlcnQgZHJhZ1N0YXJ0VGltZSBiYWNrIHRvIHNjcmVlbiBwb3NpdGlvbiB1c2luZyBwYWRkZWQgcmFuZ2UpXHJcbiAgICAgICAgY29uc3Qgc3RhcnRYID0gKChkcmFnU3RhcnRUaW1lIC0gcGFkZGVkTWluKSAvIHBhZGRlZFNwYW4pICogKHJlY3Qud2lkdGggLSA2MCkgKyAzMDtcclxuICAgICAgICBjb25zdCBlbmRYID0gY3VycmVudFg7XHJcbiAgICAgICAgY29uc3QgbGVmdCA9IE1hdGgubWluKHN0YXJ0WCwgZW5kWCk7XHJcbiAgICAgICAgY29uc3Qgd2lkdGggPSBNYXRoLmFicyhlbmRYIC0gc3RhcnRYKTtcclxuICAgICAgICBzZWxlY3Rpb25PdmVybGF5LnN0eWxlLmxlZnQgPSBgJHtsZWZ0fXB4YDtcclxuICAgICAgICBzZWxlY3Rpb25PdmVybGF5LnN0eWxlLndpZHRoID0gYCR7d2lkdGh9cHhgO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZ3JhcGhBcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCAoZSkgPT4ge1xyXG4gICAgICAgIGlmICghaXNEcmFnZ2luZykgcmV0dXJuO1xyXG5cclxuICAgICAgICBjb25zdCByZWN0ID0gZ3JhcGhBcmVhLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgIGNvbnN0IGVuZFggPSBlLmNsaWVudFggLSByZWN0LmxlZnQ7XHJcbiAgICAgICAgY29uc3QgcGN0ID0gKGVuZFggLSAzMCkgLyAocmVjdC53aWR0aCAtIDYwKTtcclxuXHJcbiAgICAgICAgLy8gQ2FsY3VsYXRlIHBhZGRlZCB2aWV3cG9ydCByYW5nZSBmb3IgbW91c2UtdG8tdGltZSBjb252ZXJzaW9uXHJcbiAgICAgICAgY29uc3QgeyBwYWRkZWRNaW4sIHBhZGRlZFNwYW4gfSA9IGNvbXB1dGVQYWRkZWRWaWV3cG9ydCh2aWV3TWluVGltZSwgdmlld01heFRpbWUpO1xyXG5cclxuICAgICAgICBsZXQgZHJhZ0VuZFRpbWUgPSBwYWRkZWRNaW4gKyBwY3QgKiBwYWRkZWRTcGFuO1xyXG5cclxuICAgICAgICAvLyBDbGFtcCB0byBkYXRhIGJvdW5kc1xyXG4gICAgICAgIGRyYWdFbmRUaW1lID0gTWF0aC5tYXgoZGF0YU1pblRpbWUsIE1hdGgubWluKGRhdGFNYXhUaW1lLCBkcmFnRW5kVGltZSkpO1xyXG5cclxuICAgICAgICBpc0RyYWdnaW5nID0gZmFsc2U7XHJcbiAgICAgICAgZ3JhcGhBcmVhLmNsYXNzTGlzdC5yZW1vdmUoJ2RyYWdnaW5nJyk7XHJcbiAgICAgICAgc2VsZWN0aW9uT3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG5cclxuICAgICAgICAvLyBPbmx5IHpvb20gaWYgdGhlcmUncyBhIG1lYW5pbmdmdWwgc2VsZWN0aW9uICg+IDEgc2Vjb25kKVxyXG4gICAgICAgIGlmIChNYXRoLmFicyhkcmFnRW5kVGltZSAtIGRyYWdTdGFydFRpbWUpID4gMTAwMCkge1xyXG4gICAgICAgICAgICB6b29tVG9SYW5nZShkcmFnU3RhcnRUaW1lLCBkcmFnRW5kVGltZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgZ3JhcGhBcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XHJcbiAgICAgICAgaWYgKGlzRHJhZ2dpbmcpIHtcclxuICAgICAgICAgICAgaXNEcmFnZ2luZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICBncmFwaEFyZWEuY2xhc3NMaXN0LnJlbW92ZSgnZHJhZ2dpbmcnKTtcclxuICAgICAgICAgICAgc2VsZWN0aW9uT3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gRXZlbnQgaGFuZGxlcnMgZm9yIGlucHV0IGZpZWxkc1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICBzdGFydElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHtcclxuICAgICAgICBjb25zdCBwYXJzZWQgPSBuZXcgRGF0ZShzdGFydElucHV0LnZhbHVlKS5nZXRUaW1lKCk7XHJcbiAgICAgICAgaWYgKCFpc05hTihwYXJzZWQpKSB7XHJcbiAgICAgICAgICAgIHpvb21Ub1JhbmdlKHBhcnNlZCwgcmFuZ2VFbmQpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGVuZElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHtcclxuICAgICAgICBjb25zdCBwYXJzZWQgPSBuZXcgRGF0ZShlbmRJbnB1dC52YWx1ZSkuZ2V0VGltZSgpO1xyXG4gICAgICAgIGlmICghaXNOYU4ocGFyc2VkKSkge1xyXG4gICAgICAgICAgICB6b29tVG9SYW5nZShyYW5nZVN0YXJ0LCBwYXJzZWQpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJlc2V0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgIHpvb21Ub1JhbmdlKGRhdGFNaW5UaW1lLCBkYXRhTWF4VGltZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIEluaXRpYWwgcmVuZGVyIHdpdGggZnVsbCByYW5nZVxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICB1cGRhdGVBeGlzVGlja3MoKTtcclxuICAgIHVwZGF0ZURvdFBvc2l0aW9ucygpO1xyXG4gICAgdXBkYXRlRmlsdGVyKCk7XHJcbn1cclxuIiwgIi8qKlxyXG4gKiBHcmFwaFRpbWVsaW5lSGVscGVycy50cyAtIFZpZXdwb3J0IG1hdGggYW5kIGZvcm1hdHRpbmcgdXRpbGl0aWVzIGZvciBncmFwaCB0aW1lbGluZVxyXG4gKlxyXG4gKiBDb250YWlucyBwdXJlIGhlbHBlciBmdW5jdGlvbnMgdXNlZCBieSBib3RoIEdyYXBoVGltZWxpbmVUYWIgYW5kIEdyYXBoVGltZWxpbmVSZW5kZXJpbmc6XHJcbiAqICAgLSBQYWRkZWQgdmlld3BvcnQgY29tcHV0YXRpb24gKGVkZ2UgcGFkZGluZyBzbyBkb3RzIGRvbid0IHNpdCBhdCBleGFjdCAwJS8xMDAlKVxyXG4gKiAgIC0gVGltZXN0YW1wIGZvcm1hdHRpbmcgZm9yIGlucHV0IGZpZWxkcyBhbmQgYXhpcyB0aWNrIGxhYmVsc1xyXG4gKi9cclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBDb25zdGFudHNcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vKipcclxuICogRWRnZSBwYWRkaW5nIGFzIGEgcGVyY2VudGFnZSBvZiB0aGUgdmlld3BvcnQgcmFuZ2UgKDglIG9uIGVhY2ggc2lkZSkuXHJcbiAqIFRoaXMgZW5zdXJlcyBkb3RzIGF0IG1pbi9tYXggdGltZXN0YW1wcyBhcmVuJ3QgcG9zaXRpb25lZCBhdCBleGFjdCAwJS8xMDAlXHJcbiAqIHdoZXJlIHRoZXknZCBiZSBoaWRkZW4gYmVoaW5kIHRoZSBjb250YWluZXIncyAzMHB4IGhvcml6b250YWwgcGFkZGluZy5cclxuICovXHJcbmV4cG9ydCBjb25zdCBFREdFX1BBRERJTkdfUEVSQ0VOVCA9IDAuMDg7XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gUGFkZGVkIHZpZXdwb3J0IGNvbXB1dGF0aW9uXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLyoqIFBhZGRlZCB2aWV3cG9ydCByYW5nZSB3aXRoIHByZS1jb21wdXRlZCBzcGFuIGZvciBwb3NpdGlvbmluZyBjYWxjdWxhdGlvbnMuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgUGFkZGVkVmlld3BvcnQge1xyXG4gICAgcGFkZGVkTWluOiBudW1iZXI7XHJcbiAgICBwYWRkZWRNYXg6IG51bWJlcjtcclxuICAgIHBhZGRlZFNwYW46IG51bWJlcjtcclxufVxyXG5cclxuLyoqXHJcbiAqIENvbXB1dGUgdGhlIHBhZGRlZCB2aWV3cG9ydCByYW5nZSBmcm9tIHJhdyB2aWV3IGJvdW5kcy5cclxuICogQWRkcyBFREdFX1BBRERJTkdfUEVSQ0VOVCBwYWRkaW5nIG9uIGVhY2ggc2lkZSBzbyBlZGdlIGRvdHMgYXJlIGZ1bGx5IHZpc2libGUuXHJcbiAqXHJcbiAqIEBwYXJhbSB2aWV3TWluIC0gU3RhcnQgdGltZXN0YW1wIG9mIHRoZSBjdXJyZW50IHZpZXdwb3J0XHJcbiAqIEBwYXJhbSB2aWV3TWF4IC0gRW5kIHRpbWVzdGFtcCBvZiB0aGUgY3VycmVudCB2aWV3cG9ydFxyXG4gKiBAcmV0dXJucyBQYWRkZWRWaWV3cG9ydCB3aXRoIG1pbiwgbWF4LCBhbmQgc3BhbiBpbmNsdWRpbmcgcGFkZGluZ1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNvbXB1dGVQYWRkZWRWaWV3cG9ydCh2aWV3TWluOiBudW1iZXIsIHZpZXdNYXg6IG51bWJlcik6IFBhZGRlZFZpZXdwb3J0IHtcclxuICAgIGNvbnN0IHZpZXdTcGFuID0gdmlld01heCAtIHZpZXdNaW4gfHwgMTtcclxuICAgIGNvbnN0IHBhZGRpbmdNcyA9IEVER0VfUEFERElOR19QRVJDRU5UICogdmlld1NwYW47XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHBhZGRlZE1pbjogdmlld01pbiAtIHBhZGRpbmdNcyxcclxuICAgICAgICBwYWRkZWRNYXg6IHZpZXdNYXggKyBwYWRkaW5nTXMsXHJcbiAgICAgICAgcGFkZGVkU3BhbjogKHZpZXdNYXggKyBwYWRkaW5nTXMpIC0gKHZpZXdNaW4gLSBwYWRkaW5nTXMpXHJcbiAgICB9O1xyXG59XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gVGltZXN0YW1wIGZvcm1hdHRpbmdcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vKipcclxuICogRm9ybWF0IGEgdGltZXN0YW1wIGZvciBkaXNwbGF5IGluIGlucHV0IGZpZWxkcyAoWVlZWS1NTS1ERCBISDpNTTpTUykuXHJcbiAqXHJcbiAqIEBwYXJhbSB0cyAtIFVuaXggdGltZXN0YW1wIGluIG1pbGxpc2Vjb25kc1xyXG4gKiBAcmV0dXJucyBGb3JtYXR0ZWQgc3RyaW5nIGxpa2UgXCIyMDI2LTAyLTE2IDE0OjMwOjAwXCJcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXRUaW1lc3RhbXAodHM6IG51bWJlcik6IHN0cmluZyB7XHJcbiAgICBjb25zdCBkID0gbmV3IERhdGUodHMpO1xyXG4gICAgcmV0dXJuIGQudG9JU09TdHJpbmcoKS5yZXBsYWNlKCdUJywgJyAnKS5zdWJzdHJpbmcoMCwgMTkpO1xyXG59XHJcblxyXG4vKipcclxuICogRm9ybWF0IGEgc2hvcnQgdGltZSBsYWJlbCBmb3IgYXhpcyB0aWNrcyAodHdvLWxpbmUgZGlzcGxheSkuXHJcbiAqIFJldHVybnMgXCJZWVlZLU1NLUREXFxuSEg6TU06U1NcIiB3aXRoIG5ld2xpbmUgc2VwYXJhdG9yIGZvciB0d28tbGluZSByZW5kZXJpbmdcclxuICogaW4gdGhlIGF4aXMgdGljayBDU1MgKHdoaXRlLXNwYWNlOiBwcmUtbGluZSkuXHJcbiAqXHJcbiAqIEBwYXJhbSB0cyAtIFVuaXggdGltZXN0YW1wIGluIG1pbGxpc2Vjb25kc1xyXG4gKiBAcmV0dXJucyBUd28tbGluZSBmb3JtYXR0ZWQgc3RyaW5nIGZvciBheGlzIHRpY2sgZGlzcGxheVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdFNob3J0VGltZSh0czogbnVtYmVyKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGQgPSBuZXcgRGF0ZSh0cyk7XHJcbiAgICBjb25zdCB5ZWFyID0gZC5nZXRGdWxsWWVhcigpO1xyXG4gICAgY29uc3QgbW9udGggPSBTdHJpbmcoZC5nZXRNb250aCgpICsgMSkucGFkU3RhcnQoMiwgJzAnKTtcclxuICAgIGNvbnN0IGRheSA9IFN0cmluZyhkLmdldERhdGUoKSkucGFkU3RhcnQoMiwgJzAnKTtcclxuICAgIGNvbnN0IGhvdXJzID0gU3RyaW5nKGQuZ2V0SG91cnMoKSkucGFkU3RhcnQoMiwgJzAnKTtcclxuICAgIGNvbnN0IG1pbnV0ZXMgPSBTdHJpbmcoZC5nZXRNaW51dGVzKCkpLnBhZFN0YXJ0KDIsICcwJyk7XHJcbiAgICBjb25zdCBzZWNvbmRzID0gU3RyaW5nKGQuZ2V0U2Vjb25kcygpKS5wYWRTdGFydCgyLCAnMCcpO1xyXG4gICAgLy8gUmV0dXJuIHdpdGggbmV3bGluZSBzZXBhcmF0b3IgZm9yIHR3by1saW5lIHJlbmRlcmluZ1xyXG4gICAgcmV0dXJuIGAke3llYXJ9LSR7bW9udGh9LSR7ZGF5fVxcbiR7aG91cnN9OiR7bWludXRlc306JHtzZWNvbmRzfWA7XHJcbn1cclxuIiwgIi8qKlxyXG4gKiBHcmFwaFRpbWVsaW5lUmVuZGVyaW5nLnRzIC0gRE9NIGVsZW1lbnQgY3JlYXRpb24gZm9yIGdyYXBoIHRpbWVsaW5lXHJcbiAqXHJcbiAqIENyZWF0ZXMgYWxsIERPTSBlbGVtZW50cyBuZWVkZWQgYnkgdGhlIGdyYXBoIHRpbWVsaW5lOlxyXG4gKiAgIC0gQ29udHJvbHMgYmFyIChGcm9tL1RvIGlucHV0cywgUmVzZXQgYnV0dG9uKVxyXG4gKiAgIC0gR3JhcGggYXJlYSAoYXhpcywgdG9vbHRpcCwgc2VsZWN0aW9uIG92ZXJsYXkpXHJcbiAqICAgLSBDb2xvcmVkIGRvdHMgd2l0aCB5LWppdHRlciBhbmQgaG92ZXIgdG9vbHRpcHNcclxuICogICAtIEZpbHRlcmVkIGNhcmQgbGlzdCBjb250YWluZXJcclxuICogICAtIENvcHkgYnV0dG9uIChwb3NpdGlvbmVkIGFic29sdXRlIGluIHRvcC1yaWdodClcclxuICpcclxuICogUmV0dXJucyBhIEdyYXBoVGltZWxpbmVET00gc3RydWN0IHdpdGggcmVmZXJlbmNlcyB0byBhbGwgY3JlYXRlZCBlbGVtZW50cy5cclxuICogRXZlbnQgaGFuZGxlcnMgdGhhdCBuZWVkIHZpZXdwb3J0IHN0YXRlIChjb3B5LCByZXNldCwgZHJhZykgYXJlIE5PVCBzZXQgdXAgaGVyZSAtXHJcbiAqIHRoZSBjYWxsZXIgKEdyYXBoVGltZWxpbmVUYWIpIHdpcmVzIHRob3NlIHVwIHNpbmNlIHRoZXkgZGVwZW5kIG9uIG11dGFibGUgc3RhdGUuXHJcbiAqIERvdCBob3ZlciB0b29sdGlwcyBBUkUgc2V0IHVwIGhlcmUgc2luY2UgdGhleSBvbmx5IG5lZWQgZWFjaCBkb3QncyBvd24gZGF0YS5cclxuICovXHJcblxyXG5pbXBvcnQgeyBJT0NOb2RlRGF0YSB9IGZyb20gJy4uL3R5cGVzL0lPQ05vZGVEYXRhJztcclxuaW1wb3J0IHsgZm9ybWF0VGltZXN0YW1wIH0gZnJvbSAnLi9HcmFwaFRpbWVsaW5lSGVscGVycyc7XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gRE9NIGVsZW1lbnQgcmVmZXJlbmNlIHN0cnVjdFxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8qKlxyXG4gKiBBbGwgRE9NIGVsZW1lbnQgcmVmZXJlbmNlcyBjcmVhdGVkIGJ5IGNyZWF0ZUdyYXBoVGltZWxpbmVET00oKS5cclxuICogUHJvdmlkZXMgdGhlIGNhbGxlciB3aXRoIGRpcmVjdCBhY2Nlc3MgdG8gZXZlcnkgaW50ZXJhY3RpdmUgZWxlbWVudFxyXG4gKiBmb3Igd2lyaW5nIHVwIGV2ZW50IGhhbmRsZXJzIHRoYXQgZGVwZW5kIG9uIHZpZXdwb3J0IHN0YXRlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBHcmFwaFRpbWVsaW5lRE9NIHtcclxuICAgIGNvbnRyb2xzRWw6IEhUTUxFbGVtZW50O1xyXG4gICAgc3RhcnRJbnB1dDogSFRNTElucHV0RWxlbWVudDtcclxuICAgIGVuZElucHV0OiBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgcmVzZXRCdG46IEhUTUxFbGVtZW50O1xyXG4gICAgZ3JhcGhBcmVhOiBIVE1MRWxlbWVudDtcclxuICAgIGF4aXNFbDogSFRNTEVsZW1lbnQ7XHJcbiAgICB0b29sdGlwOiBIVE1MRWxlbWVudDtcclxuICAgIHNlbGVjdGlvbk92ZXJsYXk6IEhUTUxFbGVtZW50O1xyXG4gICAgZG90czogSFRNTEVsZW1lbnRbXTtcclxuICAgIGxpc3RDb250YWluZXI6IEhUTUxFbGVtZW50O1xyXG4gICAgY29weUJ0bjogSFRNTEVsZW1lbnQ7XHJcbn1cclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBET00gY3JlYXRpb25cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vKipcclxuICogQ3JlYXRlIGFsbCBET00gZWxlbWVudHMgZm9yIHRoZSBncmFwaCB0aW1lbGluZS5cclxuICpcclxuICogQnVpbGRzIHRoZSBmdWxsIFVJIHN0cnVjdHVyZTogY29udHJvbHMgYmFyLCBncmFwaCBhcmVhIHdpdGggYXhpcy9kb3RzL3Rvb2x0aXAvb3ZlcmxheSxcclxuICogbGlzdCBjb250YWluZXIsIGFuZCBjb3B5IGJ1dHRvbi4gRG90IGhvdmVyIHRvb2x0aXBzIGFyZSB3aXJlZCB1cCBoZXJlIHNpbmNlIHRoZXlcclxuICogb25seSBuZWVkIGVhY2ggZG90J3Mgb3duIGRhdGEuIE90aGVyIGhhbmRsZXJzIChkcmFnLCBjb3B5LCByZXNldCwgaW5wdXQgY2hhbmdlKVxyXG4gKiBhcmUgbGVmdCBmb3IgdGhlIGNhbGxlciB0byBzZXQgdXAuXHJcbiAqXHJcbiAqIEBwYXJhbSBjb250YWluZXIgLSBQYXJlbnQgRE9NIGVsZW1lbnQgdG8gcmVuZGVyIGludG9cclxuICogQHBhcmFtIHRpbWVkRGF0YSAtIElPQyBkYXRhIHBhaXJlZCB3aXRoIHBhcnNlZCB0aW1lc3RhbXBzLCBzb3J0ZWQgY2hyb25vbG9naWNhbGx5XHJcbiAqIEBwYXJhbSBkYXRhTWluVGltZSAtIEVhcmxpZXN0IHRpbWVzdGFtcCBpbiB0aGUgZnVsbCBkYXRhc2V0XHJcbiAqIEBwYXJhbSBkYXRhTWF4VGltZSAtIExhdGVzdCB0aW1lc3RhbXAgaW4gdGhlIGZ1bGwgZGF0YXNldFxyXG4gKiBAcmV0dXJucyBHcmFwaFRpbWVsaW5lRE9NIHdpdGggcmVmZXJlbmNlcyB0byBhbGwgY3JlYXRlZCBlbGVtZW50c1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUdyYXBoVGltZWxpbmVET00oXHJcbiAgICBjb250YWluZXI6IEhUTUxFbGVtZW50LFxyXG4gICAgdGltZWREYXRhOiBBcnJheTx7IGlvYzogSU9DTm9kZURhdGE7IHRzOiBudW1iZXIgfT4sXHJcbiAgICBkYXRhTWluVGltZTogbnVtYmVyLFxyXG4gICAgZGF0YU1heFRpbWU6IG51bWJlclxyXG4pOiBHcmFwaFRpbWVsaW5lRE9NIHtcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIFRpbWUgcmFuZ2UgY29udHJvbHNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgY29uc3QgY29udHJvbHNFbCA9IGNvbnRhaW5lci5jcmVhdGVEaXYoJ2dyYXBoLXJhbmdlLWNvbnRyb2xzJyk7XHJcbiAgICBjb250cm9sc0VsLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiAnRnJvbTogJywgY2xzOiAnZ3JhcGgtcmFuZ2UtbGFiZWwnIH0pO1xyXG4gICAgY29uc3Qgc3RhcnRJbnB1dCA9IGNvbnRyb2xzRWwuY3JlYXRlRWwoJ2lucHV0Jywge1xyXG4gICAgICAgIGNsczogJ2dyYXBoLXJhbmdlLWlucHV0JyxcclxuICAgICAgICB0eXBlOiAndGV4dCdcclxuICAgIH0pIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICBzdGFydElucHV0LnZhbHVlID0gZm9ybWF0VGltZXN0YW1wKGRhdGFNaW5UaW1lKTtcclxuXHJcbiAgICBjb250cm9sc0VsLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiAnIFRvOiAnLCBjbHM6ICdncmFwaC1yYW5nZS1sYWJlbCcgfSk7XHJcbiAgICBjb25zdCBlbmRJbnB1dCA9IGNvbnRyb2xzRWwuY3JlYXRlRWwoJ2lucHV0Jywge1xyXG4gICAgICAgIGNsczogJ2dyYXBoLXJhbmdlLWlucHV0JyxcclxuICAgICAgICB0eXBlOiAndGV4dCdcclxuICAgIH0pIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICBlbmRJbnB1dC52YWx1ZSA9IGZvcm1hdFRpbWVzdGFtcChkYXRhTWF4VGltZSk7XHJcblxyXG4gICAgY29uc3QgcmVzZXRCdG4gPSBjb250cm9sc0VsLmNyZWF0ZUVsKCdidXR0b24nLCB7XHJcbiAgICAgICAgdGV4dDogJ1Jlc2V0JyxcclxuICAgICAgICBjbHM6ICdncmFwaC1yYW5nZS1yZXNldCdcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gR3JhcGggYXJlYVxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICBjb25zdCBncmFwaEFyZWEgPSBjb250YWluZXIuY3JlYXRlRGl2KCdncmFwaC10aW1lbGluZS1hcmVhJyk7XHJcblxyXG4gICAgLy8gVGltZSBheGlzIGxpbmVcclxuICAgIGNvbnN0IGF4aXNFbCA9IGdyYXBoQXJlYS5jcmVhdGVEaXYoJ2dyYXBoLXRpbWUtYXhpcycpO1xyXG5cclxuICAgIC8vIFRvb2x0aXAgZWxlbWVudCAoc2hhcmVkIGFjcm9zcyBhbGwgZG90cywgcmVwb3NpdGlvbmVkIG9uIGhvdmVyKVxyXG4gICAgY29uc3QgdG9vbHRpcCA9IGdyYXBoQXJlYS5jcmVhdGVEaXYoJ2dyYXBoLXRvb2x0aXAnKTtcclxuICAgIHRvb2x0aXAuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuXHJcbiAgICAvLyBTZWxlY3Rpb24gb3ZlcmxheSBmb3IgZHJhZy10by16b29tIGludGVyYWN0aW9uXHJcbiAgICBjb25zdCBzZWxlY3Rpb25PdmVybGF5ID0gZ3JhcGhBcmVhLmNyZWF0ZURpdignZ3JhcGgtc2VsZWN0aW9uLW92ZXJsYXknKTtcclxuICAgIHNlbGVjdGlvbk92ZXJsYXkuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIERvdHMgd2l0aCB5LWppdHRlciBhbmQgaG92ZXIgdG9vbHRpcHNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgY29uc3QgZG90czogSFRNTEVsZW1lbnRbXSA9IFtdO1xyXG4gICAgdGltZWREYXRhLmZvckVhY2goKGQsIGlkeCkgPT4ge1xyXG4gICAgICAgIC8vIFktaml0dGVyIHRvIGF2b2lkIG92ZXJsYXA6IGFsdGVybmF0ZSB1cC9kb3duIGZyb20gY2VudGVyXHJcbiAgICAgICAgY29uc3QgeU9mZnNldCA9IChpZHggJSAyID09PSAwID8gLTEgOiAxKSAqICgoaWR4ICUgNCkgKiA2ICsgNCk7XHJcblxyXG4gICAgICAgIGNvbnN0IGRvdCA9IGdyYXBoQXJlYS5jcmVhdGVEaXYoJ2dyYXBoLWRvdCcpO1xyXG4gICAgICAgIGRvdC5zdHlsZS50b3AgPSBgY2FsYyg1MCUgKyAke3lPZmZzZXR9cHgpYDtcclxuICAgICAgICBkb3Quc3R5bGUuYmFja2dyb3VuZENvbG9yID0gZC5pb2MuY29sb3I7XHJcbiAgICAgICAgZG90LnN0eWxlLmJvcmRlckNvbG9yID0gZC5pb2MuY29sb3I7XHJcbiAgICAgICAgZG90LnNldEF0dHJpYnV0ZSgnZGF0YS10cycsIFN0cmluZyhkLnRzKSk7XHJcblxyXG4gICAgICAgIC8vIEhvdmVyIHRvb2x0aXAgLSBvbmx5IG5lZWRzIGRvdCdzIG93biBkYXRhLCBubyB2aWV3cG9ydCBzdGF0ZVxyXG4gICAgICAgIGRvdC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0b29sdGlwLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG4gICAgICAgICAgICB0b29sdGlwLmlubmVySFRNTCA9IGA8c3Ryb25nPiR7ZC5pb2MudHlwZX08L3N0cm9uZz48YnIvPmAgK1xyXG4gICAgICAgICAgICAgICAgYCR7ZC5pb2MudmFsdWUgfHwgJyhubyB2YWx1ZSknfTxici8+YCArXHJcbiAgICAgICAgICAgICAgICBgPHNwYW4gY2xhc3M9XCJncmFwaC10b29sdGlwLXRpbWVcIj4ke2QuaW9jLnRpbWV9PC9zcGFuPmA7XHJcbiAgICAgICAgICAgIC8vIFBvc2l0aW9uIHRvb2x0aXAgbmVhciB0aGUgZG90XHJcbiAgICAgICAgICAgIGNvbnN0IHJlY3QgPSBncmFwaEFyZWEuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGRvdFJlY3QgPSBkb3QuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgIHRvb2x0aXAuc3R5bGUubGVmdCA9IGAke2RvdFJlY3QubGVmdCAtIHJlY3QubGVmdCArIDZ9cHhgO1xyXG4gICAgICAgICAgICB0b29sdGlwLnN0eWxlLnRvcCA9IGAke2RvdFJlY3QudG9wIC0gcmVjdC50b3AgLSA2MH1weGA7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGRvdC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0b29sdGlwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGRvdHMucHVzaChkb3QpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBGaWx0ZXJlZCBjYXJkIGxpc3QgY29udGFpbmVyXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIGNvbnN0IGxpc3RDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KCdncmFwaC1maWx0ZXJlZC1saXN0Jyk7XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBDb3B5IGJ1dHRvbiAocG9zaXRpb25lZCBhYnNvbHV0ZSBpbiB0b3AtcmlnaHQgb2YgbW9kYWwpXHJcbiAgICAvLyBDbGljayBoYW5kbGVyIHNldCB1cCBieSBjYWxsZXIgc2luY2UgaXQgbmVlZHMgdmlld3BvcnQgc3RhdGVcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgY29uc3QgY29weUJ0biA9IGNvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJywge1xyXG4gICAgICAgIHRleHQ6ICdDb3B5IEZpbHRlcmVkIFJhbmdlJyxcclxuICAgICAgICBjbHM6ICd0aW1lbGluZS1jb3B5LWJ1dHRvbiBncmFwaC10aW1lbGluZS1jb3B5J1xyXG4gICAgfSk7XHJcbiAgICBjb3B5QnRuLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcclxuICAgIGNvcHlCdG4uc3R5bGUudG9wID0gJzEwcHgnO1xyXG4gICAgY29weUJ0bi5zdHlsZS5yaWdodCA9ICcxMHB4JztcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGNvbnRyb2xzRWwsXHJcbiAgICAgICAgc3RhcnRJbnB1dCxcclxuICAgICAgICBlbmRJbnB1dCxcclxuICAgICAgICByZXNldEJ0bixcclxuICAgICAgICBncmFwaEFyZWEsXHJcbiAgICAgICAgYXhpc0VsLFxyXG4gICAgICAgIHRvb2x0aXAsXHJcbiAgICAgICAgc2VsZWN0aW9uT3ZlcmxheSxcclxuICAgICAgICBkb3RzLFxyXG4gICAgICAgIGxpc3RDb250YWluZXIsXHJcbiAgICAgICAgY29weUJ0blxyXG4gICAgfTtcclxufVxyXG4iLCAiLyoqXHJcbiAqIENhbnZhc0VkZ2VzLnRzIC0gQ2FudmFzIGVkZ2UgKGFycm93KSB0cmF2ZXJzYWwgdXRpbGl0aWVzXHJcbiAqXHJcbiAqIFJlYWRzIGVkZ2VzIGZyb20gT2JzaWRpYW4ncyBpbnRlcm5hbCBjYW52YXMgQVBJIGFuZCByZXR1cm5zIG5vcm1hbGl6ZWRcclxuICogZWRnZSBkYXRhIGZvciBwYXJlbnQtY2hpbGQgcmVsYXRpb25zaGlwIGRldGVjdGlvbi4gQXJyb3cgZGlyZWN0aW9uXHJcbiAqIGRldGVybWluZXMgcmVsYXRpb25zaGlwOiBmcm9tTm9kZSA9IHBhcmVudCwgdG9Ob2RlID0gY2hpbGQuXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgQXBwLCBJdGVtVmlldyB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgREVCVUcgfSBmcm9tICcuLi9kZWJ1Zyc7XHJcblxyXG4vKiogTm9ybWFsaXplZCBlZGdlIGRhdGEgcmVwcmVzZW50aW5nIGEgY2FudmFzIGFycm93IGJldHdlZW4gdHdvIG5vZGVzLiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIEVkZ2VEYXRhIHtcclxuICAgIC8qKiBDYW52YXMgbm9kZSBJRCB0aGUgYXJyb3cgb3JpZ2luYXRlcyBmcm9tIChwYXJlbnQpICovXHJcbiAgICBmcm9tTm9kZUlkOiBzdHJpbmc7XHJcbiAgICAvKiogQ2FudmFzIG5vZGUgSUQgdGhlIGFycm93IHBvaW50cyB0byAoY2hpbGQpICovXHJcbiAgICB0b05vZGVJZDogc3RyaW5nO1xyXG59XHJcblxyXG4vKipcclxuICogUmVhZCBhbGwgZWRnZXMgZnJvbSB0aGUgYWN0aXZlIGNhbnZhcyBhbmQgcmV0dXJuIG5vcm1hbGl6ZWQgZWRnZSBkYXRhLlxyXG4gKlxyXG4gKiBBY2Nlc3NlcyB0aGUgaW50ZXJuYWwgY2FudmFzIEFQSSB2aWEgYCh2aWV3IGFzIGFueSkuY2FudmFzLmVkZ2VzYC5cclxuICogVGhlIGVkZ2VzIE1hcCBjb250YWlucyBlZGdlIG9iamVjdHMgd2l0aCBgZnJvbS5ub2RlLmlkYCBhbmQgYHRvLm5vZGUuaWRgLlxyXG4gKlxyXG4gKiBAcGFyYW0gYXBwIC0gT2JzaWRpYW4gQXBwIGluc3RhbmNlXHJcbiAqIEByZXR1cm5zIEFycmF5IG9mIG5vcm1hbGl6ZWQgZWRnZSBkYXRhLCBlbXB0eSBpZiBubyBjYW52YXMgb3IgZWRnZXNcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDYW52YXNFZGdlcyhhcHA6IEFwcCk6IEVkZ2VEYXRhW10ge1xyXG4gICAgY29uc3QgYWN0aXZlVmlldyA9IGFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShJdGVtVmlldyk7XHJcbiAgICBpZiAoIWFjdGl2ZVZpZXcgfHwgYWN0aXZlVmlldy5nZXRWaWV3VHlwZSgpICE9PSAnY2FudmFzJykge1xyXG4gICAgICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW0NhbnZhc0VkZ2VzXSBObyBhY3RpdmUgY2FudmFzIHZpZXcnKTtcclxuICAgICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY2FudmFzID0gKGFjdGl2ZVZpZXcgYXMgYW55KS5jYW52YXM7XHJcbiAgICBpZiAoIWNhbnZhcyB8fCAhY2FudmFzLmVkZ2VzKSB7XHJcbiAgICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbQ2FudmFzRWRnZXNdIE5vIGNhbnZhcyBvciBlZGdlcycpO1xyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBlZGdlczogRWRnZURhdGFbXSA9IFtdO1xyXG5cclxuICAgIGNhbnZhcy5lZGdlcy5mb3JFYWNoKChlZGdlOiBhbnkpID0+IHtcclxuICAgICAgICAvLyBJbnRlcm5hbCBjYW52YXMgZWRnZSBzdHJ1Y3R1cmU6IGVkZ2UuZnJvbS5ub2RlIGFuZCBlZGdlLnRvLm5vZGVcclxuICAgICAgICBjb25zdCBmcm9tSWQgPSBlZGdlPy5mcm9tPy5ub2RlPy5pZDtcclxuICAgICAgICBjb25zdCB0b0lkID0gZWRnZT8udG8/Lm5vZGU/LmlkO1xyXG5cclxuICAgICAgICBpZiAoZnJvbUlkICYmIHRvSWQpIHtcclxuICAgICAgICAgICAgZWRnZXMucHVzaCh7IGZyb21Ob2RlSWQ6IGZyb21JZCwgdG9Ob2RlSWQ6IHRvSWQgfSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChERUJVRykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdbQ2FudmFzRWRnZXNdIFNraXBwaW5nIGVkZ2Ugd2l0aCBtaXNzaW5nIG5vZGUgSURzOicsIGVkZ2UpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW0NhbnZhc0VkZ2VzXSBGb3VuZCcsIGVkZ2VzLmxlbmd0aCwgJ2VkZ2VzJyk7XHJcbiAgICByZXR1cm4gZWRnZXM7XHJcbn1cclxuIiwgIi8qKlxyXG4gKiBMaW5rVGltZWxpbmVQcm9jZXNzaW5nLnRzIC0gUGFyZW50LWNoaWxkIGdyb3VwaW5nIGZyb20gY2FudmFzIGVkZ2VzXHJcbiAqXHJcbiAqIEJ1aWxkcyBwYXJlbnQtY2hpbGQgZ3JvdXBzIGJ5IG1hdGNoaW5nIGNhbnZhcyBlZGdlcyAoYXJyb3dzKSB0byBJT0Mgbm9kZXMuXHJcbiAqIEFycm93IGRpcmVjdGlvbjogcGFyZW50IFx1MjE5MiBjaGlsZCAoZnJvbU5vZGUgPSBwYXJlbnQsIHRvTm9kZSA9IGNoaWxkKS5cclxuICogUGFyZW50cyBhcmUgc29ydGVkIGJ5IHRpbWUgKG9sZGVzdCBmaXJzdCksIGNoaWxkcmVuIHdpdGhpbiBlYWNoIGdyb3VwXHJcbiAqIGFyZSBhbHNvIHNvcnRlZCBieSB0aW1lLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IElPQ05vZGVEYXRhIH0gZnJvbSAnLi4vdHlwZXMvSU9DTm9kZURhdGEnO1xyXG5pbXBvcnQgeyBFZGdlRGF0YSB9IGZyb20gJy4uL2NhbnZhcy9DYW52YXNFZGdlcyc7XHJcblxyXG4vKipcclxuICogQSBwYXJlbnQgSU9DIGNhcmQgYW5kIGl0cyBsaW5rZWQgY2hpbGQgY2FyZHMuXHJcbiAqIENoaWxkcmVuIGFyZSBhbHdheXMgbGVhZiBub2RlcyAoSU9DTm9kZURhdGEpIC0gbm8gbmVzdGVkIHBhcmVudCBncm91cHMgYWxsb3dlZC5cclxuICogVGhpcyBjcmVhdGVzIGEgZmxhdCAyLWxldmVsIGhpZXJhcmNoeTogW1BdIFx1MjE5MiBbQ10gKGFsbCBjaGlsZHJlbiBhdCBzYW1lIGxldmVsKS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgUGFyZW50Q2hpbGRHcm91cCB7XHJcbiAgICBwYXJlbnQ6IElPQ05vZGVEYXRhO1xyXG4gICAgY2hpbGRyZW46IChJT0NOb2RlRGF0YSB8IFBhcmVudENoaWxkR3JvdXApW107XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZXR1cm4gdmFsdWUgZm9yIGJ1aWxkUGFyZW50Q2hpbGRHcm91cHMgd2l0aCBlcnJvciBkZXRlY3Rpb24uXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIExpbmtUaW1lbGluZVJlc3VsdCB7XHJcbiAgICAvKiogVmFsaWQgcGFyZW50LWNoaWxkIGdyb3VwcyB3aXRoIGNvcnJlY3QgYXJyb3cgZGlyZWN0aW9uICovXHJcbiAgICBncm91cHM6IFBhcmVudENoaWxkR3JvdXBbXTtcclxuICAgIC8qKiBDYXJkcyB3aXRoIGJhZCBkaXJlY3Rpb25hbCBhcnJvd3M6IENcdTIxOTJQIG9yIENcdTIxOTJDIHZpb2xhdGlvbnMgKi9cclxuICAgIGJhZERpcmVjdGlvbmFsQ2FyZHM6IElPQ05vZGVEYXRhW107XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBCdWlsZCBwYXJlbnQtY2hpbGQgZ3JvdXBzIGZyb20gSU9DIGRhdGEgYW5kIGNhbnZhcyBlZGdlcy5cclxuICpcclxuICogQWxnb3JpdGhtIChmbGF0IDItbGV2ZWwgaGllcmFyY2h5KTpcclxuICogICAxLiBJbmRleCBJT0Mgbm9kZXMgYnkgdGhlaXIgY2FudmFzIG5vZGUgSURcclxuICogICAyLiBCdWlsZCBlZGdlIG1hcHMgKHBhcmVudFx1MjE5MmNoaWxkcmVuIGFuZCBub2RlXHUyMTkyaGFzSW5jb21pbmcpXHJcbiAqICAgMy4gSWRlbnRpZnkgcm9vdCBwYXJlbnRzOiBvbmx5IFtQXSBjYXJkcyB3aXRoIG91dGdvaW5nIGVkZ2VzIChuZXZlciBbQ10gY2FyZHMpXHJcbiAqICAgNC4gRm9yIGVhY2ggcm9vdCBwYXJlbnQsIHJlY3Vyc2l2ZWx5IGNvbGxlY3QgYWxsIFtDXSBkZXNjZW5kYW50czpcclxuICogICAgICAtIERpcmVjdCBbQ10gY2hpbGRyZW4gYXJlIGFkZGVkLCB0aGVuIHRoZWlyIFtDXSBjaGlsZHJlbiwgYW5kIHNvIG9uXHJcbiAqICAgICAgLSBBbGwgW0NdIGRlc2NlbmRhbnRzIGFyZSBmbGF0dGVuZWQgaW50byB0aGUgc2FtZSBhcnJheSAobm8gbmVzdGluZylcclxuICogICAgICAtIENhcmRzIG1hcmtlZCBbUF0gYXJlIE5FVkVSIG5lc3RlZCAoYXBwZWFyIGFzIHNlcGFyYXRlIHJvb3QgZ3JvdXBzKVxyXG4gKiAgICAgIC0gVmlzaXRlZCBzZXQgcHJldmVudHMgY3ljbGVzL2R1cGxpY2F0ZXMgaW4gQ1x1MjE5MkMgY2hhaW5zXHJcbiAqICAgNS4gU29ydCBncm91cHMgYnkgcGFyZW50IHRpbWUsIGNoaWxkcmVuIGJ5IHRpbWUgd2l0aGluIGVhY2ggZ3JvdXBcclxuICogICA2LiBEZXRlY3QgZXJyb3IgY2FzZXM6XHJcbiAqICAgICAgLSBDYXJkcyBtYXJrZWQgW1BdIHRoYXQgaGF2ZSBpbmNvbWluZyBhcnJvd3MgRlJPTSBbQ10gY2FyZHMgKENcdTIxOTJQIHZpb2xhdGlvbnMpXHJcbiAqICAgICAgLSBPcnBoYW5lZCBbQ11cdTIxOTJbQ10gY2hhaW5zIHdpdGggbm8gW1BdIHVwc3RyZWFtIChubyByb290IHBhcmVudClcclxuICpcclxuICogQHBhcmFtIGlvY0RhdGEgLSBBbGwgcGFyc2VkIElPQyBub2RlIGRhdGEgZnJvbSB0aGUgY2FudmFzXHJcbiAqIEBwYXJhbSBlZGdlcyAtIENhbnZhcyBlZGdlcyAoYXJyb3dzKSBiZXR3ZWVuIG5vZGVzXHJcbiAqIEByZXR1cm5zIExpbmtUaW1lbGluZVJlc3VsdCB3aXRoIHZhbGlkIGdyb3VwcyBhbmQgZXJyb3IgY2FyZHNcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBidWlsZFBhcmVudENoaWxkR3JvdXBzKGlvY0RhdGE6IElPQ05vZGVEYXRhW10sIGVkZ2VzOiBFZGdlRGF0YVtdKTogTGlua1RpbWVsaW5lUmVzdWx0IHtcclxuICAgIC8vIEluZGV4IElPQyBkYXRhIGJ5IGNhbnZhcyBub2RlIElEIGZvciBmYXN0IGxvb2t1cFxyXG4gICAgY29uc3Qgbm9kZU1hcCA9IG5ldyBNYXA8c3RyaW5nLCBJT0NOb2RlRGF0YT4oKTtcclxuICAgIGZvciAoY29uc3QgaW9jIG9mIGlvY0RhdGEpIHtcclxuICAgICAgICBub2RlTWFwLnNldChpb2MuaWQsIGlvYyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQnVpbGQgZWRnZSBtYXBzXHJcbiAgICBjb25zdCBvdXRnb2luZ0VkZ2VzID0gbmV3IE1hcDxzdHJpbmcsIFNldDxzdHJpbmc+PigpOyAvLyBwYXJlbnQgXHUyMTkyIFNldCBvZiBjaGlsZCBJRHNcclxuICAgIGNvbnN0IGhhc0luY29taW5nRWRnZSA9IG5ldyBTZXQ8c3RyaW5nPigpOyAvLyBub2RlcyB0aGF0IGhhdmUgaW5jb21pbmcgYXJyb3dzXHJcbiAgICBjb25zdCBpbmNvbWluZ0Zyb20gPSBuZXcgTWFwPHN0cmluZywgU2V0PHN0cmluZz4+KCk7IC8vIG5vZGVJZCBcdTIxOTIgU2V0IG9mIHNvdXJjZSBub2RlIElEc1xyXG5cclxuICAgIGZvciAoY29uc3QgZWRnZSBvZiBlZGdlcykge1xyXG4gICAgICAgIC8vIE9ubHkgcHJvY2VzcyBlZGdlcyB3aGVyZSBib3RoIG5vZGVzIGFyZSBJT0MgY2FyZHNcclxuICAgICAgICBpZiAoIW5vZGVNYXAuaGFzKGVkZ2UuZnJvbU5vZGVJZCkgfHwgIW5vZGVNYXAuaGFzKGVkZ2UudG9Ob2RlSWQpKSBjb250aW51ZTtcclxuXHJcbiAgICAgICAgaWYgKCFvdXRnb2luZ0VkZ2VzLmhhcyhlZGdlLmZyb21Ob2RlSWQpKSB7XHJcbiAgICAgICAgICAgIG91dGdvaW5nRWRnZXMuc2V0KGVkZ2UuZnJvbU5vZGVJZCwgbmV3IFNldCgpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgb3V0Z29pbmdFZGdlcy5nZXQoZWRnZS5mcm9tTm9kZUlkKSEuYWRkKGVkZ2UudG9Ob2RlSWQpO1xyXG5cclxuICAgICAgICBoYXNJbmNvbWluZ0VkZ2UuYWRkKGVkZ2UudG9Ob2RlSWQpO1xyXG5cclxuICAgICAgICAvLyBUcmFjayBpbmNvbWluZyBzb3VyY2VzIGZvciBlcnJvciBkZXRlY3Rpb25cclxuICAgICAgICBpZiAoIWluY29taW5nRnJvbS5oYXMoZWRnZS50b05vZGVJZCkpIHtcclxuICAgICAgICAgICAgaW5jb21pbmdGcm9tLnNldChlZGdlLnRvTm9kZUlkLCBuZXcgU2V0KCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpbmNvbWluZ0Zyb20uZ2V0KGVkZ2UudG9Ob2RlSWQpIS5hZGQoZWRnZS5mcm9tTm9kZUlkKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENoZWNrIGlmIGEgbm9kZSBpcyBhIHJvb3QgcGFyZW50LlxyXG4gICAgICogUm9vdCBwYXJlbnRzIGFyZSBub2RlcyB0aGF0OlxyXG4gICAgICogICAtIEhhdmUgb3V0Z29pbmcgYXJyb3dzIChjaGlsZHJlbiksIEFORFxyXG4gICAgICogICAtIEFyZSBtYXJrZWQgW1BdIChpc0NoaWxkICE9PSB0cnVlKVxyXG4gICAgICogW0NdIGNhcmRzIGFyZSBORVZFUiByb290IHBhcmVudHMgXHUyMDE0IHRoZXkgYXJlIGFsd2F5cyBjaGlsZHJlbi5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gaXNSb290UGFyZW50KG5vZGVJZDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAgICAgY29uc3Qgbm9kZSA9IG5vZGVNYXAuZ2V0KG5vZGVJZCk7XHJcbiAgICAgICAgaWYgKCFub2RlIHx8ICFvdXRnb2luZ0VkZ2VzLmhhcyhub2RlSWQpKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgICAgIC8vIE9ubHkgW1BdIGNhcmRzIGNhbiBiZSByb290IHBhcmVudHMgXHUyMDE0IFtDXSBjYXJkcyBhcmUgYWx3YXlzIGNoaWxkcmVuXHJcbiAgICAgICAgcmV0dXJuICFub2RlLmlzQ2hpbGQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZWN1cnNpdmVseSBjb2xsZWN0IGFsbCBbQ10gZGVzY2VuZGFudHMgb2YgYSBub2RlLlxyXG4gICAgICogRm9sbG93cyBDXHUyMTkyQyBjaGFpbnMgdG8gZ2F0aGVyIHRoZSBmdWxsIHRyZWUsIGZsYXR0ZW5lZCBpbnRvIG9uZSBhcnJheS5cclxuICAgICAqIEZvciBQIFx1MjE5MiBDMSBcdTIxOTIgQzIgXHUyMTkyIEMzLCByZXR1cm5zIFtDMSwgQzIsIEMzXSBhbGwgYXQgdGhlIHNhbWUgbGV2ZWwuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHBhcmVudElkIC0gQ2FudmFzIG5vZGUgSUQgdG8gY29sbGVjdCBjaGlsZHJlbiBmcm9tXHJcbiAgICAgKiBAcGFyYW0gdmlzaXRlZCAtIFNldCBvZiBhbHJlYWR5LXZpc2l0ZWQgbm9kZSBJRHMgKHByZXZlbnRzIGN5Y2xlcy9kdXBsaWNhdGVzKVxyXG4gICAgICogQHJldHVybnMgRmxhdCBhcnJheSBvZiBhbGwgW0NdIGRlc2NlbmRhbnRzIChJT0NOb2RlRGF0YSBvbmx5KVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBidWlsZENoaWxkSGllcmFyY2h5KFxyXG4gICAgICAgIHBhcmVudElkOiBzdHJpbmcsXHJcbiAgICAgICAgdmlzaXRlZDogU2V0PHN0cmluZz5cclxuICAgICk6IChJT0NOb2RlRGF0YSB8IFBhcmVudENoaWxkR3JvdXApW10ge1xyXG4gICAgICAgIGNvbnN0IGNoaWxkSWRzID0gb3V0Z29pbmdFZGdlcy5nZXQocGFyZW50SWQpO1xyXG4gICAgICAgIGlmICghY2hpbGRJZHMgfHwgY2hpbGRJZHMuc2l6ZSA9PT0gMCkgcmV0dXJuIFtdO1xyXG5cclxuICAgICAgICBjb25zdCBjaGlsZHJlbjogKElPQ05vZGVEYXRhIHwgUGFyZW50Q2hpbGRHcm91cClbXSA9IFtdO1xyXG5cclxuICAgICAgICBmb3IgKGNvbnN0IGNoaWxkSWQgb2YgY2hpbGRJZHMpIHtcclxuICAgICAgICAgICAgaWYgKHZpc2l0ZWQuaGFzKGNoaWxkSWQpKSBjb250aW51ZTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNoaWxkTm9kZSA9IG5vZGVNYXAuZ2V0KGNoaWxkSWQpO1xyXG4gICAgICAgICAgICBpZiAoIWNoaWxkTm9kZSkgY29udGludWU7XHJcblxyXG4gICAgICAgICAgICAvLyBDYXJkcyBtYXJrZWQgW1BdIGFyZSBORVZFUiBuZXN0ZWQgLSB0aGV5IGFwcGVhciBhcyBzZXBhcmF0ZSByb290IGdyb3Vwc1xyXG4gICAgICAgICAgICBpZiAoIWNoaWxkTm9kZS5pc0NoaWxkKSBjb250aW51ZTtcclxuXHJcbiAgICAgICAgICAgIC8vIE1hcmsgdmlzaXRlZCBiZWZvcmUgcmVjdXJzaW5nIHRvIHByZXZlbnQgY3ljbGVzL2R1cGxpY2F0ZXNcclxuICAgICAgICAgICAgdmlzaXRlZC5hZGQoY2hpbGRJZCk7XHJcblxyXG4gICAgICAgICAgICAvLyBBZGQgdGhpcyBbQ10gY2FyZCBhcyBhIGxlYWYgbm9kZVxyXG4gICAgICAgICAgICBjaGlsZHJlbi5wdXNoKGNoaWxkTm9kZSk7XHJcblxyXG4gICAgICAgICAgICAvLyBSZWN1cnNpdmVseSBjb2xsZWN0IFtDXSBkZXNjZW5kYW50cyB0aHJvdWdoIENcdTIxOTJDIGNoYWlucyAoZmxhdCwgc2FtZSBsZXZlbClcclxuICAgICAgICAgICAgY29uc3QgZGVzY2VuZGFudHMgPSBidWlsZENoaWxkSGllcmFyY2h5KGNoaWxkSWQsIHZpc2l0ZWQpO1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5wdXNoKC4uLmRlc2NlbmRhbnRzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFNvcnQgY2hpbGRyZW4gYnkgdGltZSAob2xkZXN0IGZpcnN0KVxyXG4gICAgICAgIGNoaWxkcmVuLnNvcnQoKGEsIGIpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgYVRpbWUgPSAndGltZScgaW4gYSA/IG5ldyBEYXRlKGEudGltZSkuZ2V0VGltZSgpIDogbmV3IERhdGUoYS5wYXJlbnQudGltZSkuZ2V0VGltZSgpO1xyXG4gICAgICAgICAgICBjb25zdCBiVGltZSA9ICd0aW1lJyBpbiBiID8gbmV3IERhdGUoYi50aW1lKS5nZXRUaW1lKCkgOiBuZXcgRGF0ZShiLnBhcmVudC50aW1lKS5nZXRUaW1lKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBhVGltZSAtIGJUaW1lO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gY2hpbGRyZW47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQnVpbGQgcm9vdCBncm91cHNcclxuICAgIGNvbnN0IGdyb3VwczogUGFyZW50Q2hpbGRHcm91cFtdID0gW107XHJcblxyXG4gICAgZm9yIChjb25zdCBbcGFyZW50SWQsIF9dIG9mIG91dGdvaW5nRWRnZXMpIHtcclxuICAgICAgICBpZiAoIWlzUm9vdFBhcmVudChwYXJlbnRJZCkpIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICBjb25zdCBwYXJlbnQgPSBub2RlTWFwLmdldChwYXJlbnRJZCkhO1xyXG4gICAgICAgIGNvbnN0IHZpc2l0ZWQgPSBuZXcgU2V0PHN0cmluZz4oW3BhcmVudElkXSk7XHJcbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBidWlsZENoaWxkSGllcmFyY2h5KHBhcmVudElkLCB2aXNpdGVkKTtcclxuXHJcbiAgICAgICAgZ3JvdXBzLnB1c2goeyBwYXJlbnQsIGNoaWxkcmVuIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFNvcnQgZ3JvdXBzIGJ5IHBhcmVudCB0aW1lIChvbGRlc3QgZmlyc3QpXHJcbiAgICBncm91cHMuc29ydCgoYSwgYikgPT4gbmV3IERhdGUoYS5wYXJlbnQudGltZSkuZ2V0VGltZSgpIC0gbmV3IERhdGUoYi5wYXJlbnQudGltZSkuZ2V0VGltZSgpKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIENoZWNrIGlmIGEgbm9kZSBoYXMgYSBQYXJlbnQgW1BdIGNhcmQgYW55d2hlcmUgaW4gaXRzIHVwc3RyZWFtIGNoYWluLlxyXG4gICAgICogVHJhdmVyc2VzIGJhY2t3YXJkcyB0aHJvdWdoIGluY29taW5nIGFycm93cyB0byBmaW5kIGFuY2VzdHJ5LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBub2RlSWQgLSBDYW52YXMgbm9kZSBJRCB0byBjaGVja1xyXG4gICAgICogQHBhcmFtIHZpc2l0ZWQgLSBTZXQgb2YgYWxyZWFkeS12aXNpdGVkIG5vZGUgSURzIChwcmV2ZW50cyBjeWNsZXMpXHJcbiAgICAgKiBAcmV0dXJucyB0cnVlIGlmIGEgW1BdIGNhcmQgZXhpc3RzIHVwc3RyZWFtLCBmYWxzZSBvdGhlcndpc2VcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gaGFzUGFyZW50SW5VcHN0cmVhbShub2RlSWQ6IHN0cmluZywgdmlzaXRlZDogU2V0PHN0cmluZz4gPSBuZXcgU2V0KCkpOiBib29sZWFuIHtcclxuICAgICAgICAvLyBQcmV2ZW50IGluZmluaXRlIGxvb3BzIGluIGN5Y2xpYyBncmFwaHNcclxuICAgICAgICBpZiAodmlzaXRlZC5oYXMobm9kZUlkKSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIHZpc2l0ZWQuYWRkKG5vZGVJZCk7XHJcblxyXG4gICAgICAgIGNvbnN0IG5vZGUgPSBub2RlTWFwLmdldChub2RlSWQpO1xyXG4gICAgICAgIGlmICghbm9kZSkgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICAvLyBJZiB0aGlzIG5vZGUgaXRzZWxmIGlzIGEgUGFyZW50LCByZXR1cm4gdHJ1ZVxyXG4gICAgICAgIGlmICghbm9kZS5pc0NoaWxkKSByZXR1cm4gdHJ1ZTtcclxuXHJcbiAgICAgICAgLy8gR2V0IGFsbCBpbmNvbWluZyBzb3VyY2VzIChub2RlcyBwb2ludGluZyB0byB0aGlzIG9uZSlcclxuICAgICAgICBjb25zdCBzb3VyY2VzID0gaW5jb21pbmdGcm9tLmdldChub2RlSWQpO1xyXG4gICAgICAgIGlmICghc291cmNlcyB8fCBzb3VyY2VzLnNpemUgPT09IDApIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgLy8gUmVjdXJzaXZlbHkgY2hlY2sgaWYgYW55IHNvdXJjZSBoYXMgYSBwYXJlbnQgdXBzdHJlYW1cclxuICAgICAgICBmb3IgKGNvbnN0IHNvdXJjZUlkIG9mIHNvdXJjZXMpIHtcclxuICAgICAgICAgICAgaWYgKGhhc1BhcmVudEluVXBzdHJlYW0oc291cmNlSWQsIHZpc2l0ZWQpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIElkZW50aWZ5IGNhcmRzIHdpdGggYmFkIGRpcmVjdGlvbmFsIGFycm93czpcclxuICAgIC8vIDEuIENhcmRzIG1hcmtlZCBbUF0gdGhhdCBoYXZlIGluY29taW5nIGFycm93cyBGUk9NIFtDXSBjYXJkcyAoQ2hpbGRcdTIxOTJQYXJlbnQgdmlvbGF0aW9ucylcclxuICAgIC8vIDIuIE9ycGhhbmVkIFtDXSBjYXJkcyB3aXRoIG5vIFtQXSBwYXJlbnQgaW4gdXBzdHJlYW0gY2hhaW4gKG9ycGhhbmVkIENoaWxkXHUyMTkyQ2hpbGQgdmlvbGF0aW9ucylcclxuICAgIGNvbnN0IGJhZERpcmVjdGlvbmFsQ2FyZFNldCA9IG5ldyBTZXQ8c3RyaW5nPigpO1xyXG5cclxuICAgIC8vIEVycm9yIERldGVjdGlvbiAxOiBDaGlsZCBcdTIxOTIgUGFyZW50IGFycm93c1xyXG4gICAgZm9yIChjb25zdCBpb2Mgb2YgaW9jRGF0YSkge1xyXG4gICAgICAgIC8vIFNraXAgY2hpbGQgY2FyZHMgZm9yIHRoaXMgY2hlY2tcclxuICAgICAgICBpZiAoaW9jLmlzQ2hpbGQpIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAvLyBHZXQgYWxsIGluY29taW5nIHNvdXJjZXMgZm9yIHRoaXMgW1BdIGNhcmRcclxuICAgICAgICBjb25zdCBpbmNvbWluZ1NvdXJjZXMgPSBpbmNvbWluZ0Zyb20uZ2V0KGlvYy5pZCk7XHJcbiAgICAgICAgaWYgKCFpbmNvbWluZ1NvdXJjZXMgfHwgaW5jb21pbmdTb3VyY2VzLnNpemUgPT09IDApIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAvLyBDaGVjayBpZiBBTlkgaW5jb21pbmcgc291cmNlIGlzIGEgW0NdIGNhcmRcclxuICAgICAgICBsZXQgaGFzQ2hpbGRTb3VyY2UgPSBmYWxzZTtcclxuICAgICAgICBmb3IgKGNvbnN0IHNvdXJjZUlkIG9mIGluY29taW5nU291cmNlcykge1xyXG4gICAgICAgICAgICBjb25zdCBzb3VyY2VOb2RlID0gbm9kZU1hcC5nZXQoc291cmNlSWQpO1xyXG4gICAgICAgICAgICBpZiAoc291cmNlTm9kZSAmJiBzb3VyY2VOb2RlLmlzQ2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIGhhc0NoaWxkU291cmNlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBPbmx5IGZsYWcgaWYgYXQgbGVhc3Qgb25lIGluY29taW5nIGFycm93IGlzIGZyb20gYSBbQ10gY2FyZFxyXG4gICAgICAgIGlmIChoYXNDaGlsZFNvdXJjZSkge1xyXG4gICAgICAgICAgICBiYWREaXJlY3Rpb25hbENhcmRTZXQuYWRkKGlvYy5pZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEVycm9yIERldGVjdGlvbiAyOiBDaGlsZCBcdTIxOTIgQ2hpbGQgYXJyb3dzIHdpdGhvdXQgcGFyZW50IHVwc3RyZWFtXHJcbiAgICBmb3IgKGNvbnN0IFtjaGlsZElkLCBzb3VyY2VzXSBvZiBpbmNvbWluZ0Zyb20uZW50cmllcygpKSB7XHJcbiAgICAgICAgY29uc3QgY2hpbGROb2RlID0gbm9kZU1hcC5nZXQoY2hpbGRJZCk7XHJcbiAgICAgICAgaWYgKCFjaGlsZE5vZGUgfHwgIWNoaWxkTm9kZS5pc0NoaWxkKSBjb250aW51ZTsgLy8gT25seSBjaGVjayBbQ10gY2FyZHNcclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgQU5ZIHNvdXJjZSBpcyBhbHNvIGEgW0NdIGNhcmRcclxuICAgICAgICBmb3IgKGNvbnN0IHNvdXJjZUlkIG9mIHNvdXJjZXMpIHtcclxuICAgICAgICAgICAgY29uc3Qgc291cmNlTm9kZSA9IG5vZGVNYXAuZ2V0KHNvdXJjZUlkKTtcclxuICAgICAgICAgICAgaWYgKHNvdXJjZU5vZGUgJiYgc291cmNlTm9kZS5pc0NoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBbQ10gXHUyMTkyIFtDXSBhcnJvdyBmb3VuZCAtIGNoZWNrIGlmIHBhcmVudCBleGlzdHMgdXBzdHJlYW1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGhhc1BhcmVudCA9IGhhc1BhcmVudEluVXBzdHJlYW0oY2hpbGRJZCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gT25seSBmbGFnIGFzIGVycm9yIGlmIE5PIHBhcmVudCBleGlzdHMgaW4gdXBzdHJlYW0gY2hhaW5cclxuICAgICAgICAgICAgICAgIGlmICghaGFzUGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYmFkRGlyZWN0aW9uYWxDYXJkU2V0LmFkZChzb3VyY2VJZCk7IC8vIFRoZSBzb3VyY2UgW0NdXHJcbiAgICAgICAgICAgICAgICAgICAgYmFkRGlyZWN0aW9uYWxDYXJkU2V0LmFkZChjaGlsZElkKTsgIC8vIFRoZSB0YXJnZXQgW0NdXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ29udmVydCBTZXQgdG8gYXJyYXkgYW5kIHNvcnQgYnkgdGltZVxyXG4gICAgY29uc3QgYmFkRGlyZWN0aW9uYWxDYXJkcyA9IEFycmF5LmZyb20oYmFkRGlyZWN0aW9uYWxDYXJkU2V0KVxyXG4gICAgICAgIC5tYXAoaWQgPT4gbm9kZU1hcC5nZXQoaWQpISlcclxuICAgICAgICAuZmlsdGVyKEJvb2xlYW4pXHJcbiAgICAgICAgLnNvcnQoKGEsIGIpID0+IG5ldyBEYXRlKGEudGltZSkuZ2V0VGltZSgpIC0gbmV3IERhdGUoYi50aW1lKS5nZXRUaW1lKCkpO1xyXG5cclxuICAgIHJldHVybiB7IGdyb3VwcywgYmFkRGlyZWN0aW9uYWxDYXJkcyB9O1xyXG59XHJcbiIsICIvKipcclxuICogTGlua1RpbWVsaW5lQ2FyZFJvdy50cyAtIFNoYXJlZCBjYXJkIHJvdyByZW5kZXJpbmcgZm9yIExpbmsgVGltZWxpbmVcclxuICpcclxuICogUmVuZGVycyBhbiBJT0MgY2FyZCByb3cgd2l0aCByb2xlIGJhZGdlLCBpY29uLCBhbmQgZGV0YWlscy5cclxuICogVXNlZCBieSByZW5kZXJMZWFmTm9kZSBhbmQgZXJyb3IgaXRlbSByZW5kZXJpbmcgaW4gTGlua1RpbWVsaW5lVGFiLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IElPQ05vZGVEYXRhIH0gZnJvbSAnLi4vdHlwZXMvSU9DTm9kZURhdGEnO1xyXG5cclxuLyoqXHJcbiAqIE9wdGlvbnMgZm9yIHJlbmRlcmluZyBhbiBJT0MgY2FyZCByb3cgaW4gdGhlIExpbmsgVGltZWxpbmUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIENhcmRSb3dPcHRpb25zIHtcclxuICAgIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XHJcbiAgICBpb2M6IElPQ05vZGVEYXRhO1xyXG4gICAgc2hvd0Nvbm5lY3Rvcj86IGJvb2xlYW47XHJcbiAgICBkZXB0aD86IG51bWJlcjtcclxuICAgIGV4dHJhQ2xhc3Nlcz86IHN0cmluZ1tdO1xyXG59XHJcblxyXG4vKipcclxuICogUmVuZGVyIGEgc2luZ2xlIElPQyBjYXJkIHJvdyB3aXRoIHJvbGUgYmFkZ2UsIGljb24sIGFuZCBkZXRhaWxzLlxyXG4gKiBAcmV0dXJucyBUaGUgY3JlYXRlZCByb3cgSFRNTEVsZW1lbnRcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJJT0NDYXJkUm93KG9wdHM6IENhcmRSb3dPcHRpb25zKTogSFRNTEVsZW1lbnQge1xyXG4gICAgY29uc3QgeyBjb250YWluZXIsIGlvYywgc2hvd0Nvbm5lY3RvciA9IGZhbHNlLCBkZXB0aCA9IDAsIGV4dHJhQ2xhc3NlcyA9IFtdIH0gPSBvcHRzO1xyXG5cclxuICAgIGNvbnN0IHJvd0VsID0gY29udGFpbmVyLmNyZWF0ZURpdignbGluay10aW1lbGluZS1jaGlsZCcpO1xyXG4gICAgZXh0cmFDbGFzc2VzLmZvckVhY2goY2xzID0+IHJvd0VsLmNsYXNzTGlzdC5hZGQoY2xzKSk7XHJcbiAgICBpZiAoZGVwdGggPiAwKSB7XHJcbiAgICAgICAgcm93RWwuY2xhc3NMaXN0LmFkZChgZGVwdGgtJHtkZXB0aH1gKTtcclxuICAgICAgICByb3dFbC5zdHlsZS5tYXJnaW5MZWZ0ID0gYCR7ZGVwdGggKiAzMH1weGA7XHJcbiAgICB9XHJcbiAgICByb3dFbC5zdHlsZS5ib3JkZXJMZWZ0Q29sb3IgPSBpb2MuY29sb3I7XHJcblxyXG4gICAgaWYgKHNob3dDb25uZWN0b3IpIHtcclxuICAgICAgICByb3dFbC5jcmVhdGVEaXYoJ2xpbmstdGltZWxpbmUtY29ubmVjdG9yJyk7XHJcbiAgICB9XHJcblxyXG4gICAgcm93RWwuY3JlYXRlRWwoJ3NwYW4nLCB7XHJcbiAgICAgICAgdGV4dDogaW9jLmlzQ2hpbGQgPyAnW0NdJyA6ICdbUF0nLFxyXG4gICAgICAgIGNsczogYGxpbmstdGltZWxpbmUtcm9sZS1iYWRnZSAke2lvYy5pc0NoaWxkID8gJ3JvbGUtY2hpbGQnIDogJ3JvbGUtcGFyZW50J31gXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBpY29uRWwgPSByb3dFbC5jcmVhdGVEaXYoJ2xpbmstdGltZWxpbmUtaWNvbicpO1xyXG4gICAgaWNvbkVsLmlubmVySFRNTCA9IGlvYy5pY29uO1xyXG4gICAgaWNvbkVsLnN0eWxlLmNvbG9yID0gaW9jLmNvbG9yO1xyXG5cclxuICAgIGNvbnN0IGRldGFpbHNFbCA9IHJvd0VsLmNyZWF0ZURpdignbGluay10aW1lbGluZS1kZXRhaWxzJyk7XHJcbiAgICBkZXRhaWxzRWwuY3JlYXRlRWwoJ3N0cm9uZycsIHsgdGV4dDogaW9jLnR5cGUgfSk7XHJcbiAgICBpZiAoaW9jLnRpbWUpIHtcclxuICAgICAgICBkZXRhaWxzRWwuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6IGAgfCAke2lvYy50aW1lfWAsIGNsczogJ2xpbmstdGltZWxpbmUtdGltZScgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAoaW9jLmNhcmRJZCkge1xyXG4gICAgICAgIGRldGFpbHNFbC5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogYCB8ICR7aW9jLmNhcmRJZH1gLCBjbHM6ICdsaW5rLXRpbWVsaW5lLWNhcmQtaWQnIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKGlvYy52YWx1ZSAmJiBpb2MudmFsdWUudHJpbSgpKSB7XHJcbiAgICAgICAgZGV0YWlsc0VsLmNyZWF0ZURpdih7IHRleHQ6IGlvYy52YWx1ZSwgY2xzOiAnbGluay10aW1lbGluZS12YWx1ZScgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAoaW9jLnRhY3RpYykge1xyXG4gICAgICAgIGRldGFpbHNFbC5jcmVhdGVEaXYoeyB0ZXh0OiBgVGFjdGljOiAke2lvYy50YWN0aWN9YCwgY2xzOiAnbGluay10aW1lbGluZS10YWN0aWMnIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKGlvYy50ZWNobmlxdWUpIHtcclxuICAgICAgICBkZXRhaWxzRWwuY3JlYXRlRGl2KHsgdGV4dDogYFRlY2huaXF1ZTogJHtpb2MudGVjaG5pcXVlfWAsIGNsczogJ2xpbmstdGltZWxpbmUtdGVjaG5pcXVlJyB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcm93RWw7XHJcbn1cclxuIiwgIi8qKlxyXG4gKiBMaW5rVGltZWxpbmVUYWIudHMgLSBFeHBhbmRhYmxlIHBhcmVudC1jaGlsZCB0aW1lbGluZSB2aWV3XHJcbiAqXHJcbiAqIFJlbmRlcnMgSU9DIGNhcmRzIGdyb3VwZWQgYnkgY2FudmFzIGFycm93IGNvbm5lY3Rpb25zLiBFYWNoIHBhcmVudCBjYXJkXHJcbiAqIGhhcyBhbiBleHBhbmQvY29sbGFwc2UgdG9nZ2xlIHRvIHNob3cgaXRzIGxpbmtlZCBjaGlsZCBjYXJkcy4gQ2hpbGRyZW5cclxuICogYXJlIHJlbmRlcmVkIGluZGVudGVkIHdpdGggYSB2ZXJ0aWNhbCBjb25uZWN0b3IgbGluZS5cclxuICpcclxuICogVXNlcyBmbGF0IDItbGV2ZWwgaGllcmFyY2h5OiBbUF0gXHUyMTkyIFtDXSAoYWxsIGNoaWxkcmVuIGF0IHNhbWUgaW5kZW50YXRpb24pLlxyXG4gKiBPcnBoYW5lZCBDXHUyMTkyQyBhcnJvd3MgKG5vIFtQXSB1cHN0cmVhbSkgYXJlIGZsYWdnZWQgYXMgZXJyb3JzLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFBhcmVudENoaWxkR3JvdXAsIExpbmtUaW1lbGluZVJlc3VsdCB9IGZyb20gJy4vTGlua1RpbWVsaW5lUHJvY2Vzc2luZyc7XHJcbmltcG9ydCB7IElPQ05vZGVEYXRhIH0gZnJvbSAnLi4vdHlwZXMvSU9DTm9kZURhdGEnO1xyXG5pbXBvcnQgeyByZW5kZXJJT0NDYXJkUm93IH0gZnJvbSAnLi9MaW5rVGltZWxpbmVDYXJkUm93JztcclxuXHJcbi8qKlxyXG4gKiBUeXBlIGd1YXJkIHRvIGNoZWNrIGlmIGFuIGl0ZW0gaXMgYSBQYXJlbnRDaGlsZEdyb3VwIChuZXN0ZWQpIG9yIElPQ05vZGVEYXRhIChsZWFmKS5cclxuICovXHJcbmZ1bmN0aW9uIGlzUGFyZW50Q2hpbGRHcm91cChpdGVtOiBJT0NOb2RlRGF0YSB8IFBhcmVudENoaWxkR3JvdXApOiBpdGVtIGlzIFBhcmVudENoaWxkR3JvdXAge1xyXG4gICAgcmV0dXJuICdjaGlsZHJlbicgaW4gaXRlbSAmJiBBcnJheS5pc0FycmF5KChpdGVtIGFzIGFueSkuY2hpbGRyZW4pO1xyXG59XHJcblxyXG4vKipcclxuICogUmVuZGVyIHRoZSBsaW5rLWJhc2VkIHRpbWVsaW5lIHRhYiBjb250ZW50LlxyXG4gKlxyXG4gKiBGb3IgZWFjaCBwYXJlbnQtY2hpbGQgZ3JvdXA6XHJcbiAqICAgLSBQYXJlbnQgY2FyZCBoZWFkZXIgd2l0aCBbUF0gYmFkZ2UsIHR5cGUsIHRpbWUsIHZhbHVlLCBleHBhbmQgdG9nZ2xlXHJcbiAqICAgLSBDb2xsYXBzaWJsZSBjaGlsZHJlbiBzZWN0aW9uIHdpdGggW0NdIGJhZGdlcyBhbmQgdmVydGljYWwgY29ubmVjdG9yXHJcbiAqICAgLSBGbGF0IDItbGV2ZWwgaGllcmFyY2h5OiBhbGwgW0NdIGNhcmRzIGF0IHNhbWUgaW5kZW50YXRpb24gdW5kZXIgW1BdXHJcbiAqICAgLSBEZWZhdWx0IHN0YXRlOiBjb2xsYXBzZWQgKGNoaWxkcmVuIGhpZGRlbilcclxuICogICAtIEVycm9yIHNlY3Rpb24gZm9yIGNhcmRzIHdpdGggYmFkIGRpcmVjdGlvbmFsIGFycm93cyAoQ1x1MjE5MlAgYW5kIENcdTIxOTJDKVxyXG4gKlxyXG4gKiBAcGFyYW0gY29udGFpbmVyIC0gUGFyZW50IERPTSBlbGVtZW50IHRvIHJlbmRlciBpbnRvXHJcbiAqIEBwYXJhbSByZXN1bHQgLSBMaW5rVGltZWxpbmVSZXN1bHQgd2l0aCB2YWxpZCBncm91cHMgYW5kIGVycm9yIGNhcmRzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyTGlua1RpbWVsaW5lKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIHJlc3VsdDogTGlua1RpbWVsaW5lUmVzdWx0KTogdm9pZCB7XHJcbiAgICBjb25zdCB7IGdyb3VwcywgYmFkRGlyZWN0aW9uYWxDYXJkcyB9ID0gcmVzdWx0O1xyXG5cclxuICAgIGlmIChncm91cHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZUVsKCdwJywge1xyXG4gICAgICAgICAgICB0ZXh0OiAnTm8gSU9DIGNhcmRzIGZvdW5kLiBDcmVhdGUgcGFyZW50IGFuZCBjaGlsZCBjYXJkcywgdGhlbiBkcmF3IGFycm93cyBiZXR3ZWVuIHRoZW0uJyxcclxuICAgICAgICAgICAgY2xzOiAndGltZWxpbmUtZW1wdHktbWVzc2FnZSdcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ291bnQgZ3JvdXBzIHRoYXQgaGF2ZSBjaGlsZHJlblxyXG4gICAgY29uc3QgbGlua2VkR3JvdXBzID0gZ3JvdXBzLmZpbHRlcihnID0+IGcuY2hpbGRyZW4ubGVuZ3RoID4gMCk7XHJcbiAgICBpZiAobGlua2VkR3JvdXBzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVFbCgncCcsIHtcclxuICAgICAgICAgICAgdGV4dDogJ05vIHBhcmVudC1jaGlsZCByZWxhdGlvbnNoaXBzIGZvdW5kLiBEcmF3IGFycm93cyBiZXR3ZWVuIElPQyBjYXJkcyB0byBjcmVhdGUgbGlua3MgKGFycm93IGZyb20gcGFyZW50IHRvIGNoaWxkKS4nLFxyXG4gICAgICAgICAgICBjbHM6ICd0aW1lbGluZS1lbXB0eS1tZXNzYWdlJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVuZGVyIGEgY2hpbGQgaXRlbSAobGVhZiBub2RlIG9ubHkgaW4gZmxhdCBoaWVyYXJjaHkpLlxyXG4gICAgICogTm90ZTogV2l0aCBmbGF0IGhpZXJhcmNoeSwgY2hpbGQgd2lsbCBhbHdheXMgYmUgSU9DTm9kZURhdGEgKG5ldmVyIFBhcmVudENoaWxkR3JvdXApLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBjaGlsZHJlbkNvbnRhaW5lciAtIFBhcmVudCBET00gZWxlbWVudCB0byBhcHBlbmQgdGhlIGNoaWxkIHRvXHJcbiAgICAgKiBAcGFyYW0gY2hpbGQgLSBDaGlsZCBpdGVtIChJT0NOb2RlRGF0YSBvciBQYXJlbnRDaGlsZEdyb3VwLCBidXQgYWx3YXlzIElPQ05vZGVEYXRhIGluIHByYWN0aWNlKVxyXG4gICAgICogQHBhcmFtIGRlcHRoIC0gTmVzdGluZyBkZXB0aCAoYWx3YXlzIDAgaW4gZmxhdCBoaWVyYXJjaHkpXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHJlbmRlckNoaWxkKFxyXG4gICAgICAgIGNoaWxkcmVuQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcclxuICAgICAgICBjaGlsZDogSU9DTm9kZURhdGEgfCBQYXJlbnRDaGlsZEdyb3VwLFxyXG4gICAgICAgIGRlcHRoOiBudW1iZXJcclxuICAgICk6IHZvaWQge1xyXG4gICAgICAgIGlmIChpc1BhcmVudENoaWxkR3JvdXAoY2hpbGQpKSB7XHJcbiAgICAgICAgICAgIC8vIE5lc3RlZCBwYXJlbnQgZ3JvdXAgLSByZW5kZXIgYXMgc3ViLXBhcmVudCB3aXRoIGl0cyBvd24gY2hpbGRyZW5cclxuICAgICAgICAgICAgcmVuZGVyTmVzdGVkR3JvdXAoY2hpbGRyZW5Db250YWluZXIsIGNoaWxkLCBkZXB0aCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gTGVhZiBub2RlIC0gcmVuZGVyIGFzIHNpbXBsZSBjaGlsZFxyXG4gICAgICAgICAgICByZW5kZXJMZWFmTm9kZShjaGlsZHJlbkNvbnRhaW5lciwgY2hpbGQsIGRlcHRoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW5kZXIgYSBsZWFmIGNoaWxkIG5vZGUgKG5vIG5lc3RlZCBjaGlsZHJlbikuXHJcbiAgICAgKiBEZWxlZ2F0ZXMgdG8gc2hhcmVkIHJlbmRlcklPQ0NhcmRSb3cgaGVscGVyLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBjaGlsZHJlbkNvbnRhaW5lciAtIFBhcmVudCBET00gZWxlbWVudFxyXG4gICAgICogQHBhcmFtIGNoaWxkIC0gQ2hpbGQgSU9DIG5vZGUgZGF0YVxyXG4gICAgICogQHBhcmFtIGRlcHRoIC0gTmVzdGluZyBkZXB0aCAoZm9yIGluZGVudGF0aW9uKVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiByZW5kZXJMZWFmTm9kZShcclxuICAgICAgICBjaGlsZHJlbkNvbnRhaW5lcjogSFRNTEVsZW1lbnQsXHJcbiAgICAgICAgY2hpbGQ6IElPQ05vZGVEYXRhLFxyXG4gICAgICAgIGRlcHRoOiBudW1iZXJcclxuICAgICk6IHZvaWQge1xyXG4gICAgICAgIHJlbmRlcklPQ0NhcmRSb3coe1xyXG4gICAgICAgICAgICBjb250YWluZXI6IGNoaWxkcmVuQ29udGFpbmVyLFxyXG4gICAgICAgICAgICBpb2M6IGNoaWxkLFxyXG4gICAgICAgICAgICBzaG93Q29ubmVjdG9yOiB0cnVlLFxyXG4gICAgICAgICAgICBkZXB0aFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVuZGVyIGEgbmVzdGVkIHBhcmVudCBncm91cCAoaGFzIGl0cyBvd24gY2hpbGRyZW4pLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBjaGlsZHJlbkNvbnRhaW5lciAtIFBhcmVudCBET00gZWxlbWVudFxyXG4gICAgICogQHBhcmFtIGdyb3VwIC0gTmVzdGVkIHBhcmVudC1jaGlsZCBncm91cFxyXG4gICAgICogQHBhcmFtIGRlcHRoIC0gTmVzdGluZyBkZXB0aCAoZm9yIGluZGVudGF0aW9uKVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiByZW5kZXJOZXN0ZWRHcm91cChcclxuICAgICAgICBjaGlsZHJlbkNvbnRhaW5lcjogSFRNTEVsZW1lbnQsXHJcbiAgICAgICAgZ3JvdXA6IFBhcmVudENoaWxkR3JvdXAsXHJcbiAgICAgICAgZGVwdGg6IG51bWJlclxyXG4gICAgKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgbmVzdGVkR3JvdXBFbCA9IGNoaWxkcmVuQ29udGFpbmVyLmNyZWF0ZURpdignbGluay10aW1lbGluZS1jaGlsZCBsaW5rLXRpbWVsaW5lLW5lc3RlZC1wYXJlbnQnKTtcclxuICAgICAgICBuZXN0ZWRHcm91cEVsLmNsYXNzTGlzdC5hZGQoYGRlcHRoLSR7ZGVwdGh9YCk7XHJcbiAgICAgICAgbmVzdGVkR3JvdXBFbC5zdHlsZS5ib3JkZXJMZWZ0Q29sb3IgPSBncm91cC5wYXJlbnQuY29sb3I7XHJcbiAgICAgICAgbmVzdGVkR3JvdXBFbC5zdHlsZS5tYXJnaW5MZWZ0ID0gYCR7ZGVwdGggKiAzMH1weGA7IC8vIDMwcHggcGVyIGRlcHRoIGxldmVsXHJcblxyXG4gICAgICAgIC8vIENvbm5lY3RvciBsaW5lXHJcbiAgICAgICAgbmVzdGVkR3JvdXBFbC5jcmVhdGVEaXYoJ2xpbmstdGltZWxpbmUtY29ubmVjdG9yJyk7XHJcblxyXG4gICAgICAgIC8vIEV4cGFuZCB0b2dnbGUgKG5lc3RlZCBwYXJlbnRzIGFyZSBhbHdheXMgZXhwYW5kYWJsZSlcclxuICAgICAgICBjb25zdCB0b2dnbGVFbCA9IG5lc3RlZEdyb3VwRWwuY3JlYXRlRGl2KCdsaW5rLXRpbWVsaW5lLWV4cGFuZC10b2dnbGUnKTtcclxuICAgICAgICB0b2dnbGVFbC50ZXh0Q29udGVudCA9ICdcXHUyNUI2JzsgLy8gXHUyNUI2XHJcbiAgICAgICAgdG9nZ2xlRWwuY2xhc3NMaXN0LmFkZCgnaGFzLWNoaWxkcmVuJyk7XHJcblxyXG4gICAgICAgIC8vIFJvbGUgYmFkZ2VcclxuICAgICAgICBuZXN0ZWRHcm91cEVsLmNyZWF0ZUVsKCdzcGFuJywge1xyXG4gICAgICAgICAgICB0ZXh0OiBncm91cC5wYXJlbnQuaXNDaGlsZCA/ICdbQ10nIDogJ1tQXScsXHJcbiAgICAgICAgICAgIGNsczogYGxpbmstdGltZWxpbmUtcm9sZS1iYWRnZSAke2dyb3VwLnBhcmVudC5pc0NoaWxkID8gJ3JvbGUtY2hpbGQnIDogJ3JvbGUtcGFyZW50J31gXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIEljb25cclxuICAgICAgICBjb25zdCBpY29uRWwgPSBuZXN0ZWRHcm91cEVsLmNyZWF0ZURpdignbGluay10aW1lbGluZS1pY29uJyk7XHJcbiAgICAgICAgaWNvbkVsLmlubmVySFRNTCA9IGdyb3VwLnBhcmVudC5pY29uO1xyXG4gICAgICAgIGljb25FbC5zdHlsZS5jb2xvciA9IGdyb3VwLnBhcmVudC5jb2xvcjtcclxuXHJcbiAgICAgICAgLy8gRGV0YWlsc1xyXG4gICAgICAgIGNvbnN0IGRldGFpbHNFbCA9IG5lc3RlZEdyb3VwRWwuY3JlYXRlRGl2KCdsaW5rLXRpbWVsaW5lLWRldGFpbHMnKTtcclxuICAgICAgICBkZXRhaWxzRWwuY3JlYXRlRWwoJ3N0cm9uZycsIHsgdGV4dDogZ3JvdXAucGFyZW50LnR5cGUgfSk7XHJcbiAgICAgICAgaWYgKGdyb3VwLnBhcmVudC50aW1lKSB7XHJcbiAgICAgICAgICAgIGRldGFpbHNFbC5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogYCB8ICR7Z3JvdXAucGFyZW50LnRpbWV9YCwgY2xzOiAnbGluay10aW1lbGluZS10aW1lJyB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGdyb3VwLnBhcmVudC5jYXJkSWQpIHtcclxuICAgICAgICAgICAgZGV0YWlsc0VsLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiBgIHwgJHtncm91cC5wYXJlbnQuY2FyZElkfWAsIGNsczogJ2xpbmstdGltZWxpbmUtY2FyZC1pZCcgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChncm91cC5wYXJlbnQudmFsdWUgJiYgZ3JvdXAucGFyZW50LnZhbHVlLnRyaW0oKSkge1xyXG4gICAgICAgICAgICBkZXRhaWxzRWwuY3JlYXRlRGl2KHsgdGV4dDogZ3JvdXAucGFyZW50LnZhbHVlLCBjbHM6ICdsaW5rLXRpbWVsaW5lLXZhbHVlJyB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENoaWxkcmVuIGNvdW50IGJhZGdlXHJcbiAgICAgICAgbmVzdGVkR3JvdXBFbC5jcmVhdGVFbCgnc3BhbicsIHtcclxuICAgICAgICAgICAgdGV4dDogU3RyaW5nKGdyb3VwLmNoaWxkcmVuLmxlbmd0aCksXHJcbiAgICAgICAgICAgIGNsczogJ2xpbmstdGltZWxpbmUtY291bnQnXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIE5lc3RlZCBjaGlsZHJlbiBjb250YWluZXIgKGNvbGxhcHNlZCBieSBkZWZhdWx0KVxyXG4gICAgICAgIGNvbnN0IG5lc3RlZENoaWxkcmVuRWwgPSBjaGlsZHJlbkNvbnRhaW5lci5jcmVhdGVEaXYoJ2xpbmstdGltZWxpbmUtbmVzdGVkLWNoaWxkcmVuJyk7XHJcbiAgICAgICAgbmVzdGVkQ2hpbGRyZW5FbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG5cclxuICAgICAgICAvLyBSZWN1cnNpdmVseSByZW5kZXIgbmVzdGVkIGNoaWxkcmVuIChkZXB0aCArIDEpXHJcbiAgICAgICAgZ3JvdXAuY2hpbGRyZW4uZm9yRWFjaChuZXN0ZWRDaGlsZCA9PiB7XHJcbiAgICAgICAgICAgIHJlbmRlckNoaWxkKG5lc3RlZENoaWxkcmVuRWwsIG5lc3RlZENoaWxkLCBkZXB0aCArIDEpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBUb2dnbGUgZXhwYW5kL2NvbGxhcHNlIG9uIG5lc3RlZCBwYXJlbnQgY2xpY2tcclxuICAgICAgICBuZXN0ZWRHcm91cEVsLnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJztcclxuICAgICAgICBuZXN0ZWRHcm91cEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsgLy8gUHJldmVudCBidWJibGluZyB0byBwYXJlbnQgdG9nZ2xlc1xyXG4gICAgICAgICAgICBjb25zdCBpc0V4cGFuZGVkID0gbmVzdGVkQ2hpbGRyZW5FbC5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZSc7XHJcbiAgICAgICAgICAgIG5lc3RlZENoaWxkcmVuRWwuc3R5bGUuZGlzcGxheSA9IGlzRXhwYW5kZWQgPyAnbm9uZScgOiAnYmxvY2snO1xyXG4gICAgICAgICAgICB0b2dnbGVFbC50ZXh0Q29udGVudCA9IGlzRXhwYW5kZWQgPyAnXFx1MjVCNicgOiAnXFx1MjVCQyc7IC8vIFx1MjVCNiAvIFx1MjVCQ1xyXG4gICAgICAgICAgICB0b2dnbGVFbC5jbGFzc0xpc3QudG9nZ2xlKCdleHBhbmRlZCcsICFpc0V4cGFuZGVkKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZW5kZXIgcm9vdC1sZXZlbCBncm91cHNcclxuICAgIGdyb3Vwcy5mb3JFYWNoKGdyb3VwID0+IHtcclxuICAgICAgICBjb25zdCBncm91cEVsID0gY29udGFpbmVyLmNyZWF0ZURpdignbGluay10aW1lbGluZS1ncm91cCcpO1xyXG5cclxuICAgICAgICAvLyBQYXJlbnQgY2FyZCByb3cgKHJvb3QtbGV2ZWwsIGRlcHRoIDApXHJcbiAgICAgICAgY29uc3QgcGFyZW50RWwgPSBncm91cEVsLmNyZWF0ZURpdignbGluay10aW1lbGluZS1wYXJlbnQnKTtcclxuICAgICAgICBwYXJlbnRFbC5zdHlsZS5ib3JkZXJMZWZ0Q29sb3IgPSBncm91cC5wYXJlbnQuY29sb3I7XHJcblxyXG4gICAgICAgIC8vIEV4cGFuZCB0b2dnbGUgKG9ubHkgaWYgaGFzIGNoaWxkcmVuKVxyXG4gICAgICAgIGNvbnN0IGhhc0NoaWxkcmVuID0gZ3JvdXAuY2hpbGRyZW4ubGVuZ3RoID4gMDtcclxuICAgICAgICBjb25zdCB0b2dnbGVFbCA9IHBhcmVudEVsLmNyZWF0ZURpdignbGluay10aW1lbGluZS1leHBhbmQtdG9nZ2xlJyk7XHJcbiAgICAgICAgaWYgKGhhc0NoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgIHRvZ2dsZUVsLnRleHRDb250ZW50ID0gJ1xcdTI1QjYnOyAvLyBcdTI1QjZcclxuICAgICAgICAgICAgdG9nZ2xlRWwuY2xhc3NMaXN0LmFkZCgnaGFzLWNoaWxkcmVuJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBSb2xlIGJhZGdlXHJcbiAgICAgICAgY29uc3Qgcm9sZUJhZGdlID0gcGFyZW50RWwuY3JlYXRlRWwoJ3NwYW4nLCB7XHJcbiAgICAgICAgICAgIHRleHQ6IGdyb3VwLnBhcmVudC5pc0NoaWxkID8gJ1tDXScgOiAnW1BdJyxcclxuICAgICAgICAgICAgY2xzOiBgbGluay10aW1lbGluZS1yb2xlLWJhZGdlICR7Z3JvdXAucGFyZW50LmlzQ2hpbGQgPyAncm9sZS1jaGlsZCcgOiAncm9sZS1wYXJlbnQnfWBcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gSWNvblxyXG4gICAgICAgIGNvbnN0IGljb25FbCA9IHBhcmVudEVsLmNyZWF0ZURpdignbGluay10aW1lbGluZS1pY29uJyk7XHJcbiAgICAgICAgaWNvbkVsLmlubmVySFRNTCA9IGdyb3VwLnBhcmVudC5pY29uO1xyXG4gICAgICAgIGljb25FbC5zdHlsZS5jb2xvciA9IGdyb3VwLnBhcmVudC5jb2xvcjtcclxuXHJcbiAgICAgICAgLy8gRGV0YWlsc1xyXG4gICAgICAgIGNvbnN0IGRldGFpbHNFbCA9IHBhcmVudEVsLmNyZWF0ZURpdignbGluay10aW1lbGluZS1kZXRhaWxzJyk7XHJcbiAgICAgICAgZGV0YWlsc0VsLmNyZWF0ZUVsKCdzdHJvbmcnLCB7IHRleHQ6IGdyb3VwLnBhcmVudC50eXBlIH0pO1xyXG4gICAgICAgIGlmIChncm91cC5wYXJlbnQudGltZSkge1xyXG4gICAgICAgICAgICBkZXRhaWxzRWwuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6IGAgfCAke2dyb3VwLnBhcmVudC50aW1lfWAsIGNsczogJ2xpbmstdGltZWxpbmUtdGltZScgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChncm91cC5wYXJlbnQuY2FyZElkKSB7XHJcbiAgICAgICAgICAgIGRldGFpbHNFbC5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogYCB8ICR7Z3JvdXAucGFyZW50LmNhcmRJZH1gLCBjbHM6ICdsaW5rLXRpbWVsaW5lLWNhcmQtaWQnIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZ3JvdXAucGFyZW50LnZhbHVlICYmIGdyb3VwLnBhcmVudC52YWx1ZS50cmltKCkpIHtcclxuICAgICAgICAgICAgZGV0YWlsc0VsLmNyZWF0ZURpdih7IHRleHQ6IGdyb3VwLnBhcmVudC52YWx1ZSwgY2xzOiAnbGluay10aW1lbGluZS12YWx1ZScgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDaGlsZHJlbiBjb3VudCBiYWRnZVxyXG4gICAgICAgIGlmIChoYXNDaGlsZHJlbikge1xyXG4gICAgICAgICAgICBwYXJlbnRFbC5jcmVhdGVFbCgnc3BhbicsIHtcclxuICAgICAgICAgICAgICAgIHRleHQ6IFN0cmluZyhncm91cC5jaGlsZHJlbi5sZW5ndGgpLFxyXG4gICAgICAgICAgICAgICAgY2xzOiAnbGluay10aW1lbGluZS1jb3VudCdcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDaGlsZHJlbiBjb250YWluZXIgKGNvbGxhcHNlZCBieSBkZWZhdWx0KVxyXG4gICAgICAgIGNvbnN0IGNoaWxkcmVuRWwgPSBncm91cEVsLmNyZWF0ZURpdignbGluay10aW1lbGluZS1jaGlsZHJlbicpO1xyXG4gICAgICAgIGNoaWxkcmVuRWwuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuXHJcbiAgICAgICAgLy8gUmVuZGVyIGNoaWxkcmVuIHJlY3Vyc2l2ZWx5IChzdGFydGluZyBhdCBkZXB0aCAwKVxyXG4gICAgICAgIGdyb3VwLmNoaWxkcmVuLmZvckVhY2goY2hpbGQgPT4ge1xyXG4gICAgICAgICAgICByZW5kZXJDaGlsZChjaGlsZHJlbkVsLCBjaGlsZCwgMCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFRvZ2dsZSBleHBhbmQvY29sbGFwc2Ugb24gcGFyZW50IGNsaWNrXHJcbiAgICAgICAgaWYgKGhhc0NoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgIHBhcmVudEVsLnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJztcclxuICAgICAgICAgICAgcGFyZW50RWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpc0V4cGFuZGVkID0gY2hpbGRyZW5FbC5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZSc7XHJcbiAgICAgICAgICAgICAgICBjaGlsZHJlbkVsLnN0eWxlLmRpc3BsYXkgPSBpc0V4cGFuZGVkID8gJ25vbmUnIDogJ2Jsb2NrJztcclxuICAgICAgICAgICAgICAgIHRvZ2dsZUVsLnRleHRDb250ZW50ID0gaXNFeHBhbmRlZCA/ICdcXHUyNUI2JyA6ICdcXHUyNUJDJzsgLy8gXHUyNUI2IC8gXHUyNUJDXHJcbiAgICAgICAgICAgICAgICB0b2dnbGVFbC5jbGFzc0xpc3QudG9nZ2xlKCdleHBhbmRlZCcsICFpc0V4cGFuZGVkKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBFcnJvciBzZWN0aW9uOiBDYXJkcyB3aXRoIGluY29ycmVjdCBhcnJvdyBkaXJlY3Rpb25cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgaWYgKGJhZERpcmVjdGlvbmFsQ2FyZHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGNvbnN0IGVycm9yU2VjdGlvbiA9IGNvbnRhaW5lci5jcmVhdGVEaXYoJ2xpbmstdGltZWxpbmUtZXJyb3Itc2VjdGlvbicpO1xyXG5cclxuICAgICAgICAvLyBFcnJvciBoZWFkZXJcclxuICAgICAgICBjb25zdCBlcnJvckhlYWRlciA9IGVycm9yU2VjdGlvbi5jcmVhdGVEaXYoJ2xpbmstdGltZWxpbmUtZXJyb3ItaGVhZGVyJyk7XHJcbiAgICAgICAgZXJyb3JIZWFkZXIudGV4dENvbnRlbnQgPSAnXHUyNkEwXHVGRTBGIERpcmVjdGlvbmFsIEVycm9yczogQ2hpbGRcdTIxOTJQYXJlbnQgJiBDaGlsZFx1MjE5MkNoaWxkJztcclxuXHJcbiAgICAgICAgLy8gRXJyb3IgZGVzY3JpcHRpb25cclxuICAgICAgICBjb25zdCBlcnJvckRlc2MgPSBlcnJvclNlY3Rpb24uY3JlYXRlRGl2KCdsaW5rLXRpbWVsaW5lLWVycm9yLWRlc2NyaXB0aW9uJyk7XHJcbiAgICAgICAgZXJyb3JEZXNjLnRleHRDb250ZW50ID0gJ1RoZXNlIGNhcmRzIGhhdmUgaW5jb3JyZWN0IGFycm93IGNvbm5lY3Rpb25zOiBbUF0gY2FyZHMgd2l0aCBpbmNvbWluZyBhcnJvd3MgRlJPTSBbQ10gY2FyZHMgKENoaWxkXHUyMTkyUGFyZW50KSwgb3Igb3JwaGFuZWQgW0NdIGNhcmRzIHdpdGggbm8gW1BdIHBhcmVudCBpbiB0aGVpciB1cHN0cmVhbSBjaGFpbi4gQ1x1MjE5MkMgYXJyb3dzIGFyZSBhbGxvd2VkIHdoZW4gYSBwYXJlbnQgZXhpc3RzIGFib3ZlLic7XHJcblxyXG4gICAgICAgIC8vIFJlbmRlciBlYWNoIGJhZCBjYXJkXHJcbiAgICAgICAgYmFkRGlyZWN0aW9uYWxDYXJkcy5mb3JFYWNoKGNhcmQgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBlcnJvckl0ZW0gPSBlcnJvclNlY3Rpb24uY3JlYXRlRGl2KCdsaW5rLXRpbWVsaW5lLWVycm9yLWl0ZW0nKTtcclxuICAgICAgICAgICAgZXJyb3JJdGVtLnN0eWxlLmJvcmRlckxlZnRDb2xvciA9IGNhcmQuY29sb3I7XHJcblxyXG4gICAgICAgICAgICBlcnJvckl0ZW0uY3JlYXRlRWwoJ3NwYW4nLCB7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OiAnW1BdJyxcclxuICAgICAgICAgICAgICAgIGNsczogJ2xpbmstdGltZWxpbmUtcm9sZS1iYWRnZSByb2xlLXBhcmVudCdcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBpY29uRWwgPSBlcnJvckl0ZW0uY3JlYXRlRGl2KCdsaW5rLXRpbWVsaW5lLWljb24nKTtcclxuICAgICAgICAgICAgaWNvbkVsLmlubmVySFRNTCA9IGNhcmQuaWNvbjtcclxuICAgICAgICAgICAgaWNvbkVsLnN0eWxlLmNvbG9yID0gY2FyZC5jb2xvcjtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGRldGFpbHNFbCA9IGVycm9ySXRlbS5jcmVhdGVEaXYoJ2xpbmstdGltZWxpbmUtZGV0YWlscycpO1xyXG4gICAgICAgICAgICBkZXRhaWxzRWwuY3JlYXRlRWwoJ3N0cm9uZycsIHsgdGV4dDogY2FyZC50eXBlIH0pO1xyXG4gICAgICAgICAgICBpZiAoY2FyZC50aW1lKSB7XHJcbiAgICAgICAgICAgICAgICBkZXRhaWxzRWwuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6IGAgfCAke2NhcmQudGltZX1gLCBjbHM6ICdsaW5rLXRpbWVsaW5lLXRpbWUnIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjYXJkLmNhcmRJZCkge1xyXG4gICAgICAgICAgICAgICAgZGV0YWlsc0VsLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiBgIHwgJHtjYXJkLmNhcmRJZH1gLCBjbHM6ICdsaW5rLXRpbWVsaW5lLWNhcmQtaWQnIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjYXJkLnZhbHVlICYmIGNhcmQudmFsdWUudHJpbSgpKSB7XHJcbiAgICAgICAgICAgICAgICBkZXRhaWxzRWwuY3JlYXRlRGl2KHsgdGV4dDogY2FyZC52YWx1ZSwgY2xzOiAnbGluay10aW1lbGluZS12YWx1ZScgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG4iLCAiLyoqXHJcbiAqIFJlbmRlck1pdHJlTW9kYWwudHMgLSBNSVRSRSBBVFQmQ0sgVGVjaG5pcXVlIE1hcHBlciAoY2xhc3Mgc2hlbGwpXHJcbiAqXHJcbiAqIEZ1bGwtc2NyZWVuIG1vZGFsIHRoYXQgZGlzcGxheXMgdGhlIGNvbXBsZXRlIE1JVFJFIEFUVCZDSyBtYXRyaXguIFRoaXMgZmlsZVxyXG4gKiBjb250YWlucyB0aGUgY2xhc3MgbGlmZWN5Y2xlIChjb25zdHJ1Y3Rvciwgb25PcGVuLCBvbkNsb3NlKSBhbmQgdGhlIGNvcmVcclxuICogcmVuZGVyTWl0cmVNYXBwaW5nIG1ldGhvZCB0aGF0IGNvb3JkaW5hdGVzIGRhdGEgZXh0cmFjdGlvbiBhbmQgYWdncmVnYXRpb24uXHJcbiAqXHJcbiAqIFJlbmRlcmluZyBpcyBkZWxlZ2F0ZWQgdG8gZXh0cmFjdGVkIG1vZHVsZXM6XHJcbiAqICAgLSBNaXRyZU1vZGFsSGVscGVyczogY29udGV4dCBpbnRlcmZhY2UsIHRvZ2dsZUV4cGFuc2lvbiwgaXNBY3RpdmVUZWNobmlxdWVcclxuICogICAtIE1pdHJlTW9kYWxUYWN0aWNSZW5kZXJlcjogdGFjdGljIGNvbHVtbnMsIHRlY2huaXF1ZSBpdGVtcywgc3VidGVjaG5pcXVlc1xyXG4gKiAgIC0gTWl0cmVNb2RhbFZhbGlkYXRpb246IHZhbGlkYXRpb24gZXJyb3JzIHNlY3Rpb25cclxuICogICAtIE1pdHJlTW9kYWxTZWFyY2g6IHNlYXJjaCBiYXIgYW5kIGlucHV0IGhhbmRsaW5nXHJcbiAqICAgLSBNaXRyZVN0YXRzQmFyOiBjb3ZlcmFnZSwgYWN0aXZlIHRhY3RpY3MsIElPQyBjb3VudCwgbWlzc2luZyBmaWVsZCB3YXJuaW5nc1xyXG4gKiAgIC0gTWl0cmVBZ2dyZWdhdG9yOiA1LXN0ZXAgSU9DLXRvLW1hdHJpeCBhZ2dyZWdhdGlvblxyXG4gKiAgIC0gTWl0cmVFeHBvcnQ6IE5hdmlnYXRvciBKU09OIGV4cG9ydFxyXG4gKiAgIC0gTWl0cmVSZXNpemFibGU6IDgtaGFuZGxlIGRyYWctdG8tcmVzaXplXHJcbiAqL1xyXG5pbXBvcnQgeyBBcHAsIE1vZGFsIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBleHRyYWN0Rml4ZWRJT0NEYXRhIH0gZnJvbSAnLi4vdGltZWxpbmUvVGltZVRpbWVsaW5lUHJvY2Vzc2luZyc7XHJcbmltcG9ydCB7IGxvYWRNaXRyZURhdGFzZXQsIE1pdHJlRGF0YXNldCB9IGZyb20gJy4vTWl0cmVMb2FkZXInO1xyXG5pbXBvcnQgeyBERUJVRyB9IGZyb20gJy4uL2RlYnVnJztcclxuXHJcbmltcG9ydCB0eXBlIHsgSU9DTm9kZURhdGEgfSBmcm9tICcuLi90eXBlcy9JT0NOb2RlRGF0YSc7XHJcbmltcG9ydCB7IE1pdHJlVGVjaG5pcXVlLCBNaXRyZVRhY3RpYywgU2VhcmNoU3RhdGUsIFZhbGlkYXRpb25FcnJvciB9IGZyb20gJy4vTWl0cmVUeXBlcyc7XHJcbmltcG9ydCB7IGFnZ3JlZ2F0ZVRhY3RpY3NUZWNobmlxdWVzIH0gZnJvbSAnLi9NaXRyZUFnZ3JlZ2F0b3InO1xyXG5pbXBvcnQgeyBleHBvcnRUb05hdmlnYXRvciB9IGZyb20gJy4vTWl0cmVFeHBvcnQnO1xyXG5pbXBvcnQgeyBtYWtlUmVzaXphYmxlIH0gZnJvbSAnLi9NaXRyZVJlc2l6YWJsZSc7XHJcbmltcG9ydCB7IHJlbmRlclN0YXRzQmFyIH0gZnJvbSAnLi9NaXRyZVN0YXRzQmFyJztcclxuXHJcbi8vIEV4dHJhY3RlZCBtb2RhbCBtb2R1bGVzXHJcbmltcG9ydCB7IE1pdHJlTW9kYWxDb250ZXh0IH0gZnJvbSAnLi9NaXRyZU1vZGFsSGVscGVycyc7XHJcbmltcG9ydCB7IHJlbmRlclRhY3RpY1NlY3Rpb24gfSBmcm9tICcuL01pdHJlTW9kYWxUYWN0aWNSZW5kZXJlcic7XHJcbmltcG9ydCB7IHJlbmRlclN1YnRlY2huaXF1ZXMgfSBmcm9tICcuL01pdHJlU3VidGVjaG5pcXVlUmVuZGVyZXInO1xyXG5pbXBvcnQgeyByZW5kZXJWYWxpZGF0aW9uRXJyb3JzIH0gZnJvbSAnLi9NaXRyZU1vZGFsVmFsaWRhdGlvbic7XHJcbmltcG9ydCB7IHJlbmRlclNlYXJjaEJhciwgaGFuZGxlU2VhcmNoSW5wdXQsIFNlYXJjaFVJRWxlbWVudHMgfSBmcm9tICcuL01pdHJlTW9kYWxTZWFyY2gnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFJlbmRlck1pdHJlTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgICBwcml2YXRlIHBsdWdpbjogYW55O1xyXG4gICAgcHJpdmF0ZSBtaXRyZURhdGFzZXQ6IE1pdHJlRGF0YXNldCB8IG51bGwgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBzdWJ0ZWNobmlxdWVzTWFwOiBNYXA8c3RyaW5nLCBNaXRyZVRlY2huaXF1ZVtdPiA9IG5ldyBNYXAoKTtcclxuICAgIHByaXZhdGUgY3VycmVudFNlYXJjaFN0YXRlOiBTZWFyY2hTdGF0ZSB8IG51bGwgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBjdXJyZW50VGFjdGljczogTWl0cmVUYWN0aWNbXSB8IG51bGwgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSB2YWxpZGF0aW9uRXJyb3JzOiBWYWxpZGF0aW9uRXJyb3JbXSA9IFtdO1xyXG4gICAgcHJpdmF0ZSBhY3RpdmVUZWNobmlxdWVJZDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XHJcbiAgICBwcml2YXRlIGlvY0RhdGFNYXA6IE1hcDxzdHJpbmcsIElPQ05vZGVEYXRhPiA9IG5ldyBNYXAoKTtcclxuICAgIHByaXZhdGUgaW9jQ291bnQ6IG51bWJlciA9IDA7XHJcbiAgICBwcml2YXRlIHNlYXJjaFVJOiBTZWFyY2hVSUVsZW1lbnRzID0geyBzZWFyY2hCYXI6IG51bGwsIHNlYXJjaENsZWFyQnV0dG9uOiBudWxsLCBzZWFyY2hNYXRjaENvdW50OiBudWxsIH07XHJcblxyXG4gICAgLy8gVHJ1bmNhdGlvbiBsaW1pdHNcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgVEVDSE5JUVVFX1RSVU5DQVRFX0xJTUlUID0gMTgwO1xyXG4gICAgcHJpdmF0ZSByZWFkb25seSBTVUJURUNITklRVUVfVFJVTkNBVEVfTElNSVQgPSAxMDA7XHJcblxyXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogYW55LCBhY3RpdmVUZWNobmlxdWVJZD86IHN0cmluZyB8IG51bGwpIHtcclxuICAgICAgICBzdXBlcihhcHApO1xyXG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gICAgICAgIHRoaXMuYWN0aXZlVGVjaG5pcXVlSWQgPSBhY3RpdmVUZWNobmlxdWVJZCB8fCBudWxsO1xyXG4gICAgICAgIHRoaXMubG9hZERhdGFzZXQoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIExpZmVjeWNsZVxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgcHJpdmF0ZSBhc3luYyBsb2FkRGF0YXNldCgpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICB0aGlzLm1pdHJlRGF0YXNldCA9IGF3YWl0IGxvYWRNaXRyZURhdGFzZXQodGhpcy5hcHApO1xyXG4gICAgICAgICAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tNaXRyZU1vZGFsXSBEYXRhc2V0IGxvYWRlZDonLCB0aGlzLm1pdHJlRGF0YXNldC52ZXJzaW9uLCAnLSBUZWNobmlxdWVzOicsIE9iamVjdC5rZXlzKHRoaXMubWl0cmVEYXRhc2V0LnRlY2huaXF1ZXMpLmxlbmd0aCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tNaXRyZU1vZGFsXSBGYWlsZWQgdG8gbG9hZCBkYXRhc2V0OicsIGVycik7XHJcbiAgICAgICAgICAgIHRoaXMubWl0cmVEYXRhc2V0ID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25PcGVuKCk6IHZvaWQge1xyXG4gICAgICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW01pdHJlTW9kYWxdID09PT09IE1PREFMIE9QRU5FRCA9PT09PScpO1xyXG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgICAgIHRoaXMubW9kYWxFbC5jbGFzc0xpc3QuYWRkKCdtaXRyZS1tb2RhbC1mdWxsc2NyZWVuJyk7XHJcblxyXG4gICAgICAgIC8vIEFkZCByZXNpemUgZnVuY3Rpb25hbGl0eVxyXG4gICAgICAgIG1ha2VSZXNpemFibGUodGhpcy5tb2RhbEVsKTtcclxuXHJcbiAgICAgICAgY29uc3QgaGVhZGVyQ29udGFpbmVyID0gY29udGVudEVsLmNyZWF0ZURpdignbWl0cmUtbW9kYWwtaGVhZGVyJyk7XHJcblxyXG4gICAgICAgIGNvbnN0IHRpdGxlUm93ID0gaGVhZGVyQ29udGFpbmVyLmNyZWF0ZURpdignbWl0cmUtdGl0bGUtcm93Jyk7XHJcbiAgICAgICAgdGl0bGVSb3cuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnXHVEODNDXHVERkFGIE1JVFJFIEFUVCZDSyBUZWNobmlxdWUgTWFwcGVyJyB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgZXhwb3J0QnRuID0gdGl0bGVSb3cuY3JlYXRlRWwoJ2J1dHRvbicsIHtcclxuICAgICAgICAgICAgdGV4dDogJ0V4cG9ydCB0byBOYXZpZ2F0b3InLFxyXG4gICAgICAgICAgICBjbHM6ICdtaXRyZS1leHBvcnQtYnV0dG9uJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGV4cG9ydEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFRhY3RpY3MgJiYgdGhpcy5taXRyZURhdGFzZXQpIHtcclxuICAgICAgICAgICAgICAgIGV4cG9ydFRvTmF2aWdhdG9yKHRoaXMuY3VycmVudFRhY3RpY3MsIHRoaXMuaW9jQ291bnQsIHRoaXMubWl0cmVEYXRhc2V0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBSZW5kZXIgc2VhcmNoIGJhciB1c2luZyBleHRyYWN0ZWQgbW9kdWxlXHJcbiAgICAgICAgdGhpcy5zZWFyY2hVSSA9IHJlbmRlclNlYXJjaEJhcihoZWFkZXJDb250YWluZXIsIChxdWVyeSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTZWFyY2hTdGF0ZSA9IGhhbmRsZVNlYXJjaElucHV0KFxyXG4gICAgICAgICAgICAgICAgcXVlcnksXHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGFsRWwsXHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRUYWN0aWNzLFxyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRDb250ZXh0KCksXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaFVJXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHN0YXRzQ29udGFpbmVyID0gY29udGVudEVsLmNyZWF0ZURpdignbWl0cmUtc3RhdHMnKTtcclxuICAgICAgICBjb25zdCBjb250ZW50QXJlYSA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoJ21pdHJlLWNvbnRlbnQtYXJlYScpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyTWl0cmVNYXBwaW5nKGNvbnRlbnRBcmVhLCBzdGF0c0NvbnRhaW5lcik7XHJcbiAgICB9XHJcblxyXG4gICAgb25DbG9zZSgpOiB2b2lkIHtcclxuICAgICAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tNaXRyZU1vZGFsXSA9PT09PSBNT0RBTCBDTE9TRUQgPT09PT0nKTtcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIENvbnRleHQgYnVpbGRlclxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBCdWlsZCBhIE1pdHJlTW9kYWxDb250ZXh0IGZyb20gY3VycmVudCBjbGFzcyBzdGF0ZS5cclxuICAgICAqIFBhc3NlZCB0byBleHRyYWN0ZWQgcmVuZGVyaW5nIGZ1bmN0aW9ucyBpbnN0ZWFkIG9mIGB0aGlzYC5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBnZXRDb250ZXh0KCk6IE1pdHJlTW9kYWxDb250ZXh0IHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBhY3RpdmVUZWNobmlxdWVJZDogdGhpcy5hY3RpdmVUZWNobmlxdWVJZCxcclxuICAgICAgICAgICAgY3VycmVudFNlYXJjaFN0YXRlOiB0aGlzLmN1cnJlbnRTZWFyY2hTdGF0ZSxcclxuICAgICAgICAgICAgc3VidGVjaG5pcXVlc01hcDogdGhpcy5zdWJ0ZWNobmlxdWVzTWFwLFxyXG4gICAgICAgICAgICBpb2NEYXRhTWFwOiB0aGlzLmlvY0RhdGFNYXAsXHJcbiAgICAgICAgICAgIFRFQ0hOSVFVRV9UUlVOQ0FURV9MSU1JVDogdGhpcy5URUNITklRVUVfVFJVTkNBVEVfTElNSVQsXHJcbiAgICAgICAgICAgIFNVQlRFQ0hOSVFVRV9UUlVOQ0FURV9MSU1JVDogdGhpcy5TVUJURUNITklRVUVfVFJVTkNBVEVfTElNSVQsXHJcbiAgICAgICAgICAgIHJlbmRlclN1YnRlY2huaXF1ZXM6IChwYXJlbnRFbCwgc3VidGVjaG5pcXVlcywgc2VhcmNoU3RhdGUpID0+IHtcclxuICAgICAgICAgICAgICAgIHJlbmRlclN1YnRlY2huaXF1ZXMocGFyZW50RWwsIHN1YnRlY2huaXF1ZXMsIHRoaXMuZ2V0Q29udGV4dCgpLCBzZWFyY2hTdGF0ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gQ29yZSByZW5kZXJpbmcgKHN0YXlzIGFzIGNsYXNzIG1ldGhvZCAtIG11dGF0ZXMgNSsgcHJvcGVydGllcylcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogTWFpbiByZW5kZXJpbmcgZW50cnkgcG9pbnQuIEV4dHJhY3RzIElPQyBkYXRhLCBydW5zIGFnZ3JlZ2F0aW9uLFxyXG4gICAgICogYW5kIHJlbmRlcnMgdGhlIGZ1bGwgTUlUUkUgbWF0cml4LlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGFzeW5jIHJlbmRlck1pdHJlTWFwcGluZyhjb250YWluZXI6IEhUTUxFbGVtZW50LCBzdGF0c0NvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tNaXRyZU1vZGFsXSA9PT09PSBTVEFSVElORyBEQVRBIEVYVFJBQ1RJT04gPT09PT0nKTtcclxuXHJcbiAgICAgICAgLy8gRXh0cmFjdCBJT0MgZGF0YVxyXG4gICAgICAgIGNvbnN0IGlvY0RhdGEgPSBleHRyYWN0Rml4ZWRJT0NEYXRhKHRoaXMuYXBwKTtcclxuICAgICAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tNaXRyZU1vZGFsXSBFeHRyYWN0ZWQgSU9DIGNvdW50OicsIGlvY0RhdGEubGVuZ3RoKTtcclxuICAgICAgICB0aGlzLmlvY0NvdW50ID0gaW9jRGF0YS5sZW5ndGg7XHJcblxyXG4gICAgICAgIGlmIChpb2NEYXRhLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICBjb250YWluZXIuY3JlYXRlRWwoJ3AnLCB7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OiAnTm8gSU9DIGNhcmRzIGZvdW5kIGluIHRoZSBjdXJyZW50IGNhbnZhcy4nLFxyXG4gICAgICAgICAgICAgICAgY2xzOiAnbWl0cmUtZW1wdHktbWVzc2FnZSdcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEVuc3VyZSBkYXRhc2V0IGlzIGxvYWRlZFxyXG4gICAgICAgIGlmICghdGhpcy5taXRyZURhdGFzZXQpIHtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5sb2FkRGF0YXNldCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLm1pdHJlRGF0YXNldCkge1xyXG4gICAgICAgICAgICBjb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHtcclxuICAgICAgICAgICAgICAgIGNsczogJ21pdHJlLWVycm9yLW1lc3NhZ2UnLFxyXG4gICAgICAgICAgICAgICAgdGV4dDogJ1x1Mjc0QyBNSVRSRSBBVFQmQ0sgZGF0YXNldCBjb3VsZCBub3QgYmUgbG9hZGVkLidcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lci5jcmVhdGVFbCgncCcsIHtcclxuICAgICAgICAgICAgICAgIHRleHQ6ICdQbGVhc2UgZW5zdXJlIGVudGVycHJpc2UtYXR0YWNrLmpzb24gZXhpc3RzIGluIHRoZSBNSVRSRSBmb2xkZXIuJ1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29udGFpbmVyLmNyZWF0ZUVsKCdhJywge1xyXG4gICAgICAgICAgICAgICAgdGV4dDogJ0Rvd25sb2FkIGRhdGFzZXQgZnJvbSBNSVRSRScsXHJcbiAgICAgICAgICAgICAgICBhdHRyOiB7IGhyZWY6ICdodHRwczovL2dpdGh1Yi5jb20vbWl0cmUtYXR0YWNrL2F0dGFjay1zdGl4LWRhdGEnLCB0YXJnZXQ6ICdfYmxhbmsnIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFJ1biBhZ2dyZWdhdGlvblxyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGFnZ3JlZ2F0ZVRhY3RpY3NUZWNobmlxdWVzKGlvY0RhdGEsIHRoaXMubWl0cmVEYXRhc2V0KTtcclxuICAgICAgICBjb25zdCB0YWN0aWNzID0gcmVzdWx0LnRhY3RpY3M7XHJcbiAgICAgICAgdGhpcy5zdWJ0ZWNobmlxdWVzTWFwID0gcmVzdWx0LnN1YnRlY2huaXF1ZXNNYXA7XHJcbiAgICAgICAgdGhpcy52YWxpZGF0aW9uRXJyb3JzID0gcmVzdWx0LnZhbGlkYXRpb25FcnJvcnM7XHJcbiAgICAgICAgdGhpcy5pb2NEYXRhTWFwID0gcmVzdWx0LmlvY0RhdGFNYXA7XHJcbiAgICAgICAgdGhpcy5pb2NDb3VudCA9IHJlc3VsdC5pb2NDb3VudDtcclxuICAgICAgICBjb25zdCBtaXNzaW5nRmllbGRzID0gcmVzdWx0Lm1pc3NpbmdGaWVsZHM7XHJcblxyXG4gICAgICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW01pdHJlTW9kYWxdID09PT09IEFHR1JFR0FUSU9OIENPTVBMRVRFID09PT09Jyk7XHJcblxyXG4gICAgICAgIGlmICh0YWN0aWNzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICBjb250YWluZXIuY3JlYXRlRWwoJ3AnLCB7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OiAnTm8gTUlUUkUgdGFjdGljcyBvciB0ZWNobmlxdWVzIGZvdW5kIGluIElPQyBjYXJkcy4gQWRkIFwiTWl0cmUgVGFjdGljXCIgYW5kIFwiTWl0cmUgVGVjaG5pcXVlXCIgZmllbGRzIHRvIHlvdXIgY2FyZHMuJyxcclxuICAgICAgICAgICAgICAgIGNsczogJ21pdHJlLWVtcHR5LW1lc3NhZ2UnXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBSZW5kZXIgc3RhdHMgYmFyIChjb3ZlcmFnZSwgYWN0aXZlIHRhY3RpY3MsIElPQyBjb3VudCwgbWlzc2luZyBmaWVsZHMpXHJcbiAgICAgICAgcmVuZGVyU3RhdHNCYXIoc3RhdHNDb250YWluZXIsIHRhY3RpY3MsIHJlc3VsdC5pb2NDb3VudCwgbWlzc2luZ0ZpZWxkcyk7XHJcblxyXG4gICAgICAgIC8vIFN0b3JlIHRhY3RpY3MgZm9yIHNlYXJjaCBmaWx0ZXJpbmdcclxuICAgICAgICB0aGlzLmN1cnJlbnRUYWN0aWNzID0gdGFjdGljcztcclxuXHJcbiAgICAgICAgLy8gQnVpbGQgY29udGV4dCBmb3IgZXh0cmFjdGVkIHJlbmRlcmluZyBmdW5jdGlvbnNcclxuICAgICAgICBjb25zdCBjdHggPSB0aGlzLmdldENvbnRleHQoKTtcclxuXHJcbiAgICAgICAgLy8gUmVuZGVyIHZhbGlkYXRpb24gZXJyb3JzIHNlY3Rpb25cclxuICAgICAgICByZW5kZXJWYWxpZGF0aW9uRXJyb3JzKGNvbnRhaW5lciwgdGhpcy52YWxpZGF0aW9uRXJyb3JzKTtcclxuXHJcbiAgICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbTWl0cmVNb2RhbF0gUmVuZGVyaW5nIE1JVFJFIG1hdHJpeCAtJywgdGFjdGljcy5sZW5ndGgsICd0YWN0aWNzJyk7XHJcblxyXG4gICAgICAgIC8vIFJlbmRlciB0YWN0aWNzIGFzIGNvbHVtbnNcclxuICAgICAgICB0YWN0aWNzLmZvckVhY2godGFjdGljID0+IHtcclxuICAgICAgICAgICAgcmVuZGVyVGFjdGljU2VjdGlvbihjb250YWluZXIsIHRhY3RpYywgY3R4LCB0aGlzLmN1cnJlbnRTZWFyY2hTdGF0ZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW01pdHJlTW9kYWxdIE1hdHJpeCByZW5kZXJpbmcgY29tcGxldGU6Jywge1xyXG4gICAgICAgICAgICB0YWN0aWNzOiB0YWN0aWNzLmxlbmd0aCxcclxuICAgICAgICAgICAgaW9jQ2FyZHM6IHJlc3VsdC5pb2NDb3VudFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbiIsICIvKipcclxuICogTWl0cmVTdGl4UGFyc2VyLnRzIC0gU1RJWCAyLjEgYnVuZGxlIHBhcnNlciBmb3IgTUlUUkUgQVRUJkNLIGRhdGFzZXRcclxuICpcclxuICogUGFyc2VzIHRoZSBvZmZpY2lhbCBNSVRSRSBBVFQmQ0sgU1RJWCAyLjEgYnVuZGxlIGZvcm1hdCBpbnRvIHRoZVxyXG4gKiBpbnRlcm5hbCBNaXRyZURhdGFzZXQgc3RydWN0dXJlLiBIYW5kbGVzIHRhY3RpYyBhYmJyZXZpYXRpb24gZ2VuZXJhdGlvblxyXG4gKiBhbmQgdGhlIHR3by1wYXNzIHBhcnNpbmcgYWxnb3JpdGhtICh0YWN0aWNzIGZpcnN0LCB0aGVuIHRlY2huaXF1ZXMpLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IE1pdHJlRGF0YXNldCwgVGFjdGljRGF0YSwgVGVjaG5pcXVlRGF0YSB9IGZyb20gJy4vTWl0cmVMb2FkZXInO1xyXG5pbXBvcnQgeyBERUJVRyB9IGZyb20gJy4uL2RlYnVnJztcclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBUYWN0aWMgYWJicmV2aWF0aW9uIGNvbnN0YW50c1xyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8qKiBDb21tb24gYWJicmV2aWF0aW9ucyBmb3IgTUlUUkUgdGFjdGljIG5hbWVzLiAqL1xyXG5leHBvcnQgY29uc3QgVEFDVElDX0FCQlJFVklBVElPTlM6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPiA9IHtcclxuICAgICdSZWNvbm5haXNzYW5jZSc6IFsnUkVDT04nLCAnUkVDQ0UnLCAnUkUnXSxcclxuICAgICdSZXNvdXJjZSBEZXZlbG9wbWVudCc6IFsnUkVTT1VSQ0UnLCAnUkVTJywgJ1JEJ10sXHJcbiAgICAnSW5pdGlhbCBBY2Nlc3MnOiBbJ0lBJywgJ0lOSVQnXSxcclxuICAgICdFeGVjdXRpb24nOiBbJ0VYRUMnLCAnRVhFJywgJ0VYJ10sXHJcbiAgICAnUGVyc2lzdGVuY2UnOiBbJ1BFUlNJU1QnLCAnUEVSUycsICdQUyddLFxyXG4gICAgJ1ByaXZpbGVnZSBFc2NhbGF0aW9uJzogWydQUklWJywgJ1BFJywgJ1BSSVZFU0MnLCAnUFJJViBFU0MnXSxcclxuICAgICdEZWZlbnNlIEV2YXNpb24nOiBbJ0RFRkVOU0UnLCAnREVGJywgJ0RFJ10sXHJcbiAgICAnQ3JlZGVudGlhbCBBY2Nlc3MnOiBbJ0NSRUQnLCAnQ0EnLCAnQ1JFRCBBQ0NFU1MnXSxcclxuICAgICdEaXNjb3ZlcnknOiBbJ0RJU0MnLCAnRElTJywgJ0RJJ10sXHJcbiAgICAnTGF0ZXJhbCBNb3ZlbWVudCc6IFsnTEFURVJBTCcsICdMTScsICdMQVQgTU9WRSddLFxyXG4gICAgJ0NvbGxlY3Rpb24nOiBbJ0NPTExFQ1QnLCAnQ09MJywgJ0NPJ10sXHJcbiAgICAnQ29tbWFuZCBhbmQgQ29udHJvbCc6IFsnQzInLCAnQ05DJywgJ0NDJ10sXHJcbiAgICAnRXhmaWx0cmF0aW9uJzogWydFWEZJTCcsICdFWEZJTFRSQVRFJ10sXHJcbiAgICAnSW1wYWN0JzogWydJTVAnLCAnSU0nXVxyXG59O1xyXG5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIEFiYnJldmlhdGlvbiBnZW5lcmF0aW9uXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLyoqXHJcbiAqIEdlbmVyYXRlIGFiYnJldmlhdGlvbnMgZm9yIGEgdGFjdGljIG5hbWUuXHJcbiAqXHJcbiAqIENyZWF0ZXMgbXVsdGlwbGUgYWJicmV2aWF0aW9uIGZvcm1hdHMgdG8gc3VwcG9ydCBmbGV4aWJsZSB1c2VyIGlucHV0OlxyXG4gKlxyXG4gKiAqKjEuIEluaXRpYWxzIChhdXRvbWF0aWMpOioqXHJcbiAqIC0gXCJDcmVkZW50aWFsIEFjY2Vzc1wiIFx1MjE5MiBcIkNBXCJcclxuICogLSBcIkNvbW1hbmQgYW5kIENvbnRyb2xcIiBcdTIxOTIgXCJDQ1wiXHJcbiAqIC0gXCJQcml2aWxlZ2UgRXNjYWxhdGlvblwiIFx1MjE5MiBcIlBFXCJcclxuICpcclxuICogKioyLiBLbm93biBhYmJyZXZpYXRpb25zIChmcm9tIFRBQ1RJQ19BQkJSRVZJQVRJT05TIGNvbnN0YW50KToqKlxyXG4gKiAtIEFkZHMgY29tbW9uIHNob3J0IGZvcm1zIGxpa2UgXCJDUkVEXCIsIFwiQzJcIiwgXCJQUklWXCIsIGV0Yy5cclxuICpcclxuICogKipBbGdvcml0aG06KipcclxuICogLSBTcGxpdCB0YWN0aWMgbmFtZSBieSBzcGFjZXMgb3IgaHlwaGVuczogL1tcXHNcXC1dKy9cclxuICogLSBNYXAgZWFjaCB3b3JkIHRvIGl0cyBmaXJzdCBjaGFyYWN0ZXI6IFsnQycsICdBJ11cclxuICogLSBKb2luIGFuZCB1cHBlcmNhc2U6IFwiQ0FcIlxyXG4gKiAtIEFwcGVuZCBrbm93biBhYmJyZXZpYXRpb25zIGZyb20gbG9va3VwIHRhYmxlXHJcbiAqXHJcbiAqIEBwYXJhbSB0YWN0aWNOYW1lIC0gRnVsbCB0YWN0aWMgbmFtZSAoZS5nLiwgXCJDcmVkZW50aWFsIEFjY2Vzc1wiKVxyXG4gKiBAcmV0dXJucyBBcnJheSBvZiBhYmJyZXZpYXRpb24gc3RyaW5ncyAoZS5nLiwgW1wiQ0FcIiwgXCJDUkVEXCIsIFwiQ1JFRCBBQ0NFU1NcIl0pXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVBYmJyZXZpYXRpb25zKHRhY3RpY05hbWU6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgIGNvbnN0IGFiYnJldnM6IHN0cmluZ1tdID0gW107XHJcblxyXG4gICAgLy8gR2VuZXJhdGUgaW5pdGlhbHMgKGUuZy4sIFwiQ3JlZGVudGlhbCBBY2Nlc3NcIiAtPiBcIkNBXCIpXHJcbiAgICBjb25zdCB3b3JkcyA9IHRhY3RpY05hbWUuc3BsaXQoL1tcXHNcXC1dKy8pO1xyXG4gICAgaWYgKHdvcmRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAvLyBNYXAgZWFjaCB3b3JkIHRvIGZpcnN0IGxldHRlciwgam9pbiwgdXBwZXJjYXNlXHJcbiAgICAgICAgYWJicmV2cy5wdXNoKHdvcmRzLm1hcCh3ID0+IHdbMF0pLmpvaW4oJycpLnRvVXBwZXJDYXNlKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkZCBrbm93biBhYmJyZXZpYXRpb25zIGZyb20gVEFDVElDX0FCQlJFVklBVElPTlMgY29uc3RhbnRcclxuICAgIGlmIChUQUNUSUNfQUJCUkVWSUFUSU9OU1t0YWN0aWNOYW1lXSkge1xyXG4gICAgICAgIGFiYnJldnMucHVzaCguLi5UQUNUSUNfQUJCUkVWSUFUSU9OU1t0YWN0aWNOYW1lXSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGFiYnJldnM7XHJcbn1cclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBTVElYIDIuMSBidW5kbGUgcGFyc2VyXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLyoqXHJcbiAqIFBhcnNlIFNUSVggMi4xIGJ1bmRsZSBmb3JtYXQgaW50byBNaXRyZURhdGFzZXQuXHJcbiAqXHJcbiAqIFRoZSBvZmZpY2lhbCBNSVRSRSBBVFQmQ0sgZGF0YXNldCB1c2VzIFNUSVggMi4xIChTdHJ1Y3R1cmVkIFRocmVhdCBJbmZvcm1hdGlvblxyXG4gKiBlWHByZXNzaW9uKSBmb3JtYXQsIHdoaWNoIGlzIGEgSlNPTi1iYXNlZCBzdGFuZGFyZCBmb3IgcmVwcmVzZW50aW5nIGN5YmVyIHRocmVhdFxyXG4gKiBpbnRlbGxpZ2VuY2UuIFRoZSBidW5kbGUgY29udGFpbnMgbXVsdGlwbGUgb2JqZWN0IHR5cGVzIG1peGVkIHRvZ2V0aGVyLlxyXG4gKlxyXG4gKiAqKlNUSVggT2JqZWN0IFR5cGVzOioqXHJcbiAqIC0gYHgtbWl0cmUtY29sbGVjdGlvbmA6IE1ldGFkYXRhICh2ZXJzaW9uLCBsYXN0IHVwZGF0ZWQpXHJcbiAqIC0gYHgtbWl0cmUtdGFjdGljYDogVGFjdGljIGRlZmluaXRpb25zIChlLmcuLCBJbml0aWFsIEFjY2VzcywgRXhlY3V0aW9uKVxyXG4gKiAtIGBhdHRhY2stcGF0dGVybmA6IFRlY2huaXF1ZSBhbmQgc3VidGVjaG5pcXVlIGRlZmluaXRpb25zXHJcbiAqXHJcbiAqICoqVHdvLVBhc3MgQWxnb3JpdGhtOioqXHJcbiAqIFdlIHBhcnNlIGluIHR3byBwYXNzZXMgYmVjYXVzZSB0ZWNobmlxdWVzIHJlZmVyZW5jZSB0YWN0aWNzIGJ5IHNob3J0X25hbWVcclxuICogKGUuZy4sIFwiaW5pdGlhbC1hY2Nlc3NcIikgaW4gdGhlaXIga2lsbF9jaGFpbl9waGFzZXMsIHNvIHRhY3RpY3MgbXVzdCBiZVxyXG4gKiBleHRyYWN0ZWQgZmlyc3QgdG8gYnVpbGQgdGhlIHNob3J0X25hbWUgXHUyMTkyIHRhY3RpYyBJRCBtYXBwaW5nLlxyXG4gKlxyXG4gKiAqKlBhc3MgMToqKiBFeHRyYWN0IGFsbCB0YWN0aWNzIGFuZCBidWlsZCBzaG9ydF9uYW1lIG1hcHBpbmdcclxuICogKipQYXNzIDI6KiogRXh0cmFjdCBhbGwgdGVjaG5pcXVlcyBhbmQgcmVzb2x2ZSB0YWN0aWMgSURzIGZyb20ga2lsbF9jaGFpbl9waGFzZXNcclxuICpcclxuICogQHBhcmFtIHN0aXhCdW5kbGUgLSBSYXcgU1RJWCAyLjEgYnVuZGxlIEpTT04gb2JqZWN0XHJcbiAqIEByZXR1cm5zIE5vcm1hbGl6ZWQgTWl0cmVEYXRhc2V0IHdpdGggdGFjdGljcyBhbmQgdGVjaG5pcXVlcyBpbmRleGVkIGJ5IElEXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VTdGl4QnVuZGxlKHN0aXhCdW5kbGU6IGFueSk6IE1pdHJlRGF0YXNldCB7XHJcbiAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tNaXRyZUxvYWRlcl0gUGFyc2luZyBTVElYIGJ1bmRsZSB3aXRoJywgc3RpeEJ1bmRsZS5vYmplY3RzPy5sZW5ndGgsICdvYmplY3RzJyk7XHJcblxyXG4gICAgY29uc3QgdGFjdGljczogUmVjb3JkPHN0cmluZywgVGFjdGljRGF0YT4gPSB7fTtcclxuICAgIGNvbnN0IHRlY2huaXF1ZXM6IFJlY29yZDxzdHJpbmcsIFRlY2huaXF1ZURhdGE+ID0ge307XHJcblxyXG4gICAgLy8gRXh0cmFjdCB2ZXJzaW9uIGluZm8gZnJvbSBjb2xsZWN0aW9uIG1ldGFkYXRhXHJcbiAgICBsZXQgdmVyc2lvbiA9ICd1bmtub3duJztcclxuICAgIGxldCBsYXN0X3VwZGF0ZWQgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTtcclxuXHJcbiAgICBmb3IgKGNvbnN0IG9iaiBvZiBzdGl4QnVuZGxlLm9iamVjdHMpIHtcclxuICAgICAgICBpZiAob2JqLnR5cGUgPT09ICd4LW1pdHJlLWNvbGxlY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIHZlcnNpb24gPSBvYmoueF9taXRyZV92ZXJzaW9uIHx8ICd1bmtub3duJztcclxuICAgICAgICAgICAgbGFzdF91cGRhdGVkID0gb2JqLm1vZGlmaWVkPy5zcGxpdCgnVCcpWzBdIHx8IGxhc3RfdXBkYXRlZDtcclxuICAgICAgICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbTWl0cmVMb2FkZXJdIEZvdW5kIGNvbGxlY3Rpb24gbWV0YWRhdGEgLSB2ZXJzaW9uOicsIHZlcnNpb24sICd1cGRhdGVkOicsIGxhc3RfdXBkYXRlZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gRklSU1QgUEFTUzogRXh0cmFjdCB0YWN0aWNzXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIEJ1aWxkIHRoZSBjb21wbGV0ZSB0YWN0aWNzIG1hcCBCRUZPUkUgcHJvY2Vzc2luZyB0ZWNobmlxdWVzLCBiZWNhdXNlXHJcbiAgICAvLyB0ZWNobmlxdWVzIHJlZmVyZW5jZSB0YWN0aWNzIGJ5IHNob3J0X25hbWUgaW4ga2lsbF9jaGFpbl9waGFzZXMuXHJcbiAgICBmb3IgKGNvbnN0IG9iaiBvZiBzdGl4QnVuZGxlLm9iamVjdHMpIHtcclxuICAgICAgICBpZiAob2JqLnR5cGUgPT09ICd4LW1pdHJlLXRhY3RpYycgJiYgIW9iai54X21pdHJlX2RlcHJlY2F0ZWQpIHtcclxuICAgICAgICAgICAgY29uc3QgdGFjdGljSWQgPSBvYmouZXh0ZXJuYWxfcmVmZXJlbmNlcz8uZmluZCgocmVmOiBhbnkpID0+IHJlZi5zb3VyY2VfbmFtZSA9PT0gJ21pdHJlLWF0dGFjaycpPy5leHRlcm5hbF9pZDtcclxuICAgICAgICAgICAgaWYgKCF0YWN0aWNJZCkgY29udGludWU7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzaG9ydE5hbWUgPSBvYmoueF9taXRyZV9zaG9ydG5hbWUgfHwgdGFjdGljSWQudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICAgICAgdGFjdGljc1t0YWN0aWNJZF0gPSB7XHJcbiAgICAgICAgICAgICAgICBpZDogdGFjdGljSWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBvYmoubmFtZSxcclxuICAgICAgICAgICAgICAgIHNob3J0X25hbWU6IHNob3J0TmFtZSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBvYmouZGVzY3JpcHRpb24gfHwgJycsXHJcbiAgICAgICAgICAgICAgICBhYmJyZXZpYXRpb25zOiBnZW5lcmF0ZUFiYnJldmlhdGlvbnMob2JqLm5hbWUpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW01pdHJlTG9hZGVyXSBQYXJzZWQnLCBPYmplY3Qua2V5cyh0YWN0aWNzKS5sZW5ndGgsICd0YWN0aWNzJyk7XHJcblxyXG4gICAgLy8gQnVpbGQgdGFjdGljIHNob3J0IG5hbWUgdG8gSUQgbWFwIGZvciB0ZWNobmlxdWUgcHJvY2Vzc2luZ1xyXG4gICAgLy8gRXhhbXBsZSBtYXBwaW5nOiBcImluaXRpYWwtYWNjZXNzXCIgXHUyMTkyIFwiVEEwMDAxXCJcclxuICAgIGNvbnN0IHNob3J0TmFtZVRvVGFjdGljSWQgPSBuZXcgTWFwPHN0cmluZywgc3RyaW5nPigpO1xyXG4gICAgZm9yIChjb25zdCBbdGFjdGljSWQsIHRhY3RpY10gb2YgT2JqZWN0LmVudHJpZXModGFjdGljcykpIHtcclxuICAgICAgICBzaG9ydE5hbWVUb1RhY3RpY0lkLnNldCh0YWN0aWMuc2hvcnRfbmFtZSwgdGFjdGljSWQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gU0VDT05EIFBBU1M6IEV4dHJhY3QgdGVjaG5pcXVlc1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBOb3cgdGhhdCB3ZSBoYXZlIHRoZSBmdWxsIHRhY3RpY3MgbWFwLCBwcm9jZXNzIGFsbCBhdHRhY2stcGF0dGVybiBvYmplY3RzXHJcbiAgICAvLyAodGVjaG5pcXVlcyBhbmQgc3VidGVjaG5pcXVlcykuIFJlc29sdmUgdGFjdGljIElEcyBmcm9tIGtpbGxfY2hhaW5fcGhhc2VzXHJcbiAgICAvLyB1c2luZyB0aGUgc2hvcnROYW1lVG9UYWN0aWNJZCBtYXAgYnVpbHQgYWJvdmUuXHJcbiAgICAvL1xyXG4gICAgLy8gKipUZWNobmlxdWUgU3RydWN0dXJlOioqXHJcbiAgICAvLyAtIFBhcmVudCB0ZWNobmlxdWVzOiBSZWd1bGFyIHRlY2huaXF1ZXMgKGUuZy4sIFQxNTY2IC0gUGhpc2hpbmcpXHJcbiAgICAvLyAtIFN1YnRlY2huaXF1ZXM6IENoaWxkIHRlY2huaXF1ZXMgd2l0aCBwYXJlbnQgcmVmZXJlbmNlIChlLmcuLCBUMTU2Ni4wMDEpXHJcbiAgICAvLyAtIFRlY2huaXF1ZXMgY2FuIGJlbG9uZyB0byBtdWx0aXBsZSB0YWN0aWNzIChzdG9yZWQgYXMgYXJyYXkpXHJcbiAgICBmb3IgKGNvbnN0IG9iaiBvZiBzdGl4QnVuZGxlLm9iamVjdHMpIHtcclxuICAgICAgICBpZiAob2JqLnR5cGUgPT09ICdhdHRhY2stcGF0dGVybicgJiYgIW9iai54X21pdHJlX2RlcHJlY2F0ZWQpIHtcclxuICAgICAgICAgICAgY29uc3QgdGVjaG5pcXVlSWQgPSBvYmouZXh0ZXJuYWxfcmVmZXJlbmNlcz8uZmluZCgocmVmOiBhbnkpID0+IHJlZi5zb3VyY2VfbmFtZSA9PT0gJ21pdHJlLWF0dGFjaycpPy5leHRlcm5hbF9pZDtcclxuICAgICAgICAgICAgaWYgKCF0ZWNobmlxdWVJZCkgY29udGludWU7XHJcblxyXG4gICAgICAgICAgICAvLyBFeHRyYWN0IHRhY3RpYyBJRHMgZnJvbSBraWxsX2NoYWluX3BoYXNlc1xyXG4gICAgICAgICAgICBjb25zdCB0YWN0aWNJZHM6IHN0cmluZ1tdID0gW107XHJcbiAgICAgICAgICAgIGlmIChvYmoua2lsbF9jaGFpbl9waGFzZXMpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgcGhhc2Ugb2Ygb2JqLmtpbGxfY2hhaW5fcGhhc2VzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBoYXNlLmtpbGxfY2hhaW5fbmFtZSA9PT0gJ21pdHJlLWF0dGFjaycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFjdGljSWQgPSBzaG9ydE5hbWVUb1RhY3RpY0lkLmdldChwaGFzZS5waGFzZV9uYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhY3RpY0lkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWN0aWNJZHMucHVzaCh0YWN0aWNJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIERldGVybWluZSBwYXJlbnQgZm9yIHN1Yi10ZWNobmlxdWVzXHJcbiAgICAgICAgICAgIGxldCBwYXJlbnQ6IHN0cmluZyB8IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgaWYgKG9iai54X21pdHJlX2lzX3N1YnRlY2huaXF1ZSAmJiB0ZWNobmlxdWVJZC5pbmNsdWRlcygnLicpKSB7XHJcbiAgICAgICAgICAgICAgICBwYXJlbnQgPSB0ZWNobmlxdWVJZC5zcGxpdCgnLicpWzBdO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0ZWNobmlxdWVzW3RlY2huaXF1ZUlkXSA9IHtcclxuICAgICAgICAgICAgICAgIGlkOiB0ZWNobmlxdWVJZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IG9iai5uYW1lLFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IG9iai5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgICAgICAgICAgIHRhY3RpY3M6IHRhY3RpY0lkcyxcclxuICAgICAgICAgICAgICAgIHBhcmVudCxcclxuICAgICAgICAgICAgICAgIHVybDogb2JqLmV4dGVybmFsX3JlZmVyZW5jZXM/LmZpbmQoKHJlZjogYW55KSA9PiByZWYuc291cmNlX25hbWUgPT09ICdtaXRyZS1hdHRhY2snKT8udXJsIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgIGBodHRwczovL2F0dGFjay5taXRyZS5vcmcvdGVjaG5pcXVlcy8ke3RlY2huaXF1ZUlkLnJlcGxhY2UoJy4nLCAnLycpfWBcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbTWl0cmVMb2FkZXJdIFBhcnNlZCcsIE9iamVjdC5rZXlzKHRlY2huaXF1ZXMpLmxlbmd0aCwgJ3RlY2huaXF1ZXMnKTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHZlcnNpb24sXHJcbiAgICAgICAgbGFzdF91cGRhdGVkLFxyXG4gICAgICAgIHRhY3RpY3MsXHJcbiAgICAgICAgdGVjaG5pcXVlc1xyXG4gICAgfTtcclxufVxyXG4iLCAiLyoqXHJcbiAqIE1pdHJlVmFsaWRhdGlvbi50cyAtIFRlY2huaXF1ZS10YWN0aWMgdmFsaWRhdGlvbiBsb2dpY1xyXG4gKlxyXG4gKiBQcm92aWRlcyB0YWN0aWMgbmFtZSBub3JtYWxpemF0aW9uIChoYW5kbGluZyBhYmJyZXZpYXRpb25zLCBzaG9ydCBuYW1lcyxcclxuICogYW5kIGZ1bGwgbmFtZXMpIGFuZCB0ZWNobmlxdWUtdGFjdGljIHBhaXJpbmcgdmFsaWRhdGlvbiB3aXRoIHNldmVyaXR5IGxldmVscy5cclxuICogVXNlZCBieSBNaXRyZUFnZ3JlZ2F0b3IgdG8gdmFsaWRhdGUgSU9DIGNhcmQgTUlUUkUgZmllbGRzIGFnYWluc3QgdGhlIGRhdGFzZXQuXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgTWl0cmVEYXRhc2V0IH0gZnJvbSAnLi9NaXRyZUxvYWRlcic7XHJcbmltcG9ydCB7IERFQlVHIH0gZnJvbSAnLi4vZGVidWcnO1xyXG5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIFRhY3RpYyBuYW1lIG5vcm1hbGl6YXRpb25cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vKipcclxuICogTm9ybWFsaXplIHRhY3RpYyBuYW1lIGZvciBsb29rdXAsIGhhbmRsaW5nIG11bHRpcGxlIGlucHV0IGZvcm1hdHMuXHJcbiAqXHJcbiAqIEFjY2VwdHMgZmxleGlibGUgdGFjdGljIGlucHV0IGZyb20gdXNlcnMgYW5kIG5vcm1hbGl6ZXMgaXQgdG8gYSB0YWN0aWMgSUQgKGUuZy4sIFwiVEEwMDA2XCIpLlxyXG4gKiBVc2VzIGEgKip0aHJlZS1wYXNzIG1hdGNoaW5nIHN0cmF0ZWd5Kiogd2l0aCBwcm9ncmVzc2l2ZWx5IG1vcmUgZmxleGlibGUgcnVsZXM6XHJcbiAqXHJcbiAqICoqUGFzcyAxOiBTaG9ydCBOYW1lIE1hdGNoKiogKGUuZy4sIFwiY3JlZGVudGlhbC1hY2Nlc3NcIiwgXCJjcmVkZW50aWFsYWNjZXNzXCIsIFwiQ1JFREVOVElBTF9BQ0NFU1NcIilcclxuICogLSBOb3JtYWxpemVzIGlucHV0OiBsb3dlcmNhc2UsIHJlbW92ZSBzcGFjZXMvZGFzaGVzL3VuZGVyc2NvcmVzXHJcbiAqIC0gQ29tcGFyZXMgYWdhaW5zdCB0YWN0aWMuc2hvcnRfbmFtZSAoYWxzbyBub3JtYWxpemVkKVxyXG4gKiAtIEV4YW1wbGU6IFwiY3JlZGVudGlhbCBhY2Nlc3NcIiBcdTIxOTIgXCJjcmVkZW50aWFsYWNjZXNzXCIgXHUyMTkyIG1hdGNoZXMgXCJjcmVkZW50aWFsLWFjY2Vzc1wiIFx1MjE5MiBUQTAwMDZcclxuICpcclxuICogKipQYXNzIDI6IEZ1bGwgTmFtZSBNYXRjaCoqIChlLmcuLCBcIkNyZWRlbnRpYWwgQWNjZXNzXCIpXHJcbiAqIC0gU2FtZSBub3JtYWxpemF0aW9uIGFzIFBhc3MgMVxyXG4gKiAtIENvbXBhcmVzIGFnYWluc3QgdGFjdGljLm5hbWUgKG5vcm1hbGl6ZWQpXHJcbiAqIC0gRXhhbXBsZTogXCJDcmVkZW50aWFsLUFjY2Vzc1wiIFx1MjE5MiBcImNyZWRlbnRpYWxhY2Nlc3NcIiBcdTIxOTIgbWF0Y2hlcyBcIkNyZWRlbnRpYWwgQWNjZXNzXCIgXHUyMTkyIFRBMDAwNlxyXG4gKlxyXG4gKiAqKlBhc3MgMzogQWJicmV2aWF0aW9uIE1hdGNoKiogKGUuZy4sIFwiQ0FcIiwgXCJDUkVEXCIsIFwiQ1JFRCBBQ0NFU1NcIilcclxuICogLSBVcHBlcmNhc2UgaW5wdXQsIG5vIG5vcm1hbGl6YXRpb25cclxuICogLSBDb21wYXJlcyBhZ2FpbnN0IHRhY3RpYy5hYmJyZXZpYXRpb25zIGFycmF5XHJcbiAqIC0gRXhhbXBsZTogXCJjYVwiIFx1MjE5MiBcIkNBXCIgXHUyMTkyIG1hdGNoZXMgYWJicmV2aWF0aW9ucyBcdTIxOTIgVEEwMDA2XHJcbiAqXHJcbiAqICoqV2h5IFRocmVlIFBhc3Nlcz8qKlxyXG4gKiBBbGxvd3MgdXNlcnMgdG8gdHlwZSB0YWN0aWNzIGluIGFueSBmb3JtYXQgd2l0aG91dCBuZWVkaW5nIHRvIGtub3cgdGhlIGV4YWN0XHJcbiAqIGRhdGFzZXQgZm9ybWF0LiBBbGwgb2YgdGhlc2UgaW5wdXRzIHJlc29sdmUgdG8gdGhlIHNhbWUgdGFjdGljOlxyXG4gKiAtIFwiQ3JlZGVudGlhbCBBY2Nlc3NcIiwgXCJjcmVkZW50aWFsLWFjY2Vzc1wiLCBcIkNSRURFTlRJQUxfQUNDRVNTXCJcclxuICogLSBcIkNBXCIsIFwiQ1JFRFwiLCBcIkNSRUQgQUNDRVNTXCJcclxuICpcclxuICogQHBhcmFtIG5hbWUgLSBVc2VyIGlucHV0IHRhY3RpYyBzdHJpbmdcclxuICogQHBhcmFtIGRhdGFzZXQgLSBMb2FkZWQgTUlUUkUgZGF0YXNldFxyXG4gKiBAcmV0dXJucyBUYWN0aWMgSUQgKGUuZy4sIFwiVEEwMDA2XCIpIG9yIG51bGwgaWYgbm8gbWF0Y2ggZm91bmRcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVUYWN0aWNOYW1lKG5hbWU6IHN0cmluZywgZGF0YXNldDogTWl0cmVEYXRhc2V0KTogc3RyaW5nIHwgbnVsbCB7XHJcbiAgICAvLyBOb3JtYWxpemU6IGxvd2VyY2FzZSwgcmVtb3ZlIHNwYWNlcy9kYXNoZXMvdW5kZXJzY29yZXNcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWQgPSBuYW1lLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvW1xcc1xcLV9dKy9nLCAnJyk7XHJcblxyXG4gICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbTWl0cmVMb2FkZXJdIE5vcm1hbGl6aW5nIHRhY3RpYzonLCBuYW1lLCAnXHUyMTkyJywgbm9ybWFsaXplZCk7XHJcblxyXG4gICAgLy8gUEFTUyAxOiBDaGVjayBleGFjdCBtYXRjaCBhZ2FpbnN0IHNob3J0X25hbWUgKGUuZy4sIFwiY3JlZGVudGlhbC1hY2Nlc3NcIilcclxuICAgIGZvciAoY29uc3QgW3RhY3RpY0lkLCB0YWN0aWNdIG9mIE9iamVjdC5lbnRyaWVzKGRhdGFzZXQudGFjdGljcykpIHtcclxuICAgICAgICBpZiAodGFjdGljLnNob3J0X25hbWUucmVwbGFjZSgvXFwtL2csICcnKSA9PT0gbm9ybWFsaXplZCkge1xyXG4gICAgICAgICAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tNaXRyZUxvYWRlcl0gTWF0Y2hlZCBieSBzaG9ydF9uYW1lOicsIHRhY3RpYy5uYW1lLCAnKCcgKyB0YWN0aWNJZCArICcpJyk7XHJcbiAgICAgICAgICAgIHJldHVybiB0YWN0aWNJZDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUEFTUyAyOiBDaGVjayBmdWxsIG5hbWUgbWF0Y2ggKGUuZy4sIFwiQ3JlZGVudGlhbCBBY2Nlc3NcIilcclxuICAgIGZvciAoY29uc3QgW3RhY3RpY0lkLCB0YWN0aWNdIG9mIE9iamVjdC5lbnRyaWVzKGRhdGFzZXQudGFjdGljcykpIHtcclxuICAgICAgICBpZiAodGFjdGljLm5hbWUudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bXFxzXFwtX10rL2csICcnKSA9PT0gbm9ybWFsaXplZCkge1xyXG4gICAgICAgICAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tNaXRyZUxvYWRlcl0gTWF0Y2hlZCBieSBmdWxsIG5hbWU6JywgdGFjdGljLm5hbWUsICcoJyArIHRhY3RpY0lkICsgJyknKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRhY3RpY0lkO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBQQVNTIDM6IENoZWNrIGFiYnJldmlhdGlvbnMgKGUuZy4sIFwiQ0FcIiwgXCJDUkVEXCIpXHJcbiAgICBjb25zdCB1cHBlciA9IG5hbWUudG9VcHBlckNhc2UoKS50cmltKCk7XHJcbiAgICBmb3IgKGNvbnN0IFt0YWN0aWNJZCwgdGFjdGljXSBvZiBPYmplY3QuZW50cmllcyhkYXRhc2V0LnRhY3RpY3MpKSB7XHJcbiAgICAgICAgaWYgKHRhY3RpYy5hYmJyZXZpYXRpb25zLmluY2x1ZGVzKHVwcGVyKSkge1xyXG4gICAgICAgICAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tNaXRyZUxvYWRlcl0gTWF0Y2hlZCBieSBhYmJyZXZpYXRpb246JywgdXBwZXIsICdcdTIxOTInLCB0YWN0aWMubmFtZSwgJygnICsgdGFjdGljSWQgKyAnKScpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGFjdGljSWQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW01pdHJlTG9hZGVyXSBObyBtYXRjaCBmb3VuZCBmb3I6JywgbmFtZSk7XHJcbiAgICByZXR1cm4gbnVsbDtcclxufVxyXG5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIFRlY2huaXF1ZS10YWN0aWMgdmFsaWRhdGlvblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8qKlxyXG4gKiBWYWxpZGF0ZSB0ZWNobmlxdWUtdGFjdGljIG1hcHBpbmcgd2l0aCBzZXZlcml0eSBsZXZlbHMuXHJcbiAqXHJcbiAqIFBlcmZvcm1zIGNvbXByZWhlbnNpdmUgdmFsaWRhdGlvbiBvZiBhIHRlY2huaXF1ZS10YWN0aWMgcGFpcmluZyBmcm9tIGFuIElPQyBjYXJkLlxyXG4gKiBSZXR1cm5zIGEgc2V2ZXJpdHkgZW51bSBhbmQgb3B0aW9uYWwgZXJyb3IgbWVzc2FnZSBmb3IgZGlzcGxheSBpbiB0aGUgTUlUUkUgbW9kYWwuXHJcbiAqXHJcbiAqICoqVmFsaWRhdGlvbiBTdGVwcyAoaW4gb3JkZXIpOioqXHJcbiAqXHJcbiAqIDEuICoqTm9ybWFsaXplIFRhY3RpYyoqIC0gVXNlIG5vcm1hbGl6ZVRhY3RpY05hbWUgdG8gcmVzb2x2ZSB0YWN0aWMgSURcclxuICogICAgLSBJZiBmYWlscyBcdTIxOTIgYHVua25vd25fdGFjdGljYCAocmVkKVxyXG4gKlxyXG4gKiAyLiAqKkNoZWNrIFRlY2huaXF1ZSBFeGlzdHMqKiAtIExvb2sgdXAgdGVjaG5pcXVlIElEIGluIGRhdGFzZXRcclxuICogICAgLSBJZiBub3QgZm91bmQgXHUyMTkyIGB1bmtub3duX3RlY2huaXF1ZWAgKHJlZClcclxuICpcclxuICogMy4gKipDaGVjayBUZWNobmlxdWUtVGFjdGljIFBhaXJpbmcqKiAtIFZlcmlmeSB0ZWNobmlxdWUudGFjdGljcyBpbmNsdWRlcyB0YWN0aWNJZFxyXG4gKiAgICAtIElmIG1pc21hdGNoIFx1MjE5MiBgbWlzbWF0Y2hgIChvcmFuZ2UpIHdpdGggbGlzdCBvZiB2YWxpZCB0YWN0aWNzXHJcbiAqXHJcbiAqIDQuICoqQWxsIENoZWNrcyBQYXNzKiogXHUyMTkyIGB2YWxpZGAgKGdyZWVuKVxyXG4gKlxyXG4gKiAqKlNldmVyaXR5IE1lYW5pbmdzOioqXHJcbiAqIC0gYHZhbGlkYDogQ29ycmVjdCBwYWlyaW5nIChncmVlbiBpbmRpY2F0b3IpXHJcbiAqIC0gYHVua25vd25fdGVjaG5pcXVlYDogVGVjaG5pcXVlIElEIG5vdCBpbiBkYXRhc2V0IChyZWQsIGNyaXRpY2FsKVxyXG4gKiAtIGB1bmtub3duX3RhY3RpY2A6IFRhY3RpYyBuYW1lL2FiYnJldmlhdGlvbiBub3QgcmVjb2duaXplZCAocmVkLCBjcml0aWNhbClcclxuICogLSBgbWlzbWF0Y2hgOiBCb3RoIGV4aXN0IGJ1dCBkb24ndCBiZWxvbmcgdG9nZXRoZXIgKG9yYW5nZSwgd2FybmluZylcclxuICpcclxuICogKipFeGFtcGxlIFZhbGlkYXRpb246KipcclxuICogYGBgXHJcbiAqIHZhbGlkYXRlVGVjaG5pcXVlVGFjdGljKFwiVDE1NjZcIiwgXCJDQVwiLCBkYXRhc2V0KVxyXG4gKiBcdTIxOTIgeyBzZXZlcml0eTogJ3ZhbGlkJywgdGFjdGljSWQ6ICdUQTAwMDYnIH1cclxuICpcclxuICogdmFsaWRhdGVUZWNobmlxdWVUYWN0aWMoXCJUMTU2NlwiLCBcIkV4ZWN1dGlvblwiLCBkYXRhc2V0KVxyXG4gKiBcdTIxOTIgeyBzZXZlcml0eTogJ21pc21hdGNoJywgbWVzc2FnZTogJy4uLlZhbGlkIHRhY3RpY3M6IEluaXRpYWwgQWNjZXNzJywgdGFjdGljSWQ6ICdUQTAwMDInIH1cclxuICogYGBgXHJcbiAqXHJcbiAqIEBwYXJhbSB0ZWNobmlxdWVJZCAtIFRlY2huaXF1ZSBJRCBmcm9tIElPQyBjYXJkIChlLmcuLCBcIlQxNTY2XCIpXHJcbiAqIEBwYXJhbSB0YWN0aWNJbnB1dCAtIFRhY3RpYyBzdHJpbmcgZnJvbSBJT0MgY2FyZCAoZS5nLiwgXCJDQVwiLCBcIkNyZWRlbnRpYWwgQWNjZXNzXCIpXHJcbiAqIEBwYXJhbSBkYXRhc2V0IC0gTG9hZGVkIE1JVFJFIGRhdGFzZXRcclxuICogQHJldHVybnMgVmFsaWRhdGlvbiByZXN1bHQgd2l0aCBzZXZlcml0eSwgb3B0aW9uYWwgbWVzc2FnZSwgYW5kIHRhY3RpY0lkXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVUZWNobmlxdWVUYWN0aWMoXHJcbiAgICB0ZWNobmlxdWVJZDogc3RyaW5nLFxyXG4gICAgdGFjdGljSW5wdXQ6IHN0cmluZyxcclxuICAgIGRhdGFzZXQ6IE1pdHJlRGF0YXNldFxyXG4pOiB7XHJcbiAgICBzZXZlcml0eTogJ3ZhbGlkJyB8ICd1bmtub3duX3RlY2huaXF1ZScgfCAndW5rbm93bl90YWN0aWMnIHwgJ21pc21hdGNoJztcclxuICAgIG1lc3NhZ2U/OiBzdHJpbmc7XHJcbiAgICB0YWN0aWNJZD86IHN0cmluZztcclxufSB7XHJcbiAgICAvLyBTVEVQIDE6IE5vcm1hbGl6ZSB0YWN0aWMgbmFtZSB0byB0YWN0aWMgSUQgKGUuZy4sIFwiQ0FcIiBcdTIxOTIgXCJUQTAwMDZcIilcclxuICAgIGNvbnN0IHRhY3RpY0lkID0gbm9ybWFsaXplVGFjdGljTmFtZSh0YWN0aWNJbnB1dCwgZGF0YXNldCk7XHJcblxyXG4gICAgLy8gVW5rbm93biB0YWN0aWNcclxuICAgIGlmICghdGFjdGljSWQpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzZXZlcml0eTogJ3Vua25vd25fdGFjdGljJyxcclxuICAgICAgICAgICAgbWVzc2FnZTogYFVua25vd24gdGFjdGljOiBcIiR7dGFjdGljSW5wdXR9XCJgXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTVEVQIDI6IENoZWNrIGlmIHRlY2huaXF1ZSBleGlzdHMgaW4gZGF0YXNldFxyXG4gICAgY29uc3QgdGVjaG5pcXVlID0gZGF0YXNldC50ZWNobmlxdWVzW3RlY2huaXF1ZUlkXTtcclxuICAgIGlmICghdGVjaG5pcXVlKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc2V2ZXJpdHk6ICd1bmtub3duX3RlY2huaXF1ZScsXHJcbiAgICAgICAgICAgIG1lc3NhZ2U6IGBVbmtub3duIHRlY2huaXF1ZTogXCIke3RlY2huaXF1ZUlkfVwiYFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU1RFUCAzOiBDaGVjayBpZiB0ZWNobmlxdWUgYmVsb25ncyB0byB0aGlzIHRhY3RpY1xyXG4gICAgLy8gVGVjaG5pcXVlcyBjYW4gYmVsb25nIHRvIG11bHRpcGxlIHRhY3RpY3MsIHNvIGNoZWNrIGlmIHRhY3RpY0lkIGlzIGluIHRoZSBhcnJheVxyXG4gICAgaWYgKCF0ZWNobmlxdWUudGFjdGljcy5pbmNsdWRlcyh0YWN0aWNJZCkpIHtcclxuICAgICAgICAvLyBCdWlsZCBhIGhlbHBmdWwgZXJyb3IgbWVzc2FnZSBsaXN0aW5nIHRoZSBjb3JyZWN0IHRhY3RpY3NcclxuICAgICAgICBjb25zdCB2YWxpZFRhY3RpY3MgPSB0ZWNobmlxdWUudGFjdGljc1xyXG4gICAgICAgICAgICAubWFwKHRpZCA9PiBkYXRhc2V0LnRhY3RpY3NbdGlkXT8ubmFtZSB8fCB0aWQpXHJcbiAgICAgICAgICAgIC5qb2luKCcsICcpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHNldmVyaXR5OiAnbWlzbWF0Y2gnLFxyXG4gICAgICAgICAgICBtZXNzYWdlOiBgJHt0ZWNobmlxdWVJZH0gKCR7dGVjaG5pcXVlLm5hbWV9KSBkb2VzIG5vdCBiZWxvbmcgdG8gJHtkYXRhc2V0LnRhY3RpY3NbdGFjdGljSWRdLm5hbWV9LiBWYWxpZCB0YWN0aWNzOiAke3ZhbGlkVGFjdGljc31gLFxyXG4gICAgICAgICAgICB0YWN0aWNJZFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU1RFUCA0OiBBbGwgdmFsaWRhdGlvbiBjaGVja3MgcGFzc2VkXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHNldmVyaXR5OiAndmFsaWQnLFxyXG4gICAgICAgIHRhY3RpY0lkXHJcbiAgICB9O1xyXG59XHJcbiIsICIvKipcclxuICogTWl0cmVMb2FkZXIudHMgLSBBc3luYyBsb2FkZXIgZm9yIE1JVFJFIEFUVCZDSyBkYXRhc2V0XHJcbiAqXHJcbiAqIExvYWRzIHRoZSBmdWxsIE1JVFJFIGRhdGFzZXQgZnJvbSBNSVRSRS9lbnRlcnByaXNlLWF0dGFjay5qc29uLlxyXG4gKiBSZXF1aXJlcyBlbnRlcnByaXNlLWF0dGFjay5qc29uIC0gdGhyb3dzIGVycm9yIGlmIHVuYXZhaWxhYmxlLlxyXG4gKlxyXG4gKiBEZWxlZ2F0ZXMgU1RJWCBwYXJzaW5nIHRvIE1pdHJlU3RpeFBhcnNlci50cyBhbmQgdmFsaWRhdGlvbiB0byBNaXRyZVZhbGlkYXRpb24udHMuXHJcbiAqIFJlLWV4cG9ydHMgbm9ybWFsaXplVGFjdGljTmFtZSBhbmQgdmFsaWRhdGVUZWNobmlxdWVUYWN0aWMgc28gZXhpc3RpbmcgaW1wb3J0c1xyXG4gKiBmcm9tICcuL01pdHJlTG9hZGVyJyBjb250aW51ZSB0byB3b3JrLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgREVCVUcgfSBmcm9tICcuLi9kZWJ1Zyc7XHJcbmltcG9ydCB7IHBhcnNlU3RpeEJ1bmRsZSB9IGZyb20gJy4vTWl0cmVTdGl4UGFyc2VyJztcclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBSZS1leHBvcnRzIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5XHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBFeGlzdGluZyBtb2R1bGVzIGltcG9ydCB7IHZhbGlkYXRlVGVjaG5pcXVlVGFjdGljIH0gZnJvbSAnLi9NaXRyZUxvYWRlcicsXHJcbi8vIHNvIHdlIHJlLWV4cG9ydCBmcm9tIHRoZSBuZXcgTWl0cmVWYWxpZGF0aW9uIG1vZHVsZS5cclxuZXhwb3J0IHsgbm9ybWFsaXplVGFjdGljTmFtZSwgdmFsaWRhdGVUZWNobmlxdWVUYWN0aWMgfSBmcm9tICcuL01pdHJlVmFsaWRhdGlvbic7XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gSW50ZXJmYWNlc1xyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgTWl0cmVEYXRhc2V0IHtcclxuICAgIHZlcnNpb246IHN0cmluZztcclxuICAgIGxhc3RfdXBkYXRlZDogc3RyaW5nO1xyXG4gICAgdGFjdGljczogUmVjb3JkPHN0cmluZywgVGFjdGljRGF0YT47XHJcbiAgICB0ZWNobmlxdWVzOiBSZWNvcmQ8c3RyaW5nLCBUZWNobmlxdWVEYXRhPjtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBUYWN0aWNEYXRhIHtcclxuICAgIGlkOiBzdHJpbmc7ICAgICAgICAgICAgICAvLyBcIlRBMDAwNlwiXHJcbiAgICBuYW1lOiBzdHJpbmc7ICAgICAgICAgICAgLy8gXCJDcmVkZW50aWFsIEFjY2Vzc1wiXHJcbiAgICBzaG9ydF9uYW1lOiBzdHJpbmc7ICAgICAgLy8gXCJjcmVkZW50aWFsLWFjY2Vzc1wiXHJcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xyXG4gICAgYWJicmV2aWF0aW9uczogc3RyaW5nW107IC8vIFtcIkNBXCIsIFwiQ1JFRFwiXVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFRlY2huaXF1ZURhdGEge1xyXG4gICAgaWQ6IHN0cmluZzsgICAgICAgICAgICAgIC8vIFwiVDE1NTdcIlxyXG4gICAgbmFtZTogc3RyaW5nOyAgICAgICAgICAgIC8vIFwiQWR2ZXJzYXJ5LWluLXRoZS1NaWRkbGVcIlxyXG4gICAgZGVzY3JpcHRpb246IHN0cmluZztcclxuICAgIHRhY3RpY3M6IHN0cmluZ1tdOyAgICAgICAvLyBbXCJUQTAwMDZcIl1cclxuICAgIHBhcmVudD86IHN0cmluZzsgICAgICAgICAvLyBGb3Igc3ViLXRlY2huaXF1ZXNcclxuICAgIHVybDogc3RyaW5nO1xyXG59XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gRGF0YXNldCBjYWNoZVxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbmxldCBjYWNoZWREYXRhc2V0OiBNaXRyZURhdGFzZXQgfCBudWxsID0gbnVsbDtcclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBEYXRhc2V0IGxvYWRlclxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8qKlxyXG4gKiBMb2FkIE1JVFJFIGRhdGFzZXQgZnJvbSBKU09OIGZpbGUgb3IgZmFsbGJhY2sgdG8gZW1iZWRkZWQgZGF0YS5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkTWl0cmVEYXRhc2V0KGFwcDogQXBwKTogUHJvbWlzZTxNaXRyZURhdGFzZXQ+IHtcclxuICAgIGlmIChjYWNoZWREYXRhc2V0KSB7XHJcbiAgICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbTWl0cmVMb2FkZXJdIFJldHVybmluZyBjYWNoZWQgZGF0YXNldCcpO1xyXG4gICAgICAgIHJldHVybiBjYWNoZWREYXRhc2V0O1xyXG4gICAgfVxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgICAgLy8gVHJ5IHRvIGxvYWQgZnJvbSB2YXVsdFxyXG4gICAgICAgIGNvbnN0IGFkYXB0ZXIgPSBhcHAudmF1bHQuYWRhcHRlcjtcclxuICAgICAgICBjb25zdCBqc29uUGF0aCA9ICcub2JzaWRpYW4vcGx1Z2lucy9jeWJlcl9jYW52YXMvTUlUUkUvZW50ZXJwcmlzZS1hdHRhY2suanNvbic7XHJcblxyXG4gICAgICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW01pdHJlTG9hZGVyXSBBdHRlbXB0aW5nIHRvIGxvYWQgZnJvbTonLCBqc29uUGF0aCk7XHJcblxyXG4gICAgICAgIGlmIChhd2FpdCBhZGFwdGVyLmV4aXN0cyhqc29uUGF0aCkpIHtcclxuICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IGFkYXB0ZXIucmVhZChqc29uUGF0aCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0aXhCdW5kbGUgPSBKU09OLnBhcnNlKGNvbnRlbnQpO1xyXG5cclxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgaXQncyBhIFNUSVggYnVuZGxlXHJcbiAgICAgICAgICAgIGlmIChzdGl4QnVuZGxlLnR5cGUgPT09ICdidW5kbGUnICYmIEFycmF5LmlzQXJyYXkoc3RpeEJ1bmRsZS5vYmplY3RzKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbTWl0cmVMb2FkZXJdIFBhcnNpbmcgU1RJWCAyLjEgYnVuZGxlIGZvcm1hdC4uLicpO1xyXG4gICAgICAgICAgICAgICAgY2FjaGVkRGF0YXNldCA9IHBhcnNlU3RpeEJ1bmRsZShzdGl4QnVuZGxlKTtcclxuICAgICAgICAgICAgICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW01pdHJlTG9hZGVyXSBMb2FkZWQgZnVsbCBkYXRhc2V0IGZyb20gU1RJWCBidW5kbGUuIFRhY3RpY3M6JywgT2JqZWN0LmtleXMoY2FjaGVkRGF0YXNldC50YWN0aWNzKS5sZW5ndGgsICdUZWNobmlxdWVzOicsIE9iamVjdC5rZXlzKGNhY2hlZERhdGFzZXQudGVjaG5pcXVlcykubGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjYWNoZWREYXRhc2V0O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN0aXhCdW5kbGUudmVyc2lvbiAmJiBzdGl4QnVuZGxlLnRhY3RpY3MgJiYgc3RpeEJ1bmRsZS50ZWNobmlxdWVzKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBPbGQgcHJlLXByb2Nlc3NlZCBmb3JtYXQgKGJhY2t3YXJkIGNvbXBhdGliaWxpdHkpXHJcbiAgICAgICAgICAgICAgICBjYWNoZWREYXRhc2V0ID0gc3RpeEJ1bmRsZTtcclxuICAgICAgICAgICAgICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW01pdHJlTG9hZGVyXSBMb2FkZWQgcHJlLXByb2Nlc3NlZCBkYXRhc2V0LiBWZXJzaW9uOicsIGNhY2hlZERhdGFzZXQudmVyc2lvbiwgJ1RlY2huaXF1ZXM6JywgT2JqZWN0LmtleXMoY2FjaGVkRGF0YXNldC50ZWNobmlxdWVzKS5sZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlZERhdGFzZXQ7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ1tNaXRyZUxvYWRlcl0gVW5rbm93biBKU09OIGZvcm1hdCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignW01pdHJlTG9hZGVyXSBKU09OIGZpbGUgbm90IGZvdW5kIGF0OicsIGpzb25QYXRoKTtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgICAgICAgICAgJ01JVFJFIEFUVCZDSyBkYXRhc2V0IG5vdCBmb3VuZC4gUGxlYXNlIGVuc3VyZSBlbnRlcnByaXNlLWF0dGFjay5qc29uIGV4aXN0cyBpbiB0aGUgTUlUUkUgZm9sZGVyLiAnICtcclxuICAgICAgICAgICAgICAgICdEb3dubG9hZCBmcm9tOiBodHRwczovL2dpdGh1Yi5jb20vbWl0cmUtYXR0YWNrL2F0dGFjay1zdGl4LWRhdGEnXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignW01pdHJlTG9hZGVyXSBGYWlsZWQgdG8gbG9hZCBNSVRSRSBkYXRhc2V0OicsIGVycik7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgICAgICAnTUlUUkUgQVRUJkNLIGRhdGFzZXQgbm90IGZvdW5kLiBQbGVhc2UgZW5zdXJlIGVudGVycHJpc2UtYXR0YWNrLmpzb24gZXhpc3RzIGluIHRoZSBNSVRSRSBmb2xkZXIuICcgK1xyXG4gICAgICAgICAgICAnRG93bmxvYWQgZnJvbTogaHR0cHM6Ly9naXRodWIuY29tL21pdHJlLWF0dGFjay9hdHRhY2stc3RpeC1kYXRhJ1xyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSWYgd2UgcmVhY2ggaGVyZSB3aXRob3V0IHJldHVybmluZywgZGF0YXNldCBsb2FkIGZhaWxlZFxyXG4gICAgdGhyb3cgbmV3IEVycm9yKCdNSVRSRSBBVFQmQ0sgZGF0YXNldCBjb3VsZCBub3QgYmUgbG9hZGVkJyk7XHJcbn1cclxuIiwgIi8qKlxyXG4gKiBNaXRyZUFnZ3JlZ2F0b3JUeXBlcy50cyAtIFNoYXJlZCB0eXBlcywgY29uc3RhbnRzLCBhbmQgZXh0cmFjdGlvbiBoZWxwZXJzIGZvciBhZ2dyZWdhdGlvblxyXG4gKlxyXG4gKiBDb250YWlucyB0aGUgQWdncmVnYXRpb25SZXN1bHQgaW50ZXJmYWNlLCB0ZWNobmlxdWUgSUQvbmFtZSBleHRyYWN0aW9uIGZ1bmN0aW9ucyxcclxuICogYW5kIHRoZSBUQUNUSUNfT1JERVIga2lsbCBjaGFpbiBjb25zdGFudC4gVGhlc2UgYXJlIHNlcGFyYXRlZCBmcm9tIHRoZSBjb3JlXHJcbiAqIGFnZ3JlZ2F0aW9uIGxvZ2ljIHNvIHRoYXQgTWl0cmVBZ2dyZWdhdG9yQ2FyZFByb2Nlc3NpbmcudHMgYW5kIE1pdHJlQWdncmVnYXRvci50c1xyXG4gKiBjYW4gYm90aCBpbXBvcnQgdGhlbSB3aXRob3V0IGNpcmN1bGFyIGRlcGVuZGVuY2llcy5cclxuICovXHJcblxyXG5pbXBvcnQgeyBJT0NOb2RlRGF0YSB9IGZyb20gJy4uL3BhcnNpbmcvSU9DUGFyc2VyJztcclxuaW1wb3J0IHtcclxuICAgIE1pdHJlVGVjaG5pcXVlLFxyXG4gICAgTWl0cmVUYWN0aWMsXHJcbiAgICBWYWxpZGF0aW9uRXJyb3IsXHJcbiAgICBNaXNzaW5nRmllbGRzUmVzdWx0XHJcbn0gZnJvbSAnLi9NaXRyZVR5cGVzJztcclxuaW1wb3J0IHsgTWl0cmVEYXRhc2V0IH0gZnJvbSAnLi9NaXRyZUxvYWRlcic7XHJcbmltcG9ydCB7IERFQlVHIH0gZnJvbSAnLi4vZGVidWcnO1xyXG5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIEFnZ3JlZ2F0aW9uIHJlc3VsdFxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8qKlxyXG4gKiBSZXN1bHQgb2YgdGhlIGFnZ3JlZ2F0aW9uIGFsZ29yaXRobSwgY29udGFpbmluZyBhbGwgZGF0YSBuZWVkZWRcclxuICogZm9yIHJlbmRlcmluZyB0aGUgTUlUUkUgbWF0cml4IGFuZCB2YWxpZGF0aW9uIGVycm9ycy5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgQWdncmVnYXRpb25SZXN1bHQge1xyXG4gICAgLyoqIEFsbCAxNCB0YWN0aWNzIHdpdGggbmVzdGVkIHRlY2huaXF1ZXMgKGZvdW5kIGFuZCB1bmZvdW5kKSAqL1xyXG4gICAgdGFjdGljczogTWl0cmVUYWN0aWNbXTtcclxuICAgIC8qKiBWYWxpZGF0aW9uIGVycm9ycyBncm91cGVkIGJ5IHRlY2huaXF1ZStzZXZlcml0eSAqL1xyXG4gICAgdmFsaWRhdGlvbkVycm9yczogVmFsaWRhdGlvbkVycm9yW107XHJcbiAgICAvKiogTWFwIG9mIHBhcmVudCB0ZWNobmlxdWUgSURzIHRvIHRoZWlyIHN1YnRlY2huaXF1ZXMgKi9cclxuICAgIHN1YnRlY2huaXF1ZXNNYXA6IE1hcDxzdHJpbmcsIE1pdHJlVGVjaG5pcXVlW10+O1xyXG4gICAgLyoqIE1hcCBvZiBJT0Mgbm9kZSBJRHMgdG8gdGhlaXIgcGFyc2VkIGRhdGEgKGZvciBob3ZlciB0b29sdGlwcykgKi9cclxuICAgIGlvY0RhdGFNYXA6IE1hcDxzdHJpbmcsIElPQ05vZGVEYXRhPjtcclxuICAgIC8qKiBUb3RhbCBjb3VudCBvZiBJT0MgY2FyZHMgcHJvY2Vzc2VkICovXHJcbiAgICBpb2NDb3VudDogbnVtYmVyO1xyXG4gICAgLyoqIEluZm9ybWF0aW9uIGFib3V0IGNhcmRzIHdpdGggbWlzc2luZyBNSVRSRSBmaWVsZHMgKi9cclxuICAgIG1pc3NpbmdGaWVsZHM6IE1pc3NpbmdGaWVsZHNSZXN1bHQ7XHJcbn1cclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBLaWxsIGNoYWluIHNvcnQgb3JkZXJcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vKiogTUlUUkUga2lsbCBjaGFpbiBvcmRlciBmb3Igc29ydGluZyB0YWN0aWNzIGxlZnQgdG8gcmlnaHQgKDE0IHRhY3RpY3MpLiAqL1xyXG5leHBvcnQgY29uc3QgVEFDVElDX09SREVSID0gW1xyXG4gICAgJ1RBMDA0MycsIC8vIFJlY29ubmFpc3NhbmNlXHJcbiAgICAnVEEwMDQyJywgLy8gUmVzb3VyY2UgRGV2ZWxvcG1lbnRcclxuICAgICdUQTAwMDEnLCAvLyBJbml0aWFsIEFjY2Vzc1xyXG4gICAgJ1RBMDAwMicsIC8vIEV4ZWN1dGlvblxyXG4gICAgJ1RBMDAwMycsIC8vIFBlcnNpc3RlbmNlXHJcbiAgICAnVEEwMDA0JywgLy8gUHJpdmlsZWdlIEVzY2FsYXRpb25cclxuICAgICdUQTAwMDUnLCAvLyBEZWZlbnNlIEV2YXNpb25cclxuICAgICdUQTAwMDYnLCAvLyBDcmVkZW50aWFsIEFjY2Vzc1xyXG4gICAgJ1RBMDAwNycsIC8vIERpc2NvdmVyeVxyXG4gICAgJ1RBMDAwOCcsIC8vIExhdGVyYWwgTW92ZW1lbnRcclxuICAgICdUQTAwMDknLCAvLyBDb2xsZWN0aW9uXHJcbiAgICAnVEEwMDExJywgLy8gQ29tbWFuZCBhbmQgQ29udHJvbFxyXG4gICAgJ1RBMDAxMCcsIC8vIEV4ZmlsdHJhdGlvblxyXG4gICAgJ1RBMDA0MCcgIC8vIEltcGFjdFxyXG5dO1xyXG5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIFRlY2huaXF1ZSBJRC9uYW1lIGV4dHJhY3Rpb25cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vKipcclxuICogRXh0cmFjdCB0ZWNobmlxdWUgSUQgZnJvbSB2YXJpb3VzIGlucHV0IGZvcm1hdHMuXHJcbiAqXHJcbiAqIFN1cHBvcnRlZCBmb3JtYXRzOlxyXG4gKiAtIFwiVDE1NjZcIiAtPiBcIlQxNTY2XCJcclxuICogLSBcIlQxNTY2LjAwMVwiIC0+IFwiVDE1NjYuMDAxXCJcclxuICogLSBcIlQxNTY2IC0gUGhpc2hpbmdcIiAtPiBcIlQxNTY2XCJcclxuICogLSBcIlBoaXNoaW5nIChUMTU2NilcIiAtPiBcIlQxNTY2XCJcclxuICogLSBcIlBoaXNoaW5nXCIgKG5hbWUgb25seSkgLT4gXCJQaGlzaGluZ1wiIChmYWxsYmFjaywgd2lsbCBmYWlsIHZhbGlkYXRpb24pXHJcbiAqXHJcbiAqIE5PVEU6IFRlY2huaXF1ZSBmaWVsZCBpcyBhbHJlYWR5IHVwcGVyY2FzZWQgYnkgSU9DUGFyc2VyIGZvciBjb25zaXN0ZW5jeS5cclxuICpcclxuICogQHBhcmFtIHRlY2huaXF1ZSAtIFJhdyB0ZWNobmlxdWUgc3RyaW5nXHJcbiAqIEByZXR1cm5zIEV4dHJhY3RlZCB0ZWNobmlxdWUgSUQgb3IgcmF3IHN0cmluZyBhcyBmYWxsYmFja1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RUZWNobmlxdWVJZCh0ZWNobmlxdWU6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICBjb25zdCBpZE1hdGNoID0gdGVjaG5pcXVlLm1hdGNoKC9UXFxkezR9KD86XFwuXFxkezN9KT8vaSk7XHJcbiAgICBpZiAoaWRNYXRjaCkge1xyXG4gICAgICAgIGNvbnN0IHRlY2huaXF1ZUlkID0gaWRNYXRjaFswXS50b1VwcGVyQ2FzZSgpO1xyXG4gICAgICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW01pdHJlQWdncmVnYXRvcl0gRXh0cmFjdGVkIHRlY2huaXF1ZSBJRDonLCB0ZWNobmlxdWVJZCwgJ2Zyb206JywgdGVjaG5pcXVlKTtcclxuICAgICAgICByZXR1cm4gdGVjaG5pcXVlSWQ7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbTWl0cmVBZ2dyZWdhdG9yXSBObyB0ZWNobmlxdWUgSUQgZm91bmQgaW46JywgdGVjaG5pcXVlLCAnLSB1c2luZyByYXcgc3RyaW5nJyk7XHJcbiAgICByZXR1cm4gdGVjaG5pcXVlLnRyaW0oKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEV4dHJhY3QgdGVjaG5pcXVlIG5hbWUgZnJvbSB2YXJpb3VzIGlucHV0IGZvcm1hdHMuXHJcbiAqXHJcbiAqIFN1cHBvcnRlZCBmb3JtYXRzOlxyXG4gKiAtIFwiVDE1NjYgLSBQaGlzaGluZ1wiIC0+IFwiUGhpc2hpbmdcIlxyXG4gKiAtIFwiUGhpc2hpbmcgKFQxNTY2KVwiIC0+IFwiUGhpc2hpbmdcIlxyXG4gKiAtIFwiVDE1NjZcIiAoSUQgb25seSkgLT4gbG9va3VwIG5hbWUgZnJvbSBkYXRhc2V0XHJcbiAqIC0gXCJQaGlzaGluZ1wiIChuYW1lIG9ubHkpIC0+IFwiUGhpc2hpbmdcIlxyXG4gKlxyXG4gKiBAcGFyYW0gdGVjaG5pcXVlIC0gUmF3IHRlY2huaXF1ZSBzdHJpbmdcclxuICogQHBhcmFtIGRhdGFzZXQgLSBNSVRSRSBkYXRhc2V0IGZvciBJRC10by1uYW1lIGxvb2t1cCAobnVsbGFibGUpXHJcbiAqIEByZXR1cm5zIEV4dHJhY3RlZCBvciBsb29rZWQtdXAgdGVjaG5pcXVlIG5hbWVcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBleHRyYWN0VGVjaG5pcXVlTmFtZSh0ZWNobmlxdWU6IHN0cmluZywgZGF0YXNldDogTWl0cmVEYXRhc2V0IHwgbnVsbCk6IHN0cmluZyB7XHJcbiAgICAvLyBGb3JtYXQ6IFwiVDE1NjYgLSBQaGlzaGluZ1wiIG9yIFwiVDE1NjYuMDAxIC0gU3BlYXJwaGlzaGluZyBBdHRhY2htZW50XCJcclxuICAgIGNvbnN0IGRhc2hNYXRjaCA9IHRlY2huaXF1ZS5tYXRjaCgvVFxcZHs0fSg/OlxcLlxcZHszfSk/XFxzKi1cXHMqKC4rKS8pO1xyXG4gICAgaWYgKGRhc2hNYXRjaCkge1xyXG4gICAgICAgIGNvbnN0IG5hbWUgPSBkYXNoTWF0Y2hbMV0udHJpbSgpO1xyXG4gICAgICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW01pdHJlQWdncmVnYXRvcl0gRXh0cmFjdGVkIG5hbWUgZnJvbSBkYXNoIGZvcm1hdDonLCBuYW1lKTtcclxuICAgICAgICByZXR1cm4gbmFtZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBGb3JtYXQ6IFwiUGhpc2hpbmcgKFQxNTY2KVwiIG9yIFwiU3BlYXJwaGlzaGluZyBBdHRhY2htZW50IChUMTU2Ni4wMDEpXCJcclxuICAgIGNvbnN0IHBhcmVuTWF0Y2ggPSB0ZWNobmlxdWUubWF0Y2goLyguKz8pXFxzKlxcKFRcXGR7NH0oPzpcXC5cXGR7M30pP1xcKS8pO1xyXG4gICAgaWYgKHBhcmVuTWF0Y2gpIHtcclxuICAgICAgICBjb25zdCBuYW1lID0gcGFyZW5NYXRjaFsxXS50cmltKCk7XHJcbiAgICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbTWl0cmVBZ2dyZWdhdG9yXSBFeHRyYWN0ZWQgbmFtZSBmcm9tIHBhcmVuIGZvcm1hdDonLCBuYW1lKTtcclxuICAgICAgICByZXR1cm4gbmFtZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBJRC1vbmx5IGZvcm1hdDogbG9va3VwIG5hbWUgZnJvbSBkYXRhc2V0XHJcbiAgICBjb25zdCBpZE9ubHlNYXRjaCA9IHRlY2huaXF1ZS5tYXRjaCgvXlRcXGR7NH0oPzpcXC5cXGR7M30pPyQvKTtcclxuICAgIGlmIChpZE9ubHlNYXRjaCAmJiBkYXRhc2V0KSB7XHJcbiAgICAgICAgY29uc3QgdGVjaERhdGEgPSBkYXRhc2V0LnRlY2huaXF1ZXNbaWRPbmx5TWF0Y2hbMF1dO1xyXG4gICAgICAgIGlmICh0ZWNoRGF0YSkge1xyXG4gICAgICAgICAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tNaXRyZUFnZ3JlZ2F0b3JdIExvb2tlZCB1cCBuYW1lIGZvciBJRDonLCBpZE9ubHlNYXRjaFswXSwgJy0+JywgdGVjaERhdGEubmFtZSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0ZWNoRGF0YS5uYW1lO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tNaXRyZUFnZ3JlZ2F0b3JdIFVzaW5nIHJhdyB0ZWNobmlxdWUgc3RyaW5nIGFzIG5hbWU6JywgdGVjaG5pcXVlKTtcclxuICAgIHJldHVybiB0ZWNobmlxdWUudHJpbSgpO1xyXG59XHJcbiIsICIvKipcclxuICogTWl0cmVTZXZlcml0eS50cyAtIFNldmVyaXR5IGNsYXNzaWZpY2F0aW9uIGFuZCBDU1Mgc3R5bGluZyBoZWxwZXJzXHJcbiAqXHJcbiAqIFByb3ZpZGVzIHV0aWxpdHkgZnVuY3Rpb25zIGZvciBkZXRlcm1pbmluZyBzZXZlcml0eSBsZXZlbHMgYW5kIGFwcGx5aW5nXHJcbiAqIGFwcHJvcHJpYXRlIHZpc3VhbCBzdHlsaW5nIHRvIHRlY2huaXF1ZSBlbGVtZW50cyBpbiB0aGUgTUlUUkUgbWF0cml4LlxyXG4gKlxyXG4gKiBTZXZlcml0eSBSYW5raW5nIChoaWdoZXN0IHRvIGxvd2VzdCBwcmlvcml0eSk6XHJcbiAqIDEuIHVua25vd25fdGVjaG5pcXVlICg0KSAtIFRlY2huaXF1ZSBJRCBub3QgaW4gZGF0YXNldCAocmVkKVxyXG4gKiAyLiB1bmtub3duX3RhY3RpYyAoMykgLSBUYWN0aWMgbmFtZSBub3QgcmVjb2duaXplZCAocmVkKVxyXG4gKiAzLiBtaXNtYXRjaCAoMikgLSBCb3RoIHZhbGlkIGJ1dCB3cm9uZyBwYWlyaW5nIChvcmFuZ2UpXHJcbiAqIDQuIHZhbGlkICgxKSAtIENvcnJlY3QgcGFpcmluZyAoZ3JlZW4pXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgVmFsaWRhdGlvblNldmVyaXR5IH0gZnJvbSAnLi9NaXRyZVR5cGVzJztcclxuXHJcbi8qKlxyXG4gKiBXaGV0aGVyIHRoZSBzZXZlcml0eSByZXByZXNlbnRzIGEgY3JpdGljYWwgZXJyb3IgKHJlZCBpbmRpY2F0b3IpLlxyXG4gKiBDcml0aWNhbCBzZXZlcml0aWVzOiB1bmtub3duX3RlY2huaXF1ZSwgdW5rbm93bl90YWN0aWMuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNDcml0aWNhbFNldmVyaXR5KHNldmVyaXR5OiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgIHJldHVybiBzZXZlcml0eSA9PT0gJ3Vua25vd25fdGVjaG5pcXVlJ1xyXG4gICAgICAgIHx8IHNldmVyaXR5ID09PSAndW5rbm93bl90YWN0aWMnO1xyXG59XHJcblxyXG4vKipcclxuICogR2V0IHRoZSBhcHByb3ByaWF0ZSBpY29uIGZvciBhIHZhbGlkYXRpb24gc2V2ZXJpdHkgbGV2ZWwuXHJcbiAqIENyaXRpY2FsIGVycm9ycyBnZXQgcmVkIGNpcmNsZSwgd2FybmluZ3MgZ2V0IHdhcm5pbmcgdHJpYW5nbGUuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2V2ZXJpdHlJY29uKHNldmVyaXR5OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIGlzQ3JpdGljYWxTZXZlcml0eShzZXZlcml0eSkgPyAnXHVEODNEXHVERDM0JyA6ICdcdTI2QTBcdUZFMEYnO1xyXG59XHJcblxyXG4vKipcclxuICogQXBwbHkgdGhlIGFwcHJvcHJpYXRlIENTUyB2YWxpZGF0aW9uIGNsYXNzIGJhc2VkIG9uIHNldmVyaXR5LlxyXG4gKiAtIHZhbGlkIC0+IG1pdHJlLXRlY2huaXF1ZS12YWxpZCAoZ3JlZW4pXHJcbiAqIC0gY3JpdGljYWwgZXJyb3JzIC0+IG1pdHJlLXRlY2huaXF1ZS1lcnJvciAocmVkKVxyXG4gKiAtIG1pc21hdGNoIC0+IG1pdHJlLXRlY2huaXF1ZS13YXJuaW5nIChvcmFuZ2UpXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gYXBwbHlTZXZlcml0eUNsYXNzKGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBzZXZlcml0eTogc3RyaW5nKTogdm9pZCB7XHJcbiAgICBpZiAoc2V2ZXJpdHkgPT09ICd2YWxpZCcpIHtcclxuICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdtaXRyZS10ZWNobmlxdWUtdmFsaWQnKTtcclxuICAgIH0gZWxzZSBpZiAoaXNDcml0aWNhbFNldmVyaXR5KHNldmVyaXR5KSkge1xyXG4gICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ21pdHJlLXRlY2huaXF1ZS1lcnJvcicpO1xyXG4gICAgfSBlbHNlIGlmIChzZXZlcml0eSA9PT0gJ21pc21hdGNoJykge1xyXG4gICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ21pdHJlLXRlY2huaXF1ZS13YXJuaW5nJyk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEZXRlcm1pbmVzIGlmIG5ld1NldmVyaXR5IHNob3VsZCBvdmVycmlkZSBleGlzdGluZ1NldmVyaXR5IHdoZW4gYWdncmVnYXRpbmcuXHJcbiAqXHJcbiAqIFdoZW4gbXVsdGlwbGUgSU9DIGNhcmRzIHJlZmVyZW5jZSB0aGUgc2FtZSB0ZWNobmlxdWUgd2l0aCBkaWZmZXJlbnQgdmFsaWRhdGlvblxyXG4gKiByZXN1bHRzLCB0aGUgbW9zdCBjcml0aWNhbCBzZXZlcml0eSBpcyBrZXB0LiBVc2VzIG51bWVyaWNhbCByYW5raW5nIHdoZXJlXHJcbiAqIGhpZ2hlciBudW1iZXIgPSBtb3JlIGNyaXRpY2FsIGVycm9yLlxyXG4gKlxyXG4gKiBAcGFyYW0gbmV3U2V2ZXJpdHkgLSBTZXZlcml0eSBmcm9tIG5ld2x5IHByb2Nlc3NlZCBjYXJkXHJcbiAqIEBwYXJhbSBleGlzdGluZ1NldmVyaXR5IC0gQ3VycmVudCBhZ2dyZWdhdGVkIHNldmVyaXR5IGZvciB0aGlzIHRlY2huaXF1ZVxyXG4gKiBAcmV0dXJucyB0cnVlIGlmIG5ld1NldmVyaXR5IHNob3VsZCByZXBsYWNlIGV4aXN0aW5nU2V2ZXJpdHlcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBzaG91bGRPdmVycmlkZVNldmVyaXR5KFxyXG4gICAgbmV3U2V2ZXJpdHk6IFZhbGlkYXRpb25TZXZlcml0eSxcclxuICAgIGV4aXN0aW5nU2V2ZXJpdHk6IFZhbGlkYXRpb25TZXZlcml0eVxyXG4pOiBib29sZWFuIHtcclxuICAgIGNvbnN0IHNldmVyaXR5UmFuazogUmVjb3JkPFZhbGlkYXRpb25TZXZlcml0eSwgbnVtYmVyPiA9IHtcclxuICAgICAgICAndW5rbm93bl90ZWNobmlxdWUnOiA0LFxyXG4gICAgICAgICd1bmtub3duX3RhY3RpYyc6IDMsXHJcbiAgICAgICAgJ21pc21hdGNoJzogMixcclxuICAgICAgICAndmFsaWQnOiAxXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIHNldmVyaXR5UmFua1tuZXdTZXZlcml0eV0gPiBzZXZlcml0eVJhbmtbZXhpc3RpbmdTZXZlcml0eV07XHJcbn1cclxuIiwgIi8qKlxyXG4gKiBNaXRyZUFnZ3JlZ2F0b3JDYXJkUHJvY2Vzc2luZy50cyAtIFNURVAgMTogQnVpbGQgZm91bmQgdGVjaG5pcXVlcyBmcm9tIElPQyBjYXJkc1xyXG4gKlxyXG4gKiBQcm9jZXNzZXMgYWxsIElPQyBjYXJkcyB0byBidWlsZCB0aGUgZm91bmRUZWNobmlxdWVzIG1hcCwgY2FyZC1sZXZlbCB2YWxpZGF0aW9ucyxcclxuICogYW5kIG1pc3NpbmcgZmllbGQgdHJhY2tpbmcuIFRoaXMgaXMgdGhlIGZpcnN0IHN0ZXAgb2YgdGhlIDUtc3RlcCBhZ2dyZWdhdGlvblxyXG4gKiBhbGdvcml0aG0sIGV4dHJhY3RlZCBmcm9tIE1pdHJlQWdncmVnYXRvci50cyBmb3Igc2luZ2xlLXJlc3BvbnNpYmlsaXR5LlxyXG4gKlxyXG4gKiBIYW5kbGVzIHRocmVlIGNhc2VzIHBlciBjYXJkOlxyXG4gKiAxLiBFbXB0eSB0ZWNobmlxdWUgZmllbGQgLT4gdHJhY2sgYXMgbWlzc2luZyAoaW5mb3JtYXRpb25hbClcclxuICogMi4gRW1wdHkgdGFjdGljIGZpZWxkICh0ZWNobmlxdWUgZmlsbGVkKSAtPiB0cmFjayBhcyBtaXNzaW5nLCBzdGlsbCBoaWdobGlnaHQgdGVjaG5pcXVlXHJcbiAqIDMuIEJvdGggZmlsbGVkIC0+IGZ1bGwgdmFsaWRhdGlvbiB2aWEgTWl0cmVMb2FkZXIudmFsaWRhdGVUZWNobmlxdWVUYWN0aWMoKVxyXG4gKi9cclxuXHJcbmltcG9ydCB7IElPQ05vZGVEYXRhIH0gZnJvbSAnLi4vcGFyc2luZy9JT0NQYXJzZXInO1xyXG5pbXBvcnQgeyBWYWxpZGF0aW9uU2V2ZXJpdHksIE1pc3NpbmdGaWVsZEluZm8gfSBmcm9tICcuL01pdHJlVHlwZXMnO1xyXG5pbXBvcnQgeyBzaG91bGRPdmVycmlkZVNldmVyaXR5IH0gZnJvbSAnLi9NaXRyZVNldmVyaXR5JztcclxuaW1wb3J0IHsgTWl0cmVEYXRhc2V0LCB2YWxpZGF0ZVRlY2huaXF1ZVRhY3RpYyB9IGZyb20gJy4vTWl0cmVMb2FkZXInO1xyXG5pbXBvcnQgeyBleHRyYWN0VGVjaG5pcXVlSWQsIGV4dHJhY3RUZWNobmlxdWVOYW1lIH0gZnJvbSAnLi9NaXRyZUFnZ3JlZ2F0b3JUeXBlcyc7XHJcbmltcG9ydCB7IERFQlVHIH0gZnJvbSAnLi4vZGVidWcnO1xyXG5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIEZvdW5kIHRlY2huaXF1ZSBlbnRyeSB0eXBlXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLyoqXHJcbiAqIFRyYWNrcyBhZ2dyZWdhdGVkIGRhdGEgZm9yIGEgc2luZ2xlIGZvdW5kIHRlY2huaXF1ZSBhY3Jvc3MgYWxsIElPQyBjYXJkcy5cclxuICogTXVsdGlwbGUgY2FyZHMgbWF5IHJlZmVyZW5jZSB0aGUgc2FtZSB0ZWNobmlxdWUgLSBjb3VudHMgYW5kIHNldmVyaXRpZXNcclxuICogYXJlIGFnZ3JlZ2F0ZWQgaGVyZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgRm91bmRUZWNobmlxdWVFbnRyeSB7XHJcbiAgICAvKiogTnVtYmVyIG9mIElPQyBjYXJkcyByZWZlcmVuY2luZyB0aGlzIHRlY2huaXF1ZSAqL1xyXG4gICAgY291bnQ6IG51bWJlcjtcclxuICAgIC8qKiBJT0MgY2FyZCBub2RlIElEcyBmb3IgdG9vbHRpcC9ob3ZlciBkaXNwbGF5ICovXHJcbiAgICBpb2NDYXJkczogc3RyaW5nW107XHJcbiAgICAvKiogV29yc3QgdmFsaWRhdGlvbiBzZXZlcml0eSBhY3Jvc3MgYWxsIGNhcmRzIHJlZmVyZW5jaW5nIHRoaXMgdGVjaG5pcXVlICovXHJcbiAgICBzZXZlcml0eTogVmFsaWRhdGlvblNldmVyaXR5O1xyXG4gICAgLyoqIEVycm9yIG1lc3NhZ2UgZnJvbSB0aGUgd29yc3Qtc2V2ZXJpdHkgdmFsaWRhdGlvbiAqL1xyXG4gICAgdmFsaWRhdGlvbk1lc3NhZ2U/OiBzdHJpbmc7XHJcbiAgICAvKiogT3JpZ2luYWwgdGFjdGljIHN0cmluZyBmcm9tIHRoZSBJT0MgY2FyZCAqL1xyXG4gICAgdXNlclByb3ZpZGVkVGFjdGljOiBzdHJpbmc7XHJcbn1cclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBDYXJkIHZhbGlkYXRpb24gZW50cnkgdHlwZVxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8qKiBQZXItY2FyZCB2YWxpZGF0aW9uIHJlc3VsdCB1c2VkIGZvciBidWlsZGluZyBlcnJvciBncm91cHMgaW4gU1RFUCA1LiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIENhcmRWYWxpZGF0aW9uRW50cnkge1xyXG4gICAgY2FyZElkOiBzdHJpbmc7XHJcbiAgICB0ZWNobmlxdWVJZDogc3RyaW5nO1xyXG4gICAgdGVjaG5pcXVlTmFtZTogc3RyaW5nO1xyXG4gICAgdGFjdGljOiBzdHJpbmc7XHJcbiAgICBzZXZlcml0eTogVmFsaWRhdGlvblNldmVyaXR5O1xyXG4gICAgdmFsaWRhdGlvbk1lc3NhZ2U/OiBzdHJpbmc7XHJcbiAgICBpb2NUeXBlOiBzdHJpbmc7XHJcbiAgICBub2RlSWQ6IHN0cmluZztcclxufVxyXG5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIFJlc3VsdCBvZiBTVEVQIDFcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vKiogUmVzdWx0IG9mIGJ1aWxkRm91bmRUZWNobmlxdWVzRnJvbUlPQyAtIGFsbCBkYXRhIGNvbGxlY3RlZCBpbiBTVEVQIDEuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgQnVpbGRGb3VuZFJlc3VsdCB7XHJcbiAgICAvKiogTWFwIG9mIHRlY2huaXF1ZSBJRCAtPiBhZ2dyZWdhdGVkIGZvdW5kIGRhdGEgKi9cclxuICAgIGZvdW5kVGVjaG5pcXVlczogTWFwPHN0cmluZywgRm91bmRUZWNobmlxdWVFbnRyeT47XHJcbiAgICAvKiogTWFwIG9mIG5vZGUgSUQgLT4gcGVyLWNhcmQgdmFsaWRhdGlvbiByZXN1bHQgKi9cclxuICAgIGNhcmRWYWxpZGF0aW9uczogTWFwPHN0cmluZywgQ2FyZFZhbGlkYXRpb25FbnRyeT47XHJcbiAgICAvKiogQ2FyZHMgbWlzc2luZyB0YWN0aWMgZmllbGQgKGluZm9ybWF0aW9uYWwpICovXHJcbiAgICBtaXNzaW5nVGFjdGljQ2FyZHM6IE1pc3NpbmdGaWVsZEluZm9bXTtcclxuICAgIC8qKiBDYXJkcyBtaXNzaW5nIHRlY2huaXF1ZSBmaWVsZCAoaW5mb3JtYXRpb25hbCkgKi9cclxuICAgIG1pc3NpbmdUZWNobmlxdWVDYXJkczogTWlzc2luZ0ZpZWxkSW5mb1tdO1xyXG4gICAgLyoqIFRvdGFsIElPQyBjYXJkcyBwcm9jZXNzZWQgKGluY2x1ZGluZyB0aG9zZSB3aXRoIG1pc3NpbmcgZmllbGRzKSAqL1xyXG4gICAgaW9jQ291bnQ6IG51bWJlcjtcclxufVxyXG5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIFBhcmVudCB0ZWNobmlxdWUgdHJhY2tpbmdcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vKipcclxuICogTWFyayBwYXJlbnQgdGVjaG5pcXVlIGFzIGZvdW5kIHdoZW4gYSBzdWJ0ZWNobmlxdWUgaXMgcmVmZXJlbmNlZC5cclxuICpcclxuICogV2hlbiBhbiBhbmFseXN0IHNwZWNpZmllcyBhIHN1YnRlY2huaXF1ZSBsaWtlIFQxMDUzLjAwNSwgYm90aCB0aGUgc3VidGVjaG5pcXVlXHJcbiAqIEFORCBpdHMgcGFyZW50IChUMTA1Mykgc2hvdWxkIGJlIGhpZ2hsaWdodGVkIGluIHRoZSBtYXRyaXguIFRoZSBwYXJlbnQgaW5oZXJpdHNcclxuICogY291bnQgZnJvbSBzdWJ0ZWNobmlxdWVzIGJ1dCBkb2VzIE5PVCBpbmNsdWRlIElPQyBjYXJkIElEcyBkaXJlY3RseSAoc2luY2UgdGhlXHJcbiAqIGNhcmQgcmVmZXJlbmNlZCB0aGUgc3VidGVjaG5pcXVlLCBub3QgdGhlIHBhcmVudCkuXHJcbiAqXHJcbiAqIEBwYXJhbSB0ZWNobmlxdWVJZCAtIFRoZSB0ZWNobmlxdWUgSUQgKG1heSBiZSBzdWJ0ZWNobmlxdWUgbGlrZSBUMTA1My4wMDUpXHJcbiAqIEBwYXJhbSBmb3VuZFRlY2huaXF1ZXMgLSBNYXAgdHJhY2tpbmcgYWxsIGZvdW5kIHRlY2huaXF1ZXNcclxuICogQHBhcmFtIHRhY3RpYyAtIFRoZSB1c2VyLXByb3ZpZGVkIHRhY3RpYyBzdHJpbmdcclxuICovXHJcbmZ1bmN0aW9uIG1hcmtQYXJlbnRBc0ZvdW5kKFxyXG4gICAgdGVjaG5pcXVlSWQ6IHN0cmluZyxcclxuICAgIGZvdW5kVGVjaG5pcXVlczogTWFwPHN0cmluZywgRm91bmRUZWNobmlxdWVFbnRyeT4sXHJcbiAgICB0YWN0aWM6IHN0cmluZ1xyXG4pOiB2b2lkIHtcclxuICAgIC8vIE9ubHkgYXBwbGllcyB0byBzdWJ0ZWNobmlxdWVzIChJRHMgY29udGFpbmluZyBhIGRvdClcclxuICAgIGlmICghdGVjaG5pcXVlSWQuaW5jbHVkZXMoJy4nKSkgcmV0dXJuO1xyXG5cclxuICAgIC8vIEV4dHJhY3QgcGFyZW50IElEIChlLmcuLCBUMTA1My4wMDUgLT4gVDEwNTMpXHJcbiAgICBjb25zdCBwYXJlbnRJZCA9IHRlY2huaXF1ZUlkLnNwbGl0KCcuJylbMF07XHJcblxyXG4gICAgaWYgKGZvdW5kVGVjaG5pcXVlcy5oYXMocGFyZW50SWQpKSB7XHJcbiAgICAgICAgY29uc3QgZXhpc3RpbmcgPSBmb3VuZFRlY2huaXF1ZXMuZ2V0KHBhcmVudElkKSE7XHJcbiAgICAgICAgZXhpc3RpbmcuY291bnQrKztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZm91bmRUZWNobmlxdWVzLnNldChwYXJlbnRJZCwge1xyXG4gICAgICAgICAgICBjb3VudDogMSxcclxuICAgICAgICAgICAgaW9jQ2FyZHM6IFtdLCAgLy8gRW1wdHkgLSBjYXJkcyByZWZlcmVuY2Ugc3VidGVjaG5pcXVlcywgbm90IHBhcmVudFxyXG4gICAgICAgICAgICBzZXZlcml0eTogJ3ZhbGlkJyxcclxuICAgICAgICAgICAgdmFsaWRhdGlvbk1lc3NhZ2U6IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgdXNlclByb3ZpZGVkVGFjdGljOiB0YWN0aWNcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tNaXRyZUFnZ3JlZ2F0b3JdIE1hcmtlZCBwYXJlbnQgdGVjaG5pcXVlIGFzIGZvdW5kOicsIHtcclxuICAgICAgICBzdWJ0ZWNobmlxdWU6IHRlY2huaXF1ZUlkLFxyXG4gICAgICAgIHBhcmVudDogcGFyZW50SWQsXHJcbiAgICAgICAgdGFjdGljOiB0YWN0aWNcclxuICAgIH0pO1xyXG59XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gU1RFUCAxOiBCdWlsZCBmb3VuZCB0ZWNobmlxdWVzIGZyb20gSU9DIGNhcmRzXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLyoqXHJcbiAqIEJ1aWxkIG1hcCBvZiBmb3VuZCB0ZWNobmlxdWVzIGZyb20gSU9DIGNhcmRzIChTVEVQIDEgb2YgYWdncmVnYXRpb24pLlxyXG4gKlxyXG4gKiBMb29wcyB0aHJvdWdoIGFsbCBJT0MgY2FyZHMgYW5kIGV4dHJhY3RzIE1JVFJFIHRhY3RpYy90ZWNobmlxdWUgZmllbGRzLlxyXG4gKiBGb3IgZWFjaCB1bmlxdWUgdGVjaG5pcXVlIElELCB0cmFja3MgY291bnQsIElPQyBjYXJkIElEcywgd29yc3Qgc2V2ZXJpdHksXHJcbiAqIGFuZCB2YWxpZGF0aW9uIG1lc3NhZ2VzLiBBbHNvIGJ1aWxkcyBwZXItY2FyZCB2YWxpZGF0aW9uIGVudHJpZXMgYW5kXHJcbiAqIHRyYWNrcyBjYXJkcyB3aXRoIG1pc3NpbmcgZmllbGRzLlxyXG4gKlxyXG4gKiBAcGFyYW0gaW9jRGF0YSAtIEFycmF5IG9mIHBhcnNlZCBJT0Mgbm9kZXMgZnJvbSBjYW52YXNcclxuICogQHBhcmFtIGRhdGFzZXQgLSBMb2FkZWQgTUlUUkUgZGF0YXNldCBmb3IgdmFsaWRhdGlvblxyXG4gKiBAcmV0dXJucyBCdWlsZEZvdW5kUmVzdWx0IHdpdGggZm91bmRUZWNobmlxdWVzIG1hcCwgY2FyZCB2YWxpZGF0aW9ucywgYW5kIG1pc3NpbmcgZmllbGQgaW5mb1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkRm91bmRUZWNobmlxdWVzRnJvbUlPQyhcclxuICAgIGlvY0RhdGE6IElPQ05vZGVEYXRhW10sXHJcbiAgICBkYXRhc2V0OiBNaXRyZURhdGFzZXRcclxuKTogQnVpbGRGb3VuZFJlc3VsdCB7XHJcbiAgICBjb25zdCBmb3VuZFRlY2huaXF1ZXMgPSBuZXcgTWFwPHN0cmluZywgRm91bmRUZWNobmlxdWVFbnRyeT4oKTtcclxuXHJcbiAgICAvLyBUcmFjayB2YWxpZGF0aW9uIHBlciBjYXJkIGZvciBhY2N1cmF0ZSBlcnJvciByZXBvcnRpbmdcclxuICAgIGNvbnN0IGNhcmRWYWxpZGF0aW9ucyA9IG5ldyBNYXA8c3RyaW5nLCBDYXJkVmFsaWRhdGlvbkVudHJ5PigpO1xyXG5cclxuICAgIC8vIFRyYWNrIGNhcmRzIHdpdGggbWlzc2luZyBmaWVsZHMgKGluZm9ybWF0aW9uYWwsIG5vdCBlcnJvcnMpXHJcbiAgICBjb25zdCBtaXNzaW5nVGFjdGljQ2FyZHM6IE1pc3NpbmdGaWVsZEluZm9bXSA9IFtdO1xyXG4gICAgY29uc3QgbWlzc2luZ1RlY2huaXF1ZUNhcmRzOiBNaXNzaW5nRmllbGRJbmZvW10gPSBbXTtcclxuXHJcbiAgICAvLyBDb3VudCBBTEwgSU9DIGNhcmRzIChpbmNsdWRpbmcgdGhvc2Ugd2l0aCBtaXNzaW5nIGZpZWxkcylcclxuICAgIGxldCBpb2NDb3VudCA9IDA7XHJcblxyXG4gICAgaW9jRGF0YS5mb3JFYWNoKGlvYyA9PiB7XHJcbiAgICAgICAgY29uc3QgcmF3VGFjdGljID0gKGlvYy50YWN0aWMgfHwgJycpLnRyaW0oKTtcclxuICAgICAgICBjb25zdCByYXdUZWNobmlxdWUgPSAoaW9jLnRlY2huaXF1ZSB8fCAnJykudHJpbSgpO1xyXG5cclxuICAgICAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tNaXRyZUFnZ3JlZ2F0b3JdIFByb2Nlc3NpbmcgSU9DIGNhcmQ6Jywge1xyXG4gICAgICAgICAgICBjYXJkSWQ6IGlvYy5jYXJkSWQgfHwgJyhubyBJRCknLFxyXG4gICAgICAgICAgICB0eXBlOiBpb2MudHlwZSxcclxuICAgICAgICAgICAgbm9kZUlkOiBpb2MuaWQsXHJcbiAgICAgICAgICAgIHJhd1RhY3RpYzogcmF3VGFjdGljIHx8ICcoZW1wdHkpJyxcclxuICAgICAgICAgICAgcmF3VGVjaG5pcXVlOiByYXdUZWNobmlxdWUgfHwgJyhlbXB0eSknXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgIC8vIENBU0UgMTogRW1wdHkgdGVjaG5pcXVlIGZpZWxkXHJcbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgLy8gSWYgdGhlIHRlY2huaXF1ZSBmaWVsZCBpcyBlbXB0eSwgd2UgY2Fubm90IHZhbGlkYXRlIGFueXRoaW5nLlxyXG4gICAgICAgIC8vIFRyYWNrIGFzIG1pc3NpbmcgKGluZm9ybWF0aW9uYWwpIGluc3RlYWQgb2YgY3JlYXRpbmcgYW4gZXJyb3IuXHJcbiAgICAgICAgaWYgKCFyYXdUZWNobmlxdWUpIHtcclxuICAgICAgICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbTWl0cmVBZ2dyZWdhdG9yXSBJT0MgY2FyZCBoYXMgZW1wdHkgdGVjaG5pcXVlOicsIGlvYy5pZCk7XHJcblxyXG4gICAgICAgICAgICAvLyBUcmFjayBhcyBtaXNzaW5nIHRlY2huaXF1ZSAoaW5mb3JtYXRpb25hbClcclxuICAgICAgICAgICAgY29uc3QgbWlzc2luZ0luZm86IE1pc3NpbmdGaWVsZEluZm8gPSB7XHJcbiAgICAgICAgICAgICAgICBjYXJkSWQ6IGlvYy5jYXJkSWQgfHwgaW9jLmlkLFxyXG4gICAgICAgICAgICAgICAgaW9jVHlwZTogaW9jLnR5cGUsXHJcbiAgICAgICAgICAgICAgICBub2RlSWQ6IGlvYy5pZCxcclxuICAgICAgICAgICAgICAgIG1pc3Npbmc6ICFyYXdUYWN0aWMgPyAnYm90aCcgOiAndGVjaG5pcXVlJ1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBtaXNzaW5nVGVjaG5pcXVlQ2FyZHMucHVzaChtaXNzaW5nSW5mbyk7XHJcblxyXG4gICAgICAgICAgICAvLyBBbHNvIHRyYWNrIG1pc3NpbmcgdGFjdGljIGlmIGJvdGggYXJlIGVtcHR5XHJcbiAgICAgICAgICAgIGlmICghcmF3VGFjdGljKSB7XHJcbiAgICAgICAgICAgICAgICBtaXNzaW5nVGFjdGljQ2FyZHMucHVzaCh7Li4ubWlzc2luZ0luZm8sIG1pc3Npbmc6ICdib3RoJ30pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpb2NDb3VudCsrOyAgLy8gQ291bnQgdGhpcyBjYXJkICh3YXMgcHJldmlvdXNseSBza2lwcGVkKVxyXG4gICAgICAgICAgICByZXR1cm47ICAgICAgLy8gQ2FuJ3QgdmFsaWRhdGUgd2l0aG91dCB0ZWNobmlxdWUsIGJ1dCB3ZSd2ZSB0cmFja2VkIGl0XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCB0ZWNobmlxdWUgPSByYXdUZWNobmlxdWU7XHJcbiAgICAgICAgY29uc3QgdGVjaG5pcXVlSWQgPSBleHRyYWN0VGVjaG5pcXVlSWQodGVjaG5pcXVlKTtcclxuICAgICAgICBjb25zdCB0ZWNobmlxdWVOYW1lID0gZXh0cmFjdFRlY2huaXF1ZU5hbWUodGVjaG5pcXVlLCBkYXRhc2V0KTtcclxuXHJcbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgLy8gQ0FTRSAyOiBFbXB0eSB0YWN0aWMgZmllbGQgKGJ1dCB0ZWNobmlxdWUgaXMgZmlsbGVkKVxyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgIC8vIFRoZSBhbmFseXN0IHByb3ZpZGVkIGEgdGVjaG5pcXVlIGJ1dCBsZWZ0IHRoZSB0YWN0aWMgZmllbGQgZW1wdHkuXHJcbiAgICAgICAgLy8gVHJhY2sgYXMgbWlzc2luZyAoaW5mb3JtYXRpb25hbCkgaW5zdGVhZCBvZiBjcmVhdGluZyBhbiBlcnJvci5cclxuICAgICAgICBpZiAoIXJhd1RhY3RpYykge1xyXG4gICAgICAgICAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tNaXRyZUFnZ3JlZ2F0b3JdIElPQyBjYXJkIGhhcyBlbXB0eSB0YWN0aWM6JywgaW9jLmlkKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFRyYWNrIGFzIG1pc3NpbmcgdGFjdGljIChpbmZvcm1hdGlvbmFsLCBOT1QgYW4gZXJyb3IpXHJcbiAgICAgICAgICAgIG1pc3NpbmdUYWN0aWNDYXJkcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGNhcmRJZDogaW9jLmNhcmRJZCB8fCBpb2MuaWQsXHJcbiAgICAgICAgICAgICAgICBpb2NUeXBlOiBpb2MudHlwZSxcclxuICAgICAgICAgICAgICAgIG5vZGVJZDogaW9jLmlkLFxyXG4gICAgICAgICAgICAgICAgbWlzc2luZzogJ3RhY3RpYydcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpb2NDb3VudCsrOyAgLy8gQ291bnQgdGhpcyBjYXJkXHJcblxyXG4gICAgICAgICAgICAvLyBTdGlsbCBhZGQgdGVjaG5pcXVlIHRvIGZvdW5kVGVjaG5pcXVlcyBmb3IgbWF0cml4IGhpZ2hsaWdodGluZ1xyXG4gICAgICAgICAgICAvLyAodGVjaG5pcXVlIGV4aXN0cywganVzdCBjYW4ndCB2YWxpZGF0ZSB0YWN0aWMgcmVsYXRpb25zaGlwKVxyXG4gICAgICAgICAgICBpZiAoIWZvdW5kVGVjaG5pcXVlcy5oYXModGVjaG5pcXVlSWQpKSB7XHJcbiAgICAgICAgICAgICAgICBmb3VuZFRlY2huaXF1ZXMuc2V0KHRlY2huaXF1ZUlkLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY291bnQ6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgaW9jQ2FyZHM6IFtpb2MuaWRdLFxyXG4gICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAndmFsaWQnLCAgLy8gTm8gc2V2ZXJpdHkgcGVuYWx0eSBmb3IgbWlzc2luZyB0YWN0aWNcclxuICAgICAgICAgICAgICAgICAgICB2YWxpZGF0aW9uTWVzc2FnZTogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJQcm92aWRlZFRhY3RpYzogJyhlbXB0eSknXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nID0gZm91bmRUZWNobmlxdWVzLmdldCh0ZWNobmlxdWVJZCkhO1xyXG4gICAgICAgICAgICAgICAgZXhpc3RpbmcuY291bnQrKztcclxuICAgICAgICAgICAgICAgIGV4aXN0aW5nLmlvY0NhcmRzLnB1c2goaW9jLmlkKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbWFya1BhcmVudEFzRm91bmQodGVjaG5pcXVlSWQsIGZvdW5kVGVjaG5pcXVlcywgJyhlbXB0eSknKTtcclxuICAgICAgICAgICAgcmV0dXJuOyAgLy8gU2tpcCB2YWxpZGF0aW9uIChjYW4ndCB2YWxpZGF0ZSB3aXRob3V0IHRhY3RpYylcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgIC8vIENBU0UgMzogQm90aCB0YWN0aWMgYW5kIHRlY2huaXF1ZSBmaWxsZWQgLSBub3JtYWwgdmFsaWRhdGlvblxyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgIC8vIFN0YW5kYXJkIHZhbGlkYXRpb24gcGF0aCB1c2luZyBNaXRyZUxvYWRlci52YWxpZGF0ZVRlY2huaXF1ZVRhY3RpYygpLlxyXG4gICAgICAgIGNvbnN0IHRhY3RpYyA9IHJhd1RhY3RpYztcclxuICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdmFsaWRhdGVUZWNobmlxdWVUYWN0aWModGVjaG5pcXVlSWQsIHRhY3RpYywgZGF0YXNldCk7XHJcblxyXG4gICAgICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW01pdHJlQWdncmVnYXRvcl0gVmFsaWRhdGVkIHRlY2huaXF1ZTonLCB7XHJcbiAgICAgICAgICAgIGNhcmRJZDogaW9jLmNhcmRJZCB8fCBpb2MuaWQsXHJcbiAgICAgICAgICAgIHRlY2huaXF1ZUlkLFxyXG4gICAgICAgICAgICB0YWN0aWMsXHJcbiAgICAgICAgICAgIHNldmVyaXR5OiB2YWxpZGF0aW9uLnNldmVyaXR5LFxyXG4gICAgICAgICAgICBtZXNzYWdlOiB2YWxpZGF0aW9uLm1lc3NhZ2UgfHwgJ3ZhbGlkJ1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpb2NDb3VudCsrOyAgLy8gQ291bnQgdGhpcyBjYXJkXHJcblxyXG4gICAgICAgIC8vIEFsd2F5cyBzdG9yZSBpbmRpdmlkdWFsIGNhcmQgdmFsaWRhdGlvblxyXG4gICAgICAgIGNhcmRWYWxpZGF0aW9ucy5zZXQoaW9jLmlkLCB7XHJcbiAgICAgICAgICAgIGNhcmRJZDogaW9jLmNhcmRJZCB8fCBpb2MuaWQsXHJcbiAgICAgICAgICAgIHRlY2huaXF1ZUlkLFxyXG4gICAgICAgICAgICB0ZWNobmlxdWVOYW1lLFxyXG4gICAgICAgICAgICB0YWN0aWMsXHJcbiAgICAgICAgICAgIHNldmVyaXR5OiB2YWxpZGF0aW9uLnNldmVyaXR5LFxyXG4gICAgICAgICAgICB2YWxpZGF0aW9uTWVzc2FnZTogdmFsaWRhdGlvbi5tZXNzYWdlLFxyXG4gICAgICAgICAgICBpb2NUeXBlOiBpb2MudHlwZSxcclxuICAgICAgICAgICAgbm9kZUlkOiBpb2MuaWRcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gRXhpc3RpbmcgZm91bmRUZWNobmlxdWVzIGFnZ3JlZ2F0aW9uIChmb3IgbWF0cml4IGNvbG9yaW5nKVxyXG4gICAgICAgIGlmIChmb3VuZFRlY2huaXF1ZXMuaGFzKHRlY2huaXF1ZUlkKSkge1xyXG4gICAgICAgICAgICBjb25zdCBleGlzdGluZyA9IGZvdW5kVGVjaG5pcXVlcy5nZXQodGVjaG5pcXVlSWQpITtcclxuICAgICAgICAgICAgZXhpc3RpbmcuY291bnQrKztcclxuICAgICAgICAgICAgZXhpc3RpbmcuaW9jQ2FyZHMucHVzaChpb2MuaWQpO1xyXG4gICAgICAgICAgICBpZiAoc2hvdWxkT3ZlcnJpZGVTZXZlcml0eSh2YWxpZGF0aW9uLnNldmVyaXR5LCBleGlzdGluZy5zZXZlcml0eSkpIHtcclxuICAgICAgICAgICAgICAgIGV4aXN0aW5nLnNldmVyaXR5ID0gdmFsaWRhdGlvbi5zZXZlcml0eTtcclxuICAgICAgICAgICAgICAgIGV4aXN0aW5nLnZhbGlkYXRpb25NZXNzYWdlID0gdmFsaWRhdGlvbi5tZXNzYWdlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZm91bmRUZWNobmlxdWVzLnNldCh0ZWNobmlxdWVJZCwge1xyXG4gICAgICAgICAgICAgICAgY291bnQ6IDEsXHJcbiAgICAgICAgICAgICAgICBpb2NDYXJkczogW2lvYy5pZF0sXHJcbiAgICAgICAgICAgICAgICBzZXZlcml0eTogdmFsaWRhdGlvbi5zZXZlcml0eSxcclxuICAgICAgICAgICAgICAgIHZhbGlkYXRpb25NZXNzYWdlOiB2YWxpZGF0aW9uLm1lc3NhZ2UsXHJcbiAgICAgICAgICAgICAgICB1c2VyUHJvdmlkZWRUYWN0aWM6IHRhY3RpY1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIG1hcmtQYXJlbnRBc0ZvdW5kKHRlY2huaXF1ZUlkLCBmb3VuZFRlY2huaXF1ZXMsIHRhY3RpYyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tNaXRyZUFnZ3JlZ2F0b3JdIEZvdW5kJywgZm91bmRUZWNobmlxdWVzLnNpemUsICd1bmlxdWUgdGVjaG5pcXVlcyBpbiBJT0MgY2FyZHMnKTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGZvdW5kVGVjaG5pcXVlcyxcclxuICAgICAgICBjYXJkVmFsaWRhdGlvbnMsXHJcbiAgICAgICAgbWlzc2luZ1RhY3RpY0NhcmRzLFxyXG4gICAgICAgIG1pc3NpbmdUZWNobmlxdWVDYXJkcyxcclxuICAgICAgICBpb2NDb3VudFxyXG4gICAgfTtcclxufVxyXG4iLCAiLyoqXHJcbiAqIE1pdHJlQWdncmVnYXRvci50cyAtIElPQy10by1NSVRSRSBtYXRyaXggYWdncmVnYXRpb24gYWxnb3JpdGhtIChTVEVQcyAyLTUpXHJcbiAqXHJcbiAqIEltcGxlbWVudHMgdGhlIGNvcmUgYWdncmVnYXRpb24gdGhhdCBidWlsZHMgdGhlIGNvbXBsZXRlIE1JVFJFIEFUVCZDSyBtYXRyaXhcclxuICogZnJvbSBJT0MgY2FyZCBkYXRhLiBTVEVQIDEgKGNhcmQgcHJvY2Vzc2luZykgaXMgZGVsZWdhdGVkIHRvXHJcbiAqIE1pdHJlQWdncmVnYXRvckNhcmRQcm9jZXNzaW5nLnRzLiBUaGlzIG1vZHVsZSBoYW5kbGVzOlxyXG4gKlxyXG4gKiAqKkFsZ29yaXRobSBTdGVwcyAoaW4gdGhpcyBmaWxlKToqKlxyXG4gKiAyLiBCdWlsZCBmdWxsIHRhY3RpYyBzdHJ1Y3R1cmUgZnJvbSBkYXRhc2V0IChhbGwgMTQgdGFjdGljcylcclxuICogMy4gUG9wdWxhdGUgQUxMIHRlY2huaXF1ZXMgZnJvbSBkYXRhc2V0IChmb3VuZCBhbmQgdW5mb3VuZClcclxuICogNC4gQ29udmVydCB0byBhcnJheSBhbmQgc29ydCBieSBraWxsIGNoYWluIG9yZGVyXHJcbiAqIDUuIENvbGxlY3QgdmFsaWRhdGlvbiBlcnJvcnMgZm9yIGRpc3BsYXlcclxuICpcclxuICogVHlwZXMgYW5kIGV4dHJhY3Rpb24gaGVscGVycyBsaXZlIGluIE1pdHJlQWdncmVnYXRvclR5cGVzLnRzLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IElPQ05vZGVEYXRhIH0gZnJvbSAnLi4vcGFyc2luZy9JT0NQYXJzZXInO1xyXG5pbXBvcnQge1xyXG4gICAgTWl0cmVUZWNobmlxdWUsXHJcbiAgICBNaXRyZVRhY3RpYyxcclxuICAgIFZhbGlkYXRpb25FcnJvclxyXG59IGZyb20gJy4vTWl0cmVUeXBlcyc7XHJcbmltcG9ydCB7IE1pdHJlRGF0YXNldCB9IGZyb20gJy4vTWl0cmVMb2FkZXInO1xyXG5pbXBvcnQgeyBERUJVRyB9IGZyb20gJy4uL2RlYnVnJztcclxuXHJcbi8vIFJlLWV4cG9ydCB0eXBlcyBhbmQgaGVscGVycyBzbyBleGlzdGluZyBpbXBvcnRlcnMgZG9uJ3QgYnJlYWtcclxuZXhwb3J0IHsgQWdncmVnYXRpb25SZXN1bHQsIGV4dHJhY3RUZWNobmlxdWVJZCwgZXh0cmFjdFRlY2huaXF1ZU5hbWUgfSBmcm9tICcuL01pdHJlQWdncmVnYXRvclR5cGVzJztcclxuaW1wb3J0IHsgQWdncmVnYXRpb25SZXN1bHQsIFRBQ1RJQ19PUkRFUiB9IGZyb20gJy4vTWl0cmVBZ2dyZWdhdG9yVHlwZXMnO1xyXG5pbXBvcnQgeyBidWlsZEZvdW5kVGVjaG5pcXVlc0Zyb21JT0MgfSBmcm9tICcuL01pdHJlQWdncmVnYXRvckNhcmRQcm9jZXNzaW5nJztcclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBDb3JlIGFnZ3JlZ2F0aW9uIChTVEVQcyAyLTUpXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLyoqXHJcbiAqIEFnZ3JlZ2F0ZSBNSVRSRSB0YWN0aWNzIGFuZCB0ZWNobmlxdWVzIGZyb20gSU9DIGNhcmRzIGludG8gZnVsbCBtYXRyaXggc3RydWN0dXJlLlxyXG4gKlxyXG4gKiBUaGlzIGlzIHRoZSBjb3JlIGFnZ3JlZ2F0aW9uIGFsZ29yaXRobSB0aGF0IGJ1aWxkcyB0aGUgY29tcGxldGUgTUlUUkUgQVRUJkNLIG1hdHJpeFxyXG4gKiBzaG93aW5nIEFMTCAxNCB0YWN0aWNzIGFuZCBBTEwgfjgwMCsgdGVjaG5pcXVlcywgd2l0aCBmb3VuZCB0ZWNobmlxdWVzIGhpZ2hsaWdodGVkXHJcbiAqIGFuZCB2YWxpZGF0ZWQuXHJcbiAqXHJcbiAqIEBwYXJhbSBpb2NEYXRhIC0gQXJyYXkgb2YgcGFyc2VkIElPQyBub2RlcyBmcm9tIGNhbnZhc1xyXG4gKiBAcGFyYW0gZGF0YXNldCAtIExvYWRlZCBNSVRSRSBkYXRhc2V0XHJcbiAqIEByZXR1cm5zIEFnZ3JlZ2F0aW9uUmVzdWx0IHdpdGggdGFjdGljcywgZXJyb3JzLCBzdWJ0ZWNobmlxdWVzIG1hcCwgYW5kIElPQyBkYXRhIG1hcFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGFnZ3JlZ2F0ZVRhY3RpY3NUZWNobmlxdWVzKFxyXG4gICAgaW9jRGF0YTogSU9DTm9kZURhdGFbXSxcclxuICAgIGRhdGFzZXQ6IE1pdHJlRGF0YXNldFxyXG4pOiBBZ2dyZWdhdGlvblJlc3VsdCB7XHJcbiAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tNaXRyZUFnZ3JlZ2F0b3JdIFN0YXJ0aW5nIGZ1bGwgbWF0cml4IGFnZ3JlZ2F0aW9uIHdpdGgnLCBpb2NEYXRhLmxlbmd0aCwgJ0lPQyBjYXJkcycpO1xyXG4gICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbTWl0cmVBZ2dyZWdhdG9yXSBEYXRhc2V0IGhhcycsIE9iamVjdC5rZXlzKGRhdGFzZXQudGVjaG5pcXVlcykubGVuZ3RoLCAndGVjaG5pcXVlcycpO1xyXG5cclxuICAgIC8vIEJ1aWxkIElPQyBkYXRhIG1hcCBmb3IgaG92ZXIgdG9vbHRpcHNcclxuICAgIGNvbnN0IGlvY0RhdGFNYXAgPSBuZXcgTWFwPHN0cmluZywgSU9DTm9kZURhdGE+KCk7XHJcbiAgICBpb2NEYXRhLmZvckVhY2goaW9jID0+IHtcclxuICAgICAgICBpb2NEYXRhTWFwLnNldChpb2MuaWQsIGlvYyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIFNURVAgMTogQnVpbGQgbWFwIG9mIGZvdW5kIHRlY2huaXF1ZXMgZnJvbSBJT0MgY2FyZHNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gRGVsZWdhdGVkIHRvIE1pdHJlQWdncmVnYXRvckNhcmRQcm9jZXNzaW5nLmJ1aWxkRm91bmRUZWNobmlxdWVzRnJvbUlPQygpXHJcbiAgICBjb25zdCB7XHJcbiAgICAgICAgZm91bmRUZWNobmlxdWVzLFxyXG4gICAgICAgIGNhcmRWYWxpZGF0aW9ucyxcclxuICAgICAgICBtaXNzaW5nVGFjdGljQ2FyZHMsXHJcbiAgICAgICAgbWlzc2luZ1RlY2huaXF1ZUNhcmRzLFxyXG4gICAgICAgIGlvY0NvdW50XHJcbiAgICB9ID0gYnVpbGRGb3VuZFRlY2huaXF1ZXNGcm9tSU9DKGlvY0RhdGEsIGRhdGFzZXQpO1xyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gU1RFUCAyOiBCdWlsZCBmdWxsIHRhY3RpYyBzdHJ1Y3R1cmUgZnJvbSBkYXRhc2V0XHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIENyZWF0ZSBhIE1pdHJlVGFjdGljIGVudHJ5IGZvciBBTEwgMTQgdGFjdGljcyBpbiB0aGUgQVRUJkNLIGZyYW1ld29yay5cclxuICAgIGNvbnN0IHRhY3RpY01hcCA9IG5ldyBNYXA8c3RyaW5nLCBNaXRyZVRhY3RpYz4oKTtcclxuXHJcbiAgICBPYmplY3QudmFsdWVzKGRhdGFzZXQudGFjdGljcykuZm9yRWFjaCh0YWN0aWNEYXRhID0+IHtcclxuICAgICAgICB0YWN0aWNNYXAuc2V0KHRhY3RpY0RhdGEuaWQsIHtcclxuICAgICAgICAgICAgbmFtZTogdGFjdGljRGF0YS5pZCxcclxuICAgICAgICAgICAgZGlzcGxheU5hbWU6IGAke3RhY3RpY0RhdGEubmFtZX0gKCR7dGFjdGljRGF0YS5pZH0pYCxcclxuICAgICAgICAgICAgdGVjaG5pcXVlczogW11cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gU1RFUCAzOiBQb3B1bGF0ZSBBTEwgdGVjaG5pcXVlcyBmcm9tIGRhdGFzZXRcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gTG9vcCB0aHJvdWdoIEFMTCB+ODAwKyB0ZWNobmlxdWVzIGFuZCBhZGQgdGhlbSB0byB0aGVpciByZXNwZWN0aXZlXHJcbiAgICAvLyB0YWN0aWNzLiBGb3VuZCB0ZWNobmlxdWVzIGdldCBhZ2dyZWdhdGVkIGRhdGEgZnJvbSBTVEVQIDE7IHVuZm91bmRcclxuICAgIC8vIHRlY2huaXF1ZXMgZ2V0IHNldmVyaXR5PSdub3RfZm91bmQnIChncmF5KS5cclxuICAgIGNvbnN0IHN1YnRlY2huaXF1ZXNNYXAgPSBuZXcgTWFwPHN0cmluZywgTWl0cmVUZWNobmlxdWVbXT4oKTtcclxuXHJcbiAgICBPYmplY3QudmFsdWVzKGRhdGFzZXQudGVjaG5pcXVlcykuZm9yRWFjaCh0ZWNoRGF0YSA9PiB7XHJcbiAgICAgICAgY29uc3QgZm91bmREYXRhID0gZm91bmRUZWNobmlxdWVzLmdldCh0ZWNoRGF0YS5pZCk7XHJcbiAgICAgICAgY29uc3QgaXNGb3VuZCA9ICEhZm91bmREYXRhO1xyXG5cclxuICAgICAgICBjb25zdCB0ZWNobmlxdWVPYmo6IE1pdHJlVGVjaG5pcXVlID0ge1xyXG4gICAgICAgICAgICBpZDogdGVjaERhdGEuaWQsXHJcbiAgICAgICAgICAgIG5hbWU6IHRlY2hEYXRhLm5hbWUsXHJcbiAgICAgICAgICAgIHRhY3RpYzogJycsXHJcbiAgICAgICAgICAgIHRhY3RpY0lkOiAnJyxcclxuICAgICAgICAgICAgY291bnQ6IGZvdW5kRGF0YT8uY291bnQgfHwgMCxcclxuICAgICAgICAgICAgaW9jQ2FyZHM6IGZvdW5kRGF0YT8uaW9jQ2FyZHMgfHwgW10sXHJcbiAgICAgICAgICAgIHNldmVyaXR5OiBmb3VuZERhdGE/LnNldmVyaXR5IHx8ICdub3RfZm91bmQnLFxyXG4gICAgICAgICAgICB2YWxpZGF0aW9uTWVzc2FnZTogZm91bmREYXRhPy52YWxpZGF0aW9uTWVzc2FnZSxcclxuICAgICAgICAgICAgZGVzY3JpcHRpb246IHRlY2hEYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICBpc0ZvdW5kXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gU3VidGVjaG5pcXVlcyBzdG9yZWQgc2VwYXJhdGVseVxyXG4gICAgICAgIGlmICh0ZWNoRGF0YS5wYXJlbnQpIHtcclxuICAgICAgICAgICAgaWYgKCFzdWJ0ZWNobmlxdWVzTWFwLmhhcyh0ZWNoRGF0YS5wYXJlbnQpKSB7XHJcbiAgICAgICAgICAgICAgICBzdWJ0ZWNobmlxdWVzTWFwLnNldCh0ZWNoRGF0YS5wYXJlbnQsIFtdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGVjaERhdGEudGFjdGljcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB0ZWNobmlxdWVPYmoudGFjdGljID0gZm91bmREYXRhPy51c2VyUHJvdmlkZWRUYWN0aWMgfHwgdGVjaERhdGEudGFjdGljc1swXTtcclxuICAgICAgICAgICAgICAgIHRlY2huaXF1ZU9iai50YWN0aWNJZCA9IHRlY2hEYXRhLnRhY3RpY3NbMF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc3VidGVjaG5pcXVlc01hcC5nZXQodGVjaERhdGEucGFyZW50KSEucHVzaCh0ZWNobmlxdWVPYmopO1xyXG5cclxuICAgICAgICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbTWl0cmVBZ2dyZWdhdG9yXSBBZGRlZCBzdWJ0ZWNobmlxdWU6Jywge1xyXG4gICAgICAgICAgICAgICAgaWQ6IHRlY2hEYXRhLmlkLFxyXG4gICAgICAgICAgICAgICAgcGFyZW50OiB0ZWNoRGF0YS5wYXJlbnQsXHJcbiAgICAgICAgICAgICAgICBpc0ZvdW5kLFxyXG4gICAgICAgICAgICAgICAgdG90YWxTdWJ0ZWNobmlxdWVzOiBzdWJ0ZWNobmlxdWVzTWFwLmdldCh0ZWNoRGF0YS5wYXJlbnQpIS5sZW5ndGhcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybjsgLy8gU2tpcCBhZGRpbmcgdG8gbWFpbiB0YWN0aWMgbGlzdFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gUGFyZW50IHRlY2huaXF1ZXMgYWRkZWQgdG8gQUxMIHRoZWlyIHZhbGlkIHRhY3RpY3NcclxuICAgICAgICB0ZWNoRGF0YS50YWN0aWNzLmZvckVhY2godGFjdGljSWQgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXRhY3RpY01hcC5oYXModGFjdGljSWQpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ1tNaXRyZUFnZ3JlZ2F0b3JdIFVua25vd24gdGFjdGljIElEIGluIGRhdGFzZXQ6JywgdGFjdGljSWQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCB0YWN0aWMgPSB0YWN0aWNNYXAuZ2V0KHRhY3RpY0lkKSE7XHJcbiAgICAgICAgICAgIHRhY3RpYy50ZWNobmlxdWVzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgLi4udGVjaG5pcXVlT2JqLFxyXG4gICAgICAgICAgICAgICAgdGFjdGljOiBmb3VuZERhdGE/LnVzZXJQcm92aWRlZFRhY3RpYyB8fCB0YWN0aWNJZCxcclxuICAgICAgICAgICAgICAgIHRhY3RpY0lkXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBTVEVQIDQ6IENvbnZlcnQgdG8gYXJyYXkgYW5kIHNvcnQgYnkga2lsbCBjaGFpbiBvcmRlclxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICBjb25zdCB0YWN0aWNzID0gQXJyYXkuZnJvbSh0YWN0aWNNYXAudmFsdWVzKCkpO1xyXG5cclxuICAgIHRhY3RpY3Muc29ydCgoYSwgYikgPT4ge1xyXG4gICAgICAgIGNvbnN0IGluZGV4QSA9IFRBQ1RJQ19PUkRFUi5pbmRleE9mKGEubmFtZSk7XHJcbiAgICAgICAgY29uc3QgaW5kZXhCID0gVEFDVElDX09SREVSLmluZGV4T2YoYi5uYW1lKTtcclxuICAgICAgICBpZiAoaW5kZXhBID09PSAtMSkgcmV0dXJuIDE7XHJcbiAgICAgICAgaWYgKGluZGV4QiA9PT0gLTEpIHJldHVybiAtMTtcclxuICAgICAgICByZXR1cm4gaW5kZXhBIC0gaW5kZXhCO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gU29ydCB0ZWNobmlxdWVzOiBmb3VuZCBmaXJzdCwgdGhlbiBieSBJRFxyXG4gICAgdGFjdGljcy5mb3JFYWNoKHRhY3RpYyA9PiB7XHJcbiAgICAgICAgdGFjdGljLnRlY2huaXF1ZXMuc29ydCgoYSwgYikgPT4ge1xyXG4gICAgICAgICAgICBpZiAoYS5pc0ZvdW5kICYmICFiLmlzRm91bmQpIHJldHVybiAtMTtcclxuICAgICAgICAgICAgaWYgKCFhLmlzRm91bmQgJiYgYi5pc0ZvdW5kKSByZXR1cm4gMTtcclxuICAgICAgICAgICAgcmV0dXJuIGEuaWQubG9jYWxlQ29tcGFyZShiLmlkKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW01pdHJlQWdncmVnYXRvcl0gRnVsbCBtYXRyaXggYnVpbHQ6Jywge1xyXG4gICAgICAgIHRvdGFsVGFjdGljczogdGFjdGljcy5sZW5ndGgsXHJcbiAgICAgICAgdG90YWxUZWNobmlxdWVzOiB0YWN0aWNzLnJlZHVjZSgoc3VtLCB0KSA9PiBzdW0gKyB0LnRlY2huaXF1ZXMubGVuZ3RoLCAwKSxcclxuICAgICAgICBmb3VuZFRlY2huaXF1ZXM6IGZvdW5kVGVjaG5pcXVlcy5zaXplXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIFNURVAgNTogQ29sbGVjdCB2YWxpZGF0aW9uIGVycm9ycyBmb3IgZGlzcGxheVxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBCdWlsZCB0aGUgdmFsaWRhdGlvbiBlcnJvcnMgYXJyYXkgZm9yIHJlbmRlcmluZyBhdCB0aGUgdG9wIG9mIHRoZSBtb2RhbC5cclxuICAgIC8vIEdyb3VwcyBlcnJvcnMgYnkgdGVjaG5pcXVlK3NldmVyaXR5IHRvIGF2b2lkIGR1cGxpY2F0ZXMuXHJcbiAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tNaXRyZUFnZ3JlZ2F0b3JdIENvbGxlY3RpbmcgdmFsaWRhdGlvbiBlcnJvcnMgZnJvbSBjYXJkLWxldmVsIHZhbGlkYXRpb24uLi4nKTtcclxuICAgIGNvbnN0IHZhbGlkYXRpb25FcnJvcnM6IFZhbGlkYXRpb25FcnJvcltdID0gW107XHJcblxyXG4gICAgY29uc3QgZXJyb3JzQnlUZWNobmlxdWUgPSBuZXcgTWFwPHN0cmluZywge1xyXG4gICAgICAgIHRlY2huaXF1ZUlkOiBzdHJpbmc7XHJcbiAgICAgICAgdGVjaG5pcXVlTmFtZTogc3RyaW5nO1xyXG4gICAgICAgIHNldmVyaXR5OiAndW5rbm93bl90ZWNobmlxdWUnIHwgJ3Vua25vd25fdGFjdGljJyB8ICdtaXNtYXRjaCc7XHJcbiAgICAgICAgbWVzc2FnZTogc3RyaW5nO1xyXG4gICAgICAgIGNhcmRzOiBBcnJheTx7IGNhcmRJZDogc3RyaW5nOyBpb2NUeXBlOiBzdHJpbmc7IG5vZGVJZDogc3RyaW5nOyB9PjtcclxuICAgIH0+KCk7XHJcblxyXG4gICAgY2FyZFZhbGlkYXRpb25zLmZvckVhY2goKGNhcmRWYWxpZGF0aW9uLCBjYXJkSWQpID0+IHtcclxuICAgICAgICBpZiAoY2FyZFZhbGlkYXRpb24uc2V2ZXJpdHkgIT09ICd2YWxpZCcpIHtcclxuICAgICAgICAgICAgY29uc3Qga2V5ID0gYCR7Y2FyZFZhbGlkYXRpb24udGVjaG5pcXVlSWR9LSR7Y2FyZFZhbGlkYXRpb24uc2V2ZXJpdHl9YDtcclxuXHJcbiAgICAgICAgICAgIGlmICghZXJyb3JzQnlUZWNobmlxdWUuaGFzKGtleSkpIHtcclxuICAgICAgICAgICAgICAgIGVycm9yc0J5VGVjaG5pcXVlLnNldChrZXksIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZWNobmlxdWVJZDogY2FyZFZhbGlkYXRpb24udGVjaG5pcXVlSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVjaG5pcXVlTmFtZTogY2FyZFZhbGlkYXRpb24udGVjaG5pcXVlTmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogY2FyZFZhbGlkYXRpb24uc2V2ZXJpdHkgYXMgYW55LFxyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGNhcmRWYWxpZGF0aW9uLnZhbGlkYXRpb25NZXNzYWdlIHx8ICdWYWxpZGF0aW9uIGVycm9yJyxcclxuICAgICAgICAgICAgICAgICAgICBjYXJkczogW11cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBlcnJvcnNCeVRlY2huaXF1ZS5nZXQoa2V5KSEuY2FyZHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBjYXJkSWQ6IGNhcmRWYWxpZGF0aW9uLmNhcmRJZCxcclxuICAgICAgICAgICAgICAgIGlvY1R5cGU6IGNhcmRWYWxpZGF0aW9uLmlvY1R5cGUsXHJcbiAgICAgICAgICAgICAgICBub2RlSWQ6IGNhcmRWYWxpZGF0aW9uLm5vZGVJZFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBlcnJvcnNCeVRlY2huaXF1ZS5mb3JFYWNoKChlcnJvckRhdGEpID0+IHtcclxuICAgICAgICB2YWxpZGF0aW9uRXJyb3JzLnB1c2goe1xyXG4gICAgICAgICAgICB0ZWNobmlxdWVJZDogZXJyb3JEYXRhLnRlY2huaXF1ZUlkLFxyXG4gICAgICAgICAgICB0ZWNobmlxdWVOYW1lOiBlcnJvckRhdGEudGVjaG5pcXVlTmFtZSxcclxuICAgICAgICAgICAgc2V2ZXJpdHk6IGVycm9yRGF0YS5zZXZlcml0eSxcclxuICAgICAgICAgICAgbWVzc2FnZTogZXJyb3JEYXRhLm1lc3NhZ2UsXHJcbiAgICAgICAgICAgIGlvY0NhcmRzOiBlcnJvckRhdGEuY2FyZHNcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW01pdHJlQWdncmVnYXRvcl0gQWdncmVnYXRpb24gY29tcGxldGU6Jywge1xyXG4gICAgICAgIGVycm9yR3JvdXBzOiB2YWxpZGF0aW9uRXJyb3JzLmxlbmd0aCxcclxuICAgICAgICBjYXJkc1dpdGhFcnJvcnM6IEFycmF5LmZyb20oY2FyZFZhbGlkYXRpb25zLnZhbHVlcygpKS5maWx0ZXIodiA9PiB2LnNldmVyaXR5ICE9PSAndmFsaWQnKS5sZW5ndGgsXHJcbiAgICAgICAgbWlzc2luZ1RhY3RpYzogbWlzc2luZ1RhY3RpY0NhcmRzLmxlbmd0aCxcclxuICAgICAgICBtaXNzaW5nVGVjaG5pcXVlOiBtaXNzaW5nVGVjaG5pcXVlQ2FyZHMubGVuZ3RoXHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHRhY3RpY3MsXHJcbiAgICAgICAgdmFsaWRhdGlvbkVycm9ycyxcclxuICAgICAgICBzdWJ0ZWNobmlxdWVzTWFwLFxyXG4gICAgICAgIGlvY0RhdGFNYXAsXHJcbiAgICAgICAgaW9jQ291bnQsXHJcbiAgICAgICAgbWlzc2luZ0ZpZWxkczoge1xyXG4gICAgICAgICAgICBtaXNzaW5nVGFjdGljOiBtaXNzaW5nVGFjdGljQ2FyZHMsXHJcbiAgICAgICAgICAgIG1pc3NpbmdUZWNobmlxdWU6IG1pc3NpbmdUZWNobmlxdWVDYXJkc1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuIiwgIi8qKlxyXG4gKiBNaXRyZUV4cG9ydC50cyAtIE1JVFJFIEFUVCZDSyBOYXZpZ2F0b3IgSlNPTiBleHBvcnRcclxuICpcclxuICogR2VuZXJhdGVzIGEgSlNPTiBsYXllciBmaWxlIGNvbXBhdGlibGUgd2l0aCB0aGUgb2ZmaWNpYWwgTUlUUkUgQVRUJkNLIE5hdmlnYXRvclxyXG4gKiAoaHR0cHM6Ly9taXRyZS1hdHRhY2suZ2l0aHViLmlvL2F0dGFjay1uYXZpZ2F0b3IvKS4gVGhlIGV4cG9ydCB1c2VzIHByZS1jb21wdXRlZFxyXG4gKiB0YWN0aWNzIGZyb20gdGhlIG1vZGFsICh3aGF0LXlvdS1zZWUtaXMtd2hhdC15b3UtZXhwb3J0KSBhbmQgaW5jbHVkZXMgc2V2ZXJpdHktYmFzZWRcclxuICogY29sb3JpbmcsIElPQyBjYXJkIGNvdW50cyBhcyB0ZWNobmlxdWUgc2NvcmVzLCBhbmQgdmFsaWRhdGlvbiBtZXNzYWdlcyBpbiBjb21tZW50cy5cclxuICovXHJcblxyXG5pbXBvcnQgeyBNaXRyZVRhY3RpYyB9IGZyb20gJy4vTWl0cmVUeXBlcyc7XHJcbmltcG9ydCB7IGlzQ3JpdGljYWxTZXZlcml0eSwgZ2V0U2V2ZXJpdHlJY29uIH0gZnJvbSAnLi9NaXRyZVNldmVyaXR5JztcclxuaW1wb3J0IHsgTWl0cmVEYXRhc2V0IH0gZnJvbSAnLi9NaXRyZUxvYWRlcic7XHJcbmltcG9ydCB7IERFQlVHIH0gZnJvbSAnLi4vZGVidWcnO1xyXG5cclxuLyoqXHJcbiAqIEV4cG9ydCB0aGUgY3VycmVudCBNSVRSRSBtYXRyaXggdG8gTmF2aWdhdG9yIEpTT04gZm9ybWF0IGFuZCB0cmlnZ2VyIGRvd25sb2FkLlxyXG4gKlxyXG4gKiBVc2VzIHRoZSBwcmUtY29tcHV0ZWQgdGFjdGljcyBmcm9tIHRoZSBtb2RhbCBpbnN0ZWFkIG9mIHJlLXJ1bm5pbmcgYWdncmVnYXRpb24uXHJcbiAqIE9ubHkgZm91bmQgdGVjaG5pcXVlcyAoaXNGb3VuZD10cnVlKSBhcmUgaW5jbHVkZWQgaW4gdGhlIGV4cG9ydC5cclxuICpcclxuICogQHBhcmFtIHRhY3RpY3MgLSBQcmUtY29tcHV0ZWQgdGFjdGljcyBhcnJheSBmcm9tIGFnZ3JlZ2F0aW9uXHJcbiAqIEBwYXJhbSBpb2NDb3VudCAtIFRvdGFsIG51bWJlciBvZiBJT0MgY2FyZHMgZm9yIGRlc2NyaXB0aW9uIHRleHRcclxuICogQHBhcmFtIGRhdGFzZXQgLSBNSVRSRSBkYXRhc2V0IGZvciB0YWN0aWMgc2hvcnQgbmFtZSBsb29rdXBcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBleHBvcnRUb05hdmlnYXRvcihcclxuICAgIHRhY3RpY3M6IE1pdHJlVGFjdGljW10sXHJcbiAgICBpb2NDb3VudDogbnVtYmVyLFxyXG4gICAgZGF0YXNldDogTWl0cmVEYXRhc2V0XHJcbik6IHZvaWQge1xyXG4gICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbTWl0cmVFeHBvcnRdIFN0YXJ0aW5nIGV4cG9ydCAtJywgdGFjdGljcy5sZW5ndGgsICd0YWN0aWNzLCcsIGlvY0NvdW50LCAnSU9DIGNhcmRzJyk7XHJcblxyXG4gICAgLy8gQnVpbGQgTUlUUkUgQVRUJkNLIE5hdmlnYXRvciBsYXllciBmb3JtYXRcclxuICAgIGNvbnN0IGxheWVyID0ge1xyXG4gICAgICAgIG5hbWU6IFwiQ3liZXIgQ2FudmFzIElPQyBBbmFseXNpc1wiLFxyXG4gICAgICAgIHZlcnNpb25zOiB7XHJcbiAgICAgICAgICAgIGF0dGFjazogXCIxNFwiLFxyXG4gICAgICAgICAgICBuYXZpZ2F0b3I6IFwiNC45LjRcIixcclxuICAgICAgICAgICAgbGF5ZXI6IFwiNC41XCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIGRvbWFpbjogXCJlbnRlcnByaXNlLWF0dGFja1wiLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uOiBgR2VuZXJhdGVkIGZyb20gJHtpb2NDb3VudH0gSU9DIGNhcmRzIGluIE9ic2lkaWFuIENhbnZhc2AsXHJcbiAgICAgICAgZmlsdGVyczoge1xyXG4gICAgICAgICAgICBwbGF0Zm9ybXM6IFtcIndpbmRvd3NcIiwgXCJsaW51eFwiLCBcIm1hY29zXCJdXHJcbiAgICAgICAgfSxcclxuICAgICAgICBzb3J0aW5nOiAwLFxyXG4gICAgICAgIGxheW91dDoge1xyXG4gICAgICAgICAgICBsYXlvdXQ6IFwic2lkZVwiLFxyXG4gICAgICAgICAgICBhZ2dyZWdhdGVGdW5jdGlvbjogXCJhdmVyYWdlXCIsXHJcbiAgICAgICAgICAgIHNob3dJRDogdHJ1ZSxcclxuICAgICAgICAgICAgc2hvd05hbWU6IHRydWUsXHJcbiAgICAgICAgICAgIHNob3dBZ2dyZWdhdGVTY29yZXM6IGZhbHNlLFxyXG4gICAgICAgICAgICBjb3VudFVuc2NvcmVkOiBmYWxzZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaGlkZURpc2FibGVkOiBmYWxzZSxcclxuICAgICAgICB0ZWNobmlxdWVzOiBbXSBhcyBhbnlbXSxcclxuICAgICAgICBncmFkaWVudDoge1xyXG4gICAgICAgICAgICBjb2xvcnM6IFtcIiNmZjY2NjZcIiwgXCIjZmZlNzY2XCIsIFwiIzhlYzg0M1wiXSxcclxuICAgICAgICAgICAgbWluVmFsdWU6IDAsXHJcbiAgICAgICAgICAgIG1heFZhbHVlOiAxMDBcclxuICAgICAgICB9LFxyXG4gICAgICAgIGxlZ2VuZEl0ZW1zOiBbXSBhcyBhbnlbXSxcclxuICAgICAgICBtZXRhZGF0YTogW10gYXMgYW55W10sXHJcbiAgICAgICAgbGlua3M6IFtdIGFzIGFueVtdLFxyXG4gICAgICAgIHNob3dUYWN0aWNSb3dCYWNrZ3JvdW5kOiB0cnVlLFxyXG4gICAgICAgIHRhY3RpY1Jvd0JhY2tncm91bmQ6IFwiI2RkZGRkZFwiLFxyXG4gICAgICAgIHNlbGVjdFRlY2huaXF1ZXNBY3Jvc3NUYWN0aWNzOiB0cnVlLFxyXG4gICAgICAgIHNlbGVjdFN1YnRlY2huaXF1ZXNXaXRoUGFyZW50OiBmYWxzZVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBBZGQgdGVjaG5pcXVlcyB0byBsYXllciAob25seSBmb3VuZCB0ZWNobmlxdWVzKVxyXG4gICAgdGFjdGljcy5mb3JFYWNoKHRhY3RpYyA9PiB7XHJcbiAgICAgICAgdGFjdGljLnRlY2huaXF1ZXMuZm9yRWFjaCh0ZWNobmlxdWUgPT4ge1xyXG4gICAgICAgICAgICAvLyBTa2lwIHVuZm91bmQgdGVjaG5pcXVlcyBpbiBleHBvcnRcclxuICAgICAgICAgICAgaWYgKCF0ZWNobmlxdWUuaXNGb3VuZCkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgLy8gVXNlIHRhY3RpYyBzaG9ydCBuYW1lIGZyb20gZGF0YXNldCBmb3IgTmF2aWdhdG9yIGNvbXBhdGliaWxpdHlcclxuICAgICAgICAgICAgY29uc3QgdGFjdGljRGF0YSA9IGRhdGFzZXQudGFjdGljc1t0ZWNobmlxdWUudGFjdGljSWRdO1xyXG4gICAgICAgICAgICBjb25zdCB0YWN0aWNTaG9ydE5hbWUgPSB0YWN0aWNEYXRhPy5zaG9ydF9uYW1lXHJcbiAgICAgICAgICAgICAgICB8fCB0YWN0aWMubmFtZS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xccysvZywgJy0nKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFNldCBjb2xvciBiYXNlZCBvbiBzZXZlcml0eVxyXG4gICAgICAgICAgICBsZXQgY29sb3I6IHN0cmluZztcclxuICAgICAgICAgICAgaWYgKHRlY2huaXF1ZS5zZXZlcml0eSA9PT0gJ3ZhbGlkJykge1xyXG4gICAgICAgICAgICAgICAgY29sb3IgPSBcIiM2NmJiNmFcIjsgIC8vIEdyZWVuIC0gdmFsaWRcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChpc0NyaXRpY2FsU2V2ZXJpdHkodGVjaG5pcXVlLnNldmVyaXR5KSkge1xyXG4gICAgICAgICAgICAgICAgY29sb3IgPSBcIiNmNDQzMzZcIjsgIC8vIFJlZCAtIHVua25vd25cclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0ZWNobmlxdWUuc2V2ZXJpdHkgPT09ICdtaXNtYXRjaCcpIHtcclxuICAgICAgICAgICAgICAgIGNvbG9yID0gXCIjZmZhNTAwXCI7ICAvLyBPcmFuZ2UgLSB3cm9uZyB0YWN0aWNcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbG9yID0gXCIjNjZiYjZhXCI7ICAvLyBEZWZhdWx0IGdyZWVuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIEJ1aWxkIGNvbW1lbnQgd2l0aCB2YWxpZGF0aW9uIHN0YXR1c1xyXG4gICAgICAgICAgICBsZXQgY29tbWVudCA9IGBVc2VkIGluICR7dGVjaG5pcXVlLmNvdW50fSBJT0MgY2FyZCR7dGVjaG5pcXVlLmNvdW50ID4gMSA/ICdzJyA6ICcnfWA7XHJcbiAgICAgICAgICAgIGlmICh0ZWNobmlxdWUuc2V2ZXJpdHkgIT09ICd2YWxpZCcgJiYgdGVjaG5pcXVlLnZhbGlkYXRpb25NZXNzYWdlKSB7XHJcbiAgICAgICAgICAgICAgICBjb21tZW50ICs9IGBcXG4ke2dldFNldmVyaXR5SWNvbih0ZWNobmlxdWUuc2V2ZXJpdHkpfSAke3RlY2huaXF1ZS52YWxpZGF0aW9uTWVzc2FnZX1gO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBsYXllci50ZWNobmlxdWVzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgdGVjaG5pcXVlSUQ6IHRlY2huaXF1ZS5pZCxcclxuICAgICAgICAgICAgICAgIHRhY3RpYzogdGFjdGljU2hvcnROYW1lLFxyXG4gICAgICAgICAgICAgICAgY29sb3IsXHJcbiAgICAgICAgICAgICAgICBjb21tZW50LFxyXG4gICAgICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiBbXHJcbiAgICAgICAgICAgICAgICAgICAgeyBuYW1lOiAnc2V2ZXJpdHknLCB2YWx1ZTogdGVjaG5pcXVlLnNldmVyaXR5IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgeyBuYW1lOiAnaW9jX2NhcmRzJywgdmFsdWU6IHRlY2huaXF1ZS5pb2NDYXJkcy5qb2luKCcsICcpIH1cclxuICAgICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgICAgICBsaW5rczogW10sXHJcbiAgICAgICAgICAgICAgICBzaG93U3VidGVjaG5pcXVlczogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBzY29yZTogdGVjaG5pcXVlLmNvdW50ICogMTAgLy8gU2NhbGUgY291bnQgZm9yIHZpc3VhbCB3ZWlnaHRcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tNaXRyZUV4cG9ydF0gRXhwb3J0ZWQnLCBsYXllci50ZWNobmlxdWVzLmxlbmd0aCwgJ3RlY2huaXF1ZXMgdG8gTmF2aWdhdG9yIGZvcm1hdCcpO1xyXG5cclxuICAgIC8vIFRyaWdnZXIgZG93bmxvYWRcclxuICAgIGNvbnN0IGpzb25TdHJpbmcgPSBKU09OLnN0cmluZ2lmeShsYXllciwgbnVsbCwgMik7XHJcbiAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2pzb25TdHJpbmddLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyB9KTtcclxuICAgIGNvbnN0IHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XHJcblxyXG4gICAgY29uc3QgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcclxuICAgIGEuaHJlZiA9IHVybDtcclxuICAgIGEuZG93bmxvYWQgPSBgbWl0cmUtbmF2aWdhdG9yLSR7RGF0ZS5ub3coKX0uanNvbmA7XHJcbiAgICBhLmNsaWNrKCk7XHJcblxyXG4gICAgVVJMLnJldm9rZU9iamVjdFVSTCh1cmwpO1xyXG59XHJcbiIsICIvKipcclxuICogTWl0cmVSZXNpemFibGUudHMgLSA4LWhhbmRsZSBkcmFnLXRvLXJlc2l6ZSBmb3IgTUlUUkUgbW9kYWxcclxuICpcclxuICogQ3JlYXRlcyA4IHJlc2l6ZSBoYW5kbGVzICg0IGNvcm5lcnMgKyA0IGVkZ2VzKSBvbiB0aGUgbW9kYWwgZWxlbWVudFxyXG4gKiBhbmQgYXR0YWNoZXMgZHJhZyBsaXN0ZW5lcnMgZm9yIGludGVyYWN0aXZlIHJlc2l6aW5nLlxyXG4gKlxyXG4gKiAqKkNvb3JkaW5hdGUgTWF0aDoqKlxyXG4gKiAtIEVhc3QgKEUpOiBEcmFnIHJpZ2h0IGluY3JlYXNlcyB3aWR0aCBieSBkZWx0YVhcclxuICogLSBXZXN0IChXKTogRHJhZyBsZWZ0IGRlY3JlYXNlcyB3aWR0aCwgc2hpZnRzIG1vZGFsIGxlZnRcclxuICogLSBTb3V0aCAoUyk6IERyYWcgZG93biBpbmNyZWFzZXMgaGVpZ2h0IGJ5IGRlbHRhWVxyXG4gKiAtIE5vcnRoIChOKTogRHJhZyB1cCBkZWNyZWFzZXMgaGVpZ2h0LCBzaGlmdHMgbW9kYWwgdXBcclxuICogLSBDb3JuZXJzOiBDb21iaW5lIHR3byBkaXJlY3Rpb25zIChlLmcuLCBORSA9IE5vcnRoICsgRWFzdClcclxuICpcclxuICogKipDb25zdHJhaW50czoqKlxyXG4gKiAtIE1JTl9XSURUSDogNjAwcHggKHByZXZlbnRzIGNydXNoaW5nIHRhY3RpYyBjb2x1bW5zKVxyXG4gKiAtIE1JTl9IRUlHSFQ6IDQwMHB4IChwcmV2ZW50cyBoaWRpbmcgaGVhZGVyL2NvbnRyb2xzKVxyXG4gKiAtIE1BWDogOTUlIG9mIHZpZXdwb3J0IChwcmV2ZW50cyBvdmVyZmxvdylcclxuICovXHJcblxyXG5pbXBvcnQgeyBERUJVRyB9IGZyb20gJy4uL2RlYnVnJztcclxuXHJcbi8qKlxyXG4gKiBBZGQgZHJhZyBoYW5kbGVzIGFuZCByZXNpemUgZnVuY3Rpb25hbGl0eSB0byBhIG1vZGFsIGVsZW1lbnQuXHJcbiAqXHJcbiAqIEBwYXJhbSBtb2RhbCAtIFRoZSBtb2RhbCBET00gZWxlbWVudCB0byBtYWtlIHJlc2l6YWJsZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VSZXNpemFibGUobW9kYWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tNaXRyZVJlc2l6YWJsZV0gQXR0YWNoaW5nIHJlc2l6ZSBoYW5kbGVzJyk7XHJcblxyXG4gICAgY29uc3QgTUlOX1dJRFRIID0gNjAwOyAgIC8vIE5hcnJvd2VyIHdvdWxkIGNydXNoIHRhY3RpYyBjb2x1bW5zXHJcbiAgICBjb25zdCBNSU5fSEVJR0hUID0gNDAwOyAgLy8gU2hvcnRlciB3b3VsZCBoaWRlIGhlYWRlci9jb250cm9sc1xyXG4gICAgY29uc3QgTUFYX1dJRFRIID0gd2luZG93LmlubmVyV2lkdGggKiAwLjk1OyAgIC8vIExlYXZlIDUlIHZpZXdwb3J0IG1hcmdpblxyXG4gICAgY29uc3QgTUFYX0hFSUdIVCA9IHdpbmRvdy5pbm5lckhlaWdodCAqIDAuOTU7XHJcblxyXG4gICAgLy8gUmVzaXplIGhhbmRsZSBwb3NpdGlvbnM6IFtjbGFzc05hbWUsIGN1cnNvciwgaXNDb3JuZXJdXHJcbiAgICAvLyBOPU5vcnRoLCBTPVNvdXRoLCBFPUVhc3QsIFc9V2VzdFxyXG4gICAgY29uc3QgaGFuZGxlczogQXJyYXk8W3N0cmluZywgc3RyaW5nLCBib29sZWFuXT4gPSBbXHJcbiAgICAgICAgWydyZXNpemUtaGFuZGxlLW4nLCAnbnMtcmVzaXplJywgZmFsc2VdLCAgICAvLyBUb3AgZWRnZVxyXG4gICAgICAgIFsncmVzaXplLWhhbmRsZS1zJywgJ25zLXJlc2l6ZScsIGZhbHNlXSwgICAgLy8gQm90dG9tIGVkZ2VcclxuICAgICAgICBbJ3Jlc2l6ZS1oYW5kbGUtZScsICdldy1yZXNpemUnLCBmYWxzZV0sICAgIC8vIFJpZ2h0IGVkZ2VcclxuICAgICAgICBbJ3Jlc2l6ZS1oYW5kbGUtdycsICdldy1yZXNpemUnLCBmYWxzZV0sICAgIC8vIExlZnQgZWRnZVxyXG4gICAgICAgIFsncmVzaXplLWhhbmRsZS1uZScsICduZXN3LXJlc2l6ZScsIHRydWVdLCAgLy8gVG9wLXJpZ2h0IGNvcm5lclxyXG4gICAgICAgIFsncmVzaXplLWhhbmRsZS1udycsICdud3NlLXJlc2l6ZScsIHRydWVdLCAgLy8gVG9wLWxlZnQgY29ybmVyXHJcbiAgICAgICAgWydyZXNpemUtaGFuZGxlLXNlJywgJ253c2UtcmVzaXplJywgdHJ1ZV0sICAvLyBCb3R0b20tcmlnaHQgY29ybmVyXHJcbiAgICAgICAgWydyZXNpemUtaGFuZGxlLXN3JywgJ25lc3ctcmVzaXplJywgdHJ1ZV0sICAvLyBCb3R0b20tbGVmdCBjb3JuZXJcclxuICAgIF07XHJcblxyXG4gICAgaGFuZGxlcy5mb3JFYWNoKChbY2xhc3NOYW1lLCBjdXJzb3IsIGlzQ29ybmVyXSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGhhbmRsZSA9IG1vZGFsLmNyZWF0ZURpdihgbWl0cmUtcmVzaXplLWhhbmRsZSAke2NsYXNzTmFtZX1gKTtcclxuICAgICAgICBoYW5kbGUuc3R5bGUuY3Vyc29yID0gY3Vyc29yO1xyXG5cclxuICAgICAgICBsZXQgc3RhcnRYID0gMCwgc3RhcnRZID0gMCwgc3RhcnRXaWR0aCA9IDAsIHN0YXJ0SGVpZ2h0ID0gMCwgc3RhcnRMZWZ0ID0gMCwgc3RhcnRUb3AgPSAwO1xyXG5cclxuICAgICAgICBjb25zdCBvbk1vdXNlRG93biA9IChlOiBNb3VzZUV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcbiAgICAgICAgICAgIHN0YXJ0WCA9IGUuY2xpZW50WDtcclxuICAgICAgICAgICAgc3RhcnRZID0gZS5jbGllbnRZO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcmVjdCA9IG1vZGFsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgICAgICBzdGFydFdpZHRoID0gcmVjdC53aWR0aDtcclxuICAgICAgICAgICAgc3RhcnRIZWlnaHQgPSByZWN0LmhlaWdodDtcclxuICAgICAgICAgICAgc3RhcnRMZWZ0ID0gcmVjdC5sZWZ0O1xyXG4gICAgICAgICAgICBzdGFydFRvcCA9IHJlY3QudG9wO1xyXG5cclxuICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgb25Nb3VzZU1vdmUpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgb25Nb3VzZVVwKTtcclxuXHJcbiAgICAgICAgICAgIG1vZGFsLmFkZENsYXNzKCdtaXRyZS1tb2RhbC1yZXNpemluZycpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGNvbnN0IG9uTW91c2VNb3ZlID0gKGU6IE1vdXNlRXZlbnQpID0+IHtcclxuICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIG1vdXNlIG1vdmVtZW50IHNpbmNlIGRyYWcgc3RhcnRlZFxyXG4gICAgICAgICAgICBjb25zdCBkZWx0YVggPSBlLmNsaWVudFggLSBzdGFydFg7ICAvLyBQb3NpdGl2ZSA9IG1vdmVkIHJpZ2h0XHJcbiAgICAgICAgICAgIGNvbnN0IGRlbHRhWSA9IGUuY2xpZW50WSAtIHN0YXJ0WTsgIC8vIFBvc2l0aXZlID0gbW92ZWQgZG93blxyXG5cclxuICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSBuZXcgZGltZW5zaW9ucyBmcm9tIHN0YXJ0aW5nIHZhbHVlc1xyXG4gICAgICAgICAgICBsZXQgbmV3V2lkdGggPSBzdGFydFdpZHRoO1xyXG4gICAgICAgICAgICBsZXQgbmV3SGVpZ2h0ID0gc3RhcnRIZWlnaHQ7XHJcbiAgICAgICAgICAgIGxldCBuZXdMZWZ0ID0gc3RhcnRMZWZ0O1xyXG4gICAgICAgICAgICBsZXQgbmV3VG9wID0gc3RhcnRUb3A7XHJcblxyXG4gICAgICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIG5ldyBkaW1lbnNpb25zIGJhc2VkIG9uIGhhbmRsZSBkaXJlY3Rpb25cclxuICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgICAgICAgICBpZiAoY2xhc3NOYW1lLmluY2x1ZGVzKCctZScpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBFYXN0IChyaWdodCBlZGdlKTogZHJhZyByaWdodCBpbmNyZWFzZXMgd2lkdGhcclxuICAgICAgICAgICAgICAgIG5ld1dpZHRoID0gTWF0aC5tYXgoTUlOX1dJRFRILCBNYXRoLm1pbihNQVhfV0lEVEgsIHN0YXJ0V2lkdGggKyBkZWx0YVgpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY2xhc3NOYW1lLmluY2x1ZGVzKCctdycpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBXZXN0IChsZWZ0IGVkZ2UpOiBkcmFnIGxlZnQgaW5jcmVhc2VzIHdpZHRoLCBzaGlmdHMgbW9kYWwgbGVmdFxyXG4gICAgICAgICAgICAgICAgbmV3V2lkdGggPSBNYXRoLm1heChNSU5fV0lEVEgsIE1hdGgubWluKE1BWF9XSURUSCwgc3RhcnRXaWR0aCAtIGRlbHRhWCkpO1xyXG4gICAgICAgICAgICAgICAgbmV3TGVmdCA9IHN0YXJ0TGVmdCArIChzdGFydFdpZHRoIC0gbmV3V2lkdGgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjbGFzc05hbWUuaW5jbHVkZXMoJy1zJykpIHtcclxuICAgICAgICAgICAgICAgIC8vIFNvdXRoIChib3R0b20gZWRnZSk6IGRyYWcgZG93biBpbmNyZWFzZXMgaGVpZ2h0XHJcbiAgICAgICAgICAgICAgICBuZXdIZWlnaHQgPSBNYXRoLm1heChNSU5fSEVJR0hULCBNYXRoLm1pbihNQVhfSEVJR0hULCBzdGFydEhlaWdodCArIGRlbHRhWSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjbGFzc05hbWUuaW5jbHVkZXMoJy1uJykpIHtcclxuICAgICAgICAgICAgICAgIC8vIE5vcnRoICh0b3AgZWRnZSk6IGRyYWcgdXAgaW5jcmVhc2VzIGhlaWdodCwgc2hpZnRzIG1vZGFsIHVwXHJcbiAgICAgICAgICAgICAgICBuZXdIZWlnaHQgPSBNYXRoLm1heChNSU5fSEVJR0hULCBNYXRoLm1pbihNQVhfSEVJR0hULCBzdGFydEhlaWdodCAtIGRlbHRhWSkpO1xyXG4gICAgICAgICAgICAgICAgbmV3VG9wID0gc3RhcnRUb3AgKyAoc3RhcnRIZWlnaHQgLSBuZXdIZWlnaHQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBBcHBseSBuZXcgZGltZW5zaW9ucyB3aXRoICFpbXBvcnRhbnQgdG8gb3ZlcnJpZGUgQ1NTXHJcbiAgICAgICAgICAgIG1vZGFsLnN0eWxlLnNldFByb3BlcnR5KCd3aWR0aCcsIGAke25ld1dpZHRofXB4YCwgJ2ltcG9ydGFudCcpO1xyXG4gICAgICAgICAgICBtb2RhbC5zdHlsZS5zZXRQcm9wZXJ0eSgnaGVpZ2h0JywgYCR7bmV3SGVpZ2h0fXB4YCwgJ2ltcG9ydGFudCcpO1xyXG4gICAgICAgICAgICBtb2RhbC5zdHlsZS5zZXRQcm9wZXJ0eSgnbWF4LXdpZHRoJywgYCR7bmV3V2lkdGh9cHhgLCAnaW1wb3J0YW50Jyk7XHJcbiAgICAgICAgICAgIG1vZGFsLnN0eWxlLnNldFByb3BlcnR5KCdtYXgtaGVpZ2h0JywgYCR7bmV3SGVpZ2h0fXB4YCwgJ2ltcG9ydGFudCcpO1xyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHBvc2l0aW9uIGlmIHJlc2l6aW5nIGZyb20gdG9wIG9yIGxlZnRcclxuICAgICAgICAgICAgaWYgKGNsYXNzTmFtZS5pbmNsdWRlcygnLXcnKSB8fCBjbGFzc05hbWUuaW5jbHVkZXMoJy1uJykpIHtcclxuICAgICAgICAgICAgICAgIG1vZGFsLnN0eWxlLmxlZnQgPSBgJHtuZXdMZWZ0fXB4YDtcclxuICAgICAgICAgICAgICAgIG1vZGFsLnN0eWxlLnRvcCA9IGAke25ld1RvcH1weGA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjb25zdCBvbk1vdXNlVXAgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIG9uTW91c2VNb3ZlKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIG9uTW91c2VVcCk7XHJcbiAgICAgICAgICAgIG1vZGFsLnJlbW92ZUNsYXNzKCdtaXRyZS1tb2RhbC1yZXNpemluZycpO1xyXG4gICAgICAgICAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tNaXRyZVJlc2l6YWJsZV0gUmVzaXplIGNvbXBsZXRlJyk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaGFuZGxlLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIG9uTW91c2VEb3duKTtcclxuICAgIH0pO1xyXG59XHJcbiIsICIvKipcclxuICogTWl0cmVTdGF0c0Jhci50cyAtIFN0YXRpc3RpY3MgYmFyIHJlbmRlcmluZyBmb3IgTUlUUkUgbW9kYWxcclxuICpcclxuICogUmVuZGVycyB0aGUgc3VtbWFyeSBzdGF0aXN0aWNzIGJhciBhdCB0aGUgdG9wIG9mIHRoZSBNSVRSRSBBVFQmQ0sgbW9kYWwsXHJcbiAqIHNob3dpbmcgY292ZXJhZ2UgcGVyY2VudGFnZSwgYWN0aXZlIHRhY3RpY3MsIElPQyBjYXJkIGNvdW50LCBhbmQgd2FybmluZ3NcclxuICogZm9yIGNhcmRzIHdpdGggbWlzc2luZyBNSVRSRSBmaWVsZHMgKHRhY3RpYyBvciB0ZWNobmlxdWUpLlxyXG4gKlxyXG4gKiBFeHRyYWN0ZWQgZnJvbSBSZW5kZXJNaXRyZU1vZGFsLnJlbmRlck1pdHJlTWFwcGluZygpIHRvIGtlZXAgdGhlIG1vZGFsXHJcbiAqIG9yY2hlc3RyYXRvciBmb2N1c2VkIG9uIGRhdGEgZmxvdyBhbmQgZGVsZWdhdGlvbi5cclxuICovXHJcbmltcG9ydCB7IE1pdHJlVGFjdGljLCBNaXNzaW5nRmllbGRzUmVzdWx0IH0gZnJvbSAnLi9NaXRyZVR5cGVzJztcclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBTdGF0cyBiYXIgcmVuZGVyaW5nXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLyoqXHJcbiAqIFJlbmRlcnMgdGhlIE1JVFJFIG1vZGFsIHN0YXRpc3RpY3MgYmFyIHdpdGggY292ZXJhZ2UsIHRhY3RpY3MsIElPQyBjb3VudCxcclxuICogYW5kIG1pc3NpbmcgZmllbGQgd2FybmluZ3MuXHJcbiAqXHJcbiAqIFN0YXRzIGRpc3BsYXllZDpcclxuICogICAtIENvdmVyYWdlOiBmb3VuZC90b3RhbCB0ZWNobmlxdWVzIHdpdGggcGVyY2VudGFnZVxyXG4gKiAgIC0gQWN0aXZlIHRhY3RpY3M6IGhvdyBtYW55IHRhY3RpY3MgaGF2ZSBhdCBsZWFzdCBvbmUgZm91bmQgdGVjaG5pcXVlXHJcbiAqICAgLSBJT0MgY2FyZCBjb3VudDogdG90YWwgY2FyZHMgZXh0cmFjdGVkIGZyb20gY2FudmFzXHJcbiAqICAgLSBNaXNzaW5nIHRhY3RpYyB3YXJuaW5nOiBjYXJkcyB3aXRoIHRhY3RpYyBmaWVsZCBlbXB0eSAod2l0aCB0b29sdGlwKVxyXG4gKiAgIC0gTWlzc2luZyB0ZWNobmlxdWUgd2FybmluZzogY2FyZHMgd2l0aCB0ZWNobmlxdWUgZmllbGQgZW1wdHkgKHdpdGggdG9vbHRpcClcclxuICpcclxuICogQHBhcmFtIHN0YXRzQ29udGFpbmVyIC0gVGhlIERPTSBlbGVtZW50IHRvIHJlbmRlciBzdGF0cyBpbnRvXHJcbiAqIEBwYXJhbSB0YWN0aWNzIC0gQXJyYXkgb2YgdGFjdGljIGNvbHVtbnMgZnJvbSBhZ2dyZWdhdGlvbiByZXN1bHRcclxuICogQHBhcmFtIGlvY0NvdW50IC0gVG90YWwgbnVtYmVyIG9mIElPQyBjYXJkcyBvbiB0aGUgY2FudmFzXHJcbiAqIEBwYXJhbSBtaXNzaW5nRmllbGRzIC0gQ2FyZHMgd2l0aCBtaXNzaW5nIHRhY3RpYy90ZWNobmlxdWUgZmllbGRzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyU3RhdHNCYXIoXHJcbiAgICBzdGF0c0NvbnRhaW5lcjogSFRNTEVsZW1lbnQsXHJcbiAgICB0YWN0aWNzOiBNaXRyZVRhY3RpY1tdLFxyXG4gICAgaW9jQ291bnQ6IG51bWJlcixcclxuICAgIG1pc3NpbmdGaWVsZHM6IE1pc3NpbmdGaWVsZHNSZXN1bHRcclxuKTogdm9pZCB7XHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIENvdmVyYWdlIHBlcmNlbnRhZ2UgY2FsY3VsYXRpb25cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIGNvbnN0IHRvdGFsVGVjaG5pcXVlcyA9IHRhY3RpY3MucmVkdWNlKChzdW0sIHQpID0+IHN1bSArIHQudGVjaG5pcXVlcy5sZW5ndGgsIDApO1xyXG4gICAgY29uc3QgZm91bmRUZWNobmlxdWVzID0gdGFjdGljcy5yZWR1Y2UoXHJcbiAgICAgICAgKHN1bSwgdCkgPT4gc3VtICsgdC50ZWNobmlxdWVzLmZpbHRlcih0ZWNoID0+IHRlY2guaXNGb3VuZCkubGVuZ3RoLFxyXG4gICAgICAgIDBcclxuICAgICk7XHJcbiAgICBjb25zdCBjb3ZlcmFnZVBlcmNlbnQgPSB0b3RhbFRlY2huaXF1ZXMgPiAwXHJcbiAgICAgICAgPyBNYXRoLnJvdW5kKChmb3VuZFRlY2huaXF1ZXMgLyB0b3RhbFRlY2huaXF1ZXMpICogMTAwKVxyXG4gICAgICAgIDogMDtcclxuXHJcbiAgICAvLyBDb3ZlcmFnZSBzdGF0XHJcbiAgICBzdGF0c0NvbnRhaW5lci5jcmVhdGVFbCgnZGl2Jywge1xyXG4gICAgICAgIHRleHQ6IGBcdUQ4M0RcdURDQ0EgQ292ZXJhZ2U6ICR7Zm91bmRUZWNobmlxdWVzfS8ke3RvdGFsVGVjaG5pcXVlc30gdGVjaG5pcXVlcyAoJHtjb3ZlcmFnZVBlcmNlbnR9JSlgLFxyXG4gICAgICAgIGNsczogJ21pdHJlLXN0YXQtaXRlbSdcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gQWN0aXZlIHRhY3RpY3MgY291bnRcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIGNvbnN0IGFjdGl2ZVRhY3RpY3MgPSB0YWN0aWNzLmZpbHRlcih0ID0+IHQudGVjaG5pcXVlcy5zb21lKHRlY2ggPT4gdGVjaC5pc0ZvdW5kKSkubGVuZ3RoO1xyXG4gICAgc3RhdHNDb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHtcclxuICAgICAgICB0ZXh0OiBgXHUyNjk0XHVGRTBGIFRhY3RpY3M6ICR7YWN0aXZlVGFjdGljc30vJHt0YWN0aWNzLmxlbmd0aH0gYWN0aXZlYCxcclxuICAgICAgICBjbHM6ICdtaXRyZS1zdGF0LWl0ZW0nXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIElPQyBjYXJkIGNvdW50XHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBzdGF0c0NvbnRhaW5lci5jcmVhdGVFbCgnZGl2Jywge1xyXG4gICAgICAgIHRleHQ6IGBcdUQ4M0RcdURDQzcgSU9DIENhcmRzOiAke2lvY0NvdW50fSB0b3RhbGAsXHJcbiAgICAgICAgY2xzOiAnbWl0cmUtc3RhdC1pdGVtJ1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBNaXNzaW5nIHRhY3RpYyB3YXJuaW5nICh3aXRoIGhvdmVyIHRvb2x0aXAgc2hvd2luZyBjYXJkIGRldGFpbHMpXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBjb25zdCBtaXNzaW5nVGFjdGljQ291bnQgPSBtaXNzaW5nRmllbGRzLm1pc3NpbmdUYWN0aWMubGVuZ3RoO1xyXG4gICAgaWYgKG1pc3NpbmdUYWN0aWNDb3VudCA+IDApIHtcclxuICAgICAgICBjb25zdCBtaXNzaW5nVGFjdGljRWwgPSBzdGF0c0NvbnRhaW5lci5jcmVhdGVFbCgnZGl2Jywge1xyXG4gICAgICAgICAgICB0ZXh0OiBgXHUyNkEwXHVGRTBGIE1pc3NpbmcgVGFjdGljOiAke21pc3NpbmdUYWN0aWNDb3VudH0gY2FyZCR7bWlzc2luZ1RhY3RpY0NvdW50ID09PSAxID8gJycgOiAncyd9YCxcclxuICAgICAgICAgICAgY2xzOiAnbWl0cmUtc3RhdC1pdGVtIG1pdHJlLXN0YXQtd2FybmluZydcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gSG92ZXIgdG9vbHRpcCB3aXRoIGNhcmQgZGV0YWlsc1xyXG4gICAgICAgIGNvbnN0IHRvb2x0aXBUZXh0ID0gbWlzc2luZ0ZpZWxkcy5taXNzaW5nVGFjdGljXHJcbiAgICAgICAgICAgIC5tYXAoaW5mbyA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtaXNzaW5nID0gaW5mby5taXNzaW5nID09PSAnYm90aCcgPyAndGFjdGljLCB0ZWNobmlxdWUnIDogJ3RhY3RpYyc7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYCR7aW5mby5pb2NUeXBlfSAke2luZm8uY2FyZElkfSAobWlzc2luZzogJHttaXNzaW5nfSlgO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuam9pbignXFxuJyk7XHJcblxyXG4gICAgICAgIG1pc3NpbmdUYWN0aWNFbC5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgdG9vbHRpcFRleHQpO1xyXG4gICAgICAgIG1pc3NpbmdUYWN0aWNFbC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBgJHttaXNzaW5nVGFjdGljQ291bnR9IGNhcmRzIG1pc3NpbmcgdGFjdGljIGZpZWxkYCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBNaXNzaW5nIHRlY2huaXF1ZSB3YXJuaW5nICh3aXRoIGhvdmVyIHRvb2x0aXAgc2hvd2luZyBjYXJkIGRldGFpbHMpXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBjb25zdCBtaXNzaW5nVGVjaG5pcXVlQ291bnQgPSBtaXNzaW5nRmllbGRzLm1pc3NpbmdUZWNobmlxdWUubGVuZ3RoO1xyXG4gICAgaWYgKG1pc3NpbmdUZWNobmlxdWVDb3VudCA+IDApIHtcclxuICAgICAgICBjb25zdCBtaXNzaW5nVGVjaG5pcXVlRWwgPSBzdGF0c0NvbnRhaW5lci5jcmVhdGVFbCgnZGl2Jywge1xyXG4gICAgICAgICAgICB0ZXh0OiBgXHUyNkEwXHVGRTBGIE1pc3NpbmcgVGVjaG5pcXVlOiAke21pc3NpbmdUZWNobmlxdWVDb3VudH0gY2FyZCR7bWlzc2luZ1RlY2huaXF1ZUNvdW50ID09PSAxID8gJycgOiAncyd9YCxcclxuICAgICAgICAgICAgY2xzOiAnbWl0cmUtc3RhdC1pdGVtIG1pdHJlLXN0YXQtd2FybmluZydcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gSG92ZXIgdG9vbHRpcCB3aXRoIGNhcmQgZGV0YWlsc1xyXG4gICAgICAgIGNvbnN0IHRvb2x0aXBUZXh0ID0gbWlzc2luZ0ZpZWxkcy5taXNzaW5nVGVjaG5pcXVlXHJcbiAgICAgICAgICAgIC5tYXAoaW5mbyA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtaXNzaW5nID0gaW5mby5taXNzaW5nID09PSAnYm90aCcgPyAndGFjdGljLCB0ZWNobmlxdWUnIDogJ3RlY2huaXF1ZSc7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYCR7aW5mby5pb2NUeXBlfSAke2luZm8uY2FyZElkfSAobWlzc2luZzogJHttaXNzaW5nfSlgO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuam9pbignXFxuJyk7XHJcblxyXG4gICAgICAgIG1pc3NpbmdUZWNobmlxdWVFbC5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgdG9vbHRpcFRleHQpO1xyXG4gICAgICAgIG1pc3NpbmdUZWNobmlxdWVFbC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBgJHttaXNzaW5nVGVjaG5pcXVlQ291bnR9IGNhcmRzIG1pc3NpbmcgdGVjaG5pcXVlIGZpZWxkYCk7XHJcbiAgICB9XHJcbn1cclxuIiwgIi8qKlxyXG4gKiBNaXRyZVRleHRVdGlscy50cyAtIERlc2NyaXB0aW9uIHRleHQgY2xlYW5pbmcgYW5kIHRydW5jYXRpb25cclxuICpcclxuICogVXRpbGl0eSBmdW5jdGlvbnMgZm9yIHByb2Nlc3NpbmcgTUlUUkUgdGVjaG5pcXVlIGRlc2NyaXB0aW9ucy5cclxuICogUmVtb3ZlcyBtYXJrZG93biBmb3JtYXR0aW5nIGFydGlmYWN0cyBhbmQgdHJ1bmNhdGVzIGxvbmcgdGV4dFxyXG4gKiBmb3IgY29tcGFjdCBkaXNwbGF5IGluIHRoZSBtYXRyaXggdmlldy5cclxuICovXHJcblxyXG4vKipcclxuICogQ2xlYW4gTUlUUkUgZGVzY3JpcHRpb24gdGV4dCBieSByZW1vdmluZyBtYXJrZG93biBsaW5rcyBhbmQgc3F1YXJlIGJyYWNrZXRzLlxyXG4gKlxyXG4gKiBSZW1vdmVzIHR3byB0eXBlcyBvZiBtYXJrZG93biBhcnRpZmFjdHM6XHJcbiAqIDEuIEZ1bGwgbWFya2Rvd24gbGlua3M6IFt0ZXh0XSh1cmwpIFx1MjE5MiByZW1vdmVkIGVudGlyZWx5XHJcbiAqIDIuIFNxdWFyZSBicmFja2V0IHJlZmVyZW5jZXM6IFthbnl0aGluZ10gXHUyMTkyIHJlbW92ZWQgZW50aXJlbHlcclxuICpcclxuICogQHBhcmFtIGRlc2NyaXB0aW9uIC0gUmF3IGRlc2NyaXB0aW9uIGZyb20gTUlUUkUgZGF0YXNldFxyXG4gKiBAcmV0dXJucyBDbGVhbmVkIGRlc2NyaXB0aW9uIHRleHQgd2l0aCBub3JtYWxpemVkIHdoaXRlc3BhY2VcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjbGVhbkRlc2NyaXB0aW9uKGRlc2NyaXB0aW9uOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgaWYgKCFkZXNjcmlwdGlvbikgcmV0dXJuICcnO1xyXG5cclxuICAgIGxldCBjbGVhbmVkID0gZGVzY3JpcHRpb247XHJcblxyXG4gICAgLy8gUmVtb3ZlIG1hcmtkb3duIGxpbmtzIFt0ZXh0XSh1cmwpIC0gcmVtb3ZlIGVudGlyZWx5XHJcbiAgICBjbGVhbmVkID0gY2xlYW5lZC5yZXBsYWNlKC9cXFsoW15cXF1dKylcXF1cXChbXildK1xcKS9nLCAnJyk7XHJcblxyXG4gICAgLy8gUmVtb3ZlIGFsbCBzcXVhcmUgYnJhY2tldHMgYW5kIHRoZWlyIGNvbnRlbnQgW2FueXRoaW5nXVxyXG4gICAgY2xlYW5lZCA9IGNsZWFuZWQucmVwbGFjZSgvXFxbW15cXF1dKlxcXS9nLCAnJyk7XHJcblxyXG4gICAgLy8gQ2xlYW4gdXAgbXVsdGlwbGUgc3BhY2VzIGFuZCB0cmltXHJcbiAgICBjbGVhbmVkID0gY2xlYW5lZC5yZXBsYWNlKC9cXHMrL2csICcgJykudHJpbSgpO1xyXG5cclxuICAgIHJldHVybiBjbGVhbmVkO1xyXG59XHJcblxyXG4vKipcclxuICogVHJ1bmNhdGUgZGVzY3JpcHRpb24gdG8gbWF4aW11bSBjaGFyYWN0ZXIgbGVuZ3RoIHdpdGggZWxsaXBzaXMuXHJcbiAqIFRydW5jYXRlcyBhdCB3b3JkIGJvdW5kYXJ5IHRvIGF2b2lkIGN1dHRpbmcgd29yZHMgbWlkLXdheS5cclxuICpcclxuICogQHBhcmFtIGRlc2NyaXB0aW9uIC0gQ2xlYW5lZCBkZXNjcmlwdGlvbiB0ZXh0XHJcbiAqIEBwYXJhbSBtYXhDaGFycyAtIE1heGltdW0gY2hhcmFjdGVycyAoZGVmYXVsdDogMTgwKVxyXG4gKiBAcmV0dXJucyBUcnVuY2F0ZWQgZGVzY3JpcHRpb24gd2l0aCBcIi4uLlwiIGlmIG5lZWRlZFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHRydW5jYXRlRGVzY3JpcHRpb24oZGVzY3JpcHRpb246IHN0cmluZywgbWF4Q2hhcnM6IG51bWJlciA9IDE4MCk6IHN0cmluZyB7XHJcbiAgICBpZiAoIWRlc2NyaXB0aW9uIHx8IGRlc2NyaXB0aW9uLmxlbmd0aCA8PSBtYXhDaGFycykge1xyXG4gICAgICAgIHJldHVybiBkZXNjcmlwdGlvbjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBUcnVuY2F0ZSBhdCBsYXN0IHNwYWNlIGJlZm9yZSBtYXhDaGFycyB0byBhdm9pZCBjdXR0aW5nIHdvcmRzXHJcbiAgICBjb25zdCB0cnVuY2F0ZWQgPSBkZXNjcmlwdGlvbi5zdWJzdHJpbmcoMCwgbWF4Q2hhcnMpO1xyXG4gICAgY29uc3QgbGFzdFNwYWNlID0gdHJ1bmNhdGVkLmxhc3RJbmRleE9mKCcgJyk7XHJcblxyXG4gICAgaWYgKGxhc3RTcGFjZSA+IDApIHtcclxuICAgICAgICByZXR1cm4gdHJ1bmNhdGVkLnN1YnN0cmluZygwLCBsYXN0U3BhY2UpICsgJy4uLic7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRydW5jYXRlZCArICcuLi4nO1xyXG59XHJcbiIsICIvKipcclxuICogTWl0cmVTZWFyY2gudHMgLSBTZWFyY2ggcXVlcnkgcGFyc2luZywgbWF0Y2hpbmcsIGFuZCBoaWdobGlnaHQgcmVuZGVyaW5nXHJcbiAqXHJcbiAqIEhhbmRsZXMgdGhlIHNlYXJjaCBmdW5jdGlvbmFsaXR5IGluIHRoZSBNSVRSRSBtb2RhbC4gU3VwcG9ydHMgYm90aFxyXG4gKiBrZXl3b3JkLWJhc2VkIHNlYXJjaCBhbmQgcXVvdGVkIHBocmFzZSBtYXRjaGluZy4gUHJvdmlkZXMgRE9NIHRleHRcclxuICogaGlnaGxpZ2h0aW5nIGZvciB2aXN1YWwgZmVlZGJhY2sgb24gbWF0Y2hlZCB0ZXJtcy5cclxuICovXHJcblxyXG5pbXBvcnQgeyBTZWFyY2hTdGF0ZSwgU2VhcmNoTWF0Y2gsIE1pdHJlVGVjaG5pcXVlIH0gZnJvbSAnLi9NaXRyZVR5cGVzJztcclxuaW1wb3J0IHsgREVCVUcgfSBmcm9tICcuLi9kZWJ1Zyc7XHJcblxyXG4vKipcclxuICogUGFyc2Ugc2VhcmNoIHF1ZXJ5IGludG8ga2V5d29yZHMgYW5kIHBocmFzZXMuXHJcbiAqXHJcbiAqIFN1cHBvcnRzIHR3byB0eXBlcyBvZiBzZWFyY2ggdGVybXM6XHJcbiAqIDEuICoqS2V5d29yZHMqKjogU3BhY2Utc2VwYXJhdGVkIHdvcmRzIChlLmcuLCBcInNwZWFyIHBoaXNoaW5nXCIgLT4gW1wic3BlYXJcIiwgXCJwaGlzaGluZ1wiXSlcclxuICogMi4gKipQaHJhc2VzKio6IFF1b3RlZCBzdHJpbmdzIChlLmcuLCAnXCJzcGVhciBwaGlzaGluZ1wiJyAtPiBbXCJzcGVhciBwaGlzaGluZ1wiXSlcclxuICpcclxuICogKipBbGdvcml0aG06KipcclxuICogMS4gQ2hlY2sgZm9yIHVubWF0Y2hlZCBxdW90ZXMgYW5kIHJlbW92ZSB0aGUgbGFzdCBvbmVcclxuICogMi4gRXh0cmFjdCBhbGwgcXVvdGVkIHBocmFzZXMgdXNpbmcgcmVnZXg6IC9cIihbXlwiXSspXCIvZ1xyXG4gKiAzLiBSZW1vdmUgcGhyYXNlcyBmcm9tIHF1ZXJ5IGFuZCBzcGxpdCByZW1haW5pbmcgdGV4dCBpbnRvIGtleXdvcmRzXHJcbiAqIDQuIE5vcm1hbGl6ZSBhbGwgdGVybXMgdG8gbG93ZXJjYXNlIGZvciBjYXNlLWluc2Vuc2l0aXZlIG1hdGNoaW5nXHJcbiAqXHJcbiAqIEBwYXJhbSBxdWVyeSAtIFJhdyBzZWFyY2ggcXVlcnkgc3RyaW5nXHJcbiAqIEByZXR1cm5zIFNlYXJjaFN0YXRlIG9iamVjdCB3aXRoIHBhcnNlZCBrZXl3b3JkcyBhbmQgcGhyYXNlc1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlU2VhcmNoUXVlcnkocXVlcnk6IHN0cmluZyk6IFNlYXJjaFN0YXRlIHtcclxuICAgIGlmICghcXVlcnkgfHwgIXF1ZXJ5LnRyaW0oKSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHF1ZXJ5OiAnJyxcclxuICAgICAgICAgICAga2V5d29yZHM6IFtdLFxyXG4gICAgICAgICAgICBwaHJhc2VzOiBbXSxcclxuICAgICAgICAgICAgaXNBY3RpdmU6IGZhbHNlXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB0cmltbWVkUXVlcnkgPSBxdWVyeS50cmltKCk7XHJcblxyXG4gICAgLy8gSGFuZGxlIHVubWF0Y2hlZCBxdW90ZXMgKG9kZCBudW1iZXIgb2YgcXVvdGVzKVxyXG4gICAgY29uc3QgcXVvdGVDb3VudCA9ICh0cmltbWVkUXVlcnkubWF0Y2goL1wiL2cpIHx8IFtdKS5sZW5ndGg7XHJcbiAgICBsZXQgcHJvY2Vzc2VkUXVlcnkgPSB0cmltbWVkUXVlcnk7XHJcbiAgICBpZiAocXVvdGVDb3VudCAlIDIgIT09IDApIHtcclxuICAgICAgICBjb25zdCBsYXN0UXVvdGVJbmRleCA9IHByb2Nlc3NlZFF1ZXJ5Lmxhc3RJbmRleE9mKCdcIicpO1xyXG4gICAgICAgIHByb2Nlc3NlZFF1ZXJ5ID0gcHJvY2Vzc2VkUXVlcnkuc3Vic3RyaW5nKDAsIGxhc3RRdW90ZUluZGV4KSArIHByb2Nlc3NlZFF1ZXJ5LnN1YnN0cmluZyhsYXN0UXVvdGVJbmRleCArIDEpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEV4dHJhY3QgcXVvdGVkIHBocmFzZXMgdXNpbmcgcmVnZXhcclxuICAgIGNvbnN0IHBocmFzZXM6IHN0cmluZ1tdID0gW107XHJcbiAgICBjb25zdCBwaHJhc2VSZWdleCA9IC9cIihbXlwiXSspXCIvZztcclxuICAgIGxldCBtYXRjaDtcclxuICAgIHdoaWxlICgobWF0Y2ggPSBwaHJhc2VSZWdleC5leGVjKHByb2Nlc3NlZFF1ZXJ5KSkgIT09IG51bGwpIHtcclxuICAgICAgICBwaHJhc2VzLnB1c2gobWF0Y2hbMV0udG9Mb3dlckNhc2UoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmVtb3ZlIHF1b3RlZCBwaHJhc2VzIGZyb20gcXVlcnkgYW5kIHNwbGl0IHJlbWFpbmluZyBpbnRvIGtleXdvcmRzXHJcbiAgICBjb25zdCByZW1haW5pbmdRdWVyeSA9IHByb2Nlc3NlZFF1ZXJ5LnJlcGxhY2UoL1wiW15cIl0rXCIvZywgJyAnKTtcclxuICAgIGNvbnN0IGtleXdvcmRzID0gcmVtYWluaW5nUXVlcnlcclxuICAgICAgICAuc3BsaXQoL1xccysvKVxyXG4gICAgICAgIC5tYXAoayA9PiBrLnRyaW0oKS50b0xvd2VyQ2FzZSgpKVxyXG4gICAgICAgIC5maWx0ZXIoayA9PiBrLmxlbmd0aCA+IDApO1xyXG5cclxuICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW01pdHJlU2VhcmNoXSBQYXJzZWQgcXVlcnk6JywgeyBxdWVyeTogdHJpbW1lZFF1ZXJ5LCBrZXl3b3JkcywgcGhyYXNlcyB9KTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHF1ZXJ5OiB0cmltbWVkUXVlcnksXHJcbiAgICAgICAga2V5d29yZHMsXHJcbiAgICAgICAgcGhyYXNlcyxcclxuICAgICAgICBpc0FjdGl2ZToga2V5d29yZHMubGVuZ3RoID4gMCB8fCBwaHJhc2VzLmxlbmd0aCA+IDBcclxuICAgIH07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDaGVjayBpZiB0ZXh0IG1hdGNoZXMgYWxsIGtleXdvcmRzIGFuZCBwaHJhc2VzIGluIHNlYXJjaCBzdGF0ZS5cclxuICpcclxuICogQHBhcmFtIHRleHQgLSBUZXh0IHRvIGNoZWNrXHJcbiAqIEBwYXJhbSBzZWFyY2hTdGF0ZSAtIFBhcnNlZCBzZWFyY2ggc3RhdGVcclxuICogQHJldHVybnMgVHJ1ZSBpZiB0ZXh0IG1hdGNoZXMgYWxsIHNlYXJjaCB0ZXJtc1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHRleHRNYXRjaGVzUXVlcnkodGV4dDogc3RyaW5nLCBzZWFyY2hTdGF0ZTogU2VhcmNoU3RhdGUpOiBib29sZWFuIHtcclxuICAgIGlmICghc2VhcmNoU3RhdGUuaXNBY3RpdmUpIHJldHVybiB0cnVlO1xyXG5cclxuICAgIGNvbnN0IGxvd2VyVGV4dCA9IHRleHQudG9Mb3dlckNhc2UoKTtcclxuXHJcbiAgICAvLyBDaGVjayBhbGwga2V5d29yZHMgYXJlIHByZXNlbnRcclxuICAgIGNvbnN0IGFsbEtleXdvcmRzTWF0Y2ggPSBzZWFyY2hTdGF0ZS5rZXl3b3Jkcy5ldmVyeShrZXl3b3JkID0+XHJcbiAgICAgICAgbG93ZXJUZXh0LmluY2x1ZGVzKGtleXdvcmQpXHJcbiAgICApO1xyXG5cclxuICAgIC8vIENoZWNrIGFsbCBwaHJhc2VzIGFyZSBwcmVzZW50XHJcbiAgICBjb25zdCBhbGxQaHJhc2VzTWF0Y2ggPSBzZWFyY2hTdGF0ZS5waHJhc2VzLmV2ZXJ5KHBocmFzZSA9PlxyXG4gICAgICAgIGxvd2VyVGV4dC5pbmNsdWRlcyhwaHJhc2UpXHJcbiAgICApO1xyXG5cclxuICAgIHJldHVybiBhbGxLZXl3b3Jkc01hdGNoICYmIGFsbFBocmFzZXNNYXRjaDtcclxufVxyXG5cclxuLyoqXHJcbiAqIENoZWNrIGlmIGEgdGVjaG5pcXVlIG1hdGNoZXMgdGhlIHNlYXJjaCBxdWVyeS5cclxuICpcclxuICogKipTZWFyY2ggSGllcmFyY2h5IChjaGVja2VkIGluIG9yZGVyKToqKlxyXG4gKiAxLiAqKlRlY2huaXF1ZSBJRCoqIChlLmcuLCBcIlQxNTY2XCIpIC0gaGlnaGVzdCBwcmlvcml0eSwgZXhhY3QgbWF0Y2hcclxuICogMi4gKipUZWNobmlxdWUgTmFtZSoqIChlLmcuLCBcIlBoaXNoaW5nXCIpIC0gY29tbW9uIHVzZSBjYXNlXHJcbiAqIDMuICoqVGVjaG5pcXVlIERlc2NyaXB0aW9uKiogLSBmaW5kcyB0ZWNobmlxdWVzIGJ5IGJlaGF2aW9yIGRlc2NyaXB0aW9uXHJcbiAqIDQuICoqU3VidGVjaG5pcXVlcyoqIC0gaWYgY2hpbGQgbWF0Y2hlcywgc2hvdyB0aGUgcGFyZW50IGZvciBjb250ZXh0XHJcbiAqXHJcbiAqIFJldHVybnMgYXMgc29vbiBhcyBhIG1hdGNoIGlzIGZvdW5kIChzaG9ydC1jaXJjdWl0cykuXHJcbiAqXHJcbiAqIEBwYXJhbSB0ZWNobmlxdWUgLSBUZWNobmlxdWUgdG8gY2hlY2tcclxuICogQHBhcmFtIHNlYXJjaFN0YXRlIC0gUGFyc2VkIHNlYXJjaCBzdGF0ZSB3aXRoIGtleXdvcmRzL3BocmFzZXNcclxuICogQHBhcmFtIHN1YnRlY2huaXF1ZXNNYXAgLSBNYXAgb2YgcGFyZW50IHRlY2huaXF1ZSBJRHMgdG8gdGhlaXIgc3VidGVjaG5pcXVlc1xyXG4gKiBAcmV0dXJucyBTZWFyY2hNYXRjaCByZXN1bHQgd2l0aCBtYXRjaCBkZXRhaWxzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gbWF0Y2hlc1NlYXJjaChcclxuICAgIHRlY2huaXF1ZTogTWl0cmVUZWNobmlxdWUsXHJcbiAgICBzZWFyY2hTdGF0ZTogU2VhcmNoU3RhdGUsXHJcbiAgICBzdWJ0ZWNobmlxdWVzTWFwOiBNYXA8c3RyaW5nLCBNaXRyZVRlY2huaXF1ZVtdPlxyXG4pOiBTZWFyY2hNYXRjaCB7XHJcbiAgICBpZiAoIXNlYXJjaFN0YXRlLmlzQWN0aXZlKSB7XHJcbiAgICAgICAgcmV0dXJuIHsgbWF0Y2hlZDogdHJ1ZSB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIDEuIENoZWNrIHRlY2huaXF1ZSBJRFxyXG4gICAgaWYgKHRleHRNYXRjaGVzUXVlcnkodGVjaG5pcXVlLmlkLCBzZWFyY2hTdGF0ZSkpIHtcclxuICAgICAgICByZXR1cm4geyBtYXRjaGVkOiB0cnVlLCBtYXRjaFR5cGU6ICdpZCcsIG1hdGNoVGV4dDogdGVjaG5pcXVlLmlkIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gMi4gQ2hlY2sgdGVjaG5pcXVlIG5hbWVcclxuICAgIGlmICh0ZXh0TWF0Y2hlc1F1ZXJ5KHRlY2huaXF1ZS5uYW1lLCBzZWFyY2hTdGF0ZSkpIHtcclxuICAgICAgICByZXR1cm4geyBtYXRjaGVkOiB0cnVlLCBtYXRjaFR5cGU6ICduYW1lJywgbWF0Y2hUZXh0OiB0ZWNobmlxdWUubmFtZSB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIDMuIENoZWNrIHRlY2huaXF1ZSBkZXNjcmlwdGlvblxyXG4gICAgaWYgKHRlY2huaXF1ZS5kZXNjcmlwdGlvbiAmJiB0ZXh0TWF0Y2hlc1F1ZXJ5KHRlY2huaXF1ZS5kZXNjcmlwdGlvbiwgc2VhcmNoU3RhdGUpKSB7XHJcbiAgICAgICAgcmV0dXJuIHsgbWF0Y2hlZDogdHJ1ZSwgbWF0Y2hUeXBlOiAnZGVzY3JpcHRpb24nLCBtYXRjaFRleHQ6IHRlY2huaXF1ZS5kZXNjcmlwdGlvbiB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIDQuIENoZWNrIHN1YnRlY2huaXF1ZXMgKGlmIGNoaWxkIG1hdGNoZXMsIHNob3cgcGFyZW50IGZvciBjb250ZXh0KVxyXG4gICAgY29uc3Qgc3VidGVjaG5pcXVlcyA9IHN1YnRlY2huaXF1ZXNNYXAuZ2V0KHRlY2huaXF1ZS5pZCkgfHwgW107XHJcbiAgICBmb3IgKGNvbnN0IHN1YnRlY2ggb2Ygc3VidGVjaG5pcXVlcykge1xyXG4gICAgICAgIGlmICh0ZXh0TWF0Y2hlc1F1ZXJ5KHN1YnRlY2guaWQsIHNlYXJjaFN0YXRlKSB8fFxyXG4gICAgICAgICAgICB0ZXh0TWF0Y2hlc1F1ZXJ5KHN1YnRlY2gubmFtZSwgc2VhcmNoU3RhdGUpIHx8XHJcbiAgICAgICAgICAgIChzdWJ0ZWNoLmRlc2NyaXB0aW9uICYmIHRleHRNYXRjaGVzUXVlcnkoc3VidGVjaC5kZXNjcmlwdGlvbiwgc2VhcmNoU3RhdGUpKSkge1xyXG4gICAgICAgICAgICByZXR1cm4geyBtYXRjaGVkOiB0cnVlLCBtYXRjaFR5cGU6ICdzdWJ0ZWNobmlxdWUnLCBtYXRjaFRleHQ6IHN1YnRlY2gubmFtZSB9O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBtYXRjaGVkOiBmYWxzZSB9O1xyXG59XHJcblxyXG4vKipcclxuICogRXNjYXBlIEhUTUwgc3BlY2lhbCBjaGFyYWN0ZXJzIHRvIHByZXZlbnQgWFNTIGluamVjdGlvbi5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBlc2NhcGVIdG1sKHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGRpdi50ZXh0Q29udGVudCA9IHRleHQ7XHJcbiAgICByZXR1cm4gZGl2LmlubmVySFRNTDtcclxufVxyXG5cclxuLyoqXHJcbiAqIEVzY2FwZSBzcGVjaWFsIHJlZ2V4IG1ldGFjaGFyYWN0ZXJzLlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGVzY2FwZVJlZ2V4KHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gdGV4dC5yZXBsYWNlKC9bLiorP14ke30oKXxbXFxdXFxcXF0vZywgJ1xcXFwkJicpO1xyXG59XHJcblxyXG4vKipcclxuICogSGlnaGxpZ2h0IHNlYXJjaCBtYXRjaGVzIGluIGEgRE9NIHRleHQgZWxlbWVudC5cclxuICpcclxuICogUmVwbGFjZXMgbWF0Y2hpbmcgdGV4dCBzZWdtZW50cyB3aXRoIDxtYXJrPiBlbGVtZW50cy5cclxuICogUGhyYXNlcyBhcmUgaGlnaGxpZ2h0ZWQgZmlyc3QgKGxvbmdlciBtYXRjaGVzKSwgdGhlbiBrZXl3b3Jkcy5cclxuICogVXNlcyBuZWdhdGl2ZSBsb29rYWhlYWQgdG8gYXZvaWQgZG91YmxlLXdyYXBwaW5nIGluc2lkZSBleGlzdGluZyBtYXJrcy5cclxuICpcclxuICogQHBhcmFtIGVsZW1lbnQgLSBET00gZWxlbWVudCB0byBoaWdobGlnaHRcclxuICogQHBhcmFtIG9yaWdpbmFsVGV4dCAtIE9yaWdpbmFsIHRleHQgY29udGVudFxyXG4gKiBAcGFyYW0gc2VhcmNoU3RhdGUgLSBQYXJzZWQgc2VhcmNoIHN0YXRlXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaGlnaGxpZ2h0TWF0Y2hlcyhcclxuICAgIGVsZW1lbnQ6IEhUTUxFbGVtZW50LFxyXG4gICAgb3JpZ2luYWxUZXh0OiBzdHJpbmcsXHJcbiAgICBzZWFyY2hTdGF0ZTogU2VhcmNoU3RhdGVcclxuKTogdm9pZCB7XHJcbiAgICBpZiAoIXNlYXJjaFN0YXRlLmlzQWN0aXZlIHx8ICFvcmlnaW5hbFRleHQpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGVzY2FwZWRUZXh0ID0gZXNjYXBlSHRtbChvcmlnaW5hbFRleHQpO1xyXG5cclxuICAgIC8vIEhpZ2hsaWdodCBwaHJhc2VzIGZpcnN0IChsb25nZXIgbWF0Y2hlcylcclxuICAgIHNlYXJjaFN0YXRlLnBocmFzZXMuZm9yRWFjaChwaHJhc2UgPT4ge1xyXG4gICAgICAgIGNvbnN0IGVzY2FwZWRQaHJhc2UgPSBlc2NhcGVSZWdleChwaHJhc2UpO1xyXG4gICAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgKCR7ZXNjYXBlZFBocmFzZX0pYCwgJ2dpJyk7XHJcbiAgICAgICAgZXNjYXBlZFRleHQgPSBlc2NhcGVkVGV4dC5yZXBsYWNlKHJlZ2V4LCAnPG1hcmsgY2xhc3M9XCJtaXRyZS1zZWFyY2gtaGlnaGxpZ2h0XCI+JDE8L21hcms+Jyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBIaWdobGlnaHQga2V5d29yZHMgKGF2b2lkIGRvdWJsZS13cmFwcGluZyBpbnNpZGUgZXhpc3RpbmcgbWFya3MpXHJcbiAgICBzZWFyY2hTdGF0ZS5rZXl3b3Jkcy5mb3JFYWNoKGtleXdvcmQgPT4ge1xyXG4gICAgICAgIGNvbnN0IGVzY2FwZWRLZXl3b3JkID0gZXNjYXBlUmVnZXgoa2V5d29yZCk7XHJcbiAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGAoPyE8bWFya1tePl0qPikoJHtlc2NhcGVkS2V5d29yZH0pKD8hW148XSo8XFwvbWFyaz4pYCwgJ2dpJyk7XHJcbiAgICAgICAgZXNjYXBlZFRleHQgPSBlc2NhcGVkVGV4dC5yZXBsYWNlKHJlZ2V4LCAnPG1hcmsgY2xhc3M9XCJtaXRyZS1zZWFyY2gtaGlnaGxpZ2h0XCI+JDE8L21hcms+Jyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBlbGVtZW50LmlubmVySFRNTCA9IGVzY2FwZWRUZXh0O1xyXG59XHJcbiIsICIvKipcclxuICogTWl0cmVNb2RhbEhlbHBlcnMudHMgLSBTaGFyZWQgY29udGV4dCBhbmQgdXRpbGl0aWVzIGZvciBNSVRSRSBtb2RhbCByZW5kZXJpbmdcclxuICpcclxuICogRGVmaW5lcyB0aGUgTWl0cmVNb2RhbENvbnRleHQgaW50ZXJmYWNlIHRoYXQgcmVwbGFjZXMgYHRoaXNgIGluIGV4dHJhY3RlZFxyXG4gKiByZW5kZXJpbmcgZnVuY3Rpb25zLCBwbHVzIGhlbHBlciBmdW5jdGlvbnMgdXNlZCBhY3Jvc3MgbXVsdGlwbGUgbW9kYWwgbW9kdWxlcy5cclxuICovXHJcblxyXG5pbXBvcnQgeyBNaXRyZVRlY2huaXF1ZSwgU2VhcmNoU3RhdGUgfSBmcm9tICcuL01pdHJlVHlwZXMnO1xyXG5pbXBvcnQgeyB0cnVuY2F0ZURlc2NyaXB0aW9uIH0gZnJvbSAnLi9NaXRyZVRleHRVdGlscyc7XHJcbmltcG9ydCB7IGhpZ2hsaWdodE1hdGNoZXMgfSBmcm9tICcuL01pdHJlU2VhcmNoJztcclxuaW1wb3J0IHR5cGUgeyBJT0NOb2RlRGF0YSB9IGZyb20gJy4uL3R5cGVzL0lPQ05vZGVEYXRhJztcclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBDb250ZXh0IGludGVyZmFjZVxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8qKlxyXG4gKiBTaGFyZWQgY29udGV4dCBwYXNzZWQgdG8gZXh0cmFjdGVkIHJlbmRlcmluZyBmdW5jdGlvbnMgaW5zdGVhZCBvZiBgdGhpc2AuXHJcbiAqIEJ1aWx0IGJ5IFJlbmRlck1pdHJlTW9kYWwuZ2V0Q29udGV4dCgpIGZyb20gY2xhc3MgcHJvcGVydGllcy5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgTWl0cmVNb2RhbENvbnRleHQge1xyXG4gICAgLyoqIEN1cnJlbnRseSBzZWxlY3RlZCB0ZWNobmlxdWUgSUQgKGZyb20gY2FudmFzIHNlbGVjdGlvbiksIG9yIG51bGwuICovXHJcbiAgICBhY3RpdmVUZWNobmlxdWVJZDogc3RyaW5nIHwgbnVsbDtcclxuICAgIC8qKiBDdXJyZW50IHNlYXJjaCBzdGF0ZSwgb3IgbnVsbCBpZiBubyBzZWFyY2ggaXMgYWN0aXZlLiAqL1xyXG4gICAgY3VycmVudFNlYXJjaFN0YXRlOiBTZWFyY2hTdGF0ZSB8IG51bGw7XHJcbiAgICAvKiogTWFwIG9mIHBhcmVudCB0ZWNobmlxdWUgSURzIHRvIHRoZWlyIHN1YnRlY2huaXF1ZSBhcnJheXMuICovXHJcbiAgICBzdWJ0ZWNobmlxdWVzTWFwOiBNYXA8c3RyaW5nLCBNaXRyZVRlY2huaXF1ZVtdPjtcclxuICAgIC8qKiBNYXAgb2YgSU9DIG5vZGUgSURzIHRvIHBhcnNlZCBkYXRhIChmb3IgaG92ZXIgdG9vbHRpcHMpLiAqL1xyXG4gICAgaW9jRGF0YU1hcDogTWFwPHN0cmluZywgSU9DTm9kZURhdGE+O1xyXG4gICAgLyoqIE1heCBjaGFyYWN0ZXJzIGZvciBwYXJlbnQgdGVjaG5pcXVlIGRlc2NyaXB0aW9ucyBpbiBjb2xsYXBzZWQgc3RhdGUuICovXHJcbiAgICBURUNITklRVUVfVFJVTkNBVEVfTElNSVQ6IG51bWJlcjtcclxuICAgIC8qKiBNYXggY2hhcmFjdGVycyBmb3Igc3VidGVjaG5pcXVlIGRlc2NyaXB0aW9ucyBpbiBjb2xsYXBzZWQgc3RhdGUuICovXHJcbiAgICBTVUJURUNITklRVUVfVFJVTkNBVEVfTElNSVQ6IG51bWJlcjtcclxuICAgIC8qKiBDYWxsYmFjayB0byByZW5kZXIgc3VidGVjaG5pcXVlcyBpbnNpZGUgYSBwYXJlbnQgZWxlbWVudC4gKi9cclxuICAgIHJlbmRlclN1YnRlY2huaXF1ZXM6IChwYXJlbnRFbDogSFRNTEVsZW1lbnQsIHN1YnRlY2huaXF1ZXM6IE1pdHJlVGVjaG5pcXVlW10sIHNlYXJjaFN0YXRlPzogU2VhcmNoU3RhdGUgfCBudWxsKSA9PiB2b2lkO1xyXG59XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gQWN0aXZlIHRlY2huaXF1ZSBjaGVja1xyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8qKlxyXG4gKiBDaGVjayBpZiBhIHRlY2huaXF1ZSBzaG91bGQgYmUgaGlnaGxpZ2h0ZWQgYXMgdGhlIGFjdGl2ZSBzZWxlY3Rpb24uXHJcbiAqIEhhbmRsZXMgYm90aCBkaXJlY3QgbWF0Y2hlcyBhbmQgcGFyZW50LWNoaWxkIHJlbGF0aW9uc2hpcHMuXHJcbiAqXHJcbiAqIEBwYXJhbSB0ZWNobmlxdWVJZCAtIFRoZSB0ZWNobmlxdWUgSUQgdG8gY2hlY2tcclxuICogQHBhcmFtIGFjdGl2ZVRlY2huaXF1ZUlkIC0gVGhlIGN1cnJlbnRseSBhY3RpdmUgdGVjaG5pcXVlIElEIChmcm9tIGNhbnZhcyBzZWxlY3Rpb24pXHJcbiAqIEByZXR1cm5zIHRydWUgaWYgdGhpcyB0ZWNobmlxdWUgc2hvdWxkIGJlIGhpZ2hsaWdodGVkIGluIHB1cnBsZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzQWN0aXZlVGVjaG5pcXVlKHRlY2huaXF1ZUlkOiBzdHJpbmcsIGFjdGl2ZVRlY2huaXF1ZUlkOiBzdHJpbmcgfCBudWxsKTogYm9vbGVhbiB7XHJcbiAgICBpZiAoIWFjdGl2ZVRlY2huaXF1ZUlkKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgLy8gRGlyZWN0IG1hdGNoXHJcbiAgICBpZiAodGVjaG5pcXVlSWQgPT09IGFjdGl2ZVRlY2huaXF1ZUlkKSByZXR1cm4gdHJ1ZTtcclxuXHJcbiAgICAvLyBQYXJlbnQgbWF0Y2g6IHNlbGVjdGVkIHRlY2huaXF1ZSBpcyBhIHN1YnRlY2huaXF1ZSBvZiB0aGlzIHRlY2huaXF1ZVxyXG4gICAgaWYgKGFjdGl2ZVRlY2huaXF1ZUlkLmluY2x1ZGVzKCcuJykpIHtcclxuICAgICAgICBjb25zdCBwYXJlbnRJZCA9IGFjdGl2ZVRlY2huaXF1ZUlkLnNwbGl0KCcuJylbMF07XHJcbiAgICAgICAgaWYgKHRlY2huaXF1ZUlkID09PSBwYXJlbnRJZCkgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gRXhwYW5kL2NvbGxhcHNlIHRvZ2dsZVxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8qKlxyXG4gKiBUb2dnbGUgZXhwYW5zaW9uIChleHBhbmQvY29sbGFwc2UpIGZvciB0ZWNobmlxdWVzIG9yIHN1YnRlY2huaXF1ZXMuXHJcbiAqIEhhbmRsZXMgZGVzY3JpcHRpb24gc3dhcCBhbmQgb3B0aW9uYWwgc3VidGVjaG5pcXVlcyByZW5kZXJpbmcuXHJcbiAqXHJcbiAqIEBwYXJhbSBlbGVtZW50IC0gVGhlIHRlY2huaXF1ZS9zdWJ0ZWNobmlxdWUgRE9NIGVsZW1lbnRcclxuICogQHBhcmFtIGN0eCAtIE1vZGFsIGNvbnRleHQgd2l0aCBzZWFyY2ggc3RhdGUgYW5kIHN1YnRlY2huaXF1ZXMgY2FsbGJhY2tcclxuICogQHBhcmFtIHN1YnRlY2huaXF1ZXMgLSBTdWJ0ZWNobmlxdWVzIHRvIHJlbmRlciAob25seSBmb3IgcGFyZW50IHRlY2huaXF1ZXMpXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdG9nZ2xlRXhwYW5zaW9uKFxyXG4gICAgZWxlbWVudDogSFRNTEVsZW1lbnQsXHJcbiAgICBjdHg6IE1pdHJlTW9kYWxDb250ZXh0LFxyXG4gICAgc3VidGVjaG5pcXVlcz86IE1pdHJlVGVjaG5pcXVlW11cclxuKTogdm9pZCB7XHJcbiAgICBjb25zdCBpc0NvbGxhcHNlZCA9IGVsZW1lbnQuaGFzQ2xhc3MoJ2NvbGxhcHNlZCcpO1xyXG4gICAgY29uc3QgZXhwYW5kSWNvbiA9IGVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1pdHJlLWV4cGFuZC1pY29uJykgYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICBjb25zdCBkZXNjRWwgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5taXRyZS10ZWNobmlxdWUtZGVzY3JpcHRpb24nKSBhcyBIVE1MRWxlbWVudDtcclxuXHJcbiAgICBpZiAoaXNDb2xsYXBzZWQpIHtcclxuICAgICAgICAvLyBFWFBBTkRcclxuICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdjb2xsYXBzZWQnKTtcclxuICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdleHBhbmRlZCcpO1xyXG4gICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLWlzLWV4cGFuZGVkJywgJ3RydWUnKTtcclxuICAgICAgICBpZiAoZXhwYW5kSWNvbikgZXhwYW5kSWNvbi5zZXRUZXh0KCdcdTI1QkMnKTtcclxuXHJcbiAgICAgICAgLy8gUmVuZGVyIHN1YnRlY2huaXF1ZXMgaWYgcHJvdmlkZWQgKG9ubHkgZm9yIHBhcmVudCB0ZWNobmlxdWVzKVxyXG4gICAgICAgIGlmIChzdWJ0ZWNobmlxdWVzICYmIHN1YnRlY2huaXF1ZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBjdHgucmVuZGVyU3VidGVjaG5pcXVlcyhlbGVtZW50LCBzdWJ0ZWNobmlxdWVzLCBjdHguY3VycmVudFNlYXJjaFN0YXRlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFNob3cgZnVsbCBkZXNjcmlwdGlvblxyXG4gICAgICAgIGlmIChkZXNjRWwpIHtcclxuICAgICAgICAgICAgY29uc3QgZnVsbERlc2MgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1mdWxsLWRlc2NyaXB0aW9uJyk7XHJcbiAgICAgICAgICAgIGlmIChmdWxsRGVzYykge1xyXG4gICAgICAgICAgICAgICAgZGVzY0VsLnRleHRDb250ZW50ID0gZnVsbERlc2M7XHJcbiAgICAgICAgICAgICAgICBpZiAoY3R4LmN1cnJlbnRTZWFyY2hTdGF0ZT8uaXNBY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgICAgICBoaWdobGlnaHRNYXRjaGVzKGRlc2NFbCwgZnVsbERlc2MsIGN0eC5jdXJyZW50U2VhcmNoU3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBDT0xMQVBTRVxyXG4gICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ2V4cGFuZGVkJyk7XHJcbiAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnY29sbGFwc2VkJyk7XHJcbiAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtaXMtZXhwYW5kZWQnLCAnZmFsc2UnKTtcclxuICAgICAgICBpZiAoZXhwYW5kSWNvbikgZXhwYW5kSWNvbi5zZXRUZXh0KCdcdTI1QjYnKTtcclxuXHJcbiAgICAgICAgLy8gUmVtb3ZlIHN1YnRlY2huaXF1ZXMgY29udGFpbmVyIGlmIHByZXNlbnRcclxuICAgICAgICBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5taXRyZS1zdWJ0ZWNobmlxdWVzLWNvbnRhaW5lcicpPy5yZW1vdmUoKTtcclxuXHJcbiAgICAgICAgLy8gU2hvdyB0cnVuY2F0ZWQgZGVzY3JpcHRpb25cclxuICAgICAgICBpZiAoZGVzY0VsKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZ1bGxEZXNjID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtZnVsbC1kZXNjcmlwdGlvbicpO1xyXG4gICAgICAgICAgICBjb25zdCB0cnVuY2F0ZWREZXNjID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdHJ1bmNhdGVkLWRlc2NyaXB0aW9uJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGRpc3BsYXlUZXh0ID0gdHJ1bmNhdGVkRGVzYyB8fCAoZnVsbERlc2MgPyB0cnVuY2F0ZURlc2NyaXB0aW9uKGZ1bGxEZXNjKSA6IG51bGwpO1xyXG4gICAgICAgICAgICBpZiAoZGlzcGxheVRleHQpIHtcclxuICAgICAgICAgICAgICAgIGRlc2NFbC50ZXh0Q29udGVudCA9IGRpc3BsYXlUZXh0O1xyXG4gICAgICAgICAgICAgICAgaWYgKGN0eC5jdXJyZW50U2VhcmNoU3RhdGU/LmlzQWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0TWF0Y2hlcyhkZXNjRWwsIGRpc3BsYXlUZXh0LCBjdHguY3VycmVudFNlYXJjaFN0YXRlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iLCAiLyoqXHJcbiAqIE1pdHJlQ291bnRCYWRnZS50cyAtIENvdW50IGJhZGdlIHdpdGggaG92ZXIgdG9vbHRpcCBmb3IgdGVjaG5pcXVlIGl0ZW1zXHJcbiAqXHJcbiAqIENyZWF0ZXMgYSBzbWFsbCBiYWRnZSBzaG93aW5nIGhvdyBtYW55IElPQyBjYXJkcyByZWZlcmVuY2UgYSB0ZWNobmlxdWUsXHJcbiAqIHdpdGggYSBob3ZlciB0b29sdGlwIHRoYXQgbGlzdHMgaW5kaXZpZHVhbCBjYXJkIGRldGFpbHMgKHR5cGUsIHZhbHVlKS5cclxuICovXHJcblxyXG5pbXBvcnQgeyBNaXRyZVRlY2huaXF1ZSB9IGZyb20gJy4vTWl0cmVUeXBlcyc7XHJcbmltcG9ydCB7IE1pdHJlTW9kYWxDb250ZXh0IH0gZnJvbSAnLi9NaXRyZU1vZGFsSGVscGVycyc7XHJcbmltcG9ydCB7IElPQ19UWVBFUyB9IGZyb20gJy4uL3R5cGVzL0lPQ0NhcmRzVHlwZXMnO1xyXG5pbXBvcnQgeyBERUJVRyB9IGZyb20gJy4uL2RlYnVnJztcclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBDb3VudCBiYWRnZSB3aXRoIHRvb2x0aXBcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vKipcclxuICogQ3JlYXRlIGEgY291bnQgYmFkZ2Ugd2l0aCBob3ZlciB0b29sdGlwIHNob3dpbmcgY2FyZCBkZXRhaWxzLlxyXG4gKlxyXG4gKiBAcGFyYW0gcGFyZW50RWwgLSBFbGVtZW50IHRvIGF0dGFjaCB0aGUgYmFkZ2UgZGl2IHRvXHJcbiAqIEBwYXJhbSB0ZWNobmlxdWUgLSBUZWNobmlxdWUgd2l0aCBjb3VudC9pb2NDYXJkc1xyXG4gKiBAcGFyYW0gY3R4IC0gTW9kYWwgY29udGV4dCBmb3IgSU9DIGRhdGEgbG9va3VwXHJcbiAqIEBwYXJhbSBleHRyYUlvY0NhcmRzIC0gQWRkaXRpb25hbCBjYXJkIElEcyB0byBzaG93IChlLmcuLCBmcm9tIGZvdW5kIHN1YnRlY2huaXF1ZXMpXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQ291bnRCYWRnZVdpdGhUb29sdGlwKFxyXG4gICAgcGFyZW50RWw6IEhUTUxFbGVtZW50LFxyXG4gICAgdGVjaG5pcXVlOiBNaXRyZVRlY2huaXF1ZSxcclxuICAgIGN0eDogTWl0cmVNb2RhbENvbnRleHQsXHJcbiAgICBleHRyYUlvY0NhcmRzPzogc3RyaW5nW11cclxuKTogdm9pZCB7XHJcbiAgICBjb25zdCBiYWRnZSA9IHBhcmVudEVsLmNyZWF0ZURpdignbWl0cmUtdGVjaG5pcXVlLWNvdW50LWJhZGdlJyk7XHJcbiAgICBiYWRnZS50ZXh0Q29udGVudCA9IGAke3RlY2huaXF1ZS5jb3VudH0gY2FyZCR7dGVjaG5pcXVlLmNvdW50ID4gMSA/ICdzJyA6ICcnfWA7XHJcblxyXG4gICAgLy8gTWVyZ2UgdGVjaG5pcXVlJ3Mgb3duIGlvY0NhcmRzIHdpdGggYW55IGV4dHJhIGNhcmRzIGZyb20gc3VidGVjaG5pcXVlc1xyXG4gICAgY29uc3QgYWxsQ2FyZElkcyA9IFsuLi50ZWNobmlxdWUuaW9jQ2FyZHMsIC4uLihleHRyYUlvY0NhcmRzIHx8IFtdKV07XHJcblxyXG4gICAgLy8gQ3JlYXRlIHRvb2x0aXAgZWxlbWVudCAoaGlkZGVuIGJ5IGRlZmF1bHQpXHJcbiAgICBjb25zdCB0b29sdGlwID0gYmFkZ2UuY3JlYXRlRGl2KCdtaXRyZS1jb3VudC10b29sdGlwJyk7XHJcbiAgICB0b29sdGlwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcblxyXG4gICAgLy8gUG9wdWxhdGUgdG9vbHRpcCB3aXRoIGNhcmQgZGV0YWlsc1xyXG4gICAgYWxsQ2FyZElkcy5mb3JFYWNoKChjYXJkSWQsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgY29uc3QgaW9jRGF0YSA9IGN0eC5pb2NEYXRhTWFwLmdldChjYXJkSWQpO1xyXG4gICAgICAgIGlmICghaW9jRGF0YSkgcmV0dXJuO1xyXG5cclxuICAgICAgICBjb25zdCBjYXJkSXRlbSA9IHRvb2x0aXAuY3JlYXRlRGl2KCdtaXRyZS10b29sdGlwLWNhcmQnKTtcclxuXHJcbiAgICAgICAgLy8gQ2FyZCB0eXBlIHdpdGggaWNvbiBjb2xvclxyXG4gICAgICAgIGNvbnN0IGlvY1R5cGUgPSBPYmplY3QudmFsdWVzKElPQ19UWVBFUykuZmluZCh0ID0+IHQubmFtZSA9PT0gaW9jRGF0YS50eXBlKTtcclxuICAgICAgICBjb25zdCB0eXBlQ29sb3IgPSBpb2NUeXBlPy5jb2xvciB8fCAnIzg4OCc7XHJcbiAgICAgICAgY29uc3QgdHlwZUVsID0gY2FyZEl0ZW0uY3JlYXRlRGl2KCdtaXRyZS10b29sdGlwLXR5cGUnKTtcclxuICAgICAgICB0eXBlRWwuc3R5bGUuY29sb3IgPSB0eXBlQ29sb3I7XHJcbiAgICAgICAgdHlwZUVsLnN0eWxlLmZvbnRXZWlnaHQgPSAnYm9sZCc7XHJcbiAgICAgICAgdHlwZUVsLnRleHRDb250ZW50ID0gaW9jRGF0YS50eXBlO1xyXG5cclxuICAgICAgICAvLyBDYXJkIHZhbHVlL2lkZW50aWZpZXJcclxuICAgICAgICBpZiAoaW9jRGF0YS52YWx1ZSkge1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZUVsID0gY2FyZEl0ZW0uY3JlYXRlRGl2KCdtaXRyZS10b29sdGlwLXZhbHVlJyk7XHJcbiAgICAgICAgICAgIHZhbHVlRWwudGV4dENvbnRlbnQgPSBpb2NEYXRhLnZhbHVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQWRkIHNlcGFyYXRvciBiZXR3ZWVuIGNhcmRzIChleGNlcHQgbGFzdClcclxuICAgICAgICBpZiAoaW5kZXggPCBhbGxDYXJkSWRzLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgICAgY2FyZEl0ZW0uc3R5bGUuYm9yZGVyQm90dG9tID0gJzFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlciknO1xyXG4gICAgICAgICAgICBjYXJkSXRlbS5zdHlsZS5wYWRkaW5nQm90dG9tID0gJzhweCc7XHJcbiAgICAgICAgICAgIGNhcmRJdGVtLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICc4cHgnO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIEhvdmVyIGV2ZW50IGxpc3RlbmVyc1xyXG4gICAgYmFkZ2UuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcclxuICAgICAgICB0b29sdGlwLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG4gICAgfSk7XHJcbiAgICBiYWRnZS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xyXG4gICAgICAgIHRvb2x0aXAuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW01pdHJlTW9kYWxSZW5kZXJlcl0gICBcdTIxOTIgQ291bnQgYmFkZ2Ugd2l0aCB0b29sdGlwOicsIHRlY2huaXF1ZS5jb3VudCwgJ2NhcmQocyksIGFsbENhcmRzOicsIGFsbENhcmRJZHMubGVuZ3RoKTtcclxufVxyXG4iLCAiLyoqXHJcbiAqIE1pdHJlTW9kYWxUYWN0aWNSZW5kZXJlci50cyAtIFRhY3RpYyBjb2x1bW4gYW5kIHRlY2huaXF1ZSBpdGVtIHJlbmRlcmluZ1xyXG4gKlxyXG4gKiBSZW5kZXJzIGluZGl2aWR1YWwgdGFjdGljIHNlY3Rpb25zIGFzIHZlcnRpY2FsIGNvbHVtbnMgaW4gdGhlIE1JVFJFIG1hdHJpeC5cclxuICogRWFjaCBjb2x1bW4gY29udGFpbnMgdGVjaG5pcXVlIGl0ZW1zIHdpdGggZXhwYW5kL2NvbGxhcHNlLCB2YWxpZGF0aW9uIGljb25zLFxyXG4gKiBjb3VudCBiYWRnZXMgd2l0aCB0b29sdGlwcywgYW5kIHN1YnRlY2huaXF1ZSBuZXN0aW5nLlxyXG4gKlxyXG4gKiBDb3VudCBiYWRnZSByZW5kZXJpbmcgZGVsZWdhdGVkIHRvIE1pdHJlQ291bnRCYWRnZS50cy5cclxuICogU3VidGVjaG5pcXVlIHJlbmRlcmluZyBkZWxlZ2F0ZWQgdG8gTWl0cmVTdWJ0ZWNobmlxdWVSZW5kZXJlci50cy5cclxuICovXHJcblxyXG5pbXBvcnQgeyBNaXRyZVRlY2huaXF1ZSwgTWl0cmVUYWN0aWMsIFNlYXJjaFN0YXRlIH0gZnJvbSAnLi9NaXRyZVR5cGVzJztcclxuaW1wb3J0IHsgY2xlYW5EZXNjcmlwdGlvbiwgdHJ1bmNhdGVEZXNjcmlwdGlvbiB9IGZyb20gJy4vTWl0cmVUZXh0VXRpbHMnO1xyXG5pbXBvcnQgeyBhcHBseVNldmVyaXR5Q2xhc3MsIGdldFNldmVyaXR5SWNvbiB9IGZyb20gJy4vTWl0cmVTZXZlcml0eSc7XHJcbmltcG9ydCB7IGhpZ2hsaWdodE1hdGNoZXMgfSBmcm9tICcuL01pdHJlU2VhcmNoJztcclxuaW1wb3J0IHsgTWl0cmVNb2RhbENvbnRleHQsIGlzQWN0aXZlVGVjaG5pcXVlLCB0b2dnbGVFeHBhbnNpb24gfSBmcm9tICcuL01pdHJlTW9kYWxIZWxwZXJzJztcclxuaW1wb3J0IHsgY3JlYXRlQ291bnRCYWRnZVdpdGhUb29sdGlwIH0gZnJvbSAnLi9NaXRyZUNvdW50QmFkZ2UnO1xyXG5pbXBvcnQgeyBERUJVRyB9IGZyb20gJy4uL2RlYnVnJztcclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBUYWN0aWMgc2VjdGlvbiByZW5kZXJpbmdcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vKipcclxuICogUmVuZGVyIGEgc2luZ2xlIHRhY3RpYyBjb2x1bW4gd2l0aCBhbGwgaXRzIHRlY2huaXF1ZXMuXHJcbiAqXHJcbiAqIEBwYXJhbSBjb250YWluZXIgLSBQYXJlbnQgY29udGFpbmVyIGVsZW1lbnRcclxuICogQHBhcmFtIHRhY3RpYyAtIFRhY3RpYyBkYXRhIHdpdGggbmVzdGVkIHRlY2huaXF1ZXNcclxuICogQHBhcmFtIGN0eCAtIE1vZGFsIGNvbnRleHQgZm9yIHN0YXRlIGFuZCBjYWxsYmFja3NcclxuICogQHBhcmFtIHNlYXJjaFN0YXRlIC0gQ3VycmVudCBzZWFyY2ggc3RhdGUgZm9yIGZpbHRlcmluZy9oaWdobGlnaHRpbmdcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJUYWN0aWNTZWN0aW9uKFxyXG4gICAgY29udGFpbmVyOiBIVE1MRWxlbWVudCxcclxuICAgIHRhY3RpYzogTWl0cmVUYWN0aWMsXHJcbiAgICBjdHg6IE1pdHJlTW9kYWxDb250ZXh0LFxyXG4gICAgc2VhcmNoU3RhdGU/OiBTZWFyY2hTdGF0ZSB8IG51bGxcclxuKTogdm9pZCB7XHJcbiAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tNaXRyZU1vZGFsUmVuZGVyZXJdID09PT09PT09PT0gUkVOREVSSU5HIFRBQ1RJQyBTRUNUSU9OID09PT09PT09PT0nKTtcclxuICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW01pdHJlTW9kYWxSZW5kZXJlcl0gVGFjdGljOicsIHRhY3RpYy5kaXNwbGF5TmFtZSB8fCB0YWN0aWMubmFtZSk7XHJcblxyXG4gICAgY29uc3QgdGFjdGljQ29sdW1uID0gY29udGFpbmVyLmNyZWF0ZURpdignbWl0cmUtdGFjdGljLWNvbHVtbicpO1xyXG5cclxuICAgIC8vIFNob3cgZm91bmQgdnMgdG90YWwgY291bnRcclxuICAgIGNvbnN0IGZvdW5kQ291bnQgPSB0YWN0aWMudGVjaG5pcXVlcy5maWx0ZXIodCA9PiB0LmlzRm91bmQpLmxlbmd0aDtcclxuICAgIGNvbnN0IHRvdGFsQ291bnQgPSB0YWN0aWMudGVjaG5pcXVlcy5sZW5ndGg7XHJcblxyXG4gICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbTWl0cmVNb2RhbFJlbmRlcmVyXSBGb3VuZCB0ZWNobmlxdWVzOicsIGZvdW5kQ291bnQsICcvJywgdG90YWxDb3VudCk7XHJcblxyXG4gICAgY29uc3QgdGFjdGljSGVhZGVyID0gdGFjdGljQ29sdW1uLmNyZWF0ZURpdignbWl0cmUtdGFjdGljLWhlYWRlcicpO1xyXG4gICAgdGFjdGljSGVhZGVyLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogYFx1MjY5NFx1RkUwRiAke3RhY3RpYy5kaXNwbGF5TmFtZSB8fCB0YWN0aWMubmFtZX1gIH0pO1xyXG4gICAgdGFjdGljSGVhZGVyLmNyZWF0ZUVsKCdzcGFuJywge1xyXG4gICAgICAgIHRleHQ6IGAke2ZvdW5kQ291bnR9IGFjdGl2ZSAvICR7dG90YWxDb3VudH0gdG90YWwgdGVjaG5pcXVlc2AsXHJcbiAgICAgICAgY2xzOiAnbWl0cmUtdGVjaG5pcXVlLWNvdW50J1xyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgdGVjaG5pcXVlTGlzdCA9IHRhY3RpY0NvbHVtbi5jcmVhdGVEaXYoJ21pdHJlLXRlY2huaXF1ZS1saXN0Jyk7XHJcblxyXG4gICAgdGFjdGljLnRlY2huaXF1ZXMuZm9yRWFjaCgodGVjaG5pcXVlKSA9PiB7XHJcbiAgICAgICAgcmVuZGVyVGVjaG5pcXVlSXRlbSh0ZWNobmlxdWVMaXN0LCB0ZWNobmlxdWUsIGN0eCwgc2VhcmNoU3RhdGUpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbTWl0cmVNb2RhbFJlbmRlcmVyXSA9PT09PT09PT09IFRBQ1RJQyBSRU5ERVJJTkcgQ09NUExFVEUgPT09PT09PT09PScpO1xyXG59XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gVGVjaG5pcXVlIGl0ZW0gcmVuZGVyaW5nXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLyoqXHJcbiAqIFJlbmRlciBhIHNpbmdsZSB0ZWNobmlxdWUgaXRlbSB3aXRoaW4gYSB0YWN0aWMgY29sdW1uLlxyXG4gKi9cclxuZnVuY3Rpb24gcmVuZGVyVGVjaG5pcXVlSXRlbShcclxuICAgIHRlY2huaXF1ZUxpc3Q6IEhUTUxFbGVtZW50LFxyXG4gICAgdGVjaG5pcXVlOiBNaXRyZVRlY2huaXF1ZSxcclxuICAgIGN0eDogTWl0cmVNb2RhbENvbnRleHQsXHJcbiAgICBzZWFyY2hTdGF0ZT86IFNlYXJjaFN0YXRlIHwgbnVsbFxyXG4pOiB2b2lkIHtcclxuICAgIGNvbnN0IHRlY2hJdGVtID0gdGVjaG5pcXVlTGlzdC5jcmVhdGVEaXYoJ21pdHJlLXRlY2huaXF1ZS1pdGVtJyk7XHJcblxyXG4gICAgLy8gQ2hlY2sgaWYgdGhpcyB0ZWNobmlxdWUgaGFzIHN1YnRlY2huaXF1ZXNcclxuICAgIGNvbnN0IHN1YnRlY2huaXF1ZXMgPSBjdHguc3VidGVjaG5pcXVlc01hcC5nZXQodGVjaG5pcXVlLmlkKSB8fCBbXTtcclxuICAgIGNvbnN0IGhhc1N1YnRlY2huaXF1ZXMgPSBzdWJ0ZWNobmlxdWVzLmxlbmd0aCA+IDA7XHJcblxyXG4gICAgLy8gQ2hlY2sgaWYgZGVzY3JpcHRpb24gaXMgbG9uZ1xyXG4gICAgY29uc3QgY2xlYW5lZERlc2MgPSBjbGVhbkRlc2NyaXB0aW9uKHRlY2huaXF1ZS5kZXNjcmlwdGlvbiB8fCAnJyk7XHJcbiAgICBjb25zdCBpc0xvbmdEZXNjcmlwdGlvbiA9IGNsZWFuZWREZXNjLmxlbmd0aCA+IGN0eC5URUNITklRVUVfVFJVTkNBVEVfTElNSVQ7XHJcblxyXG4gICAgLy8gRXhwYW5kYWJsZSBpZiBsb25nIGRlc2NyaXB0aW9uIE9SIGhhcyBzdWJ0ZWNobmlxdWVzXHJcbiAgICBjb25zdCBpc0V4cGFuZGFibGUgPSBpc0xvbmdEZXNjcmlwdGlvbiB8fCBoYXNTdWJ0ZWNobmlxdWVzO1xyXG5cclxuICAgIC8vIEFkZCBkYXRhIGF0dHJpYnV0ZXMgZm9yIHN0YXRlIG1hbmFnZW1lbnRcclxuICAgIHRlY2hJdGVtLnNldEF0dHJpYnV0ZSgnZGF0YS10ZWNobmlxdWUtaWQnLCB0ZWNobmlxdWUuaWQpO1xyXG4gICAgdGVjaEl0ZW0uc2V0QXR0cmlidXRlKCdkYXRhLXN1YnRlY2huaXF1ZS1jb3VudCcsIHN1YnRlY2huaXF1ZXMubGVuZ3RoLnRvU3RyaW5nKCkpO1xyXG4gICAgdGVjaEl0ZW0uc2V0QXR0cmlidXRlKCdkYXRhLWlzLWV4cGFuZGFibGUnLCBpc0V4cGFuZGFibGUudG9TdHJpbmcoKSk7XHJcbiAgICB0ZWNoSXRlbS5zZXRBdHRyaWJ1dGUoJ2RhdGEtZnVsbC1kZXNjcmlwdGlvbicsIGNsZWFuZWREZXNjKTtcclxuICAgIGlmIChpc0xvbmdEZXNjcmlwdGlvbikge1xyXG4gICAgICAgIGNvbnN0IHRydW5jYXRlZCA9IHRydW5jYXRlRGVzY3JpcHRpb24oY2xlYW5lZERlc2MpO1xyXG4gICAgICAgIHRlY2hJdGVtLnNldEF0dHJpYnV0ZSgnZGF0YS10cnVuY2F0ZWQtZGVzY3JpcHRpb24nLCB0cnVuY2F0ZWQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIGlmIHRoaXMgaXMgdGhlIGFjdGl2ZSB0ZWNobmlxdWUgKGZyb20gc2VsZWN0ZWQgY2FyZClcclxuICAgIGNvbnN0IGlzQWN0aXZlID0gaXNBY3RpdmVUZWNobmlxdWUodGVjaG5pcXVlLmlkLCBjdHguYWN0aXZlVGVjaG5pcXVlSWQpO1xyXG4gICAgaWYgKGlzQWN0aXZlKSB7XHJcbiAgICAgICAgdGVjaEl0ZW0uYWRkQ2xhc3MoJ21pdHJlLXRlY2huaXF1ZS1hY3RpdmUnKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBBcHBseSBzdHlsaW5nIGJhc2VkIG9uIGlzRm91bmQgYW5kIHNldmVyaXR5XHJcbiAgICBpZiAoIXRlY2huaXF1ZS5pc0ZvdW5kKSB7XHJcbiAgICAgICAgdGVjaEl0ZW0uYWRkQ2xhc3MoJ21pdHJlLXRlY2huaXF1ZS11bmZvdW5kJyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGFwcGx5U2V2ZXJpdHlDbGFzcyh0ZWNoSXRlbSwgdGVjaG5pcXVlLnNldmVyaXR5KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB0ZWNoSW5mbyA9IHRlY2hJdGVtLmNyZWF0ZURpdignbWl0cmUtdGVjaG5pcXVlLWluZm8nKTtcclxuXHJcbiAgICAvLyBBZGQgZXhwYW5kIGljb24gaWYgZXhwYW5kYWJsZSAobG9uZyBkZXNjcmlwdGlvbiBPUiBzdWJ0ZWNobmlxdWVzKVxyXG4gICAgaWYgKGlzRXhwYW5kYWJsZSkge1xyXG4gICAgICAgIHRlY2hJbmZvLmNyZWF0ZUVsKCdzcGFuJywge1xyXG4gICAgICAgICAgICBjbHM6ICdtaXRyZS1leHBhbmQtaWNvbicsXHJcbiAgICAgICAgICAgIHRleHQ6ICdcdTI1QjYnXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGVjaEl0ZW0uYWRkQ2xhc3MoJ2hhcy1leHBhbmRhYmxlJyk7XHJcbiAgICAgICAgdGVjaEl0ZW0uYWRkQ2xhc3MoJ2NvbGxhcHNlZCcpO1xyXG5cclxuICAgICAgICAvLyBDbGljayBoYW5kbGVyIGZvciBleHBhbmQvY29sbGFwc2VcclxuICAgICAgICB0ZWNoSXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIHRvZ2dsZUV4cGFuc2lvbih0ZWNoSXRlbSwgY3R4LCBzdWJ0ZWNobmlxdWVzKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICB0ZWNoSW5mby5jcmVhdGVFbCgnc3BhbicsIHtcclxuICAgICAgICB0ZXh0OiB0ZWNobmlxdWUuaWQsXHJcbiAgICAgICAgY2xzOiAnbWl0cmUtdGVjaG5pcXVlLWlkJ1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gQWRkIHN1YnRlY2huaXF1ZSBjb3VudCB0byBuYW1lIGlmIHByZXNlbnRcclxuICAgIGNvbnN0IG5hbWVUZXh0ID0gaGFzU3VidGVjaG5pcXVlc1xyXG4gICAgICAgID8gYCR7dGVjaG5pcXVlLm5hbWV9ICgke3N1YnRlY2huaXF1ZXMubGVuZ3RofSlgXHJcbiAgICAgICAgOiB0ZWNobmlxdWUubmFtZTtcclxuICAgIGNvbnN0IG5hbWVFbCA9IHRlY2hJbmZvLmNyZWF0ZUVsKCdzcGFuJywge1xyXG4gICAgICAgIHRleHQ6IG5hbWVUZXh0LFxyXG4gICAgICAgIGNsczogJ21pdHJlLXRlY2huaXF1ZS1uYW1lJ1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gQXBwbHkgc2VhcmNoIGhpZ2hsaWdodGluZyB0byBuYW1lIGlmIGFjdGl2ZVxyXG4gICAgaWYgKHNlYXJjaFN0YXRlPy5pc0FjdGl2ZSkge1xyXG4gICAgICAgIGhpZ2hsaWdodE1hdGNoZXMobmFtZUVsLCB0ZWNobmlxdWUubmFtZSwgc2VhcmNoU3RhdGUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFNob3cgZGVzY3JpcHRpb24gZm9yIEFMTCB0ZWNobmlxdWVzXHJcbiAgICBpZiAodGVjaG5pcXVlLmRlc2NyaXB0aW9uKSB7XHJcbiAgICAgICAgY29uc3QgZGVzY0VsID0gdGVjaEl0ZW0uY3JlYXRlRGl2KCdtaXRyZS10ZWNobmlxdWUtZGVzY3JpcHRpb24nKTtcclxuXHJcbiAgICAgICAgY29uc3QgaXNFeHBhbmRlZCA9IHRlY2hJdGVtLmhhc0NsYXNzKCdleHBhbmRlZCcpO1xyXG4gICAgICAgIGxldCBkaXNwbGF5VGV4dDogc3RyaW5nO1xyXG5cclxuICAgICAgICBpZiAoaXNFeHBhbmRlZCB8fCAhaXNFeHBhbmRhYmxlKSB7XHJcbiAgICAgICAgICAgIGRpc3BsYXlUZXh0ID0gY2xlYW5lZERlc2M7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZGlzcGxheVRleHQgPSB0cnVuY2F0ZURlc2NyaXB0aW9uKGNsZWFuZWREZXNjKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGRlc2NFbC50ZXh0Q29udGVudCA9IGRpc3BsYXlUZXh0O1xyXG5cclxuICAgICAgICBpZiAoc2VhcmNoU3RhdGU/LmlzQWN0aXZlKSB7XHJcbiAgICAgICAgICAgIGhpZ2hsaWdodE1hdGNoZXMoZGVzY0VsLCBkaXNwbGF5VGV4dCwgc2VhcmNoU3RhdGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBTaG93IGNvdW50IGJhZGdlIE9OTFkgZm9yIGZvdW5kIHRlY2huaXF1ZXNcclxuICAgIGlmICh0ZWNobmlxdWUuaXNGb3VuZCkge1xyXG4gICAgICAgIC8vIENvbGxlY3QgaW9jQ2FyZHMgZnJvbSBmb3VuZCBzdWJ0ZWNobmlxdWVzIGZvciBwYXJlbnQgdG9vbHRpcFxyXG4gICAgICAgIGNvbnN0IHN1YnRlY2hDYXJkczogc3RyaW5nW10gPSBbXTtcclxuICAgICAgICBzdWJ0ZWNobmlxdWVzLmZvckVhY2goc3ViID0+IHtcclxuICAgICAgICAgICAgaWYgKHN1Yi5pc0ZvdW5kICYmIHN1Yi5pb2NDYXJkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBzdWJ0ZWNoQ2FyZHMucHVzaCguLi5zdWIuaW9jQ2FyZHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY3JlYXRlQ291bnRCYWRnZVdpdGhUb29sdGlwKHRlY2hJdGVtLCB0ZWNobmlxdWUsIGN0eCwgc3VidGVjaENhcmRzKTtcclxuICAgIH1cclxufVxyXG4iLCAiLyoqXHJcbiAqIE1pdHJlU3VidGVjaG5pcXVlUmVuZGVyZXIudHMgLSBTdWJ0ZWNobmlxdWUgbGlzdCByZW5kZXJpbmdcclxuICpcclxuICogUmVuZGVycyB0aGUgZXhwYW5kYWJsZSBzdWJ0ZWNobmlxdWVzIGNvbnRhaW5lciBpbnNpZGUgYSBwYXJlbnQgdGVjaG5pcXVlXHJcbiAqIGVsZW1lbnQuIEVhY2ggc3VidGVjaG5pcXVlIHNob3dzIElELCBuYW1lLCB0cnVuY2F0ZWQgZGVzY3JpcHRpb24sIHZhbGlkYXRpb25cclxuICogaWNvbiwgYW5kIGNvdW50IGJhZGdlLiBTdXBwb3J0cyBleHBhbmQvY29sbGFwc2UgZm9yIGxvbmcgZGVzY3JpcHRpb25zLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IE1pdHJlVGVjaG5pcXVlLCBTZWFyY2hTdGF0ZSB9IGZyb20gJy4vTWl0cmVUeXBlcyc7XHJcbmltcG9ydCB7IGNsZWFuRGVzY3JpcHRpb24sIHRydW5jYXRlRGVzY3JpcHRpb24gfSBmcm9tICcuL01pdHJlVGV4dFV0aWxzJztcclxuaW1wb3J0IHsgYXBwbHlTZXZlcml0eUNsYXNzLCBnZXRTZXZlcml0eUljb24gfSBmcm9tICcuL01pdHJlU2V2ZXJpdHknO1xyXG5pbXBvcnQgeyBoaWdobGlnaHRNYXRjaGVzIH0gZnJvbSAnLi9NaXRyZVNlYXJjaCc7XHJcbmltcG9ydCB7IE1pdHJlTW9kYWxDb250ZXh0LCBpc0FjdGl2ZVRlY2huaXF1ZSwgdG9nZ2xlRXhwYW5zaW9uIH0gZnJvbSAnLi9NaXRyZU1vZGFsSGVscGVycyc7XHJcbmltcG9ydCB7IGNyZWF0ZUNvdW50QmFkZ2VXaXRoVG9vbHRpcCB9IGZyb20gJy4vTWl0cmVDb3VudEJhZGdlJztcclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBTdWJ0ZWNobmlxdWVzIHJlbmRlcmluZ1xyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8qKlxyXG4gKiBSZW5kZXIgc3VidGVjaG5pcXVlcyBjb250YWluZXIgaW5zaWRlIGEgcGFyZW50IHRlY2huaXF1ZSBlbGVtZW50LlxyXG4gKlxyXG4gKiBAcGFyYW0gcGFyZW50RWwgLSBUaGUgcGFyZW50IHRlY2huaXF1ZSBET00gZWxlbWVudFxyXG4gKiBAcGFyYW0gc3VidGVjaG5pcXVlcyAtIEFycmF5IG9mIHN1YnRlY2huaXF1ZSBvYmplY3RzXHJcbiAqIEBwYXJhbSBjdHggLSBNb2RhbCBjb250ZXh0IGZvciBzdGF0ZSBhbmQgY2FsbGJhY2tzXHJcbiAqIEBwYXJhbSBzZWFyY2hTdGF0ZSAtIEN1cnJlbnQgc2VhcmNoIHN0YXRlIGZvciBoaWdobGlnaHRpbmdcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJTdWJ0ZWNobmlxdWVzKFxyXG4gICAgcGFyZW50RWw6IEhUTUxFbGVtZW50LFxyXG4gICAgc3VidGVjaG5pcXVlczogTWl0cmVUZWNobmlxdWVbXSxcclxuICAgIGN0eDogTWl0cmVNb2RhbENvbnRleHQsXHJcbiAgICBzZWFyY2hTdGF0ZT86IFNlYXJjaFN0YXRlIHwgbnVsbFxyXG4pOiB2b2lkIHtcclxuICAgIGNvbnN0IGNvbnRhaW5lciA9IHBhcmVudEVsLmNyZWF0ZURpdih7IGNsczogJ21pdHJlLXN1YnRlY2huaXF1ZXMtY29udGFpbmVyJyB9KTtcclxuXHJcbiAgICBzdWJ0ZWNobmlxdWVzLmZvckVhY2goc3VidGVjaCA9PiB7XHJcbiAgICAgICAgY29uc3Qgc3ViSXRlbSA9IGNvbnRhaW5lci5jcmVhdGVEaXYoJ21pdHJlLXRlY2huaXF1ZS1pdGVtIG1pdHJlLXN1YnRlY2huaXF1ZScpO1xyXG5cclxuICAgICAgICAvLyBDaGVjayBpZiBzdWJ0ZWNobmlxdWUgZGVzY3JpcHRpb24gaXMgbG9uZ1xyXG4gICAgICAgIGNvbnN0IGNsZWFuZWREZXNjID0gY2xlYW5EZXNjcmlwdGlvbihzdWJ0ZWNoLmRlc2NyaXB0aW9uIHx8ICcnKTtcclxuICAgICAgICBjb25zdCBpc0xvbmdEZXNjcmlwdGlvbiA9IGNsZWFuZWREZXNjLmxlbmd0aCA+IGN0eC5TVUJURUNITklRVUVfVFJVTkNBVEVfTElNSVQ7XHJcblxyXG4gICAgICAgIC8vIEFkZCBkYXRhIGF0dHJpYnV0ZXMgZm9yIHN0YXRlIG1hbmFnZW1lbnRcclxuICAgICAgICBzdWJJdGVtLnNldEF0dHJpYnV0ZSgnZGF0YS10ZWNobmlxdWUtaWQnLCBzdWJ0ZWNoLmlkKTtcclxuICAgICAgICBzdWJJdGVtLnNldEF0dHJpYnV0ZSgnZGF0YS1mdWxsLWRlc2NyaXB0aW9uJywgY2xlYW5lZERlc2MpO1xyXG4gICAgICAgIGlmIChpc0xvbmdEZXNjcmlwdGlvbikge1xyXG4gICAgICAgICAgICBjb25zdCB0cnVuY2F0ZWQgPSB0cnVuY2F0ZURlc2NyaXB0aW9uKGNsZWFuZWREZXNjLCBjdHguU1VCVEVDSE5JUVVFX1RSVU5DQVRFX0xJTUlUKTtcclxuICAgICAgICAgICAgc3ViSXRlbS5zZXRBdHRyaWJ1dGUoJ2RhdGEtdHJ1bmNhdGVkLWRlc2NyaXB0aW9uJywgdHJ1bmNhdGVkKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENoZWNrIGlmIHRoaXMgc3VidGVjaG5pcXVlIGlzIGFjdGl2ZVxyXG4gICAgICAgIGNvbnN0IGlzQWN0aXZlID0gaXNBY3RpdmVUZWNobmlxdWUoc3VidGVjaC5pZCwgY3R4LmFjdGl2ZVRlY2huaXF1ZUlkKTtcclxuICAgICAgICBpZiAoaXNBY3RpdmUpIHtcclxuICAgICAgICAgICAgc3ViSXRlbS5hZGRDbGFzcygnbWl0cmUtdGVjaG5pcXVlLWFjdGl2ZScpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQXBwbHkgc3R5bGluZyBiYXNlZCBvbiBpc0ZvdW5kIGFuZCBzZXZlcml0eVxyXG4gICAgICAgIGlmICghc3VidGVjaC5pc0ZvdW5kKSB7XHJcbiAgICAgICAgICAgIHN1Ykl0ZW0uYWRkQ2xhc3MoJ21pdHJlLXRlY2huaXF1ZS11bmZvdW5kJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYXBwbHlTZXZlcml0eUNsYXNzKHN1Ykl0ZW0sIHN1YnRlY2guc2V2ZXJpdHkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3Qgc3ViSW5mbyA9IHN1Ykl0ZW0uY3JlYXRlRGl2KCdtaXRyZS10ZWNobmlxdWUtaW5mbycpO1xyXG5cclxuICAgICAgICAvLyBBZGQgZXhwYW5kIGljb24gaWYgZGVzY3JpcHRpb24gaXMgbG9uZ1xyXG4gICAgICAgIGlmIChpc0xvbmdEZXNjcmlwdGlvbikge1xyXG4gICAgICAgICAgICBzdWJJbmZvLmNyZWF0ZUVsKCdzcGFuJywge1xyXG4gICAgICAgICAgICAgICAgY2xzOiAnbWl0cmUtZXhwYW5kLWljb24nLFxyXG4gICAgICAgICAgICAgICAgdGV4dDogJ1x1MjVCNidcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHN1Ykl0ZW0uYWRkQ2xhc3MoJ2hhcy1leHBhbmRhYmxlJyk7XHJcbiAgICAgICAgICAgIHN1Ykl0ZW0uYWRkQ2xhc3MoJ2NvbGxhcHNlZCcpO1xyXG5cclxuICAgICAgICAgICAgc3ViSXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgdG9nZ2xlRXhwYW5zaW9uKHN1Ykl0ZW0sIGN0eCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc3ViSW5mby5jcmVhdGVFbCgnc3BhbicsIHtcclxuICAgICAgICAgICAgdGV4dDogc3VidGVjaC5pZCxcclxuICAgICAgICAgICAgY2xzOiAnbWl0cmUtdGVjaG5pcXVlLWlkJ1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBuYW1lRWwgPSBzdWJJbmZvLmNyZWF0ZUVsKCdzcGFuJywge1xyXG4gICAgICAgICAgICB0ZXh0OiBzdWJ0ZWNoLm5hbWUsXHJcbiAgICAgICAgICAgIGNsczogJ21pdHJlLXRlY2huaXF1ZS1uYW1lJ1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBBcHBseSBzZWFyY2ggaGlnaGxpZ2h0aW5nIHRvIG5hbWUgaWYgYWN0aXZlXHJcbiAgICAgICAgaWYgKHNlYXJjaFN0YXRlPy5pc0FjdGl2ZSkge1xyXG4gICAgICAgICAgICBoaWdobGlnaHRNYXRjaGVzKG5hbWVFbCwgc3VidGVjaC5uYW1lLCBzZWFyY2hTdGF0ZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBTaG93IGRlc2NyaXB0aW9uIHdpdGggdHJ1bmNhdGlvblxyXG4gICAgICAgIGlmIChzdWJ0ZWNoLmRlc2NyaXB0aW9uKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRlc2NFbCA9IHN1Ykl0ZW0uY3JlYXRlRGl2KCdtaXRyZS10ZWNobmlxdWUtZGVzY3JpcHRpb24nKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBkaXNwbGF5VGV4dDogc3RyaW5nO1xyXG4gICAgICAgICAgICBpZiAoaXNMb25nRGVzY3JpcHRpb24pIHtcclxuICAgICAgICAgICAgICAgIGRpc3BsYXlUZXh0ID0gdHJ1bmNhdGVEZXNjcmlwdGlvbihjbGVhbmVkRGVzYywgY3R4LlNVQlRFQ0hOSVFVRV9UUlVOQ0FURV9MSU1JVCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5VGV4dCA9IGNsZWFuZWREZXNjO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkZXNjRWwudGV4dENvbnRlbnQgPSBkaXNwbGF5VGV4dDtcclxuXHJcbiAgICAgICAgICAgIGlmIChzZWFyY2hTdGF0ZT8uaXNBY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgIGhpZ2hsaWdodE1hdGNoZXMoZGVzY0VsLCBkaXNwbGF5VGV4dCwgc2VhcmNoU3RhdGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBTaG93IGNvdW50IGJhZGdlIGZvciBmb3VuZCBzdWJ0ZWNobmlxdWVzXHJcbiAgICAgICAgaWYgKHN1YnRlY2guaXNGb3VuZCkge1xyXG4gICAgICAgICAgICBjcmVhdGVDb3VudEJhZGdlV2l0aFRvb2x0aXAoc3ViSXRlbSwgc3VidGVjaCwgY3R4KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxyXG4iLCAiLyoqXHJcbiAqIE1pdHJlTW9kYWxWYWxpZGF0aW9uLnRzIC0gVmFsaWRhdGlvbiBlcnJvcnMgc2VjdGlvbiByZW5kZXJpbmdcclxuICpcclxuICogUmVuZGVycyB0aGUgY29sbGFwc2libGUgdmFsaWRhdGlvbiBlcnJvcnMgc2VjdGlvbiBhdCB0aGUgdG9wIG9mIHRoZSBNSVRSRVxyXG4gKiBtb2RhbC4gR3JvdXBzIGVycm9ycyBieSB0eXBlIChNaXNzaW5nIFRhY3RpYywgVW5rbm93biBUYWN0aWMsIFRlY2huaXF1ZVxyXG4gKiBFcnJvcnMsIE1pc21hdGNoZXMpIGFuZCBzaG93cyBhZmZlY3RlZCBJT0MgY2FyZCByZWZlcmVuY2VzLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFZhbGlkYXRpb25FcnJvciB9IGZyb20gJy4vTWl0cmVUeXBlcyc7XHJcbmltcG9ydCB7IGlzQ3JpdGljYWxTZXZlcml0eSB9IGZyb20gJy4vTWl0cmVTZXZlcml0eSc7XHJcbmltcG9ydCB7IERFQlVHIH0gZnJvbSAnLi4vZGVidWcnO1xyXG5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIFZhbGlkYXRpb24gZXJyb3JzIHNlY3Rpb25cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vKipcclxuICogUmVuZGVyIHZhbGlkYXRpb24gZXJyb3JzIHNlY3Rpb24gd2l0aCBjYXJkIHJlZmVyZW5jZXMuXHJcbiAqIEdyb3VwcyBlcnJvcnMgYnkgdHlwZSBhbmQgcHJvdmlkZXMgYSBjb2xsYXBzaWJsZSBVSS5cclxuICpcclxuICogR3JvdXBzIGVycm9ycyBpbnRvIDMgY2F0ZWdvcmllczpcclxuICogLSBVbmtub3duIFRhY3RpYzogVGFjdGljIGFiYnJldmlhdGlvbi9uYW1lIG5vdCByZWNvZ25pemVkXHJcbiAqIC0gVGVjaG5pcXVlIEVycm9yczogVGVjaG5pcXVlIElEIG5vdCBmb3VuZCBpbiBkYXRhc2V0XHJcbiAqIC0gVmFsaWRhdGlvbiBNaXNtYXRjaGVzOiBCb3RoIHZhbGlkIGJ1dCBkb24ndCBiZWxvbmcgdG9nZXRoZXJcclxuICpcclxuICogTk9URTogQ2FyZHMgd2l0aCBtaXNzaW5nIGZpZWxkcyBhcmUgTk9UIHNob3duIGhlcmUgLSB0aGV5IGFwcGVhclxyXG4gKiBpbiB0aGUgc3RhdGlzdGljcyBiYXIgYXMgaW5mb3JtYXRpb25hbCBjb3VudHMgd2l0aCBob3ZlciB0b29sdGlwcy5cclxuICpcclxuICogQHBhcmFtIGNvbnRhaW5lciAtIFBhcmVudCBjb250YWluZXIgZWxlbWVudFxyXG4gKiBAcGFyYW0gdmFsaWRhdGlvbkVycm9ycyAtIEFycmF5IG9mIHZhbGlkYXRpb24gZXJyb3JzIGZyb20gYWdncmVnYXRpb25cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJWYWxpZGF0aW9uRXJyb3JzKFxyXG4gICAgY29udGFpbmVyOiBIVE1MRWxlbWVudCxcclxuICAgIHZhbGlkYXRpb25FcnJvcnM6IFZhbGlkYXRpb25FcnJvcltdXHJcbik6IHZvaWQge1xyXG4gICAgaWYgKHZhbGlkYXRpb25FcnJvcnMubGVuZ3RoID09PSAwKSByZXR1cm47XHJcblxyXG4gICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbTWl0cmVNb2RhbFZhbGlkYXRpb25dIFJlbmRlcmluZycsIHZhbGlkYXRpb25FcnJvcnMubGVuZ3RoLCAndmFsaWRhdGlvbiBlcnJvcnMnKTtcclxuXHJcbiAgICAvLyBHcm91cCBlcnJvcnMgYnkgdHlwZSAob25seSAzIGNhdGVnb3JpZXMgbm93IC0gZW1wdHlfdGFjdGljIHJlbW92ZWQpXHJcbiAgICBjb25zdCB0YWN0aWNFcnJvcnMgPSB2YWxpZGF0aW9uRXJyb3JzLmZpbHRlcihlID0+IGUuc2V2ZXJpdHkgPT09ICd1bmtub3duX3RhY3RpYycpO1xyXG4gICAgY29uc3QgdGVjaG5pcXVlRXJyb3JzID0gdmFsaWRhdGlvbkVycm9ycy5maWx0ZXIoZSA9PiBlLnNldmVyaXR5ID09PSAndW5rbm93bl90ZWNobmlxdWUnKTtcclxuICAgIGNvbnN0IG1pc21hdGNoRXJyb3JzID0gdmFsaWRhdGlvbkVycm9ycy5maWx0ZXIoZSA9PiBlLnNldmVyaXR5ID09PSAnbWlzbWF0Y2gnKTtcclxuXHJcbiAgICBjb25zdCBlcnJvclNlY3Rpb24gPSBjb250YWluZXIuY3JlYXRlRGl2KCdtaXRyZS12YWxpZGF0aW9uLWVycm9ycycpO1xyXG5cclxuICAgIC8vIEhlYWRlciB3aXRoIHRvdGFsIGNvdW50XHJcbiAgICBjb25zdCBoZWFkZXIgPSBlcnJvclNlY3Rpb24uY3JlYXRlRGl2KCdtaXRyZS1lcnJvcnMtaGVhZGVyJyk7XHJcbiAgICBoZWFkZXIuY3JlYXRlRWwoJ2gzJywge1xyXG4gICAgICAgIHRleHQ6IGBcdTI2QTBcdUZFMEYgVmFsaWRhdGlvbiBJc3N1ZXMgKCR7dmFsaWRhdGlvbkVycm9ycy5sZW5ndGh9KWBcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIENvbGxhcHNpYmxlIHRvZ2dsZVxyXG4gICAgY29uc3QgdG9nZ2xlQnRuID0gaGVhZGVyLmNyZWF0ZUVsKCdidXR0b24nLCB7XHJcbiAgICAgICAgdGV4dDogJ0hpZGUnLFxyXG4gICAgICAgIGNsczogJ21pdHJlLWVycm9ycy10b2dnbGUnXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBlcnJvcnNMaXN0ID0gZXJyb3JTZWN0aW9uLmNyZWF0ZURpdignbWl0cmUtZXJyb3JzLWxpc3QnKTtcclxuICAgIGVycm9yU2VjdGlvbi5hZGRDbGFzcygnZXhwYW5kZWQnKTtcclxuXHJcbiAgICB0b2dnbGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgaWYgKGVycm9yU2VjdGlvbi5oYXNDbGFzcygnZXhwYW5kZWQnKSkge1xyXG4gICAgICAgICAgICBlcnJvclNlY3Rpb24ucmVtb3ZlQ2xhc3MoJ2V4cGFuZGVkJyk7XHJcbiAgICAgICAgICAgIGVycm9yU2VjdGlvbi5hZGRDbGFzcygnY29sbGFwc2VkJyk7XHJcbiAgICAgICAgICAgIHRvZ2dsZUJ0bi5zZXRUZXh0KCdTaG93Jyk7XHJcbiAgICAgICAgICAgIGVycm9yc0xpc3Quc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBlcnJvclNlY3Rpb24ucmVtb3ZlQ2xhc3MoJ2NvbGxhcHNlZCcpO1xyXG4gICAgICAgICAgICBlcnJvclNlY3Rpb24uYWRkQ2xhc3MoJ2V4cGFuZGVkJyk7XHJcbiAgICAgICAgICAgIHRvZ2dsZUJ0bi5zZXRUZXh0KCdIaWRlJyk7XHJcbiAgICAgICAgICAgIGVycm9yc0xpc3Quc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gUmVuZGVyIGVhY2ggZXJyb3IgY2F0ZWdvcnkgKE1pc3NpbmcgVGFjdGljIGNhdGVnb3J5IHJlbW92ZWQpXHJcbiAgICBpZiAodGFjdGljRXJyb3JzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICByZW5kZXJFcnJvckNhdGVnb3J5KGVycm9yc0xpc3QsICdVbmtub3duIFRhY3RpYycsIHRhY3RpY0Vycm9ycywgJ1x1RDgzRFx1REQzNCcpO1xyXG4gICAgfVxyXG4gICAgaWYgKHRlY2huaXF1ZUVycm9ycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgcmVuZGVyRXJyb3JDYXRlZ29yeShlcnJvcnNMaXN0LCAnVGVjaG5pcXVlIEVycm9ycycsIHRlY2huaXF1ZUVycm9ycywgJ1x1RDgzRFx1REQzNCcpO1xyXG4gICAgfVxyXG4gICAgaWYgKG1pc21hdGNoRXJyb3JzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICByZW5kZXJFcnJvckNhdGVnb3J5KGVycm9yc0xpc3QsICdWYWxpZGF0aW9uIE1pc21hdGNoZXMnLCBtaXNtYXRjaEVycm9ycywgJ1x1MjZBMFx1RkUwRicpO1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gRXJyb3IgY2F0ZWdvcnkgcmVuZGVyaW5nXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLyoqXHJcbiAqIFJlbmRlciBhIGNhdGVnb3J5IG9mIHZhbGlkYXRpb24gZXJyb3JzIHdpdGggaGVhZGVyIGFuZCBpdGVtcy5cclxuICpcclxuICogQHBhcmFtIGNvbnRhaW5lciAtIFBhcmVudCBjb250YWluZXIgZWxlbWVudFxyXG4gKiBAcGFyYW0gY2F0ZWdvcnlUaXRsZSAtIERpc3BsYXkgdGl0bGUgZm9yIHRoaXMgY2F0ZWdvcnlcclxuICogQHBhcmFtIGVycm9ycyAtIEFycmF5IG9mIGVycm9ycyBpbiB0aGlzIGNhdGVnb3J5XHJcbiAqIEBwYXJhbSBpY29uIC0gRW1vamkgaWNvbiBmb3IgdGhlIGNhdGVnb3J5IGhlYWRlclxyXG4gKi9cclxuZnVuY3Rpb24gcmVuZGVyRXJyb3JDYXRlZ29yeShcclxuICAgIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsXHJcbiAgICBjYXRlZ29yeVRpdGxlOiBzdHJpbmcsXHJcbiAgICBlcnJvcnM6IFZhbGlkYXRpb25FcnJvcltdLFxyXG4gICAgaWNvbjogc3RyaW5nXHJcbik6IHZvaWQge1xyXG4gICAgY29uc3QgY2F0ZWdvcnlTZWN0aW9uID0gY29udGFpbmVyLmNyZWF0ZURpdignbWl0cmUtZXJyb3ItY2F0ZWdvcnknKTtcclxuICAgIGNvbnN0IGNhdGVnb3J5SGVhZGVyID0gY2F0ZWdvcnlTZWN0aW9uLmNyZWF0ZURpdignbWl0cmUtZXJyb3ItY2F0ZWdvcnktaGVhZGVyJyk7XHJcbiAgICBjYXRlZ29yeUhlYWRlci5jcmVhdGVFbCgnaDQnLCB7XHJcbiAgICAgICAgdGV4dDogYCR7aWNvbn0gJHtjYXRlZ29yeVRpdGxlfSAoJHtlcnJvcnMubGVuZ3RofSlgXHJcbiAgICB9KTtcclxuXHJcbiAgICBlcnJvcnMuZm9yRWFjaChlcnJvciA9PiB7XHJcbiAgICAgICAgY29uc3QgZXJyb3JJdGVtID0gY2F0ZWdvcnlTZWN0aW9uLmNyZWF0ZURpdignbWl0cmUtZXJyb3ItaXRlbScpO1xyXG5cclxuICAgICAgICAvLyBBcHBseSBzZXZlcml0eSBzdHlsaW5nXHJcbiAgICAgICAgaWYgKGlzQ3JpdGljYWxTZXZlcml0eShlcnJvci5zZXZlcml0eSkpIHtcclxuICAgICAgICAgICAgZXJyb3JJdGVtLmFkZENsYXNzKCdtaXRyZS1lcnJvci1jcml0aWNhbCcpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZXJyb3Iuc2V2ZXJpdHkgPT09ICdtaXNtYXRjaCcpIHtcclxuICAgICAgICAgICAgZXJyb3JJdGVtLmFkZENsYXNzKCdtaXRyZS1lcnJvci13YXJuaW5nJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBFcnJvciBoZWFkZXIgd2l0aCB0ZWNobmlxdWUgSUQgYW5kIG5hbWVcclxuICAgICAgICBjb25zdCBlcnJvckhlYWRlciA9IGVycm9ySXRlbS5jcmVhdGVEaXYoJ21pdHJlLWVycm9yLWhlYWRlcicpO1xyXG4gICAgICAgIGVycm9ySGVhZGVyLmNyZWF0ZUVsKCdzcGFuJywge1xyXG4gICAgICAgICAgICB0ZXh0OiBlcnJvci50ZWNobmlxdWVJZCxcclxuICAgICAgICAgICAgY2xzOiAnbWl0cmUtZXJyb3ItdGVjaG5pcXVlLWlkJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGVycm9ySGVhZGVyLmNyZWF0ZUVsKCdzcGFuJywge1xyXG4gICAgICAgICAgICB0ZXh0OiBlcnJvci50ZWNobmlxdWVOYW1lLFxyXG4gICAgICAgICAgICBjbHM6ICdtaXRyZS1lcnJvci10ZWNobmlxdWUtbmFtZSdcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gRXJyb3IgbWVzc2FnZVxyXG4gICAgICAgIGVycm9ySXRlbS5jcmVhdGVEaXYoe1xyXG4gICAgICAgICAgICB0ZXh0OiBlcnJvci5tZXNzYWdlLFxyXG4gICAgICAgICAgICBjbHM6ICdtaXRyZS1lcnJvci1tZXNzYWdlJ1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBDYXJkIHJlZmVyZW5jZXNcclxuICAgICAgICBjb25zdCBjYXJkc1NlY3Rpb24gPSBlcnJvckl0ZW0uY3JlYXRlRGl2KCdtaXRyZS1lcnJvci1jYXJkcycpO1xyXG4gICAgICAgIGNhcmRzU2VjdGlvbi5jcmVhdGVFbCgnc3BhbicsIHtcclxuICAgICAgICAgICAgdGV4dDogJ0FmZmVjdGVkIGNhcmRzOiAnLFxyXG4gICAgICAgICAgICBjbHM6ICdtaXRyZS1lcnJvci1jYXJkcy1sYWJlbCdcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgZXJyb3IuaW9jQ2FyZHMuZm9yRWFjaCgoY2FyZCwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY2FyZEJhZGdlID0gY2FyZHNTZWN0aW9uLmNyZWF0ZUVsKCdzcGFuJywge1xyXG4gICAgICAgICAgICAgICAgY2xzOiAnbWl0cmUtZXJyb3ItY2FyZC1iYWRnZScsXHJcbiAgICAgICAgICAgICAgICBhdHRyOiB7ICd0aXRsZSc6IGBOb2RlIElEOiAke2NhcmQubm9kZUlkfWAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNhcmRCYWRnZS5jcmVhdGVFbCgnc3BhbicsIHtcclxuICAgICAgICAgICAgICAgIHRleHQ6IGNhcmQuaW9jVHlwZSxcclxuICAgICAgICAgICAgICAgIGNsczogJ21pdHJlLWVycm9yLWNhcmQtdHlwZSdcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNhcmRCYWRnZS5jcmVhdGVFbCgnc3BhbicsIHtcclxuICAgICAgICAgICAgICAgIHRleHQ6IGAgJHtjYXJkLmNhcmRJZH1gLFxyXG4gICAgICAgICAgICAgICAgY2xzOiAnbWl0cmUtZXJyb3ItY2FyZC1pZCdcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoaW5kZXggPCBlcnJvci5pb2NDYXJkcy5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgICAgICAgICBjYXJkc1NlY3Rpb24uY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6ICcsICcgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcbiIsICIvKipcclxuICogTWl0cmVNb2RhbFNlYXJjaC50cyAtIFNlYXJjaCBiYXIgcmVuZGVyaW5nIGFuZCBpbnB1dCBoYW5kbGluZ1xyXG4gKlxyXG4gKiBNYW5hZ2VzIHRoZSBzZWFyY2ggVUkgaW4gdGhlIE1JVFJFIG1vZGFsIGhlYWRlcjogaW5wdXQgZmllbGQsIGNsZWFyIGJ1dHRvbixcclxuICogbWF0Y2ggY291bnQgZGlzcGxheSwgYW5kIGRlYm91bmNlZCByZS1yZW5kZXIgb24gaW5wdXQgY2hhbmdlcy5cclxuICovXHJcblxyXG5pbXBvcnQgeyBNaXRyZVRhY3RpYywgU2VhcmNoU3RhdGUgfSBmcm9tICcuL01pdHJlVHlwZXMnO1xyXG5pbXBvcnQgeyBwYXJzZVNlYXJjaFF1ZXJ5LCBtYXRjaGVzU2VhcmNoIH0gZnJvbSAnLi9NaXRyZVNlYXJjaCc7XHJcbmltcG9ydCB7IE1pdHJlTW9kYWxDb250ZXh0IH0gZnJvbSAnLi9NaXRyZU1vZGFsSGVscGVycyc7XHJcbmltcG9ydCB7IHJlbmRlclRhY3RpY1NlY3Rpb24gfSBmcm9tICcuL01pdHJlTW9kYWxUYWN0aWNSZW5kZXJlcic7XHJcbmltcG9ydCB7IERFQlVHIH0gZnJvbSAnLi4vZGVidWcnO1xyXG5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIFNlYXJjaCBVSSBlbGVtZW50c1xyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8qKlxyXG4gKiBSZWZlcmVuY2VzIHRvIHRoZSBzZWFyY2ggYmFyIERPTSBlbGVtZW50cywgc3RvcmVkIGJ5IHRoZSBtb2RhbFxyXG4gKiBmb3Igc3RhdGUgdXBkYXRlcyBkdXJpbmcgc2VhcmNoIGlucHV0IGhhbmRsaW5nLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBTZWFyY2hVSUVsZW1lbnRzIHtcclxuICAgIHNlYXJjaEJhcjogSFRNTElucHV0RWxlbWVudCB8IG51bGw7XHJcbiAgICBzZWFyY2hDbGVhckJ1dHRvbjogSFRNTEVsZW1lbnQgfCBudWxsO1xyXG4gICAgc2VhcmNoTWF0Y2hDb3VudDogSFRNTEVsZW1lbnQgfCBudWxsO1xyXG59XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gU2VhcmNoIGJhciByZW5kZXJpbmdcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vKipcclxuICogUmVuZGVyIHNlYXJjaCBiYXIgaW4gbW9kYWwgaGVhZGVyLlxyXG4gKlxyXG4gKiBAcGFyYW0gaGVhZGVyQ29udGFpbmVyIC0gSGVhZGVyIGNvbnRhaW5lciBlbGVtZW50IHRvIGFkZCBzZWFyY2ggYmFyIHRvXHJcbiAqIEBwYXJhbSBvblNlYXJjaENoYW5nZSAtIENhbGxiYWNrIGludm9rZWQgd2l0aCBuZXcgc2VhcmNoIHF1ZXJ5IGFmdGVyIGRlYm91bmNlXHJcbiAqIEByZXR1cm5zIFNlYXJjaFVJRWxlbWVudHMgZm9yIGV4dGVybmFsIHN0YXRlIG1hbmFnZW1lbnRcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJTZWFyY2hCYXIoXHJcbiAgICBoZWFkZXJDb250YWluZXI6IEhUTUxFbGVtZW50LFxyXG4gICAgb25TZWFyY2hDaGFuZ2U6IChxdWVyeTogc3RyaW5nKSA9PiB2b2lkXHJcbik6IFNlYXJjaFVJRWxlbWVudHMge1xyXG4gICAgY29uc3Qgc2VhcmNoQ29udGFpbmVyID0gaGVhZGVyQ29udGFpbmVyLmNyZWF0ZURpdignbWl0cmUtc2VhcmNoLWNvbnRhaW5lcicpO1xyXG5cclxuICAgIGNvbnN0IHNlYXJjaElucHV0ID0gc2VhcmNoQ29udGFpbmVyLmNyZWF0ZUVsKCdpbnB1dCcsIHtcclxuICAgICAgICB0eXBlOiAndGV4dCcsXHJcbiAgICAgICAgcGxhY2Vob2xkZXI6ICdTZWFyY2ggdGVjaG5pcXVlcyAodXNlIFwicXVvdGVzXCIgZm9yIGV4YWN0IHBocmFzZXMpLi4uJyxcclxuICAgICAgICBjbHM6ICdtaXRyZS1zZWFyY2gtaW5wdXQnXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBjbGVhckJ1dHRvbiA9IHNlYXJjaENvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJywge1xyXG4gICAgICAgIHRleHQ6ICdcdTI3MTUnLFxyXG4gICAgICAgIGNsczogJ21pdHJlLXNlYXJjaC1jbGVhcicsXHJcbiAgICAgICAgYXR0cjogeyAnYXJpYS1sYWJlbCc6ICdDbGVhciBzZWFyY2gnIH1cclxuICAgIH0pO1xyXG4gICAgY2xlYXJCdXR0b24uc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuXHJcbiAgICBjb25zdCBtYXRjaENvdW50ID0gc2VhcmNoQ29udGFpbmVyLmNyZWF0ZURpdignbWl0cmUtc2VhcmNoLW1hdGNoLWNvdW50Jyk7XHJcbiAgICBtYXRjaENvdW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcblxyXG4gICAgLy8gRGVib3VuY2VkIHNlYXJjaCBoYW5kbGVyICgzMDBtcyBkZWxheSlcclxuICAgIGxldCBkZWJvdW5jZVRpbWVyOiBudW1iZXIgfCBudWxsID0gbnVsbDtcclxuICAgIHNlYXJjaElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xyXG4gICAgICAgIGlmIChkZWJvdW5jZVRpbWVyICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dChkZWJvdW5jZVRpbWVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZGVib3VuY2VUaW1lciA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgb25TZWFyY2hDaGFuZ2Uoc2VhcmNoSW5wdXQudmFsdWUpO1xyXG4gICAgICAgIH0sIDMwMCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjbGVhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICBzZWFyY2hJbnB1dC52YWx1ZSA9ICcnO1xyXG4gICAgICAgIG9uU2VhcmNoQ2hhbmdlKCcnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHNlYXJjaElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSkgPT4ge1xyXG4gICAgICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHtcclxuICAgICAgICAgICAgc2VhcmNoSW5wdXQudmFsdWUgPSAnJztcclxuICAgICAgICAgICAgb25TZWFyY2hDaGFuZ2UoJycpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgc2VhcmNoQmFyOiBzZWFyY2hJbnB1dCxcclxuICAgICAgICBzZWFyY2hDbGVhckJ1dHRvbjogY2xlYXJCdXR0b24sXHJcbiAgICAgICAgc2VhcmNoTWF0Y2hDb3VudDogbWF0Y2hDb3VudFxyXG4gICAgfTtcclxufVxyXG5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIFNlYXJjaCBpbnB1dCBoYW5kbGluZ1xyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8qKlxyXG4gKiBIYW5kbGUgc2VhcmNoIGlucHV0IGNoYW5nZXMgYW5kIHJlLXJlbmRlciBjb250ZW50IGFyZWEuXHJcbiAqXHJcbiAqIFBhcnNlcyB0aGUgcXVlcnksIGZpbHRlcnMgdGVjaG5pcXVlcyBieSBtYXRjaCwgcmUtcmVuZGVycyB2aXNpYmxlIHRhY3RpY3MsXHJcbiAqIGFuZCB1cGRhdGVzIHRoZSBtYXRjaCBjb3VudCBkaXNwbGF5LlxyXG4gKlxyXG4gKiBAcGFyYW0gcXVlcnkgLSBSYXcgc2VhcmNoIHF1ZXJ5IHN0cmluZ1xyXG4gKiBAcGFyYW0gbW9kYWxFbCAtIE1vZGFsIHJvb3QgZWxlbWVudCAoZm9yIGZpbmRpbmcgLm1pdHJlLWNvbnRlbnQtYXJlYSlcclxuICogQHBhcmFtIGN1cnJlbnRUYWN0aWNzIC0gQ3VycmVudCB0YWN0aWNzIGFycmF5IHRvIGZpbHRlclxyXG4gKiBAcGFyYW0gY3R4IC0gTW9kYWwgY29udGV4dCBmb3IgcmVuZGVyaW5nXHJcbiAqIEBwYXJhbSBzZWFyY2hVSSAtIFNlYXJjaCBVSSBlbGVtZW50IHJlZmVyZW5jZXNcclxuICogQHJldHVybnMgVGhlIG5ldyBTZWFyY2hTdGF0ZSBmb3Igc3RvcmFnZSBieSB0aGUgY2FsbGVyXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaGFuZGxlU2VhcmNoSW5wdXQoXHJcbiAgICBxdWVyeTogc3RyaW5nLFxyXG4gICAgbW9kYWxFbDogSFRNTEVsZW1lbnQsXHJcbiAgICBjdXJyZW50VGFjdGljczogTWl0cmVUYWN0aWNbXSB8IG51bGwsXHJcbiAgICBjdHg6IE1pdHJlTW9kYWxDb250ZXh0LFxyXG4gICAgc2VhcmNoVUk6IFNlYXJjaFVJRWxlbWVudHNcclxuKTogU2VhcmNoU3RhdGUge1xyXG4gICAgY29uc3Qgc2VhcmNoU3RhdGUgPSBwYXJzZVNlYXJjaFF1ZXJ5KHF1ZXJ5KTtcclxuXHJcbiAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tNaXRyZU1vZGFsU2VhcmNoXSBTZWFyY2ggcXVlcnk6JywgcXVlcnksICctIFBhcnNlZDonLCBzZWFyY2hTdGF0ZSk7XHJcblxyXG4gICAgLy8gVXBkYXRlIGNsZWFyIGJ1dHRvbiB2aXNpYmlsaXR5XHJcbiAgICBpZiAoc2VhcmNoVUkuc2VhcmNoQ2xlYXJCdXR0b24pIHtcclxuICAgICAgICBzZWFyY2hVSS5zZWFyY2hDbGVhckJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gc2VhcmNoU3RhdGUuaXNBY3RpdmUgPyAnYmxvY2snIDogJ25vbmUnO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFJlLXJlbmRlciBjb250ZW50IGFyZWEgd2l0aCBzZWFyY2ggZmlsdGVyXHJcbiAgICBjb25zdCBjb250YWluZXIgPSBtb2RhbEVsLnF1ZXJ5U2VsZWN0b3IoJy5taXRyZS1jb250ZW50LWFyZWEnKSBhcyBIVE1MRWxlbWVudDtcclxuICAgIGlmIChjb250YWluZXIgJiYgY3VycmVudFRhY3RpY3MpIHtcclxuICAgICAgICBjb250YWluZXIuZW1wdHkoKTtcclxuXHJcbiAgICAgICAgLy8gVXBkYXRlIGNvbnRleHQgd2l0aCBuZXcgc2VhcmNoIHN0YXRlXHJcbiAgICAgICAgY29uc3QgdXBkYXRlZEN0eCA9IHsgLi4uY3R4LCBjdXJyZW50U2VhcmNoU3RhdGU6IHNlYXJjaFN0YXRlIH07XHJcblxyXG4gICAgICAgIGxldCBtYXRjaENvdW50ID0gMDtcclxuICAgICAgICBjdXJyZW50VGFjdGljcy5mb3JFYWNoKHRhY3RpYyA9PiB7XHJcbiAgICAgICAgICAgIC8vIEZpbHRlciB0ZWNobmlxdWVzIGJ5IHNlYXJjaFxyXG4gICAgICAgICAgICBjb25zdCBtYXRjaGluZ1RlY2huaXF1ZXMgPSB0YWN0aWMudGVjaG5pcXVlcy5maWx0ZXIodGVjaCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXNlYXJjaFN0YXRlLmlzQWN0aXZlKSByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gbWF0Y2hlc1NlYXJjaCh0ZWNoLCBzZWFyY2hTdGF0ZSwgY3R4LnN1YnRlY2huaXF1ZXNNYXApO1xyXG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoLm1hdGNoZWQpIG1hdGNoQ291bnQrKztcclxuICAgICAgICAgICAgICAgIHJldHVybiBtYXRjaC5tYXRjaGVkO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIE9ubHkgcmVuZGVyIHRhY3RpYyBpZiBpdCBoYXMgbWF0Y2hpbmcgdGVjaG5pcXVlc1xyXG4gICAgICAgICAgICBpZiAobWF0Y2hpbmdUZWNobmlxdWVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGZpbHRlcmVkVGFjdGljID0geyAuLi50YWN0aWMsIHRlY2huaXF1ZXM6IG1hdGNoaW5nVGVjaG5pcXVlcyB9O1xyXG4gICAgICAgICAgICAgICAgcmVuZGVyVGFjdGljU2VjdGlvbihjb250YWluZXIsIGZpbHRlcmVkVGFjdGljLCB1cGRhdGVkQ3R4LCBzZWFyY2hTdGF0ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gVXBkYXRlIG1hdGNoIGNvdW50IGRpc3BsYXlcclxuICAgICAgICBpZiAoc2VhcmNoVUkuc2VhcmNoTWF0Y2hDb3VudCkge1xyXG4gICAgICAgICAgICBpZiAoc2VhcmNoU3RhdGUuaXNBY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgIHNlYXJjaFVJLnNlYXJjaE1hdGNoQ291bnQudGV4dENvbnRlbnQgPSBgJHttYXRjaENvdW50fSB0ZWNobmlxdWUke21hdGNoQ291bnQgIT09IDEgPyAncycgOiAnJ30gZm91bmRgO1xyXG4gICAgICAgICAgICAgICAgc2VhcmNoVUkuc2VhcmNoTWF0Y2hDb3VudC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHNlYXJjaFVJLnNlYXJjaE1hdGNoQ291bnQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gU2hvdyBcIm5vIHJlc3VsdHNcIiBtZXNzYWdlIGlmIG5vIG1hdGNoZXNcclxuICAgICAgICBpZiAobWF0Y2hDb3VudCA9PT0gMCAmJiBzZWFyY2hTdGF0ZS5pc0FjdGl2ZSkge1xyXG4gICAgICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHtcclxuICAgICAgICAgICAgICAgIGNsczogJ21pdHJlLW5vLXJlc3VsdHMnLFxyXG4gICAgICAgICAgICAgICAgdGV4dDogJ05vIHRlY2huaXF1ZXMgbWF0Y2ggeW91ciBzZWFyY2gnXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gc2VhcmNoU3RhdGU7XHJcbn1cclxuIiwgImltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IElPQ0NhbnZhc1BsdWdpbiBmcm9tICcuLi9tYWluJztcclxuXHJcbi8qKlxyXG4gKiBEZWZhdWx0IHNldHRpbmdzIHZhbHVlcyBhcHBsaWVkIHdoZW4gdGhlIHBsdWdpbiBsb2FkcyBmb3IgdGhlIGZpcnN0IHRpbWVcclxuICogb3Igd2hlbiBhIHNldHRpbmcgaGFzIG5vdCB5ZXQgYmVlbiBjb25maWd1cmVkIGJ5IHRoZSB1c2VyLlxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IElPQ0NhbnZhc1BsdWdpblNldHRpbmdzID0ge1xyXG4gIGNhcmRTaXplOiAnbWVkaXVtJyxcclxuICBzaG93VGltZWxpbmVCdXR0b246IHRydWUsXHJcbn07XHJcblxyXG4vKipcclxuICogVHlwZWQgaW50ZXJmYWNlIGZvciBhbGwgcGVyc2lzdGVkIHBsdWdpbiBzZXR0aW5ncy5cclxuICogT2JzaWRpYW4gc2VyaWFsaXNlcyB0aGlzIHRvIGBkYXRhLmpzb25gIGluc2lkZSB0aGUgcGx1Z2luIGRpcmVjdG9yeS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgSU9DQ2FudmFzUGx1Z2luU2V0dGluZ3Mge1xyXG4gIC8qKiBEZWZhdWx0IHdpZHRoIHByZXNldCBmb3IgbmV3bHktY3JlYXRlZCBJT0MgY2FyZHMgKCdzbWFsbCcgfCAnbWVkaXVtJyB8ICdsYXJnZScpLiAqL1xyXG4gIGNhcmRTaXplOiBzdHJpbmc7XHJcbiAgLyoqIFdoZXRoZXIgdGhlIGZsb2F0aW5nIHRpbWVsaW5lIGJ1dHRvbiBpcyBzaG93biBvbiBjYW52YXMgdmlld3MuICovXHJcbiAgc2hvd1RpbWVsaW5lQnV0dG9uOiBib29sZWFuO1xyXG59XHJcblxyXG4vKipcclxuICogU2V0dGluZ3MgdGFiIHJlbmRlcmVkIGluIE9ic2lkaWFuJ3MgU2V0dGluZ3MgLT4gQ29tbXVuaXR5IFBsdWdpbnMgc2VjdGlvbi5cclxuICogVGhpcyBpcyB0aGUgc2luZ2xlIGF1dGhvcml0YXRpdmUgc2V0dGluZ3MgVUkgZm9yIHRoZSBwbHVnaW4uXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUGx1Z2luU2V0dGluZ3MgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuICBwbHVnaW46IElPQ0NhbnZhc1BsdWdpbjtcclxuXHJcbiAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogSU9DQ2FudmFzUGx1Z2luKSB7XHJcbiAgICBzdXBlcihhcHAsIHBsdWdpbik7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICB9XHJcblxyXG4gIGRpc3BsYXkoKTogdm9pZCB7XHJcbiAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG4gICAgY29udGFpbmVyRWwuZW1wdHkoKTtcclxuICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ0lPQyBDYW52YXMgUGx1Z2luIFNldHRpbmdzJyB9KTtcclxuXHJcbiAgICAvLyBDYXJkIHNpemUgZHJvcGRvd24gLSBjb250cm9scyB0aGUgZGVmYXVsdCBkaW1lbnNpb25zIG9mIG5ldyBJT0MgY2FyZHNcclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZSgnRGVmYXVsdCBjYXJkIHNpemUnKVxyXG4gICAgICAuc2V0RGVzYygnU2V0IHRoZSBkZWZhdWx0IHNpemUgZm9yIElPQyBjYXJkcycpXHJcbiAgICAgIC5hZGREcm9wZG93bihkcm9wZG93biA9PiBkcm9wZG93blxyXG4gICAgICAgIC5hZGRPcHRpb24oJ3NtYWxsJywgJ1NtYWxsJylcclxuICAgICAgICAuYWRkT3B0aW9uKCdtZWRpdW0nLCAnTWVkaXVtJylcclxuICAgICAgICAuYWRkT3B0aW9uKCdsYXJnZScsICdMYXJnZScpXHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmNhcmRTaXplKVxyXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY2FyZFNpemUgPSB2YWx1ZTtcclxuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICk7XHJcblxyXG4gICAgLy8gVGltZWxpbmUgYnV0dG9uIHRvZ2dsZSAtIGhpZGVzIG9yIHNob3dzIHRoZSBmbG9hdGluZyBjbG9jayBidXR0b24gb24gY2FudmFzIHZpZXdzXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoJ1Nob3cgdGltZWxpbmUgYnV0dG9uJylcclxuICAgICAgLnNldERlc2MoJ0Rpc3BsYXkgdGltZWxpbmUgYnV0dG9uIGluIGNhbnZhcyB0b29sYmFyJylcclxuICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dUaW1lbGluZUJ1dHRvbilcclxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBib29sZWFuKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93VGltZWxpbmVCdXR0b24gPSB2YWx1ZTtcclxuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICk7XHJcbiAgfVxyXG59XHJcbiIsICIvKipcclxuICogQ2FudmFzVG9vbGJhci50cyAtIENhbnZhcyBjb250cm9sIGJhciBidXR0b24gaW5qZWN0aW9uXHJcbiAqXHJcbiAqIEluamVjdHMgcGx1Z2luIGJ1dHRvbnMgKFRpbWVsaW5lLCBJT0MgQ2FyZHMsIFJlZHVjZSwgTUlUUkUpIGludG8gT2JzaWRpYW4nc1xyXG4gKiBuYXRpdmUgYC5jYW52YXMtY29udHJvbHNgIGJhci4gVXNlcyBgLmlvYy10b29sYmFyYCBjbGFzcyBhcyBhXHJcbiAqIGR1cGxpY2F0ZS1pbmplY3Rpb24gZ3VhcmQuIEVhY2ggYnV0dG9uIGlzIGEgYC5jYW52YXMtY29udHJvbC1pdGVtYCB3aXRoXHJcbiAqIGEgYC5jbGlja2FibGUtaWNvbmAgY2hpbGQgdG8gbWF0Y2ggbmF0aXZlIE9ic2lkaWFuIHN0eWxpbmcuXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgQXBwLCBJdGVtVmlldyB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgREVCVUcgfSBmcm9tICcuLi9kZWJ1Zyc7XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gU1ZHIGljb24gY29uc3RhbnRzICgxOHgxOCBzdHJva2UtYmFzZWQpXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLyoqIENsb2NrIGljb24gZm9yIHRoZSBUaW1lbGluZSBidXR0b24uICovXHJcbmNvbnN0IFRJTUVMSU5FX1NWRyA9ICc8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjE4XCIgaGVpZ2h0PVwiMThcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxMFwiLz48cG9seWxpbmUgcG9pbnRzPVwiMTIgNiAxMiAxMiAxNiAxNFwiLz48L3N2Zz4nO1xyXG5cclxuLyoqIE1vbml0b3IgaWNvbiBmb3IgdGhlIElPQyBDYXJkcyBidXR0b24uICovXHJcbmNvbnN0IENBUkRTX1NWRyA9ICc8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjE4XCIgaGVpZ2h0PVwiMThcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+PHJlY3QgeD1cIjJcIiB5PVwiM1wiIHdpZHRoPVwiMjBcIiBoZWlnaHQ9XCIxNFwiIHJ4PVwiMlwiIHJ5PVwiMlwiLz48bGluZSB4MT1cIjhcIiB5MT1cIjIxXCIgeDI9XCIxNlwiIHkyPVwiMjFcIi8+PGxpbmUgeDE9XCIxMlwiIHkxPVwiMTdcIiB4Mj1cIjEyXCIgeTI9XCIyMVwiLz48L3N2Zz4nO1xyXG5cclxuLyoqIFNocmluayBpY29uIGZvciB0aGUgUmVkdWNlIFZpZXcgdG9nZ2xlIGJ1dHRvbi4gKi9cclxuY29uc3QgUkVEVUNFX1NWRyA9ICc8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjE4XCIgaGVpZ2h0PVwiMThcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+PHBvbHlsaW5lIHBvaW50cz1cIjQgMTQgMTAgMTQgMTAgMjBcIi8+PHBvbHlsaW5lIHBvaW50cz1cIjIwIDEwIDE0IDEwIDE0IDRcIi8+PGxpbmUgeDE9XCIxNFwiIHkxPVwiMTBcIiB4Mj1cIjIxXCIgeTI9XCIzXCIvPjxsaW5lIHgxPVwiM1wiIHkxPVwiMjFcIiB4Mj1cIjEwXCIgeTI9XCIxNFwiLz48L3N2Zz4nO1xyXG5cclxuLyoqIFNtYWxsZXIgY2FyZCBpY29uIHdpdGggYXJyb3cgZm9yIHRoZSBDaGlsZCBDYXJkIGJ1dHRvbi4gKi9cclxuY29uc3QgQ0hJTERfQ0FSRF9TVkcgPSAnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCIxOFwiIGhlaWdodD1cIjE4XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPjxyZWN0IHg9XCI1XCIgeT1cIjZcIiB3aWR0aD1cIjE2XCIgaGVpZ2h0PVwiMTJcIiByeD1cIjJcIiByeT1cIjJcIi8+PGxpbmUgeDE9XCI5XCIgeTE9XCIyMlwiIHgyPVwiMTVcIiB5Mj1cIjIyXCIvPjxsaW5lIHgxPVwiMTJcIiB5MT1cIjE4XCIgeDI9XCIxMlwiIHkyPVwiMjJcIi8+PHBvbHlsaW5lIHBvaW50cz1cIjEgMTIgNCA5IDcgMTJcIi8+PC9zdmc+JztcclxuXHJcbi8qKiBDcm9zc2hhaXIgaWNvbiBmb3IgdGhlIE1JVFJFIEFUVCZDSyBNYXBwZXIgYnV0dG9uLiAqL1xyXG5jb25zdCBNSVRSRV9TVkcgPSAnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCIxOFwiIGhlaWdodD1cIjE4XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPjxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMTBcIi8+PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCI2XCIvPjxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMlwiLz48L3N2Zz4nO1xyXG5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIENvbnRleHQgaW50ZXJmYWNlXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLyoqXHJcbiAqIENhbGxiYWNrIGJ1bmRsZSBwYXNzZWQgYnkgbWFpbi50cyB0byBkZWNvdXBsZSB0b29sYmFyIGZyb20gcGx1Z2luIGludGVybmFscy5cclxuICogRWFjaCBjYWxsYmFjayB3aXJlcyBhIGJ1dHRvbiB0byBpdHMgY29ycmVzcG9uZGluZyBwbHVnaW4gYWN0aW9uLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBUb29sYmFyQ29udGV4dCB7XHJcbiAgICBhcHA6IEFwcDtcclxuICAgIG9uVGltZWxpbmU6ICgpID0+IHZvaWQ7XHJcbiAgICBvbkFkZENhcmQ6ICgpID0+IHZvaWQ7XHJcbiAgICBvbkNoaWxkQ2FyZDogKCkgPT4gdm9pZDtcclxuICAgIG9uUmVkdWNlOiAoKSA9PiBib29sZWFuOyAgIC8vIFJldHVybnMgbmV3IGlzUmVkdWNlZFZpZXcgc3RhdGVcclxuICAgIG9uTWl0cmU6ICgpID0+IHZvaWQ7XHJcbiAgICBpc1JlZHVjZWRWaWV3OiBib29sZWFuO1xyXG59XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gQnV0dG9uIGZhY3RvcnlcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vKipcclxuICogQ3JlYXRlcyBhIHNpbmdsZSB0b29sYmFyIGJ1dHRvbiB3aXRoIFNWRyBpY29uIGZvciB0aGUgY2FudmFzIGNvbnRyb2wgYmFyLlxyXG4gKlxyXG4gKiBAcGFyYW0gbGFiZWwgLSBUb29sdGlwIC8gYXJpYS1sYWJlbCB0ZXh0XHJcbiAqIEBwYXJhbSBzdmdJY29uIC0gSW5saW5lIFNWRyBtYXJrdXAgc3RyaW5nXHJcbiAqIEBwYXJhbSBvbkNsaWNrIC0gQ2xpY2sgaGFuZGxlclxyXG4gKiBAcmV0dXJucyBUaGUgYnV0dG9uJ3Mgcm9vdCBET00gZWxlbWVudFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVRvb2xiYXJCdXR0b24obGFiZWw6IHN0cmluZywgc3ZnSWNvbjogc3RyaW5nLCBvbkNsaWNrOiAoKSA9PiB2b2lkKTogSFRNTEVsZW1lbnQge1xyXG4gICAgY29uc3QgaXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgaXRlbS5jbGFzc05hbWUgPSAnY2FudmFzLWNvbnRyb2wtaXRlbSc7XHJcbiAgICBpdGVtLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGxhYmVsKTtcclxuICAgIGl0ZW0uc2V0QXR0cmlidXRlKCd0aXRsZScsIGxhYmVsKTtcclxuICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkNsaWNrKTtcclxuXHJcbiAgICBjb25zdCBpY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBpY29uLmNsYXNzTmFtZSA9ICdjbGlja2FibGUtaWNvbic7XHJcbiAgICBpY29uLmlubmVySFRNTCA9IHN2Z0ljb247XHJcbiAgICBpdGVtLmFwcGVuZENoaWxkKGljb24pO1xyXG5cclxuICAgIHJldHVybiBpdGVtO1xyXG59XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gVG9vbGJhciBpbmplY3Rpb25cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vKipcclxuICogSW5qZWN0cyBjb250cm9sIGJ1dHRvbnMgaW50byBPYnNpZGlhbidzIG5hdGl2ZSBjYW52YXMgY29udHJvbCBiYXIuXHJcbiAqXHJcbiAqIEJ1dHRvbnMgYWRkZWQ6XHJcbiAqICAgLSBUaW1lbGluZTogb3BlbnMgdGhlIGF0dGFjay10aW1lbGluZSBtb2RhbFxyXG4gKiAgIC0gSU9DIENhcmRzOiBvcGVucyB0aGUgSU9DIGNhcmQgc2VsZWN0b3JcclxuICogICAtIFJlZHVjZTogdG9nZ2xlcyBjb21wYWN0IHZpZXdcclxuICogICAtIE1JVFJFOiBvcGVucyB0aGUgTUlUUkUgQVRUJkNLIG1hcHBlclxyXG4gKlxyXG4gKiBVc2VzIGAuaW9jLXRvb2xiYXJgIGNsYXNzIGFzIGR1cGxpY2F0ZS1pbmplY3Rpb24gZ3VhcmQuXHJcbiAqIFdyYXBwZWQgaW4gdHJ5L2NhdGNoIHNvIGZhaWx1cmVzIG5ldmVyIHRha2UgZG93biB0aGUgcGx1Z2luLlxyXG4gKlxyXG4gKiBAcGFyYW0gY3R4IC0gVG9vbGJhckNvbnRleHQgd2l0aCBhcHAgcmVmZXJlbmNlIGFuZCBidXR0b24gY2FsbGJhY2tzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gYWRkQ2FudmFzQnV0dG9ucyhjdHg6IFRvb2xiYXJDb250ZXh0KTogdm9pZCB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSBjdHguYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKEl0ZW1WaWV3KTtcclxuXHJcbiAgICAgICAgLy8gT25seSBpbmplY3QgaW50byBjYW52YXMgdmlld3NcclxuICAgICAgICBpZiAoIWFjdGl2ZVZpZXcgfHwgYWN0aXZlVmlldy5nZXRWaWV3VHlwZSgpICE9PSAnY2FudmFzJykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBjYW52YXNWaWV3ID0gYWN0aXZlVmlldy5jb250YWluZXJFbDtcclxuICAgICAgICBpZiAoIWNhbnZhc1ZpZXcpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gRmluZCBPYnNpZGlhbidzIG5hdGl2ZSBjYW52YXMgY29udHJvbHMgYmFyXHJcbiAgICAgICAgY29uc3QgY2FudmFzQ29udHJvbHMgPSBjYW52YXNWaWV3LnF1ZXJ5U2VsZWN0b3IoJy5jYW52YXMtY29udHJvbHMnKTtcclxuICAgICAgICBpZiAoIWNhbnZhc0NvbnRyb2xzKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFByZXZlbnQgZHVwbGljYXRlIGluamVjdGlvblxyXG4gICAgICAgIGlmIChjYW52YXNDb250cm9scy5xdWVyeVNlbGVjdG9yKCcuaW9jLXRvb2xiYXInKSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tDYW52YXNUb29sYmFyXSBJbmplY3RpbmcgdG9vbGJhciBidXR0b25zJyk7XHJcblxyXG4gICAgICAgIGNvbnN0IGlvY1Rvb2xiYXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBpb2NUb29sYmFyLmNsYXNzTmFtZSA9ICdpb2MtdG9vbGJhcic7XHJcblxyXG4gICAgICAgIGNvbnN0IHRpbWVsaW5lQnRuID0gY3JlYXRlVG9vbGJhckJ1dHRvbignU2hvdyBBdHRhY2sgVGltZWxpbmVzJywgVElNRUxJTkVfU1ZHLCBjdHgub25UaW1lbGluZSk7XHJcbiAgICAgICAgY29uc3QgcGFyZW50QnRuID0gY3JlYXRlVG9vbGJhckJ1dHRvbignUGFyZW50IENhcmQnLCBDQVJEU19TVkcsIGN0eC5vbkFkZENhcmQpO1xyXG4gICAgICAgIGNvbnN0IGNoaWxkQnRuID0gY3JlYXRlVG9vbGJhckJ1dHRvbignQ2hpbGQgQ2FyZCcsIENISUxEX0NBUkRfU1ZHLCBjdHgub25DaGlsZENhcmQpO1xyXG5cclxuICAgICAgICBjb25zdCByZWR1Y2VCdG4gPSBjcmVhdGVUb29sYmFyQnV0dG9uKCdUb2dnbGUgUmVkdWNlIFZpZXcnLCBSRURVQ0VfU1ZHLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld1N0YXRlID0gY3R4Lm9uUmVkdWNlKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGljb24gPSByZWR1Y2VCdG4ucXVlcnlTZWxlY3RvcignLmNsaWNrYWJsZS1pY29uJyk7XHJcbiAgICAgICAgICAgIGlmIChpY29uKSBpY29uLmNsYXNzTGlzdC50b2dnbGUoJ2lzLWFjdGl2ZScsIG5ld1N0YXRlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgbWl0cmVCdG4gPSBjcmVhdGVUb29sYmFyQnV0dG9uKCdNSVRSRSBBVFQmQ0sgTWFwcGVyJywgTUlUUkVfU1ZHLCBjdHgub25NaXRyZSk7XHJcblxyXG4gICAgICAgIGlvY1Rvb2xiYXIuYXBwZW5kQ2hpbGQodGltZWxpbmVCdG4pO1xyXG4gICAgICAgIGlvY1Rvb2xiYXIuYXBwZW5kQ2hpbGQocGFyZW50QnRuKTtcclxuICAgICAgICBpb2NUb29sYmFyLmFwcGVuZENoaWxkKGNoaWxkQnRuKTtcclxuICAgICAgICBpb2NUb29sYmFyLmFwcGVuZENoaWxkKHJlZHVjZUJ0bik7XHJcbiAgICAgICAgaW9jVG9vbGJhci5hcHBlbmRDaGlsZChtaXRyZUJ0bik7XHJcbiAgICAgICAgY2FudmFzQ29udHJvbHMuYXBwZW5kQ2hpbGQoaW9jVG9vbGJhcik7XHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAvLyBCdXR0b24gaW5qZWN0aW9uIGlzIG5vbi1jcml0aWNhbDsgbG9nIGFuZCBjb250aW51ZVxyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0lPQyBDYW52YXM6IGZhaWxlZCB0byBpbmplY3QgY2FudmFzIGJ1dHRvbnMnLCBlcnIpO1xyXG4gICAgfVxyXG59XHJcbiIsICIvKipcclxuICogQ2FudmFzU2VsZWN0aW9uLnRzIC0gRXh0cmFjdCBNSVRSRSB0ZWNobmlxdWUgZnJvbSBzZWxlY3RlZCBjYW52YXMgbm9kZVxyXG4gKlxyXG4gKiBSZWFkcyB0aGUgY3VycmVudGx5IHNlbGVjdGVkIGNhbnZhcyBub2RlIGFuZCBwYXJzZXMgaXRzIElPQyBjYXJkIHRleHRcclxuICogdG8gZXh0cmFjdCBhIE1JVFJFIHRlY2huaXF1ZSBJRC4gVXNlZCBieSB0aGUgTUlUUkUgdG9vbGJhciBidXR0b24gdG9cclxuICogcHJlLWhpZ2hsaWdodCB0aGUgdGVjaG5pcXVlIG9mIHRoZSBzZWxlY3RlZCBjYXJkIHdoZW4gdGhlIG1vZGFsIG9wZW5zLlxyXG4gKlxyXG4gKiBUcmllcyB0aHJlZSBhcHByb2FjaGVzIHRvIGRldGVjdCBzZWxlY3Rpb24gKGludGVybmFsIEFQSSBpcyB1bmRvY3VtZW50ZWQpOlxyXG4gKiAgIDEuIGNhbnZhcy5zZWxlY3Rpb24gKFNldCBvZiBub2RlIElEcylcclxuICogICAyLiBjYW52YXMuc2VsZWN0ZWROb2RlcyAoYXJyYXkgb3IgU2V0IG9mIG5vZGUgb2JqZWN0cylcclxuICogICAzLiBJdGVyYXRpbmcgY2FudmFzLm5vZGVzIGFuZCBjaGVja2luZyBub2RlLnNlbGVjdGVkIGZsYWdcclxuICovXHJcblxyXG5pbXBvcnQgeyBBcHAsIEl0ZW1WaWV3IH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBwYXJzZUlPQ05vZGUgfSBmcm9tICcuLi9wYXJzaW5nL0lPQ1BhcnNlcic7XHJcbmltcG9ydCB7IERFQlVHIH0gZnJvbSAnLi4vZGVidWcnO1xyXG5cclxuLyoqXHJcbiAqIEV4dHJhY3QgTUlUUkUgdGVjaG5pcXVlIElEIGZyb20gdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBjYW52YXMgbm9kZS5cclxuICpcclxuICogQHBhcmFtIGFwcCAtIE9ic2lkaWFuIEFwcCBpbnN0YW5jZVxyXG4gKiBAcmV0dXJucyBUZWNobmlxdWUgSUQgKGUuZy4sIFwiVDE1NjYuMDAxXCIpIG9yIG51bGwgaWYgbm8gc2VsZWN0aW9uIG9yIG5vIHRlY2huaXF1ZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFNlbGVjdGVkVGVjaG5pcXVlSWQoYXBwOiBBcHApOiBzdHJpbmcgfCBudWxsIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IGFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShJdGVtVmlldyk7XHJcbiAgICAgICAgaWYgKCFhY3RpdmVWaWV3IHx8IGFjdGl2ZVZpZXcuZ2V0Vmlld1R5cGUoKSAhPT0gJ2NhbnZhcycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBjYW52YXMgPSAoYWN0aXZlVmlldyBhcyBhbnkpLmNhbnZhcztcclxuICAgICAgICBpZiAoIWNhbnZhcykge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFRyeSBtdWx0aXBsZSBhcHByb2FjaGVzIHRvIGZpbmQgc2VsZWN0ZWQgbm9kZVxyXG4gICAgICAgIGxldCBzZWxlY3RlZE5vZGU6IGFueSA9IG51bGw7XHJcblxyXG4gICAgICAgIC8vIEFwcHJvYWNoIDE6IGNhbnZhcy5zZWxlY3Rpb24gKGxpa2VseSBhIFNldClcclxuICAgICAgICBpZiAoY2FudmFzLnNlbGVjdGlvbiAmJiBjYW52YXMuc2VsZWN0aW9uLnNpemUgPiAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZpcnN0U2VsZWN0ZWRJZCA9IEFycmF5LmZyb20oY2FudmFzLnNlbGVjdGlvbilbMF07XHJcbiAgICAgICAgICAgIHNlbGVjdGVkTm9kZSA9IGNhbnZhcy5ub2Rlcy5nZXQoZmlyc3RTZWxlY3RlZElkKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEFwcHJvYWNoIDI6IGNhbnZhcy5zZWxlY3RlZE5vZGVzXHJcbiAgICAgICAgaWYgKCFzZWxlY3RlZE5vZGUgJiYgY2FudmFzLnNlbGVjdGVkTm9kZXMpIHtcclxuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoY2FudmFzLnNlbGVjdGVkTm9kZXMpICYmIGNhbnZhcy5zZWxlY3RlZE5vZGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkTm9kZSA9IGNhbnZhcy5zZWxlY3RlZE5vZGVzWzBdO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGNhbnZhcy5zZWxlY3RlZE5vZGVzLnNpemUgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZE5vZGUgPSBBcnJheS5mcm9tKGNhbnZhcy5zZWxlY3RlZE5vZGVzKVswXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQXBwcm9hY2ggMzogSXRlcmF0ZSBub2RlcyBhbmQgY2hlY2sgc2VsZWN0ZWQgZmxhZ1xyXG4gICAgICAgIGlmICghc2VsZWN0ZWROb2RlICYmIGNhbnZhcy5ub2Rlcykge1xyXG4gICAgICAgICAgICBjYW52YXMubm9kZXMuZm9yRWFjaCgobm9kZTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAobm9kZS5zZWxlY3RlZCB8fCBub2RlLmlzU2VsZWN0ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZE5vZGUgPSBub2RlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXNlbGVjdGVkTm9kZSB8fCAhc2VsZWN0ZWROb2RlLnRleHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBQYXJzZSBJT0MgY2FyZCB1c2luZyBleGlzdGluZyBwYXJzZXJcclxuICAgICAgICBjb25zdCBwYXJzZWREYXRhID0gcGFyc2VJT0NOb2RlKHNlbGVjdGVkTm9kZSk7XHJcbiAgICAgICAgaWYgKCFwYXJzZWREYXRhIHx8ICFwYXJzZWREYXRhLnRlY2huaXF1ZSB8fCAhcGFyc2VkRGF0YS50ZWNobmlxdWUudHJpbSgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gRXh0cmFjdCB0ZWNobmlxdWUgSURcclxuICAgICAgICBjb25zdCB0ZWNobmlxdWUgPSBwYXJzZWREYXRhLnRlY2huaXF1ZS50b1VwcGVyQ2FzZSgpO1xyXG4gICAgICAgIGNvbnN0IGlkTWF0Y2ggPSB0ZWNobmlxdWUubWF0Y2goL1RcXGR7NH0oPzpcXC5cXGR7M30pPy9pKTtcclxuICAgICAgICBpZiAoaWRNYXRjaCkge1xyXG4gICAgICAgICAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tDYW52YXNTZWxlY3Rpb25dIFNlbGVjdGVkIHRlY2huaXF1ZTonLCBpZE1hdGNoWzBdLnRvVXBwZXJDYXNlKCkpO1xyXG4gICAgICAgICAgICByZXR1cm4gaWRNYXRjaFswXS50b1VwcGVyQ2FzZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignW0NhbnZhc1NlbGVjdGlvbl0gRXJyb3IgZ2V0dGluZyBzZWxlY3RlZCB0ZWNobmlxdWU6JywgZXJyKTtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxufVxyXG4iLCAiLyoqXHJcbiAqIFJlZHVjZVZpZXcudHMgLSBDb21wYWN0L3JlZHVjZWQgdmlldyB0b2dnbGUgZm9yIElPQyBjYXJkc1xyXG4gKlxyXG4gKiBUb2dnbGVzIGJldHdlZW4gbm9ybWFsIGFuZCBjb21wYWN0IHZpZXcgZm9yIGFsbCBJT0MgY2FyZHMgb24gdGhlIGFjdGl2ZVxyXG4gKiBjYW52YXMuIENvbXBhY3QgdmlldyBoaWRlcyBjYXJkIGhlYWRlcnMgYW5kIG1ldGFkYXRhICh2aWEgQ1NTIGNsYXNzKVxyXG4gKiBhbmQgcmVzaXplcyBhbGwgdGV4dCBub2RlcyB0byA2MHB4IGhlaWdodCAodmlhIGNhbnZhcyBBUEkpLlxyXG4gKlxyXG4gKiBUd28tcGFydCBpbXBsZW1lbnRhdGlvbjpcclxuICogICAxLiBDU1M6IGAuaW9jLXJlZHVjZWRgIGNsYXNzIG9uIGNhbnZhcyB3cmFwcGVyIGhpZGVzIGNvbnRlbnRcclxuICogICAyLiBKUzogY2FudmFzIG5vZGUgaGVpZ2h0cyBzdG9yZWQgaW4gYF9pb2NPcmlnaW5hbEhlaWdodGAsIHJlc2l6ZWQgdG8gNjBweFxyXG4gKi9cclxuXHJcbmltcG9ydCB7IEFwcCwgSXRlbVZpZXcgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IERFQlVHIH0gZnJvbSAnLi4vZGVidWcnO1xyXG5cclxuLyoqXHJcbiAqIFRvZ2dsZSB0aGUgcmVkdWNlZC9jb21wYWN0IHZpZXcgZm9yIElPQyBjYXJkcyBvbiB0aGUgYWN0aXZlIGNhbnZhcy5cclxuICpcclxuICogQWxnb3JpdGhtOlxyXG4gKiAgIDEuIFRvZ2dsZSBpc1JlZHVjZWRWaWV3IGZsYWcgKHBhc3NlZCBieSByZWZlcmVuY2UgdmlhIHJldHVybiB2YWx1ZSlcclxuICogICAyLiBBZGQvcmVtb3ZlIGAuaW9jLXJlZHVjZWRgIGNsYXNzIG9uIGNhbnZhcyB3cmFwcGVyXHJcbiAqICAgMy4gTG9vcCB0aHJvdWdoIGFsbCBjYW52YXMgdGV4dCBub2RlczpcclxuICogICAgICAtIElmIHJlZHVjaW5nOiBzdG9yZSBvcmlnaW5hbCBoZWlnaHQgaW4gYF9pb2NPcmlnaW5hbEhlaWdodGAsIHJlc2l6ZSB0byA2MHB4XHJcbiAqICAgICAgLSBJZiByZXN0b3Jpbmc6IHJlYWQgc3RvcmVkIGhlaWdodCwgcmVzdG9yZSBvcmlnaW5hbCBkaW1lbnNpb25zXHJcbiAqICAgNC4gQ2FsbCBjYW52YXMucmVxdWVzdEZyYW1lKCkgYW5kIGNhbnZhcy5yZXF1ZXN0U2F2ZSgpIHRvIHBlcnNpc3RcclxuICpcclxuICogV2h5IDYwcHg6IGVub3VnaCB0byBzaG93IGEgc2luZ2xlIGxpbmUgb2YgdGV4dCB3aXRoIHBhZGRpbmcuXHJcbiAqXHJcbiAqIEBwYXJhbSBhcHAgLSBPYnNpZGlhbiBBcHAgaW5zdGFuY2VcclxuICogQHBhcmFtIGlzUmVkdWNlZFZpZXcgLSBDdXJyZW50IHN0YXRlICh0cnVlID0gY3VycmVudGx5IHJlZHVjZWQpXHJcbiAqIEByZXR1cm5zIE5ldyBzdGF0ZSBhZnRlciB0b2dnbGUgKHRydWUgPSBub3cgcmVkdWNlZClcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB0b2dnbGVSZWR1Y2VWaWV3KGFwcDogQXBwLCBpc1JlZHVjZWRWaWV3OiBib29sZWFuKTogYm9vbGVhbiB7XHJcbiAgICBjb25zdCBhY3RpdmVWaWV3ID0gYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKEl0ZW1WaWV3KTtcclxuICAgIGlmICghYWN0aXZlVmlldyB8fCBhY3RpdmVWaWV3LmdldFZpZXdUeXBlKCkgIT09ICdjYW52YXMnKSByZXR1cm4gaXNSZWR1Y2VkVmlldztcclxuXHJcbiAgICBjb25zdCBjYW52YXMgPSAoYWN0aXZlVmlldyBhcyBhbnkpLmNhbnZhcztcclxuICAgIGlmICghY2FudmFzKSByZXR1cm4gaXNSZWR1Y2VkVmlldztcclxuXHJcbiAgICBjb25zdCBuZXdTdGF0ZSA9ICFpc1JlZHVjZWRWaWV3O1xyXG5cclxuICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW1JlZHVjZVZpZXddIFRvZ2dsaW5nIHJlZHVjZSB2aWV3OicsIGlzUmVkdWNlZFZpZXcsICctPicsIG5ld1N0YXRlKTtcclxuXHJcbiAgICAvLyBBZGQvcmVtb3ZlIENTUyBjbGFzcyBvbiB0aGUgY2FudmFzIHdyYXBwZXIgZm9yIENTUy1iYXNlZCBjb250ZW50IGhpZGluZ1xyXG4gICAgY29uc3Qgd3JhcHBlckVsID0gY2FudmFzLndyYXBwZXJFbDtcclxuICAgIGlmICh3cmFwcGVyRWwpIHtcclxuICAgICAgICBpZiAobmV3U3RhdGUpIHtcclxuICAgICAgICAgICAgd3JhcHBlckVsLmNsYXNzTGlzdC5hZGQoJ2lvYy1yZWR1Y2VkJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgd3JhcHBlckVsLmNsYXNzTGlzdC5yZW1vdmUoJ2lvYy1yZWR1Y2VkJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFJlc2l6ZSBhbGwgdGV4dCBub2Rlc1xyXG4gICAgaWYgKGNhbnZhcy5ub2Rlcykge1xyXG4gICAgICAgIGNhbnZhcy5ub2Rlcy5mb3JFYWNoKChub2RlOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKCFub2RlLnRleHQpIHJldHVybjsgLy8gb25seSB0ZXh0IG5vZGVzIChJT0MgY2FyZHMgaGF2ZSB0ZXh0KVxyXG4gICAgICAgICAgICBpZiAobmV3U3RhdGUpIHtcclxuICAgICAgICAgICAgICAgIC8vIFN0b3JlIG9yaWdpbmFsIGRpbWVuc2lvbnMgYmVmb3JlIHJlZHVjaW5nXHJcbiAgICAgICAgICAgICAgICBpZiAoIW5vZGUuX2lvY09yaWdpbmFsSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5faW9jT3JpZ2luYWxIZWlnaHQgPSBub2RlLmhlaWdodDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIFJlc2l6ZSB0byBjb21wYWN0IHNpbmdsZS1saW5lIGhlaWdodFxyXG4gICAgICAgICAgICAgICAgaWYgKG5vZGUucmVzaXplKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5yZXNpemUoeyB3aWR0aDogbm9kZS53aWR0aCwgaGVpZ2h0OiA2MCB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5oZWlnaHQgPSA2MDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIFJlc3RvcmUgb3JpZ2luYWwgaGVpZ2h0XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvcmlnaW5hbEggPSBub2RlLl9pb2NPcmlnaW5hbEhlaWdodCB8fCA0MDA7XHJcbiAgICAgICAgICAgICAgICBpZiAobm9kZS5yZXNpemUpIHtcclxuICAgICAgICAgICAgICAgICAgICBub2RlLnJlc2l6ZSh7IHdpZHRoOiBub2RlLndpZHRoLCBoZWlnaHQ6IG9yaWdpbmFsSCB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5oZWlnaHQgPSBvcmlnaW5hbEg7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjYW52YXMucmVxdWVzdEZyYW1lKCk7XHJcbiAgICBjYW52YXMucmVxdWVzdFNhdmUoKTtcclxuXHJcbiAgICByZXR1cm4gbmV3U3RhdGU7XHJcbn1cclxuIiwgIi8qKlxyXG4gKiBJT0NDYXJkQ3JlYXRpb24udHMgLSBJT0MgY2FyZCBjcmVhdGlvbiBvbiBjYW52YXNcclxuICpcclxuICogUHJvdmlkZXMgdGhlIGNhcmQgc2VsZWN0b3IgbW9kYWwgdHJpZ2dlciBhbmQgdGhlIGFjdHVhbCBjYXJkIGNyZWF0aW9uXHJcbiAqIGxvZ2ljLiBDcmVhdGVzIElPQyBjYXJkcyBhcyBjYW52YXMgdGV4dCBub2RlcyB3aXRoIG1hcmtkb3duK0hUTUwgY29udGVudFxyXG4gKiBnZW5lcmF0ZWQgYnkgUmVuZGVySU9DQ2FyZHMuXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgQXBwLCBJdGVtVmlldywgTm90aWNlIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBJT0NfVFlQRVMgfSBmcm9tICcuLi90eXBlcy9JT0NDYXJkc1R5cGVzJztcclxuaW1wb3J0IHsgUmVuZGVySU9DQ2FyZHNNb2RhbCB9IGZyb20gJy4vUmVuZGVySU9DQ2FyZHNNb2RhbCc7XHJcbmltcG9ydCB7IGNyZWF0ZUNhcmRDb250ZW50IH0gZnJvbSAnLi9SZW5kZXJJT0NDYXJkcyc7XHJcbmltcG9ydCB7IERFQlVHIH0gZnJvbSAnLi4vZGVidWcnO1xyXG5cclxuLyoqXHJcbiAqIE9wZW5zIHRoZSBJT0MgY2FyZCBzZWxlY3RvciBtb2RhbC4gVGhlIGNhbGxiYWNrIGNyZWF0ZXMgdGhlIGNhcmQgb25cclxuICogdGhlIGFjdGl2ZSBjYW52YXMuXHJcbiAqXHJcbiAqIEBwYXJhbSBhcHAgLSBPYnNpZGlhbiBBcHAgaW5zdGFuY2VcclxuICogQHBhcmFtIGNyZWF0ZUNhcmQgLSBDYWxsYmFjayB0byBjcmVhdGUgYSBjYXJkIGFmdGVyIHR5cGUgc2VsZWN0aW9uXHJcbiAqIEBwYXJhbSB0aXRsZSAtIE9wdGlvbmFsIG1vZGFsIHRpdGxlIChcIlNlbGVjdCBQYXJlbnQgSU9DIFR5cGVcIiBvciBcIlNlbGVjdCBDaGlsZCBJT0MgVHlwZVwiKVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIG9wZW5JT0NDYXJkU2VsZWN0b3IoYXBwOiBBcHAsIGNyZWF0ZUNhcmQ6IChpb2NUeXBlSWQ6IHN0cmluZywgb3NUeXBlPzogc3RyaW5nKSA9PiB2b2lkLCB0aXRsZT86IHN0cmluZyk6IHZvaWQge1xyXG4gICAgbmV3IFJlbmRlcklPQ0NhcmRzTW9kYWwoXHJcbiAgICAgICAgYXBwLFxyXG4gICAgICAgIElPQ19UWVBFUyxcclxuICAgICAgICAoaW9jVHlwZUlkOiBzdHJpbmcsIG9zVHlwZT86IHN0cmluZykgPT4ge1xyXG4gICAgICAgICAgICBjcmVhdGVDYXJkKGlvY1R5cGVJZCwgb3NUeXBlKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRpdGxlXHJcbiAgICApLm9wZW4oKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZXMgYW4gSU9DIGNhcmQgb24gdGhlIGFjdGl2ZSBjYW52YXMuXHJcbiAqXHJcbiAqIENhcmQgQ3JlYXRpb24gRmxvdzpcclxuICogICAxLiBWYWxpZGF0ZSBjYW52YXMgdmlldyAtIGVuc3VyZSB1c2VyIGlzIGluIGEgY2FudmFzIHZpZXdcclxuICogICAyLiBBY2Nlc3MgaW50ZXJuYWwgY2FudmFzIEFQSSB2aWEgKHZpZXcgYXMgYW55KS5jYW52YXNcclxuICogICAzLiBHZW5lcmF0ZSB0aW1lc3RhbXAtYmFzZWQgY2FyZCBJRCAoI1lZWVlNTURELUhITU0pXHJcbiAqICAgNC4gR2VuZXJhdGUgY2FyZCBjb250ZW50IHZpYSBSZW5kZXJJT0NDYXJkcy5jcmVhdGVDYXJkQ29udGVudCgpXHJcbiAqICAgNS4gQ3JlYXRlIGNhbnZhcyB0ZXh0IG5vZGUgYXQgcmFuZG9tIHBvc2l0aW9uIHdpdGhpbiA0MDB4NDAwIGFyZWFcclxuICogICA2LiBQZXJzaXN0IHRvIGRpc2sgdmlhIGNhbnZhcy5yZXF1ZXN0U2F2ZSgpXHJcbiAqXHJcbiAqIEBwYXJhbSBhcHAgLSBPYnNpZGlhbiBBcHAgaW5zdGFuY2VcclxuICogQHBhcmFtIGlvY1R5cGVJZCAtIFNuYWtlX2Nhc2UgSU9DIHR5cGUga2V5IGZyb20gSU9DX1RZUEVTIChlLmcuLCBcImlwX2FkZHJlc3NcIilcclxuICogQHBhcmFtIG9zVHlwZSAtIE9wdGlvbmFsIE9TIHZhcmlhbnQgZm9yIGhvc3RuYW1lIGNhcmRzXHJcbiAqIEBwYXJhbSBpc0NoaWxkIC0gSWYgdHJ1ZSwgY2FyZCBnZXRzIFtDXSBwcmVmaXg7IGlmIGZhbHNlLCBnZXRzIFtQXSBwcmVmaXhcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVJT0NDYXJkKGFwcDogQXBwLCBpb2NUeXBlSWQ6IHN0cmluZywgb3NUeXBlPzogc3RyaW5nLCBpc0NoaWxkOiBib29sZWFuID0gZmFsc2UpOiB2b2lkIHtcclxuICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSBhcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoSXRlbVZpZXcpO1xyXG4gICAgaWYgKCFhY3RpdmVWaWV3IHx8IGFjdGl2ZVZpZXcuZ2V0Vmlld1R5cGUoKSAhPT0gJ2NhbnZhcycpIHtcclxuICAgICAgICBuZXcgTm90aWNlKCdQbGVhc2Ugb3BlbiBhIGNhbnZhcyBmaXJzdCcpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBBY2Nlc3MgaW50ZXJuYWwgY2FudmFzIEFQSSAobm90IHB1YmxpY2x5IGRvY3VtZW50ZWQgYnkgT2JzaWRpYW4pXHJcbiAgICBjb25zdCBjYW52YXMgPSAoYWN0aXZlVmlldyBhcyBhbnkpLmNhbnZhcztcclxuICAgIGlmICghY2FudmFzKSB7XHJcbiAgICAgICAgbmV3IE5vdGljZSgnUGxlYXNlIG9wZW4gYSBjYW52YXMgZmlyc3QnKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgaW9jVHlwZSA9IElPQ19UWVBFU1tpb2NUeXBlSWRdO1xyXG4gICAgaWYgKCFpb2NUeXBlKSB7XHJcbiAgICAgICAgbmV3IE5vdGljZSgnVW5rbm93biBJT0MgdHlwZTogJyArIGlvY1R5cGVJZCk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEdlbmVyYXRlIHRpbWVzdGFtcC1iYXNlZCBjYXJkIElEIChmb3JtYXQ6ICNZWVlZTU1ERC1ISE1NKVxyXG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcclxuICAgIGNvbnN0IHllYXIgPSBub3cuZ2V0RnVsbFllYXIoKTtcclxuICAgIGNvbnN0IG1vbnRoID0gU3RyaW5nKG5vdy5nZXRNb250aCgpICsgMSkucGFkU3RhcnQoMiwgJzAnKTtcclxuICAgIGNvbnN0IGRheSA9IFN0cmluZyhub3cuZ2V0RGF0ZSgpKS5wYWRTdGFydCgyLCAnMCcpO1xyXG4gICAgY29uc3QgaG91cnMgPSBTdHJpbmcobm93LmdldEhvdXJzKCkpLnBhZFN0YXJ0KDIsICcwJyk7XHJcbiAgICBjb25zdCBtaW51dGVzID0gU3RyaW5nKG5vdy5nZXRNaW51dGVzKCkpLnBhZFN0YXJ0KDIsICcwJyk7XHJcbiAgICBjb25zdCBjYXJkSWQgPSBgIyR7eWVhcn0ke21vbnRofSR7ZGF5fS0ke2hvdXJzfSR7bWludXRlc31gO1xyXG5cclxuICAgIGlmIChERUJVRykgY29uc29sZS5kZWJ1ZygnW0NhcmRDcmVhdGlvbl0gQ3JlYXRpbmcgY2FyZDonLCBpb2NUeXBlSWQsIGNhcmRJZCk7XHJcblxyXG4gICAgLy8gR2VuZXJhdGUgbWFya2Rvd24gY29udGVudCBmb3IgdGhlIElPQyBjYXJkXHJcbiAgICBjb25zdCBjb250ZW50ID0gY3JlYXRlQ2FyZENvbnRlbnQoaW9jVHlwZSwgaW9jVHlwZUlkLCBvc1R5cGUgfHwgbnVsbCwgY2FyZElkLCBpc0NoaWxkKTtcclxuXHJcbiAgICAvLyBDcmVhdGUgdGV4dCBub2RlIG9uIGNhbnZhcyB3aXRoIHJhbmRvbSBwb3NpdGlvblxyXG4gICAgY2FudmFzLmNyZWF0ZVRleHROb2RlKHtcclxuICAgICAgICBwb3M6IHsgeDogTWF0aC5yYW5kb20oKSAqIDQwMCwgeTogTWF0aC5yYW5kb20oKSAqIDQwMCB9LCAgLy8gUmFuZG9tIHBsYWNlbWVudFxyXG4gICAgICAgIHNpemU6IHsgd2lkdGg6IDQwMCwgaGVpZ2h0OiA0MDAgfSwgIC8vIFN0YW5kYXJkIGNhcmQgc2l6ZVxyXG4gICAgICAgIHRleHQ6IGNvbnRlbnQgIC8vIE1hcmtkb3duIHdpdGggSFRNTCBoZWFkZXJcclxuICAgIH0pO1xyXG4gICAgY2FudmFzLnJlcXVlc3RTYXZlKCk7ICAvLyBQZXJzaXN0IHRvIC5jYW52YXMgZmlsZVxyXG5cclxuICAgIG5ldyBOb3RpY2UoYENyZWF0ZWQgJHtpb2NUeXBlLm5hbWV9IGNhcmRgKTtcclxufVxyXG4iLCAiLyoqXG4gKiBSZW5kZXJJT0NDYXJkc01vZGFsLnRzIC0gSU9DIHR5cGUgcGlja2VyIG1vZGFsLlxuICpcbiAqIFByZXNlbnRzIGEgMy1jb2x1bW4gZ3JpZCBvZiBhbGwgcmVnaXN0ZXJlZCBJT0MgdHlwZXMuIFdoZW4gdGhlIGFuYWx5c3QgY2xpY2tzXG4gKiBhIHR5cGUsIHRoZSBtb2RhbCBmaXJlcyB0aGUgYG9uU2VsZWN0YCBjYWxsYmFjayB3aXRoIHRoZSBjaG9zZW4gdHlwZSBJRCBhbmRcbiAqIChmb3IgSG9zdG5hbWUpIHRoZSBPUyB2YXJpYW50LCB0aGVuIGNsb3Nlcy4gVGhlIHBhcmVudCBjb2RlIChtYWluLnRzKSB1c2VzXG4gKiB0aGUgY2FsbGJhY2sgdG8gY3JlYXRlIHRoZSBhY3R1YWwgY2FudmFzIHRleHQgbm9kZSB2aWEgUmVuZGVySU9DQ2FyZHMuXG4gKlxuICogU3BlY2lhbCBjYXNlOiBjbGlja2luZyBcIkhvc3RuYW1lXCIgZG9lcyBOT1QgaW1tZWRpYXRlbHkgc2VsZWN0IC0tIGl0IHJlcGxhY2VzXG4gKiB0aGUgZ3JpZCB3aXRoIGFuIE9TIHN1Yi1zZWxlY3RvciAoV2luZG93cyBXb3Jrc3RhdGlvbiAvIFdpbmRvd3MgU2VydmVyIC9cbiAqIG1hY09TIC8gTGludXgpIHNvIHRoZSBjYXJkIGdldHMgdGhlIGNvcnJlY3QgcGxhdGZvcm0gaWNvbi5cbiAqXG4gKiBVc2VzIElPQ0ZpZWxkIGFuZCBJT0NDYXJkc1R5cGVzIGludGVyZmFjZXMgaW1wb3J0ZWQgZnJvbSBJT0NDYXJkc1R5cGVzLnRzLlxuICovXG5pbXBvcnQgeyBBcHAsIE1vZGFsIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgSU9DRmllbGQsIElPQ0NhcmRzVHlwZXMgfSBmcm9tICcuLi90eXBlcy9JT0NDYXJkc1R5cGVzJztcblxuLyoqIENhbGxiYWNrIHNpZ25hdHVyZTogcmVjZWl2ZXMgdGhlIHNlbGVjdGVkIElPQyB0eXBlIGtleSBhbmQgb3B0aW9uYWwgT1MgdmFyaWFudC4gKi9cbnR5cGUgT25TZWxlY3RDYWxsYmFjayA9IChpb2NUeXBlSWQ6IHN0cmluZywgb3NUeXBlPzogc3RyaW5nKSA9PiB2b2lkO1xuXG5leHBvcnQgY2xhc3MgUmVuZGVySU9DQ2FyZHNNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBwcml2YXRlIGlvY1R5cGVzOiBJT0NDYXJkc1R5cGVzO1xuICAgIHByaXZhdGUgb25TZWxlY3Q6IE9uU2VsZWN0Q2FsbGJhY2s7XG4gICAgcHJpdmF0ZSB0aXRsZTogc3RyaW5nO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIGlvY1R5cGVzOiBJT0NDYXJkc1R5cGVzLCBvblNlbGVjdDogT25TZWxlY3RDYWxsYmFjaywgdGl0bGU/OiBzdHJpbmcpIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5pb2NUeXBlcyA9IGlvY1R5cGVzO1xuICAgICAgICB0aGlzLm9uU2VsZWN0ID0gb25TZWxlY3Q7XG4gICAgICAgIHRoaXMudGl0bGUgPSB0aXRsZSB8fCAnU2VsZWN0IElPQyBUeXBlJztcbiAgICB9XG5cbiAgICAvKiogQnVpbGRzIHRoZSBwcmltYXJ5IElPQyB0eXBlIGdyaWQgdmlldy4gKi9cbiAgICBvbk9wZW4oKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuXG4gICAgICAgIHRoaXMubW9kYWxFbC5jbGFzc0xpc3QuYWRkKCdpb2MtdHlwZS1zZWxlY3Rvci1tb2RhbCcpO1xuICAgICAgICB0aGlzLm1vZGFsRWwuc3R5bGUubWF4V2lkdGggPSAnOTAwcHgnO1xuICAgICAgICB0aGlzLm1vZGFsRWwuc3R5bGUud2lkdGggPSAnOTB2dyc7XG5cbiAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogdGhpcy50aXRsZSB9KTtcblxuICAgICAgICBjb25zdCBjb250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRGl2KCdpb2MtdHlwZS1jb250YWluZXInKTtcblxuICAgICAgICBjb25zdCB0eXBlQ291bnQgPSBPYmplY3Qua2V5cyh0aGlzLmlvY1R5cGVzKS5sZW5ndGg7XG4gICAgICAgIC8vIENhbGN1bGF0ZSBjb2x1bW5zOiBhaW0gZm9yIHJvdWdobHkgc3F1YXJlIGdyaWRcbiAgICAgICAgY29uc3QgY29scyA9IE1hdGgubWluKE1hdGguY2VpbChNYXRoLnNxcnQodHlwZUNvdW50KSksIDUpO1xuICAgICAgICBjb250YWluZXIuc3R5bGUuZ3JpZFRlbXBsYXRlQ29sdW1ucyA9IGByZXBlYXQoJHtjb2xzfSwgMWZyKWA7XG5cbiAgICAgICAgT2JqZWN0LmtleXModGhpcy5pb2NUeXBlcykuZm9yRWFjaCgoaW9jVHlwZUlkOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGlvY1R5cGUgPSB0aGlzLmlvY1R5cGVzW2lvY1R5cGVJZF07XG4gICAgICAgICAgICBjb25zdCBidXR0b24gPSBjb250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgY2xzOiAnaW9jLXR5cGUtYnV0dG9uJyB9KTtcblxuICAgICAgICAgICAgLy8gQ29sb3ItY29kZWQgbGVmdCBib3JkZXIgbGV0cyBhbmFseXN0cyB2aXN1YWxseSBhc3NvY2lhdGUgdHlwZXMgd2l0aFxuICAgICAgICAgICAgLy8gdGhlIHNhbWUgY29sb3JzIHVzZWQgb24gdGltZWxpbmUgaXRlbXMgYW5kIGNhcmQgaGVhZGVyc1xuICAgICAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnZGF0YS1pb2MtdHlwZScsIGlvY1R5cGVJZCk7XG4gICAgICAgICAgICBidXR0b24uc3R5bGUuYm9yZGVyTGVmdCA9IGA0cHggc29saWQgJHtpb2NUeXBlLmNvbG9yfWA7XG5cbiAgICAgICAgICAgIGNvbnN0IGljb25Db250YWluZXIgPSBidXR0b24uY3JlYXRlRGl2KCdpb2MtYnV0dG9uLWljb24nKTtcbiAgICAgICAgICAgIGljb25Db250YWluZXIuaW5uZXJIVE1MID0gaW9jVHlwZS5zdmc7XG5cbiAgICAgICAgICAgIGNvbnN0IHRleHRDb250YWluZXIgPSBidXR0b24uY3JlYXRlRGl2KCdpb2MtYnV0dG9uLXRleHQnKTtcbiAgICAgICAgICAgIHRleHRDb250YWluZXIudGV4dENvbnRlbnQgPSBpb2NUeXBlLm5hbWU7XG5cbiAgICAgICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBIb3N0bmFtZSBuZWVkcyBhIHNlY29uZCBzdGVwIC0tIHBpY2tpbmcgdGhlIE9TIHZhcmlhbnRcbiAgICAgICAgICAgICAgICBpZiAoaW9jVHlwZUlkID09PSAnaG9zdG5hbWUnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd09TU2VsZWN0b3IoaW9jVHlwZUlkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uU2VsZWN0KGlvY1R5cGVJZCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVwbGFjZXMgdGhlIHR5cGUgZ3JpZCB3aXRoIGFuIE9TIHNlbGVjdG9yIHN1Yi12aWV3LlxuICAgICAqIE9ubHkgcmVhY2hhYmxlIHdoZW4gaW9jVHlwZUlkID09PSAnaG9zdG5hbWUnIGFuZCB0aGUgdHlwZSBoYXMgb3NfaWNvbnMuXG4gICAgICovXG4gICAgcHJpdmF0ZSBzaG93T1NTZWxlY3Rvcihpb2NUeXBlSWQ6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XG5cbiAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ1NlbGVjdCBPcGVyYXRpbmcgU3lzdGVtJyB9KTtcbiAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdwJywgeyB0ZXh0OiAnQ2hvb3NlIHRoZSBvcGVyYXRpbmcgc3lzdGVtIGZvciB0aGlzIGhvc3RuYW1lOicgfSk7XG5cbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gY29udGVudEVsLmNyZWF0ZURpdignb3Mtc2VsZWN0b3ItY29udGFpbmVyJyk7XG4gICAgICAgIGNvbnN0IGlvY1R5cGUgPSB0aGlzLmlvY1R5cGVzW2lvY1R5cGVJZF07XG5cbiAgICAgICAgaWYgKGlvY1R5cGUub3NfaWNvbnMpIHtcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKGlvY1R5cGUub3NfaWNvbnMpLmZvckVhY2goKG9zVHlwZTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb3NCdXR0b24gPSBjb250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgY2xzOiAnb3MtdHlwZS1idXR0b24nIH0pO1xuICAgICAgICAgICAgICAgIG9zQnV0dG9uLnNldEF0dHJpYnV0ZSgnZGF0YS1vcy10eXBlJywgb3NUeXBlKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGljb25Db250YWluZXIgPSBvc0J1dHRvbi5jcmVhdGVEaXYoJ29zLWJ1dHRvbi1pY29uJyk7XG4gICAgICAgICAgICAgICAgaWNvbkNvbnRhaW5lci5pbm5lckhUTUwgPSBpb2NUeXBlLm9zX2ljb25zIVtvc1R5cGVdO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgdGV4dENvbnRhaW5lciA9IG9zQnV0dG9uLmNyZWF0ZURpdignb3MtYnV0dG9uLXRleHQnKTtcbiAgICAgICAgICAgICAgICB0ZXh0Q29udGFpbmVyLnRleHRDb250ZW50ID0gb3NUeXBlLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgb3NUeXBlLnNsaWNlKDEpO1xuXG4gICAgICAgICAgICAgICAgb3NCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25TZWxlY3QoaW9jVHlwZUlkLCBvc1R5cGUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEJhY2sgYnV0dG9uIGxldHMgdGhlIGFuYWx5c3QgcmV0dXJuIHRvIHRoZSBtYWluIGdyaWQgd2l0aG91dCBjbG9zaW5nXG4gICAgICAgIGNvbnN0IGJhY2tCdXR0b24gPSBjb250ZW50RWwuY3JlYXRlRWwoJ2J1dHRvbicsIHtcbiAgICAgICAgICAgIHRleHQ6ICdcXHUyMTkwIEJhY2sgdG8gSU9DIFR5cGVzJyxcbiAgICAgICAgICAgIGNsczogJ2JhY2stYnV0dG9uJ1xuICAgICAgICB9KTtcblxuICAgICAgICBiYWNrQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XG4gICAgICAgICAgICB0aGlzLm9uT3BlbigpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBvbkNsb3NlKCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XG4gICAgfVxufSIsICIvKipcclxuICogUmVuZGVySU9DQ2FyZHMudHMgLSBHZW5lcmF0ZXMgdGhlIG1hcmtkb3duIGNvbnRlbnQgZm9yIG5ldyBJT0MgY2FudmFzIGNhcmRzLlxyXG4gKlxyXG4gKiBFYWNoIGNhcmQgaXMgYSBzdGFuZGFyZCBPYnNpZGlhbiBjYW52YXMgdGV4dCBub2RlIHdob3NlIGNvbnRlbnQgaXMgYSBtaXggb2ZcclxuICogSFRNTCAoZm9yIHRoZSBzdHlsZWQgaGVhZGVyIHdpdGggaW5saW5lIFNWRyBpY29uKSBhbmQgbWFya2Rvd24gKGZvciB0aGVcclxuICogYW5hbHlzdC1lZGl0YWJsZSBmaWVsZHMpLiBUaGlzIGh5YnJpZCBmb3JtYXQgbGV0cyB0aGUgY2FudmFzIHJlbmRlcmVyIGRpc3BsYXlcclxuICogYSByaWNoIGhlYWRlciB3aGlsZSBrZWVwaW5nIHRoZSBmaWVsZCB2YWx1ZXMgaW4gcGxhaW4gbWFya2Rvd24gdGhhdCB0aGVcclxuICogdGltZWxpbmUgcHJvY2Vzc29ycyBjYW4gcGFyc2Ugd2l0aCByZWdleC5cclxuICpcclxuICogQ2FyZCBzdHJ1Y3R1cmU6XHJcbiAqICAgMS4gSFRNTCBoZWFkZXIgZGl2IC0tIGdyYWRpZW50IGJhY2tncm91bmQsIGNvbG9yZWQgYm9yZGVyLCBpbmxpbmUgU1ZHICsgdHlwZSBuYW1lXHJcbiAqICAgMi4gVHlwZS1zcGVjaWZpYyBmaWVsZHMgLS0gZWFjaCByZW5kZXJlZCBhcyBhIGJvbGQgbGFiZWwgd2l0aCBpbmxpbmUgdmFsdWVcclxuICogICAzLiBGaXhlZCBmb3JlbnNpYyBmaWVsZHMgLS0gVGltZSBvZiBFdmVudCAoYXV0by1maWxsZWQpLCBTcGx1bmsgUXVlcnksXHJcbiAqICAgICAgTUlUUkUgVGFjdGljLCBhbmQgTUlUUkUgVGVjaG5pcXVlIChsZWZ0IGJsYW5rIGZvciB0aGUgYW5hbHlzdClcclxuICovXHJcbmltcG9ydCB7IElPQ0ZpZWxkIH0gZnJvbSAnLi4vdHlwZXMvSU9DQ2FyZHNUeXBlcyc7XHJcblxyXG4vKipcclxuICogQnVpbGRzIHRoZSBmdWxsIG1hcmtkb3duK0hUTUwgc3RyaW5nIGZvciBhIG5ldyBJT0MgY2FyZC5cclxuICogQHBhcmFtIGlvY1R5cGUgIC0gVGhlIElPQ0ZpZWxkIGRlZmluaXRpb24gZnJvbSB0aGUgdHlwZSByZWdpc3RyeVxyXG4gKiBAcGFyYW0gaW9jVHlwZUlkIC0gVGhlIHNuYWtlX2Nhc2Uga2V5IChuZWVkZWQgdG8gZGV0ZWN0IFwiaG9zdG5hbWVcIiBzcGVjaWFsIGNhc2UpXHJcbiAqIEBwYXJhbSBvc1R5cGUgICAtIElmIGlvY1R5cGVJZCBpcyBcImhvc3RuYW1lXCIsIHdoaWNoIE9TIHZhcmlhbnQgd2FzIHNlbGVjdGVkXHJcbiAqIEBwYXJhbSBjYXJkSWQgICAtIFRpbWVzdGFtcC1iYXNlZCB1bmlxdWUgSUQgZm9yIHRoZSBjYXJkIChmb3JtYXQ6ICNZWVlZTU1ERC1ISE1NKVxyXG4gKiBAcGFyYW0gaXNDaGlsZCAgLSBJZiB0cnVlLCBjYXJkIGdldHMgW0NdIHByZWZpeDsgaWYgZmFsc2UsIGdldHMgW1BdIHByZWZpeFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUNhcmRDb250ZW50KFxyXG4gICAgaW9jVHlwZTogSU9DRmllbGQsXHJcbiAgICBpb2NUeXBlSWQ6IHN0cmluZyxcclxuICAgIG9zVHlwZTogc3RyaW5nIHwgbnVsbCA9IG51bGwsXHJcbiAgICBjYXJkSWQ6IHN0cmluZyA9ICcnLFxyXG4gICAgaXNDaGlsZDogYm9vbGVhbiA9IGZhbHNlXHJcbik6IHN0cmluZyB7XHJcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xyXG4gICAgY29uc3QgdGltZXN0YW1wID0gbm93LnRvSVNPU3RyaW5nKCkucmVwbGFjZSgnVCcsICcgJykuc3Vic3RyaW5nKDAsIDE5KTtcclxuXHJcbiAgICAvLyBGb3IgaG9zdG5hbWUgY2FyZHMsIHN3YXAgaW4gdGhlIE9TLXNwZWNpZmljIGljb24gaWYgdGhlIGFuYWx5c3QgcGlja2VkIG9uZVxyXG4gICAgbGV0IGljb25TdmcgPSBpb2NUeXBlLnN2ZztcclxuICAgIGlmIChpb2NUeXBlSWQgPT09ICdob3N0bmFtZScgJiYgb3NUeXBlICYmIGlvY1R5cGUub3NfaWNvbnMpIHtcclxuICAgICAgICBpY29uU3ZnID0gaW9jVHlwZS5vc19pY29uc1tvc1R5cGUgYXMga2V5b2YgdHlwZW9mIGlvY1R5cGUub3NfaWNvbnNdIHx8IGlvY1R5cGUuc3ZnO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFJvbGUgYmFkZ2U6IFtQXSBmb3IgcGFyZW50IGNhcmRzLCBbQ10gZm9yIGNoaWxkIGNhcmRzXHJcbiAgICBjb25zdCByb2xlTGFiZWwgPSBpc0NoaWxkID8gJ1tDXScgOiAnW1BdJztcclxuICAgIGNvbnN0IHJvbGVDbGFzcyA9IGlzQ2hpbGQgPyAnaW9jLXJvbGUtY2hpbGQnIDogJ2lvYy1yb2xlLXBhcmVudCc7XHJcbiAgICBjb25zdCByb2xlQmFkZ2UgPSBgPHNwYW4gY2xhc3M9XCJpb2MtY2FyZC1yb2xlICR7cm9sZUNsYXNzfVwiIHN0eWxlPVwiZm9udC1zaXplOiAxMnB4OyBmb250LXdlaWdodDogNzAwOyBwYWRkaW5nOiAycHggNnB4OyBib3JkZXItcmFkaXVzOiA0cHg7IG1hcmdpbi1yaWdodDogNHB4O1wiPiR7cm9sZUxhYmVsfTwvc3Bhbj5gO1xyXG5cclxuICAgIC8vIFRoZSBIVE1MIGhlYWRlciB1c2VzIGlubGluZSBzdHlsZXMgc28gdGhlIGNhcmQgaXMgc2VsZi1jb250YWluZWQgLS0gbm9cclxuICAgIC8vIGV4dGVybmFsIENTUyBuZWVkZWQgZm9yIHRoZSBoZWFkZXIgdG8gcmVuZGVyIGNvcnJlY3RseSBpbnNpZGUgT2JzaWRpYW4nc1xyXG4gICAgLy8gY2FudmFzIG1hcmtkb3duIHByZXZpZXcuXHJcbiAgICBsZXQgY29udGVudCA9IGA8ZGl2IGNsYXNzPVwiaW9jLWNhcmQtY29udGFpbmVyXCI+PGRpdiBjbGFzcz1cImlvYy1jYXJkLWhlYWRlclwiXHJcbiAgICAgICAgc3R5bGU9XCJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDE2cHg7IG1hcmdpbi1ib3R0b206IDMwcHg7IHBhZGRpbmc6IDIwcHg7XHJcbiAgICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgJHtpb2NUeXBlLmNvbG9yfTIyLCB0cmFuc3BhcmVudCk7XHJcbiAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4OyBib3JkZXItYm90dG9tOiAzcHggc29saWQgJHtpb2NUeXBlLmNvbG9yfTtcIj5cclxuICAgICAgICA8ZGl2IGNsYXNzPVwiaW9jLWhlYWRlci1jb250ZW50XCIgc3R5bGU9XCJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDE2cHg7IHdpZHRoOiAxMDAlO1wiPlxyXG4gICAgICAgIDxkaXYgY2xhc3M9XCJpb2MtaWNvblwiIHN0eWxlPVwiZmxleC1zaHJpbms6IDA7XCI+JHtpY29uU3ZnfTwvZGl2PjxoMiBzdHlsZT1cIm1hcmdpbjogMDtcclxuICAgICAgICBjb2xvcjogJHtpb2NUeXBlLmNvbG9yfTsgZm9udC1zaXplOiAyNHB4OyBmb250LXdlaWdodDogNzAwO1wiPiR7cm9sZUJhZGdlfSR7aW9jVHlwZS5uYW1lfTwvaDI+XHJcbiAgICAgICAgPHNwYW4gY2xhc3M9XCJpb2MtY2FyZC1pZFwiIHN0eWxlPVwibWFyZ2luLWxlZnQ6IGF1dG87IHBhZGRpbmc6IDJweCA4cHg7IGZvbnQtc2l6ZTogMTFweDsgZm9udC13ZWlnaHQ6IDYwMDsgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpOyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGJvcmRlci1yYWRpdXM6IDRweDsgZm9udC1mYW1pbHk6IHZhcigtLWZvbnQtbW9ub3NwYWNlKTtcIj4ke2NhcmRJZH08L3NwYW4+XHJcbiAgICAgICAgPC9kaXY+PCEtLSBJT0NfQ0FSRF9JRDoke2NhcmRJZH0gLS0+PC9kaXY+PC9kaXY+XFxuYDtcclxuXHJcbiAgICAvLyBUeXBlLXNwZWNpZmljIGZpZWxkczogZmllbGQgbGFiZWwgd2l0aCBzcGFjZSBmb3IgdXNlciB0byBmaWxsIGluIHZhbHVlc1xyXG4gICAgLy8gRGVsaW1pdGVycyAoLS0tLS0tLS0tLS0tKSBtYXJrIGNsZWFyIHZhbHVlIGJvdW5kYXJpZXMgZm9yIHJlbGlhYmxlIHBhcnNpbmdcclxuICAgIC8vIFBhcnNlciB3aWxsIGV4dHJhY3QgY29udGVudCBiZXR3ZWVuIGZpZWxkIGxhYmVsIGFuZCB0aGUgZGVsaW1pdGVyXHJcbiAgICBpb2NUeXBlLmZpZWxkcy5mb3JFYWNoKChmaWVsZDogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgY29udGVudCArPSBgJHtmaWVsZH06IFxcblxcblxcbi0tLS0tLS0tLS0tLVxcbmA7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBGaXhlZCBmb3JlbnNpYyBtZXRhZGF0YSBmaWVsZHMgYXBwZW5kZWQgdG8gZXZlcnkgY2FyZCB0eXBlLlxyXG4gICAgLy8gXCJUaW1lIG9mIEV2ZW50XCIgaXMgcHJlLWZpbGxlZCB3aXRoIHRoZSBjcmVhdGlvbiB0aW1lc3RhbXA7IHRoZSByZXN0XHJcbiAgICAvLyBhcmUgbGVmdCBibGFuayBmb3IgdGhlIGFuYWx5c3QuXHJcbiAgICAvLyBEZWxpbWl0ZXJzIGVuc3VyZSByZWxpYWJsZSB2YWx1ZSBleHRyYWN0aW9uIGV2ZW4gd2l0aCBtdWx0aS1saW5lIGNvbnRlbnQuXHJcbiAgICBjb250ZW50ICs9IGBUaW1lIG9mIEV2ZW50OiAke3RpbWVzdGFtcH1cXG5cXG5cXG4tLS0tLS0tLS0tLS1cXG5gO1xyXG4gICAgY29udGVudCArPSBgU3BsdW5rIFF1ZXJ5OiBcXG5cXG5cXG4tLS0tLS0tLS0tLS1cXG5gO1xyXG4gICAgY29udGVudCArPSBgTWl0cmUgVGFjdGljOiBcXG5cXG5cXG4tLS0tLS0tLS0tLS1cXG5gO1xyXG4gICAgY29udGVudCArPSBgTWl0cmUgVGVjaG5pcXVlOiBcXG5cXG5cXG4tLS0tLS0tLS0tLS1cXG5gO1xyXG5cclxuICAgIHJldHVybiBjb250ZW50O1xyXG59XHJcbiIsICIvKipcclxuICogQ2FudmFzQ29udGV4dE1lbnUudHMgLSBSaWdodC1jbGljayBjb250ZXh0IG1lbnUgZm9yIElPQyBjYXJkIHJvbGUgY29udmVyc2lvblxyXG4gKlxyXG4gKiBJbnRlcmNlcHRzIHRoZSBgY29udGV4dG1lbnVgIGV2ZW50IG9uIGNhbnZhcyBub2RlcyB0byBwcm92aWRlIElPQy1zcGVjaWZpY1xyXG4gKiBhY3Rpb25zOiBjb252ZXJ0aW5nIGJldHdlZW4gUGFyZW50IFtQXSBhbmQgQ2hpbGQgW0NdIHJvbGVzLCBhbmQgZGVsZXRpbmdcclxuICogc2VsZWN0ZWQgbm9kZXMuIE5vbi1JT0Mgbm9kZXMgYXJlIGxlZnQgYWxvbmUgc28gT2JzaWRpYW4ncyBkZWZhdWx0IGNvbnRleHRcclxuICogbWVudSBhcHBlYXJzIG5vcm1hbGx5LlxyXG4gKlxyXG4gKiBVc2VzIERPTS1sZXZlbCBldmVudCBpbnRlcmNlcHRpb24gYmVjYXVzZSBPYnNpZGlhbiBoYXMgbm8gb2ZmaWNpYWxcclxuICogYGNhbnZhczpub2RlLW1lbnVgIHdvcmtzcGFjZSBldmVudCBcdTIwMTQgb25seSBmaWxlLW1lbnUsIGVkaXRvci1tZW51LCBldGMuXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgQXBwLCBJdGVtVmlldywgTWVudSB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgREVCVUcgfSBmcm9tICcuLi9kZWJ1Zyc7XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gTGlzdGVuZXIgdHJhY2tpbmcgZm9yIGNsZWFudXBcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vKiogV2Vha01hcCB0byBzdG9yZSBsaXN0ZW5lciByZWZlcmVuY2VzIGZvciBjbGVhbnVwIG9uIHVubG9hZC4gKi9cclxuY29uc3QgbGlzdGVuZXJNYXAgPSBuZXcgV2Vha01hcDxIVE1MRWxlbWVudCwgKGU6IE1vdXNlRXZlbnQpID0+IHZvaWQ+KCk7XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gUm9sZSBjb252ZXJzaW9uXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLyoqXHJcbiAqIE1vZGlmeSBhIGNhbnZhcyBub2RlJ3MgdGV4dCB0byBjaGFuZ2UgaXRzIHJvbGUgYmFkZ2UuXHJcbiAqXHJcbiAqIFBlcmZvcm1zIHR3byBzdHJpbmcgcmVwbGFjZW1lbnRzIGluIHRoZSBIVE1MIGhlYWRlcjpcclxuICogICAtIENTUyBjbGFzczogaW9jLXJvbGUtcGFyZW50IDwtPiBpb2Mtcm9sZS1jaGlsZFxyXG4gKiAgIC0gQmFkZ2UgdGV4dDogPltQXTwgPC0+ID5bQ108XHJcbiAqXHJcbiAqIEBwYXJhbSBub2RlIC0gQ2FudmFzIG5vZGUgb2JqZWN0IChoYXMgLnRleHQgcHJvcGVydHkpXHJcbiAqIEBwYXJhbSB0YXJnZXRSb2xlIC0gVGhlIHJvbGUgdG8gY29udmVydCB0b1xyXG4gKi9cclxuZnVuY3Rpb24gY29udmVydENhcmRSb2xlKG5vZGU6IGFueSwgdGFyZ2V0Um9sZTogJ3BhcmVudCcgfCAnY2hpbGQnKTogdm9pZCB7XHJcbiAgICBjb25zdCB0ZXh0OiBzdHJpbmcgPSBub2RlLnRleHQgfHwgbm9kZS5nZXRUZXh0Py4oKSB8fCAnJztcclxuICAgIGlmICghdGV4dCkgcmV0dXJuO1xyXG5cclxuICAgIGxldCBuZXdUZXh0OiBzdHJpbmc7XHJcbiAgICBpZiAodGFyZ2V0Um9sZSA9PT0gJ2NoaWxkJykge1xyXG4gICAgICAgIC8vIFAgLT4gQ1xyXG4gICAgICAgIG5ld1RleHQgPSB0ZXh0XHJcbiAgICAgICAgICAgIC5yZXBsYWNlKCdpb2Mtcm9sZS1wYXJlbnQnLCAnaW9jLXJvbGUtY2hpbGQnKVxyXG4gICAgICAgICAgICAucmVwbGFjZSgnPltQXTwnLCAnPltDXTwnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gQyAtPiBQXHJcbiAgICAgICAgbmV3VGV4dCA9IHRleHRcclxuICAgICAgICAgICAgLnJlcGxhY2UoJ2lvYy1yb2xlLWNoaWxkJywgJ2lvYy1yb2xlLXBhcmVudCcpXHJcbiAgICAgICAgICAgIC5yZXBsYWNlKCc+W0NdPCcsICc+W1BdPCcpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFVwZGF0ZSB0aGUgbm9kZSB0ZXh0IHZpYSB0aGUgY2FudmFzIEFQSVxyXG4gICAgaWYgKG5vZGUuc2V0VGV4dCkge1xyXG4gICAgICAgIG5vZGUuc2V0VGV4dChuZXdUZXh0KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbm9kZS50ZXh0ID0gbmV3VGV4dDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoYFtDYW52YXNDb250ZXh0TWVudV0gQ29udmVydGVkIG5vZGUgdG8gJHt0YXJnZXRSb2xlfWApO1xyXG59XHJcblxyXG4vKipcclxuICogQ2hlY2sgaWYgYSBub2RlJ3MgdGV4dCBjb250YWlucyBhbiBJT0Mgcm9sZSBiYWRnZSAoW1BdIG9yIFtDXSkuXHJcbiAqIEByZXR1cm5zICdwYXJlbnQnIHwgJ2NoaWxkJyB8IG51bGxcclxuICovXHJcbmZ1bmN0aW9uIGdldE5vZGVSb2xlKG5vZGU6IGFueSk6ICdwYXJlbnQnIHwgJ2NoaWxkJyB8IG51bGwge1xyXG4gICAgY29uc3QgdGV4dDogc3RyaW5nID0gbm9kZS50ZXh0IHx8IG5vZGUuZ2V0VGV4dD8uKCkgfHwgJyc7XHJcbiAgICBpZiAoLz5cXFtQXFxdPC8udGVzdCh0ZXh0KSkgcmV0dXJuICdwYXJlbnQnO1xyXG4gICAgaWYgKC8+XFxbQ1xcXTwvLnRlc3QodGV4dCkpIHJldHVybiAnY2hpbGQnO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbn1cclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBDb250ZXh0IG1lbnUgaGFuZGxlclxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8qKlxyXG4gKiBTZXQgdXAgdGhlIHJpZ2h0LWNsaWNrIGNvbnRleHQgbWVudSBvbiBhIGNhbnZhcyB3cmFwcGVyIGVsZW1lbnQuXHJcbiAqXHJcbiAqIEF0dGFjaGVzIGEgYGNvbnRleHRtZW51YCBsaXN0ZW5lciAoY2FwdHVyZSBwaGFzZSkgdGhhdDpcclxuICogICAxLiBGaW5kcyB0aGUgY2xpY2tlZCAuY2FudmFzLW5vZGUgZWxlbWVudFxyXG4gKiAgIDIuIE1hcHMgaXQgdG8gYSBjYW52YXMgbm9kZSBvYmplY3QgdmlhIG5vZGVFbCBjb21wYXJpc29uXHJcbiAqICAgMy4gQ2hlY2tzIGlmIHRoZSBub2RlIGlzIGFuIElPQyBjYXJkIChoYXMgW1BdIG9yIFtDXSBiYWRnZSlcclxuICogICA0LiBTaG93cyBhbiBPYnNpZGlhbiBNZW51IHdpdGggcm9sZSBjb252ZXJzaW9uICsgZGVsZXRlIG9wdGlvbnNcclxuICpcclxuICogRm9yIG5vbi1JT0Mgbm9kZXMsIHRoZSBldmVudCBwcm9wYWdhdGVzIG5vcm1hbGx5IHNvIE9ic2lkaWFuJ3NcclxuICogZGVmYXVsdCBjb250ZXh0IG1lbnUgYXBwZWFycy5cclxuICpcclxuICogQHBhcmFtIGFwcCAtIE9ic2lkaWFuIEFwcCBpbnN0YW5jZVxyXG4gKiBAcGFyYW0gY2FudmFzIC0gVGhlIGludGVybmFsIGNhbnZhcyBvYmplY3QgKGhhcyAubm9kZXMsIC5zZWxlY3Rpb24sIC53cmFwcGVyRWwpXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gc2V0dXBDYW52YXNDb250ZXh0TWVudShhcHA6IEFwcCwgY2FudmFzOiBhbnkpOiB2b2lkIHtcclxuICAgIGNvbnN0IHdyYXBwZXJFbDogSFRNTEVsZW1lbnQgPSBjYW52YXMud3JhcHBlckVsO1xyXG4gICAgaWYgKCF3cmFwcGVyRWwpIHJldHVybjtcclxuXHJcbiAgICAvLyBQcmV2ZW50IGR1cGxpY2F0ZSBsaXN0ZW5lcnMgb24gdGhlIHNhbWUgd3JhcHBlclxyXG4gICAgaWYgKGxpc3RlbmVyTWFwLmhhcyh3cmFwcGVyRWwpKSByZXR1cm47XHJcblxyXG4gICAgY29uc3QgaGFuZGxlciA9IChlOiBNb3VzZUV2ZW50KSA9PiB7XHJcbiAgICAgICAgLy8gU3RlcCAxOiBGaW5kIHRoZSBjbGlja2VkIC5jYW52YXMtbm9kZSBET00gZWxlbWVudFxyXG4gICAgICAgIGNvbnN0IG5vZGVFbCA9IChlLnRhcmdldCBhcyBIVE1MRWxlbWVudCkuY2xvc2VzdCgnLmNhbnZhcy1ub2RlJyk7XHJcbiAgICAgICAgaWYgKCFub2RlRWwpIHJldHVybjsgLy8gQ2xpY2sgd2Fzbid0IG9uIGEgbm9kZSBcdTIwMTQgbGV0IGRlZmF1bHQgbWVudSBzaG93XHJcblxyXG4gICAgICAgIC8vIFN0ZXAgMjogTWFwIERPTSBlbGVtZW50IHRvIGNhbnZhcyBub2RlIG9iamVjdFxyXG4gICAgICAgIGxldCB0YXJnZXROb2RlOiBhbnkgPSBudWxsO1xyXG4gICAgICAgIGNhbnZhcy5ub2Rlcy5mb3JFYWNoKChub2RlOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKG5vZGUubm9kZUVsID09PSBub2RlRWwgfHwgbm9kZS5jb250ZW50RWwgPT09IG5vZGVFbCkge1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0Tm9kZSA9IG5vZGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAoIXRhcmdldE5vZGUpIHJldHVybjtcclxuXHJcbiAgICAgICAgLy8gU3RlcCAzOiBDaGVjayBpZiB0aGlzIGlzIGFuIElPQyBjYXJkXHJcbiAgICAgICAgY29uc3QgY2xpY2tlZFJvbGUgPSBnZXROb2RlUm9sZSh0YXJnZXROb2RlKTtcclxuICAgICAgICBpZiAoIWNsaWNrZWRSb2xlKSByZXR1cm47IC8vIE5vdCBhbiBJT0MgY2FyZCBcdTIwMTQgbGV0IE9ic2lkaWFuIGhhbmRsZSBpdFxyXG5cclxuICAgICAgICAvLyBTdGVwIDQ6IFByZXZlbnQgT2JzaWRpYW4ncyBkZWZhdWx0IGNvbnRleHQgbWVudVxyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xyXG5cclxuICAgICAgICAvLyBTdGVwIDU6IERldGVybWluZSBzZWxlY3Rpb24gXHUyMDE0IHNpbmdsZSBjYXJkIG9yIG11bHRpLXNlbGVjdFxyXG4gICAgICAgIGNvbnN0IHNlbGVjdGVkTm9kZXM6IGFueVtdID0gW107XHJcbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gY2FudmFzLnNlbGVjdGlvbjtcclxuICAgICAgICBpZiAoc2VsZWN0aW9uICYmIHNlbGVjdGlvbi5zaXplID4gMSAmJiBzZWxlY3Rpb24uaGFzKHRhcmdldE5vZGUpKSB7XHJcbiAgICAgICAgICAgIC8vIE11bHRpLXNlbGVjdDogb3BlcmF0ZSBvbiBhbGwgc2VsZWN0ZWQgSU9DIGNhcmRzXHJcbiAgICAgICAgICAgIHNlbGVjdGlvbi5mb3JFYWNoKChub2RlOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChnZXROb2RlUm9sZShub2RlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkTm9kZXMucHVzaChub2RlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gU2luZ2xlIGNhcmRcclxuICAgICAgICAgICAgc2VsZWN0ZWROb2Rlcy5wdXNoKHRhcmdldE5vZGUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gU3RlcCA2OiBCdWlsZCB0aGUgbWVudVxyXG4gICAgICAgIGNvbnN0IG1lbnUgPSBuZXcgTWVudSgpO1xyXG4gICAgICAgIGNvbnN0IGlzTXVsdGkgPSBzZWxlY3RlZE5vZGVzLmxlbmd0aCA+IDE7XHJcblxyXG4gICAgICAgIGlmIChpc011bHRpKSB7XHJcbiAgICAgICAgICAgIC8vIE11bHRpLXNlbGVjdDogc2hvdyBib3RoIGNvbnZlcnNpb24gb3B0aW9uc1xyXG4gICAgICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoJ0NvbnZlcnQgdG8gUGFyZW50IFtQXScpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldEljb24oJ2Fycm93LXVwLWNpcmNsZScpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZE5vZGVzLmZvckVhY2gobiA9PiBjb252ZXJ0Q2FyZFJvbGUobiwgJ3BhcmVudCcpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLnJlcXVlc3RTYXZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoJ0NvbnZlcnQgdG8gQ2hpbGQgW0NdJylcclxuICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbignYXJyb3ctZG93bi1jaXJjbGUnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWROb2Rlcy5mb3JFYWNoKG4gPT4gY29udmVydENhcmRSb2xlKG4sICdjaGlsZCcpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLnJlcXVlc3RTYXZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIFNpbmdsZSBjYXJkOiBzaG93IG9ubHkgdGhlIG9wcG9zaXRlIHJvbGVcclxuICAgICAgICAgICAgY29uc3Qgb3Bwb3NpdGVSb2xlID0gY2xpY2tlZFJvbGUgPT09ICdwYXJlbnQnID8gJ2NoaWxkJyA6ICdwYXJlbnQnO1xyXG4gICAgICAgICAgICBjb25zdCBsYWJlbCA9IG9wcG9zaXRlUm9sZSA9PT0gJ3BhcmVudCdcclxuICAgICAgICAgICAgICAgID8gJ0NvbnZlcnQgdG8gUGFyZW50IFtQXSdcclxuICAgICAgICAgICAgICAgIDogJ0NvbnZlcnQgdG8gQ2hpbGQgW0NdJztcclxuICAgICAgICAgICAgY29uc3QgaWNvbiA9IG9wcG9zaXRlUm9sZSA9PT0gJ3BhcmVudCdcclxuICAgICAgICAgICAgICAgID8gJ2Fycm93LXVwLWNpcmNsZSdcclxuICAgICAgICAgICAgICAgIDogJ2Fycm93LWRvd24tY2lyY2xlJztcclxuXHJcbiAgICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShsYWJlbClcclxuICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbihpY29uKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udmVydENhcmRSb2xlKHRhcmdldE5vZGUsIG9wcG9zaXRlUm9sZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcy5yZXF1ZXN0U2F2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFNlcGFyYXRvciArIERlbGV0ZSBvcHRpb25cclxuICAgICAgICBtZW51LmFkZFNlcGFyYXRvcigpO1xyXG4gICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICBpdGVtLnNldFRpdGxlKCdEZWxldGUnKVxyXG4gICAgICAgICAgICAgICAgLnNldEljb24oJ3RyYXNoJylcclxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZE5vZGVzLmZvckVhY2gobiA9PiBjYW52YXMucmVtb3ZlTm9kZShuKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLnJlcXVlc3RTYXZlKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbWVudS5zaG93QXRNb3VzZUV2ZW50KGUpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyBBdHRhY2ggb24gY2FwdHVyZSBwaGFzZSB0byBpbnRlcmNlcHQgYmVmb3JlIE9ic2lkaWFuJ3MgaGFuZGxlclxyXG4gICAgd3JhcHBlckVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NvbnRleHRtZW51JywgaGFuZGxlciwgdHJ1ZSk7XHJcbiAgICBsaXN0ZW5lck1hcC5zZXQod3JhcHBlckVsLCBoYW5kbGVyKTtcclxuXHJcbiAgICBpZiAoREVCVUcpIGNvbnNvbGUuZGVidWcoJ1tDYW52YXNDb250ZXh0TWVudV0gQ29udGV4dCBtZW51IGhhbmRsZXIgYXR0YWNoZWQnKTtcclxufVxyXG5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIENsZWFudXBcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vKipcclxuICogUmVtb3ZlIHRoZSBjb250ZXh0IG1lbnUgbGlzdGVuZXIgZnJvbSBhIGNhbnZhcyB3cmFwcGVyIGVsZW1lbnQuXHJcbiAqIENhbGxlZCBkdXJpbmcgcGx1Z2luIHVubG9hZCB0byBwcmV2ZW50IG1lbW9yeSBsZWFrcy5cclxuICpcclxuICogQHBhcmFtIHdyYXBwZXJFbCAtIFRoZSBjYW52YXMgd3JhcHBlciBET00gZWxlbWVudFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUNhbnZhc0NvbnRleHRNZW51KHdyYXBwZXJFbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuICAgIGNvbnN0IGhhbmRsZXIgPSBsaXN0ZW5lck1hcC5nZXQod3JhcHBlckVsKTtcclxuICAgIGlmIChoYW5kbGVyKSB7XHJcbiAgICAgICAgd3JhcHBlckVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NvbnRleHRtZW51JywgaGFuZGxlciwgdHJ1ZSk7XHJcbiAgICAgICAgbGlzdGVuZXJNYXAuZGVsZXRlKHdyYXBwZXJFbCk7XHJcbiAgICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmRlYnVnKCdbQ2FudmFzQ29udGV4dE1lbnVdIENvbnRleHQgbWVudSBoYW5kbGVyIHJlbW92ZWQnKTtcclxuICAgIH1cclxufVxyXG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWVBLElBQUFBLG9CQUF3Qzs7O0FDTHhDLElBQUFDLG1CQUEyQjs7O0FDVHBCLElBQU0sUUFBUTs7O0FDd0JkLElBQU0sb0JBQXlEO0FBQUEsRUFDbEUsRUFBRSxTQUFTLGVBQWUsTUFBTSxhQUFhO0FBQUEsRUFDN0MsRUFBRSxTQUFTLGdCQUFnQixNQUFNLGNBQWM7QUFBQSxFQUMvQyxFQUFFLFNBQVMsY0FBYyxNQUFNLFlBQVk7QUFBQSxFQUMzQyxFQUFFLFNBQVMsUUFBUSxNQUFNLE1BQU07QUFBQSxFQUMvQixFQUFFLFNBQVMsa0JBQWtCLE1BQU0sZ0JBQWdCO0FBQUEsRUFDbkQsRUFBRSxTQUFTLGFBQWEsTUFBTSxXQUFXO0FBQUEsRUFDekMsRUFBRSxTQUFTLGNBQWMsTUFBTSxZQUFZO0FBQUEsRUFDM0MsRUFBRSxTQUFTLGVBQWUsTUFBTSxhQUFhO0FBQUEsRUFDN0MsRUFBRSxTQUFTLGlCQUFpQixNQUFNLGVBQWU7QUFBQSxFQUNqRCxFQUFFLFNBQVMsaUJBQWlCLE1BQU0sZUFBZTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBSWpELEVBQUUsU0FBUyxZQUFZLE1BQU0sVUFBVTtBQUFBLEVBQ3ZDLEVBQUUsU0FBUyxpQkFBaUIsTUFBTSxlQUFlO0FBQUEsRUFDakQsRUFBRSxTQUFTLFNBQVMsTUFBTSxPQUFPO0FBQUEsRUFDakMsRUFBRSxTQUFTLFNBQVMsTUFBTSxPQUFPO0FBQUEsRUFDakMsRUFBRSxTQUFTLFFBQVEsTUFBTSxNQUFNO0FBQUEsRUFDL0IsRUFBRSxTQUFTLE9BQU8sTUFBTSxLQUFLO0FBQ2pDO0FBZ0JPLFNBQVMsY0FBYyxNQUFzQjtBQUNoRCxhQUFXLEVBQUUsU0FBUyxLQUFLLEtBQUssbUJBQW1C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VSxNQUFNO0FBQ1osYUFBSyxnQkFBZ0IsaUJBQWlCLEtBQUssS0FBSyxLQUFLLGFBQWE7QUFDbEUsZUFBTyxLQUFLO0FBQUEsTUFDaEI7QUFBQSxNQUNBLFNBQVMsTUFBTTtBQUNYLGNBQU0sb0JBQW9CLHVCQUF1QixLQUFLLEdBQUc7QUFDekQsWUFBSSxpQkFBaUIsS0FBSyxLQUFLLE1BQU0saUJBQWlCLEVBQUUsS0FBSztBQUFBLE1BQ2pFO0FBQUEsSUFDSixDQUFDO0FBR0QsUUFBSTtBQUNBLFlBQU0sYUFBYSxLQUFLLElBQUksVUFBVSxvQkFBb0IsMEJBQVE7QUFDbEUsVUFBSSxjQUFjLFdBQVcsWUFBWSxNQUFNLFVBQVU7QUFDckQsY0FBTSxTQUFVLFdBQW1CO0FBQ25DLFlBQUksaUNBQVEsV0FBVztBQUNuQixlQUFLLGtCQUFrQixPQUFPO0FBQzlCLGlDQUF1QixLQUFLLEtBQUssTUFBTTtBQUFBLFFBQzNDO0FBQUEsTUFDSjtBQUFBLElBQ0osU0FBUyxLQUFQO0FBQ0UsY0FBUSxNQUFNLDZDQUE2QyxHQUFHO0FBQUEsSUFDbEU7QUFBQSxFQUNKO0FBQ0o7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAidmFsdWUiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIl0KfQo=
